'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1118:function(D,P,b){b.r(P);D=b(0);var f=b(212),c=b(1141),n=b(1124),m=b(1305),w=b(1306);class z{constructor(t,A){this.Vnb=!1;this.ina=null;if(!t)throw Error.argumentNull("annotations");if(!t.Rwc(A))throw Error.argument("structTypeID","Invalid struct type ID");this.gw=t;this.Gxc=this.gw.w2h(A);this.UKj=A}get Fmc(){return this.gw}get isReadOnly(){return this.Vnb}get G1a(){return this.UKj}Eub(t){if(0>t||t>=this.Gxc)throw Error.argument("iField",
"Invalid field index");return this.ina&&null!=this.ina[t]?this.ina[t]:this.gw.X5h(this.G1a,t)}Wyg(t,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.Gxc)throw Error.argument("iField","Invalid field index");if(!this.gw.Svc(this.gw.BZb(this.G1a,t),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.ina||(this.ina=Array(this.Gxc)))[t]=A}bja(){const {Annotations:t}=b(1118);let A="[";if(this.ina){let B=
!0;for(let S=0;S<this.Gxc;++S){if(null==this.ina[S])continue;const C=this.gw.BZb(this.G1a,S);if(t.PFb(C,this.ina[S],this.gw.X5h(this.G1a,S)))continue;B?B=!1:A+=", ";A+=this.gw.Y5h(this.G1a,S);A+="=";const H=this.gw.bja(C,this.ina[S]);C===t.Bca?(A+='"',A+=c.a.ACf(H),A+='"'):A+=H}}return A+"]"}isEqual(t){const {Annotations:A}=b(1118);if(this===t)return!0;if(!t||this.gw!==t.Fmc||this.G1a!==t.G1a)return!1;for(let B=0;B<this.Gxc;++B)if(!A.PFb(this.gw.BZb(this.G1a,B),this.Eub(B),t.Eub(B)))return!1;return!0}clone(){const t=
new z(this.gw,this.G1a);this.ina&&(t.ina=Array.clone(this.ina));return t}zW(){return this.isReadOnly?this.clone():this}O5f(){const {Annotations:t}=b(1118);if(!this.isReadOnly&&(this.Vnb=!0,this.ina))for(let A=0;A<this.Gxc;++A){const B=this.ina[A];null!=B&&t.i3b(B)}}toString(){return this.bja()}}Object(D.a)(z,"StructValue",null,[1462,1459]);b.d(P,"Annotations",function(){return v});class v{constructor(t,A){if(!t)throw Error.argumentNull("initData");if(!A)throw Error.argumentNull("objectFetcher");this.NHl=
A.$xk;let B=0;var S=A.uub(t.J(B));++B;this.Q9f=new m.a(new w.a(S));this.rtj=t.J(B);++B;this.Tsi=Array(this.u$d);this.Ird=Array(this.u$d);this.Xzb=Array(this.u$d);for(S=0;S<this.u$d;++S){this.Tsi[S]=A.getString(t.J(B));++B;this.Ird[S]=t.J(B);++B;var C=t.J(B);++B;this.Xzb[S]=Array(C);for(var H=0;H<C;++H)this.Xzb[S][H]=A.getString(t.J(B)),++B}this.TKj=t.J(B);++B;this.rti=Array(this.TEd);this.sne=Array(this.TEd);this.tne=Array(this.TEd);this.rne=Array(this.TEd);for(S=0;S<this.TEd;++S)for(this.rti[S]=
A.getString(t.J(B)),++B,C=t.J(B),++B,this.sne[S]=Array(C),this.tne[S]=Array(C),this.rne[S]=Array(C),H=0;H<C;++H)this.sne[S][H]=A.getString(t.J(B)),++B,this.tne[S][H]=t.J(B),++B,this.rne[S][H]=({pma:B}=this.PWa(this.tne[S][H],t,B,null,null,null)).returnValue,v.i3b(this.rne[S][H]);this.Pnj=t.J(B);++B;this.x9f=Array(this.Zmc);this.y9f=Array(this.Zmc);this.w9f=Array(this.Zmc);for(S=0;S<this.Zmc;++S)this.x9f[S]=A.getString(t.J(B)),++B,this.y9f[S]=t.J(B),++B,this.w9f[S]=({pma:B}=this.PWa(this.y9f[S],t,
B,null,null,null)).returnValue,v.i3b(this.w9f[S])}Wed(t){for(let A=0;A<this.Zmc;++A)if(this.x9f[A]===t)return A;return-1}UWh(t){if(!this.Qwc(t))throw Error.argument("attrID","Invalid attribute ID");return this.x9f[t]}getAttributeType(t){if(!this.Qwc(t))throw Error.argument("attrID","Invalid attribute ID");return this.y9f[t]}BZb(t,A){if(!this.Rwc(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.tne[v.UEd(t)];if(0>A||A>=t.length)throw Error.argument("iField","Invalid field index");
return t[A]}bja(t,A){if(!this.r3f(t))throw Error.argument("typeID","Invalid type ID");if(!this.Svc(t,A))throw Error.argument("value","Value is not of the correct type");switch(t){case v.Bca:return A;case v.kEa:return A?"True":"False";case v.BRa:case v.rxa:return A.toString();case v.kY:return A.bja();default:if(!v.dJ(t)&&v.dHd(t)){t=v.oCf(t);const C=this.Xzb[t].length;switch(this.Ird[t]){case 0:return this.Xzb[t][A];case 1:if(A){var B="";for(var S=1;S<C;++S)A&1<<S-1&&(0<B.length&&(B+=" & "),B+=this.Xzb[t][S]);
return B}return this.Xzb[t][0];case 2:B="";for(S=0;S<C;++S)A&1<<S&&(0<B.length&&(B+=" & "),B+=this.Xzb[t][S]);return B;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Ird[t]);}}else return A.bja()}}r3f(t){switch(t){case v.Bca:case v.kEa:case v.BRa:case v.rxa:case v.kY:return!0;default:return v.dJ(t)?this.r3f(v.Mcb(t)):v.dHd(t)?this.Dzl(t):this.Rwc(t)}}Dzl(t){t=v.oCf(t);return 0<=t&&t<this.Tsi.length}Rwc(t){t=v.UEd(t);return 0<=t&&t<this.rti.length}Qwc(t){return 0<=t&&t<
this.Zmc}Svc(t,A){if(null==A)return!1;switch(t){case v.Bca:return"string"===typeof A;case v.kEa:return"boolean"===typeof A;case v.BRa:return"number"===typeof A;case v.rxa:return"number"===typeof A;case v.kY:return Object(f.a)(1458,A);default:if(v.dJ(t))return Object(f.a)(1461,A)&&A.l8===v.Mcb(t);if(v.dHd(t)){if("number"!==typeof A)return!1;t=v.oCf(t);const B=this.Xzb[t].length;switch(this.Ird[t]){case 0:return 0<=A&&A<B;case 1:return!(A&-1<<B-1);case 2:return!!A&&!(A&-1<<B);default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.Ird[t]);}}else return Object(f.a)(1462,A)&&A.G1a===t}}get Zmc(){return this.Pnj}get u$d(){return this.rtj}get TEd(){return this.TKj}CNk(t){if(!this.Qwc(t))throw Error.argument("attrID","Invalid attribute ID");return this.w9f[t]}w2h(t){if(!this.Rwc(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.sne[v.UEd(t)].length}Y5h(t,A){if(!this.Rwc(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.sne[v.UEd(t)][A]}X5h(t,A){if(!this.Rwc(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.rne[v.UEd(t)];if(0>A||A>=t.length)throw Error.argument("iField","Invalid field index");return t[A]}PWa(t,A,B,S,C,H){if(!A)throw Error.argumentNull("initData");if(v.dJ(t)){var J=A.J(B);++B;t=v.Mcb(t);var M=new n.a(this,t);for(var G=0;G<J;++G)Array.add(M.items,({pma:B}=this.PWa(t,A,B,S,C,H)).returnValue);return{returnValue:M,pma:B}}switch(t){case v.Bca:return{returnValue:(S||this.Q9f).getString(A.J(B++)),pma:B};case v.kEa:return{returnValue:1===A.J(B++),pma:B};case v.BRa:return{returnValue:A.J(B++),
pma:B};case v.rxa:return{returnValue:(C||this.NHl)[A.J(B++)],pma:B};case v.kY:t=A.J(B++);J=new c.a(this);for(M=0;M<t;++M)G=A.J(B),++B,H&&(G=H[G]),J.Ly(G,({pma:B}=this.PWa(this.getAttributeType(G),A,B,S,C,H)).returnValue);return{returnValue:J,pma:B};default:if(v.dHd(t))return{returnValue:A.J(B++),pma:B};if(v.b$i(t)){J=A.J(B++);M=new z(this,t);for(G=0;G<J;++G){const R=A.J(B);++B;M.Wyg(R,({pma:B}=this.PWa(this.BZb(t,R),A,B,S,C,H)).returnValue)}return{returnValue:M,pma:B}}throw Error.argument("typeID",
"Invalid type ID");}}static dHd(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static b$i(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static dJ(t){return 32768===(t&32768)}static KYk(t){if(v.dJ(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static Mcb(t){if(!v.dJ(t))throw Error.argument("listTypeID","List type ID required");return t&-32769}static PFb(t,A,B){switch(t){case v.Bca:case v.kEa:case v.BRa:case v.rxa:return A===B;case v.kY:return A.isEqual(B);
default:return v.dJ(t)?A.isEqual(B):v.dHd(t)?A===B:A.isEqual(B)}}static i3b(t){Object(f.a)(1459,t)&&t.O5f()}static zW(t){return Object(f.a)(1459,t)?t.zW():t}static oCf(t){return t-16}static UEd(t){return(t&-16385)-16}}v.Bca=1;v.kEa=2;v.BRa=3;v.rxa=5;v.kY=9;Object(D.a)(v,"Annotations",null,[1463])},1119:function(D,P,b){D=b(0);var f=b(18),c=b(38),n=b(5),m=b(97),w=b(126),z=b(690),v=b(184),t=b(531),A=b(381),B=b(21),S=b(42),C=b(203),H=b(1),J=b(1208);class M{constructor(I,K){this.ytj=I;this.xC=K}J(I){return this.ytj.uz(I,
this.xC)}}Object(D.a)(M,"PropertyMergeStrategies",null,[]);var G=b(1300),R=b(1404);b.d(P,"a",function(){return O});class O{constructor(I=null){this.Xdh=null;this.Lic=I||this.ohd()}get Mn(){return 1}get iAb(){return this.Lic}ohd(){return[Object(S.a)(this,this.vTm,"tryPreProcessFavoredRevision"),Object(S.a)(this,this.vdk,"cloneObjectAndRemoveNeededProperties"),Object(S.a)(this,this.mTm,"tryMergeNodeInternal")]}get xC(){return 5}get gxd(){return this.Xdh||(this.Xdh=new M(this.uk(),this.xC))}cD(I,K){const Y=
I.Lf.value.Ie;w.a.instance.ya(4016352,1,3,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",Y.id,Y.Ab);I.fo.logger.wf(Object.assign(new R.a,{Mn:this.Mn,pyc:Y.Ab,fxd:K}));return!1}MKg(I){const K=I.Lf.value;w.a.instance.ya(4016353,1,4,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",K.Ie.id,K.Ie.Ab);for(let Y=0;Y<this.iAb.length;Y++)if(!(0,this.iAb[Y])(I))return w.a.instance.ya(4016354,1,
3,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",K.Ie.id,K.Ie.Ab,Y),I.fo.logger.Ume("GraphNodeComplexMerge.GetMergeFunctions()",Y),this.mFl(I),I.jl=null,!1;w.a.instance.ya(4016355,1,4,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",K.Ie.id,K.Ie.Ab);return!0}mFl(I){I.JPg||(I.JPg=!0,G.a(I.Lf.value.Kr,"Base",1),G.a(I.Lf.value.Ie,"Favored",1),G.a(I.Zm.value.Ie,"Conflict",1))}vTm(I){const K=I.Lf.value,Y=this.gxd;if(!K.iU)return!0;let W=
!0;K.bia.forEach((Z,U)=>{if(!U.iU||I.ig.contains(Z))return!0;U=Y.J(Z);if(5===U){const X=K.Kr.Ab;w.a.instance.ya(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",X,Z,U);I.fo.logger.wf(Object.assign(new R.a,{Mn:this.Mn,pyc:X,fxd:Z,psd:U}));return W=!1}6===U&&I.Pmg.add(Z);return!0});return W}vdk(I){I.jl=I.Lf.value.Ie.gF();const K=I.Pmg,Y=I.jl;K&&K.forEach(W=>{Y.removeProperty(z.a.Lla(W));return!0});
return!0}mTm(I){const K=I.Zm.value,Y=K.Kr.Ab,W=this.gxd;let Z=!0;K.bia.forEach((U,X)=>{const fa=W.J(U);Z=this.nTm(I,X,U,fa);Z||(I.jl=null,w.a.instance.ya(4018177,1,3,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",Y,U,fa),I.fo.logger.wf(Object.assign(new R.a,{Mn:this.Mn,pyc:Y,fxd:U,psd:fa})));return Z});return Z}nTm(I,K,Y,W){const Z=I.jl;if(!K.iU&&8!==W||2===W||7===W||I.ig.contains(Y))return!0;if(5===W)return!1;if(4===W||3===W){let U;if(({value:U}=I.Lf.value.bia.tb(Y)).returnValue&&
U.iU)return 4!==W;W=0}8===W&&(W=0);if(!W){if(!K.isDeleted)return I=z.a.Lla(Y),(O.v1m(K,Y,I)||O.tEm())&&Z.ooa(I,K.newValue),!0;W=6}return 6===W?(Z.removeProperty(z.a.Lla(Y)),!0):1===W?this.cD(I,Y):!1}pLl(I,K,Y,W){I=I||new v.a;K=K||new v.a;Y=Y||new v.a;I=I.d9();const Z=new t.a;let U=I.length;for(let X=U;X<K.length;X++){let fa=K.Ye(X);I.add(fa);Z.add(fa)}for(;U<Y.length;U++)K=Y.Ye(U),Z.contains(K)?w.a.instance.ya(4018180,1,4,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",
K):(I.add(K),W(K));return I}Oui(I,K,Y,W){return J.a(I,K,Y,W)}b_a(I,K,Y){I=I||new v.a;K=K||new v.a;Y=Y||new v.a;const W=I.zH(),Z=K.zH(),U=Y.zH();I=O.filter(I,X=>Z.contains(X)&&U.contains(X));I.zH();I.aw(I.length,O.filter(K,X=>!W.contains(X)));I.aw(I.length,O.filter(Y,X=>!W.contains(X)&&!Z.contains(X)));return I}kLl(I,K){const Y=z.a.Lla(K),W=I.Xc;var Z=W.getPropertyObjectIds(I.Lf.value.Kr,Y),U=W.getPropertyObjectIds(I.Lf.value.Ie,Y);const X=W.getPropertyObjectIds(I.Zm.value.Ie,Y);Z=this.b_a(Z,U,X);
U=I.jl;0<Z.length?W.setPropertyObjectIds(U,Y,Z):U.removeProperty(Y);I.ig.add(K)}ssb(I,K,Y){I.hasProperty(Y)?K.ooa(Y,I.ZW(Y)):K.removeProperty(Y)}Nlm(I,K){var Y=K.Hl();for(const W of Y)K.removeProperty(W);Y=I.Hl();for(const W of Y)K.ooa(W,I.ZW(W))}U3f(I,K,Y,W,Z){K=I.getPropertyInt32(K,Z);Y=I.getPropertyInt32(Y,Z);Y=null!=K&&null!=Y?Math.max(K,Y):null!=Y?Y:null!=K?K:null;null!=Y?I.setPropertyInt32(W,Z,Y):W.removeProperty(Z)}pof(I,K,Y,W,Z,U){K=I(K,Z);Y=I(Y,Z);I=I(W,Z);W=K.zH();let X=!1;U&&(X=U(K,Y,I));
X?(U=!0,W=!1):(U=W.rFh(Y),W=W.rFh(I));w.a.instance.ya(588011013,1,3,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.Ya(Z),K.So(),Y.So(),I.So(),U,W);return{x8c:I,Eeb:U,ueb:W}}oak(I,K,Y,W,Z){let U;K=I(K,Z);Y=I(Y,Z);I=I(W,Z);W=this.Nli(K,Y);U=this.Nli(K,I);w.a.instance.ya(588011014,1,3,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.Ya(Z),K.So(),Y.So(),I.So(),W,U);return{x8c:I,Eeb:W,ueb:U}}Nli(I,K){if(!I&&!K)return!0;if(!I||!K)return!1;if(!I.count&&!K.count)return!0;let Y=!1;K.forEach((W,Z)=>Y=I.La(W)&&Z==I.J(W));return Y}uk(){const I=O.rAj.value,K=new A.a(0);for(let Y=0;Y<I.length;Y++)K.W(I[Y],7);return K}static t2(){return new O}static get instance(){return O.ra.value}static tEm(){return B.a.instance.sa("Box4.IFeatureHelper").isFeatureEnabled(128)}static v1m(I,K,Y){if(void 0!==I.newValue&&null!==I.newValue||H.a.Uji(Y.type))return!0;
O.SFl(I,K,Y);return!1}static SFl(I,K,Y){Y=Y.type===H.a.string;K=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",K);Y||(K+=String.format(" [NewValue: {0}] [OldValue: {1}]",I.newValue,I.oldValue));w.a.instance.ya(19145822,1,2,K)}static filter(I,K){const Y=new v.a;I.forEach(W=>{K(W)&&Y.add(W);return!0});return Y}static vWk(){return[z.a.Ya(f.a.OPh),z.a.Ya(f.a.lastModifiedTime),z.a.Ya(f.a.cH),z.a.Ya(f.a.QCc),z.a.Ya(f.a.FRi),z.a.Ya(c.a.k6b),z.a.Ya(n.a.Y5d),z.a.Ya(n.a.aWb),z.a.Ya(m.a.oqm)]}}
O.ra=new C.a(O.t2);O.rAj=new C.a(O.vWk);Object(D.a)(O,"GraphNodeComplexMerge",null,[1347])},1124:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(1141);class c{constructor(n,m){this.Vnb=!1;const {Annotations:w}=b(1118);if(!n)throw Error.argumentNull("annotations");if(!n.r3f(m))throw Error.argument("memberTypeID","Invalid type ID");if(w.dJ(m))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.gw=n;this.JBj=m;this.hp=[]}get Fmc(){return this.gw}get isReadOnly(){return this.Vnb}get l8(){return this.JBj}get items(){return this.hp}bja(){const {Annotations:n}=
b(1118);let m="[";for(let w=0,z=this.items.length;w<z;++w){0<w&&(m+=", ");const v=this.gw.bja(this.l8,this.items[w]);this.l8===n.Bca?(m+='"',m+=f.a.ACf(v),m+='"'):m+=v}return m+"]"}isEqual(n){const {Annotations:m}=b(1118);if(this===n)return!0;if(!n||n.Fmc!==this.gw||n.l8!==this.l8||n.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!m.PFb(this.l8,this.items[w],n.items[w]))return!1;return!0}clone(){const n=new c(this.gw,this.l8);Array.addRange(n.items,this.items);return n}zW(){return this.isReadOnly?
this.clone():this}O5f(){const {Annotations:n}=b(1118);if(!this.isReadOnly){this.Vnb=!0;for(const m of this.items)n.i3b(m)}}toString(){return this.bja()}}Object(D.a)(c,"ListValue",null,[1461,1459])},1126:function(D,P,b){D=b(0);var f=b(293);class c{constructor(){this.userId=this.email=this.displayName=null}}Object(D.a)(c,"InsertMentionParameters",null,[]);class n{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(n,"InsightsParameters",null,[]);var m=b(1415),w=
b(1416),z=b(1417),v=b(1418),t=b(2),A=b(1188),B=b(1203),S=b(30),C=b(15),H=b(16),J=b(1114);b.d(P,"a",function(){return M});class M{static get dXf(){return"Insights_16x16x32"}static get LFk(){return"Find_16x16x32"}static get wFi(){return"-Parameterized"}static get vEg(){return"Parameterized"}static get CEe(){return"bTryQuery"}static get UKg(){return"TellMeSuggestion_"}static get B9i(){return"bTryQueryAlternate"}static get hIg(){return"MenuTellMe"}static get d3l(){const G={},R=[];Array.add(R,{Term:{PeopleType:"Person"}});
G.And=R;return G}static cwf(G){return G+M.wFi}static getParameter(G){let R="",O="";if(G)for(let I=0;I<G.pSh;++I)"Type"===G.DKf(I)?R=G.getValue(I):"Value"===G.DKf(I)&&(O=G.getValue(I));return new f.a(R,O)}static Yoc(G){G=Object.assign(new n,{neighborhood:G,mentionStart:0,mentionLength:G.length});return S.c(G)}static Hok(G,R,O){G=Object.assign(new c,{displayName:G,email:R,userId:O});return S.c(G)}static Dsb(G,R,O=null){G=Object.assign(new B.a,{neighborhood:G,mentionStart:0,mentionLength:G?G.length:
0});R=Object.assign(new A.a,{selection:G,userIntent:null,entryPoint:R,launchData:O});return S.c(R)}static Jom(G,R){return M.Dsb(G,M.Kom(R))}static Kom(G){switch(G){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static i_f(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static $ke(){const G=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("SovereignEnvironmentName"):
null;return!!G&&0<G.length}static isEnterpriseUser(){const G=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("HostAuthType"):null;return!!G&&"aad"===G.toLowerCase()||"external"===G&&M.mZf()}static hCg(G){var R=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTellMeServiceForGoLocalEnv",!1);R=!M.i_f()||R;return G.KOm&&R&&!M.$ke()}static qli(){const G=t.AFrameworkApplication.K?t.AFrameworkApplication.K.Oa("UiHostIntegrationType"):
"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===G&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static gCg(G){return G.rkb&&G.uEk&&(G.KFd||G.IFd||G.nfb)&&!M.qli()&&M.isEnterpriseUser()&&!M.$ke()}static lZa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.z1a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.z1a}static eCa(G){return!G||M.Jli(G.Bh)}static Jli(G){return!G||
!G.trim().length}static gKg(G){if(!G)return 0;const R=Math.pow(10,5);return Math.round(G*R)/R}static wQm(){var G=new Date;return G?new Date(G.getUTCFullYear(),G.getUTCMonth(),G.getUTCDate(),G.getUTCHours(),G.getUTCMinutes(),G.getUTCSeconds(),G.getUTCMilliseconds()):null}static hQf(G){G=new Date(G);return(M.wQm().getTime()-G.getTime())/1E3}static gmi(G){const {InsightsMenuItemFactory:R}=b(1414);switch(G){case m.a.BTf:case w.a.FTh:case R.Dei:case z.a.sxi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":return!0}return G.startsWith(M.CEe)||
G.startsWith(M.UKg)||G.startsWith(M.B9i)||G.startsWith("PeopleSuggestion")||G.startsWith("FileSuggestion")||G.startsWith("FindInDocumentSuggestion")||G.startsWith("NotesSuggestion")||G.startsWith("OnenoteNotesSuggestion")||G.startsWith("SmartLookupFromTellMe")||G.startsWith("GetHelpFromTellMe")||G.startsWith("GetHelpWithDescriptionFromTellMe")?!0:!1}static VKf(G,R){const O=[];Array.add(O,new v.a(400,G));Array.add(O,new v.a(200,R));G={};G.parts=O;return JSON.stringify(G)}static p7h(G){const R=M.hQf(G);
return 60>R?CommonUIStrings.l_TimeSince_SecsAgo:3600>R?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(R/60).toString()):86400>R?String.format(CommonUIStrings.l_TimeSince_HoursAgo,Math.floor(R/3600).toString()):172800>R?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(G)).localeFormat("MMMM dd, yyyy"))}static YPk(G){const R=Array(G.length);for(let O=0;O<G.length;O++)R[O]=G[O].commandId;return R}static mZf(){if("Dev Box"===t.AFrameworkApplication.K.Oa("StatusBarEnvironmentNameToUse"))return!0;
let G=t.AFrameworkApplication.K.Oa("UserPrincipalName");G=J.c(G)?"":H.a.Cf(G);const R=t.AFrameworkApplication.K.FD("TellMeIntEnabledForFeatureCrew")?t.AFrameworkApplication.K.UD("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(R,G)&&"inner"===t.AFrameworkApplication.K.Oa("Microsoft365Ring")}static sWk(G){switch(G.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";
case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Qu(){return C.a.DI&&
!C.a.sl}}M.ODe=9E5;Object(D.a)(M,"TellMeUtils",null,[])},1129:function(D,P,b){b.r(P);D=b(0);var f=b(42),c=b(212),n=b(56),m=b(1319),w=b(1134);class z{constructor(Db,pb,nb,ub,kb){this.groupType=Db;this.resultType=pb;this.eua=nb;this.ozf=ub;this.resultIndex=kb}}Object(D.a)(z,"ClickLoggingInfo",null,[]);const v=Db=>{const pb=[];for(;Db;)Array.add(pb,"{ContextId:"+Db.contextId+", IsGraphNodeContext:"+Db.hn+"}"),Db=Db.Um;pb.reverse();return"{"+pb.join(", ")+"}"};class t{constructor(){this.Ema=this.sessionId=
null}}Object(D.a)(t,"CorrelationRecord",null,[1338]);var A=b(1170);class B{constructor(Db,pb){this.Id=null;this.TimeStamp=0;this.Id=Db;this.TimeStamp=pb}}Object(D.a)(B,"MRUControl",null,[]);var S=b(1303),C=b(1126),H=b(2),J=b(1021);class M{constructor(Db,pb){this.s$=[];this.j5g=!1;this.yWc="";this.Jic=pb;this.sc=Db;this.tzj=Db.Bp}Nfd(){!this.j5g&&this.tzj&&this.sc&&S.a.rul()&&(this.yWc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.sc.application,this.s$=this.ZOk(),this.j5g=!0);return this.s$}Ryl(Db){return Db.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Db||"TryOfficeUpsell"===Db}RYf(Db){return this.Yol(Db)||this.Ryl(Db)||C.a.gmi(Db)?!1:!0}vVa(Db){Db=Db.ControlId;this.RYf(Db)&&(Db=this.Zrg(Db),this.njm(Db),this.AIl(),Array.insert(this.s$,0,new B(Db,Date.now())),this.yWc.length&&(Db=JSON.stringify(this.s$),J.a.instance.setItem(this.yWc,Db)))}ZOk(){if(!this.s$.length){var Db=J.a.instance.getItem(this.yWc);if(!Db||""===Db)return this.s$;let pb=null;try{pb=JSON.parse(Db)}catch(nb){this.$bk(),pb=null}if(!pb||!pb.length||10<pb.length)return this.s$;
Db=0;for(const nb of pb)if(this.sc.yle(nb.Id)&&this.RYf(nb.Id)&&(Array.insert(this.s$,Db++,nb),Db===this.Jic))break}return this.s$}Jrf(Db){Db=this.Zrg(Db);for(const pb of this.s$)if(pb.Id===Db)return!0;return!1}$bk(){J.a.instance.setItem(this.yWc,"")}vql(Db){Db=this.Zrg(Db.ControlId);return this.RYf(Db)?this.Jrf(Db):!1}njm(Db){if(0<this.s$.length){let pb=0;for(const nb of this.s$){if(nb.Id===Db){Array.removeAt(this.s$,pb);break}pb++}}}Zrg(Db){return"Excel"===this.sc.application&&Db.startsWith("m_excelWebRenderer_ewaCtl_")?
Db.substr(26,Db.length):Db}AIl(){this.s$.length===this.Jic&&Array.removeAt(this.s$,this.s$.length-1)}Yol(Db){Db=Db.split("|");let pb="";if(6<=Db.length)pb=Db[0];else if(3<=Db.length){if("3"===Db[0])return!0;pb=Db[1]}return pb.startsWith("WA")}static createInstance(Db){let pb=3;H.AFrameworkApplication.K&&(pb=H.AFrameworkApplication.K.vb("TellMeMaxRecommendedResultsToReturn",3));return new M(Db,pb)}}Object(D.a)(M,"MruControlsManager",null,[1337]);class G{constructor(Db){this.xNb=Db}N6(Db,pb){let nb;
return Db.FF&&(nb=this.xNb[Db.value])?nb.N6(Db,pb):(nb=this.qYh(Db.value))?nb.N6(nb.JMl,pb):null}G1k(Db,pb){if(Db=this.xNb[Db])for(const nb of pb)if(pb=C.a.getParameter(nb),pb.key===Db.Uig)return pb.value;return null}EPl(Db){(Db=this.qYh(Db))&&Db.BPl()}qYh(Db){const pb=Db.indexOf(C.a.wFi);return 0<pb?this.xNb[Db.substring(0,pb)]:null}}Object(D.a)(G,"ParameterizedCommandManager",null,[1336]);var R=b(1193);class O{constructor(Db){this.nti={};this.lti={};this.mti={};this.oti={};this.O9f={};this.pti=
this.eIl=this.ZHl=this.aIl=1;this.lva=Db;this.h6j();this.O4l();this.O5j();this.H4j()}eT(Db){this.nti[R.a[Db].toLowerCase()]=this.aIl++}JZ(Db,pb){this.lti[R.a[Db].toLowerCase()]=pb}xVa(Db){this.mti[R.a[Db].toLowerCase()]=this.ZHl++}N$(Db){this.oti[R.a[Db].toLowerCase()]=this.eIl++}LL(Db){this.O9f[R.a[Db].toLowerCase()]=this.pti++}h6j(){const Db=!!this.lva&&this.lva.mfb,pb=!!this.lva&&this.lva.Wud,nb=!!this.lva&&this.lva.nfb;this.eT(3);this.eT(17);this.eT(15);this.eT(6);this.eT(16);this.eT(0);this.eT(1);
Db||this.eT(2);Db&&!pb||this.eT(7);this.eT(14);nb&&this.eT(19);this.eT(13);this.eT(8);this.eT(11);this.eT(9);this.eT(10);Db&&this.eT(2);Db&&!pb&&this.eT(7);this.eT(18);this.eT(20);this.eT(12)}O4l(){this.JZ(20,1);this.JZ(3,3);this.JZ(17,3);this.JZ(15,3);this.JZ(6,3);this.JZ(16,5);this.JZ(0,5);this.JZ(1,1);this.JZ(2,1);this.JZ(7,2);this.JZ(14,3);this.JZ(13,2);this.JZ(8,1);this.JZ(11,1);this.JZ(9,1);this.JZ(10,1);this.JZ(18,1);this.JZ(12,1);this.JZ(19,2)}O5j(){this.xVa(3);this.xVa(0);this.xVa(16);this.xVa(6);
this.xVa(15);this.xVa(17);this.xVa(14);this.xVa(19);this.xVa(7);this.xVa(13)}H4j(){this.N$(13);this.N$(9);this.N$(11);this.N$(8);this.N$(10);this.N$(19);this.N$(14);this.N$(7);this.N$(2);this.N$(1);this.N$(6);this.N$(17);this.N$(15);this.N$(16);this.N$(0);this.N$(3)}Nnm(){this.O9f={};this.pti=1}R4k(Db,pb,nb){this.Nnm();const ub=!!this.lva&&this.lva.mfb,kb=!!this.lva&&this.lva.Wud,zc=!!this.lva&&this.lva.nfb;Db=Db&&kb;this.LL(3);this.LL(17);this.LL(15);this.LL(6);this.LL(16);this.LL(0);this.LL(1);
ub&&!kb||!Db||this.LL(7);pb&&this.LL(14);ub||this.LL(2);nb&&this.LL(13);ub&&!kb||Db||this.LL(7);pb||this.LL(14);zc&&this.LL(19);nb||this.LL(13);this.LL(8);this.LL(11);this.LL(9);this.LL(10);ub&&this.LL(2);ub&&!kb&&this.LL(7);this.LL(18);this.LL(20);this.LL(12);return this.O9f}u_(){return this.lva}}Object(D.a)(O,"GroupsPlacementInfo",null,[]);class I{constructor(Db,pb){this.Bh=Db;this.t8b=pb}}Object(D.a)(I,"TellMeQuery",null,[]);var K=b(1304);class Y{constructor(Db,pb){this.Id=null;this.TimeElapsedSinceClick=
0;this.Id=Db;this.TimeElapsedSinceClick=pb}}Object(D.a)(Y,"CommandClickedEvent",null,[]);var W=b(1114);class Z{constructor(Db,pb){this.TDj=Db;this.mza=pb}resultsUpdated(Db){this.TDj(W.c(Db.query)?"":Db.query.Bh,Db.Uw,Db.attributes,this.mza,Db.owc)}}Object(D.a)(Z,"ResultsUpdatedCallback",null,[1335]);var U=b(74);class X{constructor(Db,pb){this.menuModel=Db;this.iRi=pb}}Object(D.a)(X,"GeneratedMenuModel",null,[]);class fa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=
!1;this.ariaRoleDescription=null}}Object(D.a)(fa,"MenuModel",null,[]);class ma{constructor(Db,pb,nb){this.sc=Db;this.xNb=pb;this.Gea=nb}wLk(Db,pb,nb){let ub=0;const kb=new fa,zc=[];let Qc="";kb.sections=[];let md=new U.a;const vd=!!this.sc&&this.sc.mfb;var Jb=!!this.sc&&this.sc.o1a||H.AFrameworkApplication.oa.mb.o1a;for(const sc of Db){Db=0;vd||(md=new U.a);const Mc=new U.a;let Nb=sc.displayName;for(const Kb of sc.results){if(0<=Kb.value.indexOf(C.a.vEg)){if(Kb.FF){var mc=this.xNb[Kb.value];if(mc&&
Kb.value.endsWith(C.a.vEg)){if("FindParameterized"!==Kb.value&&!Jb){const Yb=[];Yb.push(appChrome.actions.setControlLabel(Kb.value,mc.Dde(Kb)));Yb.push(appChrome.actions.setButtonCommandValueId(Kb.value,mc.PIf(Kb)));appChrome.api.dispatch(Yb)}mc=Kb.value.replace(C.a.vEg,"");md.remove(mc)?Db--:Mc.add(mc);md.add(Kb.value);Db++}}}else switch(Kb.type){case 5:Mc.contains(Kb.value)||(md.add(Kb.value),Db++);break;case 7:md.add(Kb.FF);Db++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 6:case 19:case 20:case 21:md.add(Kb.value),
Db++}12===sc.groupType&&(Nb=C.a.lZa()?0<pb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,pb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,pb));20===sc.groupType&&(Nb=CommonUIStrings.l_LearningUILiveText)}ub+=Db;""!==Nb&&0<Db&&(Qc+=" , "+Db.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Nb+" , ");0<md.count&&!vd&&(Db=appChrome.api.menuSection(md.toArray(),sc.displayName,null,R.a[sc.groupType]),zc.push(Db))}Jb=
null;0<ub&&(Jb=0<pb.length?1!==ub?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,ub,pb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,pb):1!==ub?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ub):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,vd?(pb=appChrome.api.menuSection(md.toArray(),"",null,null),zc.push(pb)):Jb+=Qc);nb&&appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Jb));
kb.sections=zc;return new X(kb,ub,[])}static get bBf(){return ma.JZg||(ma.JZg=new X(Object.assign(new fa,{sections:[]}),0,[]))}}ma.JZg=null;Object(D.a)(ma,"TellMeMenuDefintionGenerator",null,[]);var ka=b(1211),oa=b(1210),za=b(30);class Ja{constructor(Db){this.KLj=Db}Tgb(Db,pb,nb){const {TellMeActor:ub}=b(1129);ub.instance.tf.Mba(pb,oa.a.PAc,Db.data.mf.toString(),Math.round(window.performance.now()-nb),oa.a.PAc,!0,ka.a.rYa);Db=za.b(Db.data.wd);pb=-1;Db.Index&&(pb=Db.Index);ub.instance.tf.CGl(pb,this.KLj)}Agb(Db,
pb,nb){const {TellMeActor:ub}=b(1129);ub.instance.tf.Mba(pb,oa.a.PAc,Db.data.mf.toString(),Math.round(window.performance.now()-nb),oa.a.PAc,!1,ka.a.rYa)}z3k(Db){if(Db&&""!==Db.trim()){const nb=window.performance.now(),ub=H.AFrameworkApplication.Y5i;var pb={};pb.Text=Db;pb.IsFileHash="false";pb=za.c(pb);H.AFrameworkApplication.je.Ki(ub,2,pb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,kb=>{this.Tgb(kb,Db.length,nb)},kb=>{this.Agb(kb,Db.length,nb)},null,null,!1,4E3,6E3)}}}Object(D.a)(Ja,
"TellMeQueryIndexCallback",null,[]);var pa=b(1133);class Na{constructor(Db,pb,nb){this.xml=Db;this.iRi=pb;this.zwk=nb}}Object(D.a)(Na,"GeneratedMenuXml",null,[]);var Da=b(1415),Aa=b(16);class Ma{constructor(Db,pb){this.EMd=Db||{};this.V6a=pb}get J0a(){return 5}N6(Db,pb=null){return this.V6a.N6(Db,pb)||this.d4j(Db.value)}d4j(Db){return Ma.wlf(Db,this.EMd[Db]||null)}static wlf(Db,pb=null){Db=String.format('<ClonedControl Id="{0}" ',Db);for(let kb in pb){var nb=kb,ub=pb[kb];ub=ub?Aa.a.we(ub.toString()):
"";Db+=String.format('{0}="{1}" ',nb,ub)}return Db+"/>"}}Object(D.a)(Ma,"CommandMenuItemFactory",null,[1080]);var ba=b(304);class L{constructor(){this.huj=CommonUIStrings.l_FindInDocumentText}get J0a(){return 8}N6(Db){var pb=Db.FF;Db=Aa.a.we(Db.value);const nb=Aa.a.we(pb);pb=Aa.a.we(String.format(this.huj,pb));return this.VKk(Db,nb,pb)}VKk(Db,pb,nb){return ba.a(Db,"1540292897",nb,C.a.LFk,null,pb,nb,null,null)}}Object(D.a)(L,"FindInDocumentMenuItemFactory",null,[1080]);var V=b(1416),ha=b(1414),la=
b(1417);class ya{get J0a(){return 7}N6(Db){const pb=Object(n.a)(K.a,Db);return this.ELk(Aa.a.we(Db.value),pb.id)}ELk(Db,pb){return ba.a(pb,"1404166600",Db,null,null,Db,Db,null,null)}}Object(D.a)(ya,"TryQueryMenuItemFactory",null,[1080]);class va{constructor(Db){this.tJ=[];this.sc=Db}ZTk(Db){for(const pb of this.tJ)if(pb.J0a===Db)return pb;return null}ia(Db){this.tJ.push(Db)}jfm(Db){this.ia(new Ma(this.sc.Xhk,Db));this.ia(new la.a(this.sc.AOl));this.ia(new Da.a(this.sc.Krm,this.sc.Jrm,this.sc.TOm,
this.sc.Vfl,this.sc.PDm));this.ia(new ha.InsightsMenuItemFactory);this.ia(new L);this.ia(new V.a);this.ia(new ya);this.sc.nMi(this)}}Object(D.a)(va,"MenuItemFactoryRegistry",null,[]);var xa=b(1145);class Ia{constructor(Db,pb){this.sc=Db;this.o9g=new va(this.sc);this.o9g.jfm(pb)}xLk(Db,pb){let nb=0;const ub=[],kb=[];for(const Qc of Db){Db=C.a.hIg;var zc=[];for(const md of Qc.results){const vd=this.o9g.ZTk(md.type).N6(md,pb);Db=C.a.hIg;zc.push(vd);if(13===md.type||14===md.type)Db="Menu32";17===md.type&&
(Db="MenuTellMeExtended");md.groupType=Qc.groupType;kb.push(Object(n.a)(xa.a,md))}nb=nb?nb:zc.length;zc=ba.e("TellMeDropdownControls",zc);Db=ba.j("TellMeDropdownMenuSection",zc,Db,Qc.displayName);ub.push(Db)}pb=ba.k(ub,"LookupDropdownMenu");return new Na(pb,nb,kb)}static get N9d(){return Ia.KZg||(Ia.KZg=new Na(ba.k([],"LookupDropdownMenu"),0,[]))}}Ia.KZg=null;Object(D.a)(Ia,"TellMeXmlGenerator",null,[]);class mb{}mb.lNl="MRU";mb.test="Test";Object(D.a)(mb,"ActionType",null,[]);var gb=b(1194),Za;(function(Db){Db[Db.Answer=
0]="Answer";Db[Db.Definition=1]="Definition";Db[Db.Entity=2]="Entity";Db[Db.WolframAnswer=3]="WolframAnswer";Db[Db.Assistance=4]="Assistance";Db[Db.Command=5]="Command";Db[Db.Document=6]="Document";Db[Db.TryQuery=7]="TryQuery";Db[Db.FindInDocument=8]="FindInDocument";Db[Db.HelpAction=9]="HelpAction";Db[Db.Insights=10]="Insights";Db[Db.People=11]="People";Db[Db.Image=12]="Image";Db[Db.FirstRunResult=13]="FirstRunResult";Db[Db.NoCommandsFoundResult=14]="NoCommandsFoundResult";Db[Db.TestResult=15]="TestResult";
Db[Db.AppsForOffice_Installed=16]="AppsForOffice_Installed";Db[Db.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";Db[Db.AppsForOffice_Query=18]="AppsForOffice_Query";Db[Db.Notes_Onenote=19]="Notes_Onenote";Db[Db.Notes_Samsung=20]="Notes_Samsung";Db[Db.Notes_Sticky=21]="Notes_Sticky";Db[Db.Learning=22]="Learning";Db[Db.Unknown=23]="Unknown"})(Za||(Za={}));Object(D.b)("ResultType",Za);var $a=b(82),cb=b(110),La=b(186);class Ya{constructor(Db,pb=null){this.IQd="TellMeWAC.";this.oFj=Db;
this.IMj=pb}Nib(Db,pb,nb){pb=$a.a.tVb(pb);Db=$a.a.Rvf(Db,this.oFj,this.IMj,nb,pb);cb.a.Nib(Db,this.IQd)}Z0a(Db,pb,nb=0){pb=$a.a.tVb(pb);cb.a.Z0a(Object.assign(new La.a,{name:Db,dataFields:pb,durationMs:nb}),this.IQd)}}Object(D.a)(Ya,"TellMeOtelLogger",null,[1359]);var Eb=b(129);class qa{constructor(Db,pb,nb,ub,kb,zc,Qc){this.Kqa=this.ira=this.bWg=null;this.Mlb=Db;this.nOc=pb;this.EUa=nb;this.Rhc=ub;this.M5a=kb;this.Czj=zc;this.Kqa=Qc?Qc:new Ya(this.Rhc?w.CuiHelper.uEg:w.CuiHelper.pDe)}get Bp(){return this.Rhc}get pDa(){return this.EUa}Rze(Db){this.bWg=
Db;switch(Db){case pa.a.contextMenu:this.ira=pa.a.contextMenu;break;default:this.ira=pa.a.tellMe}}V1j(Db,pb){this.EUa.Ema||(this.EUa.Ema=Eb.a.create().toString(),this.gri(Db,!0,pb))}APh(Db,pb=!0){this.EUa.Ema&&this.eFl(Db,pb);this.Rhc&&appChrome.api.updateTellMeCorrelationId("");this.EUa.Ema=null}gri(Db,pb,nb){const {TellMeActor:ub}=b(1129),kb=this.Jsa(A.a.feb);kb[gb.a.culture]=this.nOc;kb[gb.a.appName]=this.Mlb;kb[gb.a.context]=Db;kb[gb.a.Rke]=this.M5a;kb[gb.a.Oyl]=this.Czj;kb[gb.a.Jxl]=nb;kb[gb.a.ttl]=
pb;kb[gb.a.contentType]=ub.instance.U7d;this.Kqa.Nib(A.a.feb,kb,this.bWg);this.Rhc&&appChrome.api.updateTellMeCorrelationId(this.EUa.Ema)}eFl(Db,pb){const nb=this.Jsa(A.a.F0b);nb[gb.a.yyk]=Db;nb[gb.a.stl]=pb;this.Kqa.Z0a(A.a.F0b,nb)}BGl(Db,pb,nb){let ub=0;!nb&&0<Db.length&&(ub=Db.trim().split(" ").length);const kb=this.Jsa(A.a.query);kb[gb.a.query]="!";kb[gb.a.KAc]=pb;kb[gb.a.iJi]=Db.length;kb[gb.a.Tmi]=nb;kb[gb.a.y3m]=ub;this.Kqa.Nib(A.a.query,kb,this.ira)}YFl(Db,pb,nb,ub,kb,zc,Qc,md=null){const vd=
this.Jsa(A.a.latency);vd[gb.a.culture]=this.nOc;vd[gb.a.iJi]=Db;vd[gb.a.d$i]=pb;vd[gb.a.statusCode]=nb;vd[gb.a.qum]=kb;vd[gb.a.isSuccess]=zc;vd[gb.a.RBl]=Qc;md&&(vd[gb.a.PQm]=md);this.Kqa.Z0a(A.a.latency,vd,ub)}HGl(Db,pb){var {TellMeActor:nb}=b(1129);const {isCommandEnabled:ub}=b(1178);if(Db.results.length){var kb=this.Jsa(A.a.mPi);kb[gb.a.eua]=pb.toString();kb[gb.a.groupType]=R.a[Db.groupType];15===Db.groupType&&(kb[gb.a.nxl]=nb.instance.HId);pb=[];nb=[];for(const zc of Db.results)kb[gb.a.resultType]||
(kb[gb.a.resultType]=Za[zc.type]),nb.push(ub(zc.value)),pb.push(zc.value);0<pb.length&&(kb[gb.a.Mom]="{"+pb.join(", ")+"}",kb[gb.a.Nzk]="{"+nb.join(", ")+"}");this.Kqa.Nib(A.a.mPi,kb,this.ira)}}ZLk(Db){switch(Db){case 15:case 17:case 6:case 0:case 16:case 1:return"Command";case 3:return mb.lNl;case 12:case 8:case 9:case 10:case 18:return"Insights";case 19:return"Notes"}return R.a[Db]}WEl(Db,pb,nb,ub,kb){const zc=this.Jsa(A.a.click);zc[gb.a.d$i]=Db;zc[gb.a.S1l]=pb;zc[gb.a.commandId]=nb;zc[gb.a.dla]=
ub;zc[gb.a.actionType]=this.ZLk(kb.groupType);zc[gb.a.resultType]=Za[kb.resultType];zc[gb.a.groupType]=R.a[kb.groupType];zc[gb.a.eua]=kb.eua.toString();zc[gb.a.ozf]=kb.ozf.toString();zc[gb.a.resultIndex]=kb.resultIndex.toString();this.Kqa.Nib(A.a.click,zc,this.ira)}ZEl(Db,pb){this.EUa.Ema||(this.EUa.Ema=Eb.a.create().toString(),this.gri("",!1,pb));pb=this.Jsa(A.a.jGh);pb[gb.a.KAc]=Db;this.Kqa.Z0a(A.a.jGh,pb)}wri(Db,pb,nb){if(Db){if(nb)for(let ub in nb)Db[ub]=nb[ub];this.Kqa.Z0a(A.a.events,Db,pb)}}grd(Db,
pb,nb=null){const ub=this.Jsa(A.a.events);ub[gb.a.event]=Db;this.wri(ub,Math.round(pb),nb)}Kfb(Db,pb,nb=null){const ub=this.Jsa(A.a.events);ub[gb.a.event]=A.a.error;ub[gb.a.module]=Db;ub[gb.a.errorMessage]=pb;ub[gb.a.message]=pb;this.wri(ub,Math.round(window.performance.now()),nb)}VEl(Db){const pb=this.Jsa(A.a.GDh);pb[gb.a.value]=Db;pb[gb.a.TKi]=this.Rhc;this.Kqa.Nib(A.a.GDh,pb,this.ira)}JEl(Db){const pb=this.Jsa(A.a.enh);pb[gb.a.value]=Db;pb[gb.a.TKi]=this.Rhc;this.Kqa.Nib(A.a.enh,pb,this.ira)}PEl(Db){const pb=
this.Jsa(A.a.qVi);pb[gb.a.value]=Db;this.Kqa.Nib(A.a.qVi,pb,this.ira)}DGl(Db,pb){const nb=this.Jsa(A.a.hJi);nb[gb.a.PAc]=Db;pb&&(nb[gb.a.Ema]=pb);this.Kqa.Z0a(A.a.hJi,nb)}Jsa(Db){return{["SessionID"]:this.EUa.sessionId,["CorrelationID"]:this.EUa.Ema,["Time"]:(new Date).getTime(),["Event"]:Db,["Scenario"]:this.ira}}}Object(D.a)(qa,"UsageLogger",null,[1334]);var Oa=b(50),Ha=b(1364),ab=b(1029),Ra=b(75),Pa=b(54),bb=b(191),hb=b(313),Pb=b(15),wb=b(461),Fb=b(72),Ta=b(13);b.d(P,"TellMeActor",function(){return Zb});
class Zb{constructor(){this.V6a=this.Tda=this.kb=this.qa=this.Qca=this.Iv=this.Za=this.ea=this.tf=this.i0e=this.Kmh=this.nza=this.sc=null;this.eic=!1;this.CMe=[];this.ZVg=[];this.b$g=[];this.S5g=!1;this.lfc=this.Gea=null;this.RTc=this.M5a=!1;this.vTd=!0;this.dIb=this.Qfc=this.GFa=this.uSc=this.D1g=this.y0e=this.M9g=null;this.ZSc=!1;this.A9g=0;this.Tec=null;this.mza=-1;this.q9g=0;this.$Tc=!1;this.Wmb=null;this.Hlh=!1}get U7d(){return this.Qca?this.Qca.contentType:Zb.unknown}vfe(){return this.tf?this.tf.pDa.Ema:
null}u_(){return this.sc}get uMl(){return this.vTd}get s2m(){return this.M9g}get HId(){return this.Hlh}set HId(Db){this.Hlh=Db}QF(Db){const pb=window.performance.now();this.Gea&&!W.c(Db)&&(this.Gea(Db),this.tf.$G(A.a.QF,window.performance.now()-pb))}initialize(Db,pb=null,nb=null,ub=null,kb=null,zc=null,Qc=null,md=null,vd=null,Jb=null){const {InteractionLogger:mc}=b(1588),{AggregatorResultsProvider:sc}=b(1431);this.sc=Db;this.M5a=!!H.AFrameworkApplication.oa&&H.AFrameworkApplication.oa.mb.dfb;this.tf=
ub;if(!ub){ub=new t;ub.sessionId=H.AFrameworkApplication.userSessionId;const Mc=wb.a.$c(H.AFrameworkApplication.lcid)||wb.a.jeb;this.tf=new mc(new qa(this.sc.application,Mc.name,ub,this.sc.Bp,this.M5a,Db.rkb,null),this.sc.aik,this.sc)}this.V6a=new G(this.sc.parameterData);this.Kmh=nb||new Ia(this.sc,this.V6a);this.Gea=Qc;this.i0e=this.i0e||new ma(this.sc,this.sc.parameterData,Qc);this.kb=Oa.FocusManager.instance();this.Tda=M.createInstance(this.sc);this.D1g=new O(Db);this.ea=kb||H.AFrameworkApplication.pa;
this.Za=zc||H.AFrameworkApplication.Sb;this.Iv=vd;this.nza=pb;vd?vd.execute(Mc=>{Mc.isFeatureEnabled(Zb.JOm,!0).then(Nb=>{const {AggregatorResultsProvider:Kb}=b(1431);this.$Tc=Nb;this.nza=this.nza||Kb.createInstance(this.Tda,this.sc,this.V6a,this.$Tc);return null})}):(this.$Tc=!0,this.nza=this.nza||sc.createInstance(this.Tda,this.sc,this.V6a,this.$Tc));this.qa=md;this.GFa=Ia.N9d;this.M9g=new Promise(Mc=>{this.y0e=Mc});Jb&&Jb.execute(Mc=>{this.Qca=Mc});this.sc.Bp&&C.a.qli()&&(Db=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,
this.sc.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(Db,Db)))}pb(){this.ZSj()}lgm(Db){this.uSc=Db}ZSj(){this.ea.Ia(Ta.a.tellMe,Fb.a.frame,Object(f.a)(this,this.tellMe,"tellMe"),96);this.ea.Ia(Ta.a.gIg,Fb.a.frame,Object(f.a)(this,this.Eyh,"cacheAsyncMenuRefreshFunction"),96);this.ea.Ia(Ta.a.jIg,Fb.a.frame,Object(f.a)(this,this.Jri,"logItemExecuted"),96);this.ea.Ia(Ta.a.mIg,Fb.a.frame,Object(f.a)(this,this.qri,"logControlDeactivation"),96);this.ea.Ia(Ta.a.lIg,Fb.a.frame,
Object(f.a)(this,this.Eri,"logInputFocus"),96);this.ea.Ia(Ta.a.iIg,Fb.a.frame,Object(f.a)(this,this.feb,"interactionBegin"),96);this.ea.Ia(Ta.a.oIg,Fb.a.frame,Object(f.a)(this,this.feb,"interactionBegin"),96);this.ea.Ia(Ta.a.kIg,Fb.a.frame,Object(f.a)(this,this.Dri,"logInputBlur"),96);this.ea.Ia(Ta.a.nIg,Fb.a.frame,Object(f.a)(this,this.pri,"logControlActivated"),96);this.ea.Ia(Ta.a.JFd,Fb.a.frame,Object(f.a)(this,this.wUh,"focusSearchBox"),96);this.ea.Ia(Ta.a.fIg,Fb.a.frame,Object(f.a)(this,this.kFh,
"constructLiveNotificationForMenu"),96);this.ea.Ia(Ta.a.pIg,Fb.a.frame,Object(f.a)(this,this.aXf,"insertTryQuery"),96);this.ea.Ia(Ta.a.W4f,Fb.a.frame,Object(f.a)(this,this.aXf,"insertTryQuery"),96);this.ea.Ia(Ta.a.UDf,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.VDf,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.WDf,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.XDf,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),
96);this.ea.Ia(Ta.a.YDf,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.rhg,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.shg,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.thg,Fb.a.frame,Object(f.a)(this,this.Wgb,"openOrInsertUrl"),96);this.ea.Ia(Ta.a.xjg,Fb.a.frame,Object(f.a)(this,this.Ydb,"insertMention"),96);this.ea.Ia(Ta.a.yjg,Fb.a.frame,Object(f.a)(this,this.Ydb,"insertMention"),96);this.ea.Ia(Ta.a.zjg,Fb.a.frame,
Object(f.a)(this,this.Ydb,"insertMention"),96)}Pem(Db){this.vTd=!1;const pb=window.performance.now();Db.LZa.isCompleted?(this.vTd=!0,this.y0e(!0)):Db.KJ(()=>{this.vTd=!0;this.y0e(!0);this.tf.$G(A.a.Btk,window.performance.now()-pb)});this.ofm(Db)}ofm(Db){hb.a.Hyd(Object(f.a)(this,this.ebd,"dispatcher"));hb.a.qcd([new bb.a(Ta.a.tellMe,Fb.a.frame,96),new bb.a(Ta.a.gIg,Fb.a.frame,96),new bb.a(Ta.a.jIg,Fb.a.frame,96),new bb.a(Ta.a.mIg,Fb.a.frame,96),new bb.a(Ta.a.lIg,Fb.a.frame,96),new bb.a(Ta.a.iIg,Fb.a.frame,
96),new bb.a(Ta.a.oIg,Fb.a.frame,96),new bb.a(Ta.a.kIg,Fb.a.frame,96),new bb.a(Ta.a.nIg,Fb.a.frame,96),new bb.a(Ta.a.JFd,Fb.a.frame,96),new bb.a(Ta.a.fIg,Fb.a.frame,96),new bb.a(Ta.a.pIg,Fb.a.frame,96),new bb.a(Ta.a.W4f,Fb.a.frame,96),new bb.a(Ta.a.UDf,Fb.a.frame,96),new bb.a(Ta.a.VDf,Fb.a.frame,96),new bb.a(Ta.a.WDf,Fb.a.frame,96),new bb.a(Ta.a.XDf,Fb.a.frame,96),new bb.a(Ta.a.YDf,Fb.a.frame,96),new bb.a(Ta.a.rhg,Fb.a.frame,96),new bb.a(Ta.a.shg,Fb.a.frame,96),new bb.a(Ta.a.thg,Fb.a.frame,96),new bb.a(Ta.a.xjg,
Fb.a.frame,96),new bb.a(Ta.a.yjg,Fb.a.frame,96),new bb.a(Ta.a.zjg,Fb.a.frame,96)],Db)}ebd(Db,pb,nb,ub,kb){if(pb.contextId===Fb.a.frame)switch(Db){case Ta.a.tellMe:return this.tellMe(Db,pb,nb,ub,kb);case Ta.a.gIg:return this.Eyh(Db,pb,nb,ub,kb);case Ta.a.jIg:return this.Jri(Db,pb,nb,ub,kb);case Ta.a.mIg:return this.qri(Db,pb,nb,ub,kb);case Ta.a.lIg:return this.Eri(Db,pb,nb,ub,kb);case Ta.a.iIg:return this.feb(Db,pb,nb,ub,kb);case Ta.a.oIg:return this.vom(nb);case Ta.a.kIg:return this.Dri(Db,pb,nb,
ub,kb);case Ta.a.nIg:return this.pri(Db,pb,nb,ub,kb);case Ta.a.JFd:return this.wUh(Db,pb,nb,ub,kb);case Ta.a.fIg:return this.kFh(Db,pb,nb,ub,kb);case Ta.a.pIg:case Ta.a.W4f:return this.aXf(Db,pb,nb,ub,kb);case Ta.a.UDf:case Ta.a.VDf:case Ta.a.WDf:case Ta.a.XDf:case Ta.a.YDf:case Ta.a.rhg:case Ta.a.shg:case Ta.a.thg:return this.Wgb(Db,pb,nb,ub,kb);case Ta.a.xjg:case Ta.a.yjg:case Ta.a.zjg:return this.Ydb(Db,pb,nb,ub,kb)}return 2}wUh(Db,pb,nb){if(1===nb)return 32;this.qYi();Db=!1;(this.sc.rkb||this.M5a)&&
(pb=document.getElementById("SearchButton"))&&pb.click();if(!this.sc.rkb&&this.M5a)for(pb=document.getElementsByClassName("ms-suiteux-search-box"),nb=0;nb<pb.length;nb++){const ub=pb[nb].querySelector("input[type=search]");ub&&(Db=Oa.FocusManager.UR(ub))}else Db=Oa.FocusManager.UR($get(this.sc.Bp?w.CuiHelper.uEg:w.CuiHelper.pDe));this.RTc=!0;return Db?32:8}aXf(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.qYi();
Db=kb.CommandValueId;pb=this.sc.Bp?w.CuiHelper.uEg:w.CuiHelper.pDe;this.sc.Bp&&!W.c(kb[ab.a.AQa])&&(kb[ab.a.AQa]=!1);if(Db){if(this.sc.Bp)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Db)),this.Wmb=[18],32;if(kb=$get(pb))kb.value=Db}return Oa.FocusManager.UR($get(pb))?32:8}qYi(){this.kb.wM(this.sc.rkb||this.M5a?this.sc.Gwb:this.sc.O0a,!1)}SLk(Db,pb){switch(Db){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,pb);case 3:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,
pb);case 4:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,pb);case 6:case 15:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,pb)}return pb}kFh(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Db=this.GFa?this.GFa.iRi:0;kb.Value=1!==Db?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Db):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;
if(this.GFa)for(const zc of this.GFa.zwk)kb=Object(c.a)(K.a,zc)?zc.id:Aa.a.replaceAll(zc.value,'"',""),(kb=$get(kb+"-"+C.a.hIg))&&Pa.a.Jq(kb,Pa.a.Mka,Aa.a.we(this.SLk(zc.groupType,kb.innerText)));return 32}Eyh(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Tec=new Ra.a(2,1,0,()=>{kb[Ha.a.Callback]()},97);this.GFa&&this.Za.Cb(this.Tec);return 32}Jri(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:LogItemExecuted",
"actiondata comes null"),16;kb.CloseAllMenus&&(Db=void 0===kb.ParentControlId||null===kb.ParentControlId?"<NA>":kb.ParentControlId,pb=this.lfc?this.lfc[kb.ControlId]:null,!pb&&this.lfc&&"<NA>"!==Db&&(pb=this.lfc[Db]),pb||(pb=this.eic&&this.Tda.vql(kb),pb=this.cuk(pb,kb.ControlId),pb=new z(pb,23,-1,-1,-1),this.tf.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+kb.ControlId+" determined group:"+R.a[pb.groupType])),this.tf.wSl(kb.ControlId,Db,kb.CommandId,kb.CloseAllMenus,pb),this.V6a.EPl(kb.ControlId),
kb.Location!==pa.a.contextMenu&&(this.Tda.vVa(kb),this.sc.Cjb&&this.nza.iRj(kb.CommandId)));return 32}qri(Db,pb,nb,ub,kb){if(1===nb)return 32;S.a.Pyl()&&(new Ja(this.vfe())).z3k(this.Qfc);Db=this.Qfc;pb=this.mza;nb=this.tf.cNd;if(W.c(kb))return this.tf.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;kb=kb.UILocation;Db&&0<Db.length&&this.$Tc&&C.a.hCg(this.sc)&&this.sc.mle&&19!==kb&&pb>nb&&(this.tf.j8f(Db),this.tf.Iyg(pb));this.tf.Gnm();this.tf.VSl(window.performance.now()-
this.A9g);this.sc.Bp&&(this.dIb=null,this.tf.ZCa());this.RTc=this.ZSc=!1;this.Qfc="";return 32}Eri(Db,pb,nb){if(1===nb)return 32;this.tf.$Ab(v(pb),this.RTc);return 32}Dri(Db,pb,nb){if(1===nb)return 32;this.tf.ZCa();this.ZSc=!1;return 32}pri(Db,pb,nb,ub,kb){if(1===nb)return 32;this.A9g=window.performance.now();Db=null;kb&&(Db=kb);this.tf.Rze(W.c(Db)||W.c(Db.Location)?pa.a.unknown:Db.Location);this.tf.USl(this.q9g,this.RTc);this.ZSc||this.Egb();return 32}PHh(Db,pb){const nb=[],ub=Date.now();for(let kb of Db)Db=
(ub-kb.timeStamp)/1E3,Db=C.a.gKg(Db),Array.add(nb,new Y(pb?kb.commandId:kb.controlId,Db));return nb}Wmk(){var Db=this.Tda.Nfd();const pb=[],nb=Date.now();for(const ub of Db)Db=(nb-ub.TimeStamp)/1E3,Db=C.a.gKg(Db),Array.add(pb,new Y(ub.Id,Db));return pb}Egb(){if(!this.ZSc){this.eic=this.ZSc=!0;""!==this.sc.Uwg&&H.AFrameworkApplication.Uf(this.sc.Uwg);if(!this.S5g){this.S5g=!0;const Db={};Db.IsMLREnabled=!this.sc.Dul;Db.IsReactRibbonEnabled=this.sc.Bp;Db.IsSharedHeaderEnabled=!!H.AFrameworkApplication.oa&&
H.AFrameworkApplication.oa.mb.uA;Db.IsSearchUxEnabled=this.M5a;Db.IsTellMeInHeaderEnabled=this.sc.rkb;Db.IsGoLocalEnv=C.a.i_f();Db.IsSovereignEnvironment=C.a.$ke();Db.IsTellMeServiceResultsEnabled=C.a.hCg(this.sc);Db.IsSubstrateProviderEnabled=C.a.gCg(this.sc);Db.ShouldFetchTokens=!!H.AFrameworkApplication.oa&&H.AFrameworkApplication.oa.mb.$Db;Db.IsSerpletEnabled=C.a.lZa();Db.FirstOnClickTimeInMS=Math.round(window.performance.now());Db.IsHeaderHidden=H.AFrameworkApplication.hideHeader||H.AFrameworkApplication.fX;
Db.IsSearchInHeaderHidden=H.AFrameworkApplication.Nkd;void 0!==window.performance.timing&&null!==window.performance.timing&&(Db.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Db.IsFindWithMatchesEnabled=this.sc.rae;Db.HelpShowsTopSearchResult=this.sc.ADd;Db.HelpShowsNumberOfMatches=this.sc.zDd;this.tf.QGl(JSON.stringify(Db))}this.CMe=this.PHh(m.a.instance.Afd(),!1);this.ZVg=this.PHh(m.a.instance.Grc(),!0);this.b$g=this.Wmk();this.tf.Egb()}}feb(Db,pb,nb,ub,kb){if(1===
nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Pb.a.kU)return 32;this.Egb();Db=new Z(Object(f.a)(this,this.$Ca,"onRequestCompleted"),0);this.mza++;this.tf.beginQuery("",this.mza,this.eic);this.GFa=Ia.N9d;this.dIb=ma.bBf;if(this.nza)this.nza.Z7(new I("",this.mza),Db,this.sc.Bp);else this.tf.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Tec&&this.Za.Cb(this.Tec);return 32}vom(Db){if(1===Db)return 32;
this.kb.wR(this.sc.rkb||this.M5a?this.sc.Gwb:this.sc.O0a,!1);return 32}tellMe(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:TellMe","actiondata comes null"),16;this.tf.Rze(W.c(kb.Location)?pa.a.unknown:kb.Location);Db=kb.Value;this.sc.Bp||Db&&""!==Db.trim()?(!this.dIb&&this.sc.Bp&&(this.tf.$Ab(v(pb),this.RTc),this.Egb()),this.HCk(Db,kb.Location),kb.PopulationXML=this.GFa.xml):this.eic?kb.PopulationXML=this.GFa.xml:(kb.PopulationXML=Ia.N9d.xml,this.dIb=ma.bBf,this.Qfc=
"");return 32}HCk(Db,pb){this.sc.Bp&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Db));Db&&0<Db.trim().length&&(this.eic=!1);this.sc.GBk();pb=W.c(pb)?pa.a.tellMe:pb;if(Db!==this.Qfc||this.sc.Bp){this.mza++;this.tf.beginQuery(Db,this.mza,this.eic);const nb=new I(Db,this.mza),ub=new Z(Object(f.a)(this,this.$Ca,"onRequestCompleted"),this.mza);this.GFa=Ia.N9d;this.dIb=ma.bBf;if(this.nza)this.nza.Z7(nb,ub,this.sc.Bp,pb,this.Wmb),this.Wmb=null;else this.tf.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.q9g=this.mza;this.Qfc=Db}}nYm(Db){if(this.sc.Bp){var pb=appChrome.selectors.getActiveControlStates();if(pb=Object(n.a)(Object,pb[Db.value])){Db.label=pb.label;let nb=null;"description"in pb&&(nb=pb.description);nb&&Object.getType(nb)===String?Db.description=nb:"secondaryText"in pb?Db.description=pb.secondaryText:"fullDescriptionLabel"in pb&&(Db.description=pb.fullDescriptionLabel)}}}y4l(Db){this.lfc={};let pb=0,nb=0;for(const ub of Db){Db=0;for(const kb of ub.results)this.lfc[kb.value]=
new z(kb.groupType,kb.type,pb,Db,nb),Db++,nb++,kb.label||5!==kb.type||this.nYm(kb);0<Db&&pb++}}rzc(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(Db=kb.CommandValueId)&&window.open(Db,"_blank");return 32}Ydb(Db,pb,nb,ub,kb){if(1===nb)return 32;if(W.c(kb))return this.tf.onError("TellMeActor:InsertMention","actiondata comes null"),16;Db=kb.UILocation;let zc;kb=kb.CommandValueId;try{zc=za.a(kb)}catch(Qc){return this.tf.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return W.c(zc)?(this.tf.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):W.c(this.uSc)?(this.tf.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Db?(this.tf.onError("TellMeActor:InsertMention","location "+Db+" is unexpected"),16):this.uSc.Ydb(zc.displayName,zc.email,zc.userId)?32:(this.tf.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Wgb(Db,pb,nb,ub,kb){return 1===nb?32:
W.c(kb)?(this.tf.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===kb.UILocation?this.unl(nb,kb):this.rzc(Db,pb,nb,ub,kb)}unl(Db,pb){if(1===Db)return 32;if(W.c(pb))return this.tf.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(W.c(this.uSc))return this.tf.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Db=pb.CommandValueId;return W.c(Db)?(this.tf.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.uSc.insertHtmlText(Db)?
32:(this.tf.onError("TellMeActor:InsertUrl","url is not inserted"),16)}$Ca(Db,pb,nb,ub,kb){nb=window.performance.now();this.y4l(pb);this.tf.Zxm(pb);this.sc.Bp?(this.dIb=this.i0e.wLk(pb,Db,kb),appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.dIb.menuModel,Db,kb))):this.GFa=this.Kmh.xLk(pb,this.tf.pDa);this.Tec&&this.Za.Cb(this.Tec);kb={};kb.GroupsCount=pb.length;kb.QueryID=ub;kb.QueryLength=Db.length;this.tf.$G(A.a.uok,window.performance.now()-nb,kb)}cuk(Db,pb){return pb.startsWith(this.sc.Bp?
C.a.UKg:C.a.CEe)?4:Db?3:"bSearchHelp"===pb||pb.startsWith("GetHelpFromTellMe")?7:"bInsights"===pb||pb.startsWith("SmartLookupFromTellMe")?12:pb===this.sc.wEf?2:0}T1(Db,pb){this.nza&&this.nza.T1(Db,pb)}static get instance(){return Zb.ra||(Zb.ra=new Zb)}}Zb.ra=null;Zb.JOm="mso_tellMeService";Zb.unknown="Unknown";Object(D.a)(Zb,"TellMeActor",null,[])},1133:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{}f.tellMe="TellMe";f.contextMenu="ContextMenu";f.unknown="Unknown";Object(D.a)(f,"TellMeScenario",
null,[])},1141:function(D,P,b){D=b(0);class f{constructor(n,m){this.$qb=n;this.value=m}}Object(D.a)(f,"AttrValuePair",null,[]);b.d(P,"a",function(){return c});class c{constructor(n){this.Vnb=!1;if(!n)throw Error.argumentNull("annotations");this.gw=n;this.f0=[]}get Fmc(){return this.gw}get isReadOnly(){return this.Vnb}get GSf(){return 0<this.f0.length}Xp(n){if(!this.gw.Qwc(n))throw Error.argument("attributeID","Invalid attribute ID");for(const m of this.f0)if(n===m.$qb)return n=m.value,{returnValue:!0,
value:n};return{returnValue:!1,value:null}}Ly(n,m){var {Annotations:w}=b(1118);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.gw.Qwc(n))throw Error.argument("attributeID","Invalid attribute ID");if(!this.gw.Svc(this.gw.getAttributeType(n),m))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.i3b(m);for(w=0;w<this.f0.length;++w){const z=this.f0[w];if(n===z.$qb){z.value=m;return}}Array.add(this.f0,
new f(n,m))}SPa(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.gw.Qwc(n))throw Error.argument("attributeID","Invalid attribute ID");for(let m=0;m<this.f0.length;++m)if(n===this.f0[m].$qb){Array.removeAt(this.f0,m);break}}dbe(n){if(!n)throw Error.argumentNull("action");for(const m of this.f0)n(m.$qb,m.value)}clone(){const n=new c(this.gw);n.cab(this);return n}cab(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!n)throw Error.argumentNull("other");if(n.Fmc!==this.gw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.f0);n.dbe((m,w)=>{this.Ly(m,w)})}bja(){const {Annotations:n}=b(1118);let m="[",w=!0;for(const z of this.f0){w?w=!1:m+=", ";m+=this.gw.UWh(z.$qb);m+="=";const v=this.gw.getAttributeType(z.$qb),t=this.gw.bja(v,z.value);v===n.Bca?(m+='"',m+=c.ACf(t),m+='"'):m+=t}return m+"]"}isEqual(n){const {Annotations:m}=b(1118);if(!n)throw Error.argumentNull("other");if(this===n)return!0;
if(!n||this.gw!==n.Fmc||this.GSf!==n.GSf)return!1;let w=0,z=null,v=!1;n.dbe((t,A)=>{++w;if(!v){var B=-1;for(let S=0,C=this.f0.length;S<C;++S)if(this.f0[S].$qb===t){B=S;break}0>B?v=!0:(z||(z=Array(this.f0.length)),z[B]=A)}});if(this.f0.length!==w||v)return!1;for(let t=0,A=this.f0.length;t<A;++t)if(!m.PFb(this.gw.getAttributeType(this.f0[t].$qb),this.f0[t].value,z[t]))return!1;return!0}zW(){return this.isReadOnly?this.clone():this}O5f(){const {Annotations:n}=b(1118);if(!this.isReadOnly){this.Vnb=!0;
for(const m of this.f0)n.i3b(m.value)}}toString(){return this.bja()}static ACf(n){return n.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(c,"FeatureBundle",null,[1458,1459])},1145:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c,n,m=null,w=null,z=-99999,v=0){this.rN="";this.H1d=-1;this.value=c;this.type=n;this.label=this.FF=m;this.groupType=21;this.description=w;this.score=z;this.count=v}}Object(D.a)(f,"ResultBinding",null,[])},
1150:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c){this.attributes=null;this.query=c;this.Uw=[]}cF(c){this.Uw.push(c)}bOi(c){const n=[];for(const m of this.Uw)m.groupType!==c&&n.push(m);this.Uw.length!==n.length&&(this.Uw=n)}get owc(){return!1}}Object(D.a)(f,"SimpleResultsUpdatedEventArgs",null,[1328])},1160:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c=21,n=""){this.ht=[];this.groupType=c;this.displayName=n}get results(){return this.ht}dI(c){c.groupType=
this.groupType;Array.add(this.results,c)}Qrg(c=1){if(this.results.length>=c)for(let n=0;n<c;n++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(f,"SimpleResultGroup",null,[1329])},1161:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(){this.N9f=null;this.nha=this.P9f=0}LGf(c,n,m){if(!c)throw Error.argumentNull("referenceList");if(0>n||n>c.length)throw Error.argumentOutOfRange("startIndex");if(0>m||m>c.length)throw Error.argumentOutOfRange("length");if(n+m>
c.length)throw Error.argument("Invalid start-length range");this.N9f=c;this.P9f=n;this.nha=m}gub(c,n,m){this.LGf(c.N9f,c.P9f+n,m)}J(c){if(0>c||c>=this.nha)throw Error.argumentOutOfRange("index");return this.N9f[this.P9f+c]}get count(){return this.nha}static fvf(c){const n=new f;n.LGf(c,0,c.length);return n}}Object(D.a)(f,"ReadOnlyList",null,[1489])},1170:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{}f.click="Click";f.feb="InteractionBegin";f.F0b="InteractionEnd";f.jGh="ControlActivated";
f.query="Query";f.hJi="QueryIndexRecorded";f.GDh="Clicks";f.enh="ActionEvents";f.qVi="SessionContext";f.latency="Latency";f.mPi="RenderedResults";f.events="Events";f.uok="CreateResultsMenu";f.QF="UpdateRibbonControls";f.Lom="ResultsAggregation";f.Z7="IssueQuery";f.Uek="CommandSuggestions";f.error="Error";f.B5f="LoadModelData";f.Btk="DepsResolveTime";f.vMl="ModelDataWaitTime";f.timedOut="TimedOut";Object(D.a)(f,"EventNames",null,[])},1176:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1242);
class f extends b.a{constructor(){super();this.info=this.Qh=this.eventId=null}get pta(){return"Misc"}sYb(){this.detail.W("Type",this.pta);this.detail.W("EventId",this.eventId);this.detail.W("Func",this.Qh);this.detail.W("Info",this.info);return this.detail}}Object(D.a)(f,"BasicMergeFailureDetail",b.a,[])},1177:function(D,P,b){b.d(P,"a",function(){return m});D=b(0);var f=b(531),c=b(690),n=b(1192);class m{constructor(w,z=!0){this.Oi=z&&w?w.gF():w;this.Alc=new f.a}oC(w){this.Alc.add(c.a.Ya(w))}dBm(w){this.Alc=
w}Yui(w){this.Oi&&(new n.a(this.Oi,w)).bia.forEach((z,v)=>{v.iU&&!this.Alc.contains(z)&&(this.Alc.add(z),v.isDeleted?(v=this.Oi,v.hasProperty(c.a.Lla(z))&&v.removeProperty(c.a.Lla(z))):this.Oi.ooa(c.a.Lla(z),v.newValue));return!0})}}Object(D.a)(m,"PartialMergeResult",null,[])},1178:function(D,P,b){b.r(P);b.d(P,"updateCommandsState",function(){return A});b.d(P,"isCommandEnabled",function(){return B});b.d(P,"logCommandSuggestions",function(){return S});b.d(P,"getResultGroup",function(){return C});b.d(P,
"isCommandHookQuery",function(){return H});b.d(P,"getCommandsFromQuery",function(){return J});b.d(P,"addHighConfidenceResultsFromLocalMLProvider",function(){return M});var f=b(1194),c=b(1170),n=b(1195),m=b(1145),w=b(1160),z=b(1129),v=b(1126),t=b(2);const A=(G,R)=>{if(R&&R.Bp){const O={};for(const I of G)R.yle(I)&&(O[I]=appChrome.selectors.getModelType(I));z.TellMeActor.instance.QF(O)}},B=G=>{const R=z.TellMeActor.instance.u_();return!!R&&R.Bp&&!appChrome.selectors.isControlDisabled(G)},S=(G,R,O,I)=>
{if(z.TellMeActor.instance.tf&&G){const K=[];for(const Y of G)K.push(String.format('{{"Id":"{0}","Score":{1}}}',Y.commandId,Y.score));G={};G[f.a.suggestions]="[{"+K.join(",")+"}]";G[f.a.Tmi]=R;G[f.a.groupType]=O;G[f.a.provider]=I;z.TellMeActor.instance.tf.$G(c.a.Uek,window.performance.now(),G)}},C=(G,R,O,I,K,Y,W)=>{if(O.uJf){G=O.uJf;var Z=R,U=[];R=[];for(var X of Z){Z=X.commandId;let fa=X;X.commandId in G&&(Z=G[X.commandId],fa=new n.a(Z,X.score));Array.contains(R,Z)||(U.push(fa),R.push(Z))}R=U}X=
v.a.YPk(R);A(X,O);Z=[];U=[];X=[];G=new w.a(W);W=15===W||17===W||6===W||3===W?t.AFrameworkApplication.K?t.AFrameworkApplication.K.vb("TellMeMaxRecommendedResultsToReturn",3):3:W&&16!==W?0:5;for(const fa of R){R=fa.commandId.startsWith("btnTellMeOfficeAddIn");if(O.yle(fa.commandId)&&!R){if(v.a.gmi(fa.commandId))continue;R=null;K&&Y&&(R=K.G1k(fa.commandId,Y));B(fa.commandId)?Array.add(Z,new m.a(fa.commandId,5,R,null,fa.score)):Array.add(U,new m.a(fa.commandId,5,R,null,fa.score))}else O.J9a&&R&&I&&Array.add(X,
fa.commandId.substr(21));if(Z.length+X.length>=W)break}O=0;for(K=0;K<Z.length&&O<W;K++,O++)G.dI(Z[K]);for(K=0;K<U.length&&O<W;K++,O++)G.dI(U[K]);for(K=0;K<X.length&&O<W;K++,O++)I.xZm(X[K],G);return G},H=G=>2<G.length&&";"===G.charAt(0)&&";"===G.charAt(G.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1)),J=G=>{const R=new w.a(0);var O=G.split(";");
G=z.TellMeActor.instance.u_();for(const I of O)if(0<I.length){O=I.split(":");const K=2===O.length?O[0]:I;if(!G.yle(K))break;if(1===O.length)O=new m.a(K,5),R.dI(O);else if(2===O.length)O=new m.a(K,5,O[1]),R.dI(O);else break}return R},M=(G,R,O)=>{if(!(R&&R.results&&R.results.length&&G&&G.results&&G.results.length))return{returnValue:!1,Kef:G,Bff:R};const I=[];for(var K of R.results)Array.add(I,K.value);K=0;const Y=R.results[0].score;for(const W of G.results)if(W.score>O&&!Array.contains(I,W.value)&&
B(W.value)&&(W.score=Y,Array.insert(R.results,K,W),K++),2===K)break;return 0<K?(O=R.results.length-5,0<O&&R.Qrg(O),{returnValue:!0,Kef:G,Bff:R}):{returnValue:!1,Kef:G,Bff:R}}},1191:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{static nQm(c){return c.toString().charCodeAt(0)}static ryl(c){return 55296<=c&&57343>=c}static charAt(c,n){return c.charAt(n)}static Wth(c,n){if(c===n)return!0;"\u00a0"===c&&(c=" ");"\u00a0"===n&&(n=" ");return c===n}static Vth(c,n){if(c===n)return!0;if(!c||
!n||c.length!==n.length)return!1;c=f.vPi(c);n=f.vPi(n);return c===n}static vPi(c){return c.replace(f.Urd," ")}static wEb(c,n,m){return c.substring(n,n+m)}}f.Urd=RegExp("\u00a0","g");Object(D.a)(f,"CharUtils",null,[])},1192:function(D,P,b){b.d(P,"a",function(){return z});D=b(0);var f=b(381),c=b(690),n=b(203),m=b(42),w=b(1403);class z{constructor(v,t){this.WCj=v;this.sCj=t;this.lWe=new n.a(()=>this.Rmd());this.AGj=new n.a(Object(m.a)(this,this.bCk,"evaluatePropertyDiffs"))}get Kr(){return this.WCj}get Ie(){return this.sCj}get gNa(){return!!this.Ie&&
!this.Kr}get isDeleted(){return!this.Ie&&!!this.Kr}get iU(){return this.gNa||this.isDeleted||this.lWe.value}get bia(){return this.AGj.value}Rmd(v=null){let t=!1;this.bia.forEach((A,B)=>{t=B.iU&&(!v||7!==v.J(A));return!t});return t}bCk(){const v=new f.a;var t=this.Ie,A=this.Kr;if(this.gNa){A=t.Hl();for(var B=0;B<A.length;B++){var S=A[B];v.W(c.a.Ya(S),new w.a(S,null,t.ZW(S)))}}else if(this.isDeleted)for(t=A.Hl(),B=0;B<t.length;B++)S=t[B],v.W(c.a.Ya(S),new w.a(S,A.ZW(S),null));else{B=A.Hl();for(S=0;S<
B.length;S++){var C=B[S];let H=c.a.Ya(C);const J=A.ZW(C),M=t.hasProperty(C)?t.ZW(C):null;v.W(H,new w.a(C,J,M))}B=t.Hl();for(S=0;S<B.length;S++)C=B[S],A.hasProperty(C)||v.W(c.a.Ya(C),new w.a(C,null,t.ZW(C)))}return v}}Object(D.a)(z,"MergeableObjectDiff",null,[])},1193:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);var f;(function(c){c[c.Classifier=0]="Classifier";c[c.AppsForOffice=1]="AppsForOffice";c[c.FindInDocument=2]="FindInDocument";c[c.RecentlyUsed=3]="RecentlyUsed";c[c.TryQuery=4]="TryQuery";
c[c.Empty=5]="Empty";c[c.TryCommand=6]="TryCommand";c[c.Assistance=7]="Assistance";c[c.Answer=8]="Answer";c[c.Definition=9]="Definition";c[c.Entity=10]="Entity";c[c.WolframAnswer=11]="WolframAnswer";c[c.Insights=12]="Insights";c[c.People=13]="People";c[c.Document=14]="Document";c[c.Recommended=15]="Recommended";c[c.ServiceClassifier=16]="ServiceClassifier";c[c.ServiceRecommended=17]="ServiceRecommended";c[c.Image=18]="Image";c[c.Notes=19]="Notes";c[c.Learning=20]="Learning";c[c.None=21]="None"})(f||
(f={}));Object(D.b)("ResultGroupType",f)},1194:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{}f.appName="AppName";f.dla="CloseAllMenus";f.commandId="CommandId";f.context="Context";f.culture="Culture";f.message="Message";f.errorMessage="ErrorMessage";f.event="Event";f.Ema="CorrelationID";f.S1l="ParentUiElement";f.query="Input";f.KAc="QueryID";f.iJi="QueryLength";f.PAc="QueryIndex";f.Mom="ResultsList";f.suggestions="Suggestions";f.scenario="Scenario";f.sessionId="SessionID";f.source=
"Source";f.timeStamp="Time";f.d$i="UiElement";f.TKi="ReactUx";f.value="Val";f.statusCode="StatusCode";f.qum="Service";f.isSuccess="IsSuccess";f.PQm="TokenAcquired";f.RBl="LatencyType";f.groupName="GroupName";f.eua="GroupIndex";f.groupType="GroupType";f.resultType="ResultType";f.stl="IsInputBlur";f.ttl="IsInputFocus";f.Jxl="IsShortCutUsed";f.actionType="ActionType";f.count="Count";f.yyk="DwellTime";f.Tmi="IsZeroTerm";f.y3m="WordsCount";f.Rke="IsSearchUxEnabled";f.Oyl="IsTellMeInHeaderEnabled";f.module=
"Module";f.resultIndex="ResultIndex";f.ozf="DisplayIndex";f.Nzk="EnableList";f.provider="Provider";f.contentType="ContentType";f.nxl="IsSelectionBased";Object(D.a)(f,"Columns",null,[])},1195:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c,n){this.commandId=c;this.score=n}}Object(D.a)(f,"CommandSuggestion",null,[])},1208:function(D,P,b){b.d(P,"b",function(){return w});b.d(P,"a",function(){return v});var f=b(184),c=b(381),n=b(531),m=b(1405);const w=(A,B,S)=>{const C=z(A,
B,S);let H=0,J=0,M=0,G=new m.a;const R=new f.a;for(let O=0;O<C.length;O++){const I=C.Ye(O+1);G.b2d(A.Ye(H));G.d2d(B.Ye(J));G.i2d(S.Ye(M));H++;J++;for(M++;H<A.length&&(!I||!I.equals(A.Ye(H)));)G.b2d(A.Ye(H)),H++;for(;J<B.length&&(!I||!I.equals(B.Ye(J)));)G.d2d(B.Ye(J)),J++;for(;M<S.length&&(!I||!I.equals(S.Ye(M)));)G.i2d(S.Ye(M)),M++;R.add(G);G=new m.a}for(;H<A.length;)G.b2d(A.Ye(H)),H++;for(;J<B.length;)G.d2d(B.Ye(J)),J++;for(;M<S.length;)G.i2d(S.Ye(M)),M++;G.isEmpty||R.add(G);return R},z=(A,B,S)=>
{const C=new f.a,H=B.zH(),J=S.zH();A.forEach(M=>{H.contains(M)&&J.contains(M)&&C.add(M);return!0});return C},v=(A,B,S)=>{A=A||new f.a;B=B||new f.a;S=S||new f.a;const C=new f.a,H=new c.a(0),J=new n.a;for(var M=0;M<A.length;M++){var G=A.Ye(M);H.W(G,M)}for(A=M=0;M<B.length&&A<S.length;){G=B.Ye(M);let R=S.Ye(A),O=H.uz(G,-1),I=H.uz(R,-1);-1===O?(t(J,C,G),M++):-1===I?(t(J,C,R),A++):O===I?(t(J,C,G),M++,A++):O<I?M++:A++}for(;M<B.length;M++)G=B.Ye(M),-1===H.uz(G,-1)&&t(J,C,G);for(;A<S.length;A++)B=S.Ye(A),
-1===H.uz(B,-1)&&t(J,C,B);return C},t=(A,B,S)=>{A.contains(S)||(B.add(S),A.add(S))}},1209:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(52);class c{constructor(){this.cp=0;this.id=f.a.create()}}Object(D.a)(c,"LcsUpdateHint",null,[1385,257])},1210:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{}f.tellMe="TellMe";f.loki="Loki";f.substrate="Substrate";f.PAc="QueryIndex";f.Z5i="TellMeRanker";f.$5i="TellMeRankerLogging";Object(D.a)(f,"Services",null,[])},1211:function(D,
P,b){b.d(P,"a",function(){return f});D=b(0);class f{}f.rYa="HttpRequest";f.provider="Provider";Object(D.a)(f,"LatencyTypes",null,[])},1217:function(D,P,b){D=b(0);var f=b(18),c=b(5),n=b(184),m=b(126),w=b(169),z=b(52),v=b(531),t=b(42),A=b(219),B=b(1242);class S extends B.a{constructor(){super();this.Axe=null}get pta(){return"CreateMergeBlock"}sYb(){this.detail.W("Type",this.pta);this.detail.W("Revision",this.Axe);return this.detail}}Object(D.a)(S,"CreateMergeBlockFailureDetail",B.a,[]);var C=b(1298),
H=b(1300),J=b(1402),M=b(1243),G=b(1177),R=b(1453);b.d(P,"a",function(){return O});class O{static n7d(I,K,Y,W,Z,U,X){let fa;fa="";const ma=new n.a;for(let oa=0;oa<Y.length;oa++){var ka=void 0;let za;ka=C.a.zRk(K,Y.J(oa),W,Z,U,X,I);if(!ka)return{returnValue:null,bgb:fa};({hag:za,bgb:ka}=ka.R1h());if(!za)return{returnValue:null,bgb:fa};fa+=ka;ma.aw(ma.length,za)}return{returnValue:ma,bgb:fa}}static tIh(I,K,Y,W,Z,U,X,fa){let ma,ka,oa,za,Ja,pa;pa=Ja=za=oa=ka=ma=null;({bgb:za,returnValue:ma}=O.n7d(K,Na=>
I.runtime.pj.J(Na),Y,1,U,X,fa));if(!ma)return m.a.instance.ya(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),I.logger.wf(Object.assign(new S,{Axe:"Base"})),{returnValue:!1,QL:ma,idd:ka,jHd:oa,X2d:za,aae:Ja,SEe:pa};({bgb:Ja,returnValue:ka}=O.n7d(K,Na=>I.runtime.Lw.J(Na)||I.runtime.pj.J(Na),W,2,U,X,fa));if(!ka)return m.a.instance.ya(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
I.logger.wf(Object.assign(new S,{Axe:"Favored"})),{returnValue:!1,QL:ma,idd:ka,jHd:oa,X2d:za,aae:Ja,SEe:pa};({bgb:pa,returnValue:oa}=O.n7d(K,Na=>I.runtime.Hp.J(Na)||I.runtime.pj.J(Na),Z,4,U,X,fa));return oa?{returnValue:!0,QL:ma,idd:ka,jHd:oa,X2d:za,aae:Ja,SEe:pa}:(m.a.instance.ya(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),I.logger.wf(Object.assign(new S,{Axe:"Unfavored"})),{returnValue:!1,
QL:ma,idd:ka,jHd:oa,X2d:za,aae:Ja,SEe:pa})}static EDh(I,K=!1){const Y=new n.a;let W=0;for(;W<I.length;){var Z=I.J(W);if(1===Z.type||4===Z.type||2===Z.type)Y.add(Z),W++;else if(3===Z.type){let X="";X+=Z.character;W++;let fa=Z.fZa,ma=!1;for(;W<I.length;W++){var U=I.J(W);3===U.type?Z.runId===U.runId&&Z.hK.equals(U.hK)&&(Z.jma===U.jma||Z.vMa===U.vMa)&&Z.JF.zz(U.JF)&&(!K||Z.mB&&Z.mB.equals(U.mB))?(X+=U.character,U.fZa&&(fa=!0)):ma=!0:ma=!0;if(ma){Z=new R.a(null,Z.source,Z.ij,Z.We,Z.runId,Z.hK,X,Z.DAb,
!0,fa,Z.jma,Z.vMa,Z.o8b,Z.JF,Z.mB);Y.add(Z);break}}}}m.a.instance.ya(17044302,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",Y.So());return Y}static Mek(I,K=!1){const Y=new n.a;let W=0;for(;W<I.length;){var Z=I.J(W);if(1===Z.type||4===Z.type||2===Z.type)Y.add(Z),W++;else if(3===Z.type){let X=Z.character.toString();W++;let fa=Z.fZa;for(;W<I.length;W++){var U=I.J(W);if(3===U.type&&O.SDm(Z,U,K))X+=U.character,U.fZa&&(fa=!0);else break}Z=new R.a(null,Z.source,Z.ij,
Z.We,Z.runId,Z.hK,X,Z.DAb,!0,fa,Z.jma,Z.vMa,Z.o8b,Z.JF,Z.mB);Y.add(Z)}}m.a.instance.ya(50931345,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",Y.So());return Y}static SDm(I,K,Y){return I.runId===K.runId&&I.hK.equals(K.hK)&&(I.jma===K.jma||I.vMa===K.vMa)&&I.JF.zz(K.JF)&&(!Y||!!I.mB&&I.mB.equals(K.mB))}static szm(I,K,Y,W,Z,U,X,fa,ma,ka,oa,za,Ja,pa,Na,Da){I.setPropertyString(Y.Oi,f.a.Zk,Z);I.setPropertyUint32(Y.Oi,c.a.yb,W);I.setPropertyUint32s(Y.Oi,c.a.zm,U);I.setPropertyUint32s(Y.Oi,
c.a.Ao,X);I.setPropertyObjectIds(Y.Oi,f.a.DA,ma);I.hasProperty(Y.Oi,c.a.Qg)&&I.setPropertyUint32(Y.Oi,c.a.Qg,O.hLk());K&&K(20)&&I.setPropertyObjectIds(Y.Oi,c.a.gs,Da);W=!1;for(Z=0;Z<ka.length;Z++)if(ka.J(Z)){W=!0;break}W&&I.setPropertyBools(Y.Oi,c.a.ccg,ka);O.z7j(K,I,Y,oa,za,Ja,pa);O.A7j(I,Y,Na);Y.oC(f.a.Zk);Y.oC(c.a.yb);Y.oC(c.a.zm);Y.oC(c.a.Ao);Y.oC(f.a.DA);Y.oC(c.a.ccg);Y.oC(f.a.WB);Y.oC(f.a.XDa);Y.oC(c.a.ZT);Y.oC(c.a.xR);Y.oC(f.a.pR);Y.oC(c.a.gs);I.hasProperty(Y.Oi,c.a.Qg)&&Y.oC(c.a.Qg);0<fa.length?
I.setPropertyUint32s(Y.Oi,f.a.WB,fa):Y.Oi.removeProperty(f.a.WB)}static z7j(I,K,Y,W,Z,U,X){if(I(167)){I=W.contains(!0,(fa,ma)=>ma);O.nAg(K,Y,f.a.pR,I?W:null);O.nAg(K,Y,f.a.XDa,O.GQi(W,Z));O.nAg(K,Y,c.a.ZT,O.GQi(W,U));W=!1;for(Z=0;Z<X.length;Z++)X.J(Z)&&(W=!0);W?K.setPropertyUint32s(Y.Oi,c.a.xR,X):Y.Oi.removeProperty(c.a.xR)}}static A7j(I,K,Y){const W=X=>X;var Z=Object(t.a)(I,I.setPropertyBools,"setPropertyBools");O.ZVa(K,Y.lxb,W,Z,c.a.HYa);O.ZVa(K,Y.Ssb,W,Z,c.a.KAa);O.ZVa(K,Y.uhb,W,Z,c.a.N_a);Z=X=>
0<X.length;var U=Object(t.a)(I,I.setPropertyStrings,"setPropertyStrings");O.ZVa(K,Y.kxb,Z,U,c.a.IYa);O.ZVa(K,Y.Psb,Z,U,c.a.LWa);O.ZVa(K,Y.QBb,Z,U,c.a.j2a);Z=X=>!!X;U=Object(t.a)(I,I.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");O.ZVa(K,Y.mxb,Z,U,c.a.JYa);O.ZVa(K,Y.Jab,Z,U,c.a.MWa);O.ZVa(K,Y.SBb,Z,U,c.a.k2a);Y.uhb.any(W)?O.ZVa(K,Y.RBb,()=>!0,Object(t.a)(I,I.setPropertyObjectIds,"setPropertyObjectIds"),c.a.rRa):K.Oi.removeProperty(c.a.rRa)}static GQi(I,K){const Y=new n.a;let W=!1;for(let Z=
0;Z<I.length;Z++){const U=K.J(Z)&&!I.J(Z);Y.add(U);W=U||W}return W?Y:null}static nAg(I,K,Y,W){W?I.setPropertyBools(K.Oi,Y,W):K.Oi.removeProperty(Y)}static hLk(){return w.a.Hz()}static A2h(I,K){return I.runtime.Lw.uz(K,I.runtime.pj.J(K)||I.runtime.Hp.get(K))}static phd(I,K,Y,W,Z){let U;U=new n.a;const X=!!Y&&Y(20);if(I.runtime.Qa.isFeatureEnabled(127)){var fa=O.Mek(W,X);var ma=O.EDh(W,X);fa.length!==ma.length&&I.runtime.Qa.eo(127)}else fa=O.EDh(W,X);ma=0;let ka="",oa=new n.a,za=new n.a,Ja=new n.a,
pa=new n.a,Na=new n.a,Da=new n.a,Aa=new n.a,Ma=new n.a,ba=new n.a;const L=new J.a;let V=new n.a;var ha=fa.J(fa.length-1);if(2!==ha.type&&4!==ha.type)return m.a.instance.ya(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ha.type),I.logger.wf(Object.assign(new M.a,{Qh:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ha.type)})),{returnValue:!1,ate:U};var la=0;for(ha=
0;ha<fa.length;ha++){var ya=fa.J(ha),va=null;if(1===ya.type||3===ya.type)va=ya,ka+=va.text;else if(4===ya.type){ya=O.A2h(I,ya.ij);ya=new G.a(ya);U.add(ya);continue}va?(oa.add(va.runId),za.add(va.We),la+=va.text.length,Ja.add(la),pa.add(va.hK),Na.add(va.DAb),Da.add(va.fZa),Aa.add(va.jma),Ma.add(va.vMa),ba.add(va.o8b),L.lxb.add(va.JF.Rel),L.Ssb.add(va.JF.Bel),L.uhb.add(va.JF.hfl),L.kxb.add(va.JF.insertion.author),L.Psb.add(va.JF.deletion.author),L.QBb.add(va.JF.yPa.author),L.mxb.add(va.JF.insertion.rsd),
L.Jab.add(va.JF.deletion.rsd),L.SBb.add(va.JF.yPa.rsd),L.RBb.add(va.JF.yPa.plg),X&&V.add(va.mB)):oa.length||(oa.add(0),za.add(0),Ja.add(0),pa.add(z.a.nil),Na.add(!1),Da.add(!1),Aa.add(!1),Ma.add(!1),ba.add(0),L.lxb.add(!1),L.Ssb.add(!1),L.uhb.add(!1),L.kxb.add(""),L.Psb.add(""),L.QBb.add(""),L.mxb.add(0),L.Jab.add(0),L.SBb.add(0),L.RBb.add(z.a.nil));if(2===ya.type){la=ya;ya=la.yb;Ja.hA(Ja.length-1);va=Z.J(ma);if(!va)return m.a.instance.ya(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ma,Z.length,W.length,ha,fa.length),I.logger.wf(Object.assign(new M.a,{Qh:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),m.a.instance.Joa(17044308,1,3,"GetMergeableObjectsFromMergeBlocks Paragraphs",Z.So()),m.a.instance.Joa(17044309,1,3,"GetMergeableObjectsFromMergeBlocks MergeBlocks",W.So()),m.a.instance.Joa(17044310,1,3,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",fa.So()),{returnValue:!1,ate:U};if(va=O.A2h(I,va))va=new G.a(va.gF()),O.szm(K,Y,va,la.yb,
ka,oa,za,Ja,pa,Na,Da,Aa,Ma,ba,L,V),U.add(va);m.a.instance.ya(17044312,1,3,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",la.ij,ya,oa.So(),za.So(),Ja.So(),Da.So(),Aa.So(),Ma.So(),pa.So(),"",ba.So());ma++;ka="";oa=new n.a;za=new n.a;Ja=new n.a;pa=new n.a;Na=new n.a;Da=new n.a;Aa=new n.a;Ma=new n.a;ba=new n.a;L.reset();la=0;V=new n.a}}return{returnValue:!0,
ate:U}}static Tnm(I,K){const Y=I.runtime.Jl.J(A.a.fL),W=K.getPropertyObjectIds(Y.Oi,c.a.fV);for(let Z=0;Z<W.length;Z++)I.runtime.Jl.remove(W.J(Z));K.setPropertyObjectIds(Y.Oi,c.a.fV,new n.a);K.setPropertyString(Y.Oi,c.a.wxa,z.a.nil.toString());Y.oC(c.a.fV);Y.oC(c.a.wxa)}static vll(I,K){if(I.runtime.Jl.La(A.a.fL))return null;const Y=new G.a(I.runtime.pj.J(A.a.fL).gF());K.setPropertyString(Y.Oi,c.a.wxa,I.output.LK.last().id.toString());K.setPropertyObjectIds(Y.Oi,c.a.fV,new n.a);Y.oC(c.a.fV);Y.oC(c.a.wxa);
I.runtime.Jl.W(A.a.fL,Y);return Y}static BMf(I){const K=new n.a;I.forEach(Y=>{K.add(Y.id);return!0});return K}static Bxc(I,K,Y,W){let Z=0;Y.forEach(U=>{H.a(U,K+Z++,1);393230===U.Ab&&I.getPropertyObjectIds(U,f.a.DA).forEach(X=>{W.add(X);return!0});return!0})}static lFl(I,K){const Y=new v.a;let W=0;K.forEach(Z=>{if(Y.contains(Z))return!0;Y.add(Z);if(({index:W}=O.z6f("BaseFormatting_",W,Z,U=>I.runtime.pj.J(U))).returnValue||({index:W}=O.z6f("FavoredFormatting_",W,Z,U=>I.runtime.Lw.J(U))).returnValue||
({index:W}=O.z6f("ConflictingFormatting_",W,Z,U=>I.runtime.Hp.J(U))).returnValue)return!0;W++;return!0})}static z6f(I,K,Y,W){if(Y=W(Y))if(H.a(Y,I+K,1),1179649===Y.Ab)return K++,{returnValue:!0,index:K};return{returnValue:!1,index:K}}static Yzf(I){return!!I.runtime.pj.J(A.a.fL)}static ZVa(I,K,Y,W,Z){K.any(Y)?(W(I.Oi,Z,K),I.oC(Z)):I.Oi.removeProperty(Z)}static XXi(I,K){const Y=new n.a;Y.add(0);const W=I?I.length:0;for(let Z=0;Z<W;Z++)Y.insert(Z+1,I.Ye(Z));Y.insert(Y.length,K);return Y}}Object(D.a)(O,
"ParagraphMergeUtils",null,[])},1240:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(184);class c{constructor(n,m,w){this.am=null;this.fj=n;this.source=m;this.ij=w}get type(){return this.fj}get $jb(){return!1}get Asl(){return 1===(this.source&1)}get Bsl(){return 2===(this.source&2)}get Csl(){return 4===(this.source&4)}X7(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.kOk(),this.Mrc())}kOk(){let n="";this.Asl&&(n+="Base");this.Bsl&&(n+="FavoredUpdate");this.Csl&&
(n+="UnfavoredUpdate");return n}Mrc(){return""}zz(n){return this.type===n.type}wEd(){const n=new f.a;n.add(this);return n}get length(){return 0}}Object(D.a)(c,"AMergeBlock",null,[145,146])},1241:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1240);class f extends b.a{constructor(c,n,m){super(2,c,n);this.yb=m}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.yb,this.ij)}Mrc(){return"Eop"}clone(){return new f(this.source,this.ij,this.yb)}zz(c,n,
m,w=!1,z=!0){return super.zz(c,n,m,w)?z?c.yb===this.yb:c.ij===this.ij&&c.yb===this.yb:!1}get length(){return 1}}Object(D.a)(f,"EopMergeBlock",b.a,[])},1242:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(381);class c{constructor(){this.detail=new f.a}}Object(D.a)(c,"AMergeFailureDetail",null,[1373])},1243:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1176);class f extends b.a{constructor(){super()}get pta(){return"ParagraphMerge"}}Object(D.a)(f,"ParagraphMergeFailureDetail",
b.a,[])},1244:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1176);class f extends b.a{constructor(){super()}get pta(){return"RdOpLcs"}}Object(D.a)(f,"ReducedOpsLcsFailureDetail",b.a,[])},1245:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1176);class f extends b.a{constructor(){super()}get pta(){return"TableMerge"}}Object(D.a)(f,"TableMergeFailureDetail",b.a,[])},1249:function(D,P,b){D=b(0);class f{constructor(){this.iGd=this.Hld=null;this.M$f=this.score=this.$rd=0}bjg(C,
H,J){this.score=C.J(H);++H;this.Hld=C.J(H)?J.Hta(C.J(H)):null;++H;this.iGd=C.J(H)?J.Hta(C.J(H)):null;++H;this.$rd=C.J(H);++H;this.M$f=C.J(H);++H;return H}}Object(D.a)(f,"TokenStringGeneratorInit",null,[]);class c{constructor(C,H,J,M,G){this.Ytb=C;this.count=H;this.Nae=J;this.tQ=M;this.depth=G}}Object(D.a)(c,"ErrorTolerantTrieMatch",null,[]);var n=b(1314),m=b(1422);class w{constructor(C=null,H=0,J=0,M=0){this.HMj=C||new m.a;this.ZAa=H;this.tQ=J;this.depth=M}get x9(){return this.HMj}getKey(){return this.x9.Gx.toString()+
":"+this.ZAa.toString()}}Object(D.a)(w,"TrieBookmark",null,[]);class z{constructor(C,H){this.UZa=C;this.J9f=H}CHl(C){if(null==C)throw Error.argumentNull("prefix");let H={};var J=H[""]=new w;this.ohe(J,H);for(J=0;J<C.length;++J){const M=C.charCodeAt(J),G={};for(let R in H)this.RWj(M,H[R],G);H=G}return this.WRm(H)}ohe(C,H){if(!(C.tQ>=this.J9f)&&(C=new w(n.a.Fpf(C.x9),C.ZAa,C.tQ+1,C.depth),C.x9.RF&n.a.vlb&&(C.ZAa+=1),this.UZa.Ncc(C.x9))){C.depth+=1;let J=!0;for(;J;)z.tFe(C,H),this.ohe(C,H),C.ZAa+=this.UZa.$rc(C.x9,
!0)+(C.x9.RF&n.a.vlb?1:0),J=this.UZa.DGd(C.x9)}}RWj(C,H,J){H.tQ+1<=this.J9f&&(H.tQ+=1,z.tFe(H,J),--H.tQ);H.x9.RF&n.a.vlb&&(H.ZAa+=1);if(this.UZa.Ncc(H.x9)){H.depth+=1;let M=!0;for(;M;)H.x9.Kdc===C?(z.tFe(H,J),this.ohe(H,J)):H.tQ+1<=this.J9f&&(H.tQ+=1,z.tFe(H,J),this.ohe(H,J),--H.tQ),H.ZAa+=this.UZa.$rc(H.x9,!0)+(H.x9.RF&n.a.vlb?1:0),M=this.UZa.DGd(H.x9)}}WRm(C){const H=[];for(var J in C){const M=C[J];if(!M.x9.Gx)continue;const G=!!(M.x9.RF&n.a.vlb),R=this.UZa.$rc(M.x9,!1)+(G?1:0);Array.add(H,new c(M.ZAa,
R,G,M.tQ,M.depth))}H.sort((M,G)=>{let R=M.Ytb-G.Ytb;return R||(R=-(M.count-G.count))?R:R=M.depth-G.depth});if(2>H.length)return H;C=[];for(J=0;J<H.length;)J+=z.f8i(J,H,C);return C}static tFe(C,H){const J=C.getKey();J in H?(H=H[J],H.tQ=Math.min(H.tQ,C.tQ)):H[J]=new w(n.a.Fpf(C.x9),C.ZAa,C.tQ,C.depth)}static f8i(C,H,J){const M=H[C];let G=M.Ytb;const R=G+M.count;let O=1,I=M.Nae;for(;C+O<H.length&&H[C+O].Ytb<R;){const K=H[C+O];K.Ytb>G&&(Array.add(J,new c(G,K.Ytb-G,I,M.tQ,M.depth)),I=!1);O+=z.f8i(C+O,
H,J);G=K.Ytb+K.count}G<R&&Array.add(J,new c(G,R-G,I,M.tQ,M.depth));return O}}Object(D.a)(z,"ErrorTolerantTrieLookupEngine",null,[1547]);class v extends f{constructor(C,H,J){super();this.Jci=this.DDi=!1;this.NQh=null;if(C){var M=0;try{M=this.bjg(C,M,H);this.DDi=1===C.J(M);++M;this.Jci=1===C.J(M);++M;const G=C.J(M);this.NQh=this.d2l(J,G)}catch(G){throw Error.argument("initData");}}}d2l(C,H){return new z(C,H)}}Object(D.a)(v,"FuzzyMatchTokenStringGeneratorInit",f,[]);class t extends f{constructor(C,H){super();
this.query=this.name=null;if(C){this.Le=H.Le;var J=0;try{J=this.bjg(C,J,H),this.name=H.getString(C.J(J)),++J,this.query=H.aM(C.J(J))}catch(M){throw Error.argument("initData");}}}}Object(D.a)(t,"QueryTokenStringGeneratorInit",f,[]);class A extends f{constructor(C,H){super();if(C)try{this.bjg(C,0,H)}catch(J){throw Error.argument("initData");}}}Object(D.a)(A,"SurfaceStringTokenStringGeneratorInit",f,[]);var B=b(1161);b.d(P,"a",function(){return S});class S{constructor(C){this.A9f=C}get Hld(){return this.A9f.Hld}get iGd(){return this.A9f.iGd}get $rd(){return this.A9f.$rd}static create(C,
H,J){const {SurfaceStringTokenStringGenerator:M}=b(1552),{QueryTokenStringGenerator:G}=b(1553),{FuzzyMatchTokenStringGenerator:R}=b(1554);let O=0;try{if(C.J(O)!==S.NSb)throw Error.argument("initData","Input does not represent a token string generator");++O;const I=C.J(O);++O;const K=new B.a;K.gub(C,O,C.count-O);switch(I){case M.Z5c:return new M(new A(K,H));case G.Z5c:return new G(new t(K,H));case R.Z5c:return new R(new v(K,H,J));default:throw Error.argument("initData");}}catch(I){throw Error.argument("initData");
}}static Aph(C,H,J,M,G,R){C=C.UQm.getId(H,null);if(0>C)return++R,R;S.Bph(C,J,M,G);return R}static Bph(C,H,J,M){Array.add(M.tGg,C);Array.add(M.Y3i,H);++M.FGc[J]}}S.NSb=1099767983;Object(D.a)(S,"TokenStringGenerator",null,[1504])},1297:function(D,P,b){b.d(P,"a",function(){return n});D=b(0);var f=b(184);P=b(1240);var c=b(1191);class n extends P.a{constructor(m,w,z){super(m,w,z)}XJm(m){let w;w=null;if(!this.text||!this.$jb||0>=m||m>=this.length)return{returnValue:!1,$2i:w};w=new f.a;const z=this.clone();
z.gDd(c.a.wEb(this.text,0,m));const v=this.clone();v.gDd(c.a.wEb(this.text,m,this.length-m));w.add(z);w.add(v);return{returnValue:!0,$2i:w}}X7(){return!0}get length(){return this.text.length}}Object(D.a)(n,"ATextMergeBlock",P.a,[])},1298:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(126);class c{Qhf(n,m){return n+("[Block: "+m+"] ")}static zRk(n,m,w,z,v,t,A){const {ParagraphMergeBlockCreator:B}=b(1591),{TableMergeBlockCreator:S}=b(1595);if(393230===m.Ab)return new B(n,m,w,v,t,z(20),
A);if(393250===m.Ab)return new S(m,w);f.a.instance.ya(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",m.Ab);return null}}Object(D.a)(c,"MergeBlockCreator",null,[])},1299:function(D,P,b){b.d(P,"a",function(){return m});D=b(0);var f=b(5),c=b(52);P=b(1297);var n=b(1192);class m extends P.a{constructor(w,z,v,t,A,B,S,C,H,J,M,G,R,O){super(z,v,t);this.We=A;this.runId=B;this.DAb=C;this.Quj=S;this.xJe=w;this.fZa=H;this.jma=J;this.vMa=M;this.o8b=G;this.JF=R;this.mB=O}get t4c(){return this.xJe}get hK(){return this.Quj}get uXb(){return this.t4c(this.hK)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.We,this.runId,this.DAb,this.ij,this.hK.toString(),this.mB?this.mB.toString():"NULL")}zz(w,z,v,t=!1){if(!super.zz(w,z,v,t))return!1;if(t)return!0;if(!this.JF.zz(w.JF)||this.mB&&!this.mB.equals(w.mB))return!1;if(this.hK.equals(w.hK)||this.hK.equals(c.a.nil)||w.hK.equals(c.a.nil))return!0;w=new n.a(this.uXb,w.uXb);z=z.bIh(this.uXb);return w.Rmd(z.gxd)?!1:!0}get epl(){return this.X7()&&"\ufffc"===this.text&&this.uXb?this.uXb.hasProperty(f.a.pq)||1179725!==this.uXb.Ab?!0:!1:!1}}Object(D.a)(m,
"AUserRunMergeBlock",P.a,[])},1300:function(D,P,b){b.d(P,"a",function(){return c});var f=b(126);const c=(n,m,w=4)=>{n?f.a.instance.Joa(4273285,w,3,m,n.aFb()):f.a.instance.ya(4293845,w,1,m,"{0}: Node was null.",m)}},1301:function(D,P,b){b.d(P,"e",function(){return z});b.d(P,"a",function(){return v});b.d(P,"d",function(){return t});b.d(P,"b",function(){return A});b.d(P,"c",function(){return B});var f=b(5),c=b(18),n=b(52),m=b(824),w=b(1208);const z=(H,J,M)=>{const G=new m.a;let R=n.a.nil;J=G.getPropertyObjectId(J,
f.a.P1a);J.equals(n.a.nil)||(H=H.runtime.pj.J(J),M&&(H=M.uz(J,H)),H&&(R=G.getPropertyObjectId(H,f.a.P1a)));return R},v=(H,J,M,G,R)=>{const O=new m.a;let I=null;var K=O.getPropertyObjectId(M,f.a.P1a);K!==n.a.nil&&(I=H.runtime.pj.J(K),J&&(I=J.uz(K,I)));if(I){K=O.getPropertyObjectIds(I,c.a.ff);for(R=0;R<K.length&&!K.J(R).equals(M.id);R++);R===K.length&&(R=-1)}M=z(H,M,J);if(!M.equals(n.a.nil)&&(H=H.runtime.pj.J(M),J&&(H=J.uz(M,H)),H)){J=O.getPropertyObjectIds(H,c.a.ff);for(G=0;G<J.length&&!J.J(G).equals(I.id);G++);
G===J.length&&(G=-1)}return{rowIndex:G,aoc:R}},t=(H,J,M,G,R)=>{var O=new m.a;let I=null;var K=H.runtime.pj.J(M);J&&(K=J.uz(M,K));if(!K)return null;K=O.getPropertyObjectIds(K,c.a.ff);M=null;G<K.length&&(G=K.J(G),M=H.runtime.pj.J(G),J&&(M=J.uz(G,M)));M&&(O=O.getPropertyObjectIds(M,c.a.ff),R<O.length&&(R=O.J(R),I=H.runtime.pj.J(R),J&&(I=J.uz(R,I))));return I},A=(H,J,M)=>{let G,R;R=G=-1;const O=(new m.a).getPropertyObjectId(M,f.a.P1a);var I=z(H,M,J);if(I.equals(n.a.nil)||O.equals(n.a.nil))return{rowIndex:G,
aoc:R};J=H.runtime.DHg;var K=J.J(I);if(!K){K=S(H,I);if(!K)return{rowIndex:G,aoc:R};J.W(I,K)}for(I=0;I<K.length;I++)if(K.J(I).equals(O)){G=I;break}K=J.J(O);if(!K){K=C(H,O);if(!K)return{rowIndex:G,aoc:R};J.W(O,K)}for(H=0;H<K.length;H++)if(K.J(H).equals(M.id)){R=H;break}return{rowIndex:G,aoc:R}},B=(H,J,M,G)=>{if(0>M||0>G)return n.a.nil;new m.a;const R=H.runtime.DHg;let O=R.J(J);if(!O){O=S(H,J);if(!O)return n.a.nil;R.W(J,O)}if(M<O.length)J=O.J(M);else return n.a.nil;M=R.J(J);if(!M){M=C(H,J);if(!M)return n.a.nil;
R.W(J,M)}if(G<M.length)H=M.J(G);else return n.a.nil;return H},S=(H,J)=>{var M=new m.a;const G=H.runtime.pj.J(J);if(G){var R=H.runtime.Lw.uz(J,G);H=H.runtime.Hp.uz(J,G);J=M.getPropertyObjectIds(G,c.a.ff);R=M.getPropertyObjectIds(R,c.a.ff);M=M.getPropertyObjectIds(H,c.a.ff);return J.Ln(R,(O,I)=>O.equals(I))?M:J.Ln(M,(O,I)=>O.equals(I))?R:w.a(J,R,M,(O,I)=>O.equals(I))}return(R=H.runtime.Lw.J(J))?M.getPropertyObjectIds(R,c.a.ff):(R=H.runtime.Hp.J(J))?M.getPropertyObjectIds(R,c.a.ff):null},C=(H,J)=>{var M=
new m.a;const G=H.runtime.pj.J(J);if(G){var R=H.runtime.Lw.uz(J,G);H=H.runtime.Hp.uz(J,G);J=M.getPropertyObjectIds(G,c.a.ff);R=M.getPropertyObjectIds(R,c.a.ff);M=M.getPropertyObjectIds(H,c.a.ff);return J.Ln(R,(O,I)=>O.equals(I))?M:J.Ln(M,(O,I)=>O.equals(I))?R:null}return(R=H.runtime.Lw.J(J))?M.getPropertyObjectIds(R,c.a.ff):(R=H.runtime.Hp.J(J))?M.getPropertyObjectIds(R,c.a.ff):null}},1303:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(1126);b=b(2);class c{static Pyl(){return!f.a.i_f()&&
!f.a.$ke()&&c.isFeatureEnabled(0)}static Hli(){return c.isFeatureEnabled(1)}static rul(){return c.isFeatureEnabled(2)}static isFeatureEnabled(n){return!!(c.Wtj&1<<n)}}c.Wtj=b.AFrameworkApplication.K?b.AFrameworkApplication.K.vb("TellMeFeatureConfigValue",0):0;Object(D.a)(c,"TellMeFeatureAvailability",null,[])},1304:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1145);class f extends b.a{constructor(c,n,m,w=null){super(c,n,w);this.id=m}}Object(D.a)(f,"TryQueryResultBinding",b.a,[])},1305:function(D,
P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c){this.Ra=c}get rgb(){return this.Ra.rgb}get SMm(){return 4!==this.Ra.style}get UMm(){return!0}get trie(){return this.Ra.trie}getId(c,n){if(!this.SMm)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ra.style){case 0:return this.uWk(c,n);default:throw Error.notImplemented();}}getString(c){if(!this.UMm)throw Error.invalidOperation("String lookup not supported on this string table");if(0>c||c>=this.rgb)throw Error.argumentOutOfRange("id",
"Invalid string ID");switch(this.Ra.style){case 0:return this.K6k(c);case 4:return this.J6k(c);default:throw Error.notImplemented();}}uWk(c,n){c=this.Ra.trie.ssi(c,0,c.length,n);if(!c.succeeded)return-1;if(0>c.PGc||c.PGc>=this.Ra.rgb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ra.EGd?this.Ra.dyd.Ky(this.Ra.EGd+4*c.PGc,4):c.PGc}K6k(c){if(this.Ra.EGd){let n=0;for(;n<this.Ra.rgb&&this.Ra.dyd.Ky(this.Ra.EGd+4*n,4)!==c;++n);if(n>=this.Ra.rgb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");
return this.Ra.trie.W5h(n)}return this.Ra.trie.W5h(c)}J6k(c){const n=this.Ra.dyd.Ky(this.Ra.V3i+4*c,4);c=this.Ra.dyd.Ky(this.Ra.W3i+4*c,4);if(0>c||0>n)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const m=Array(n);for(let w=0;w<n;++w)m[w]=({thl:c}=this.Qbm(c)).returnValue;return String.fromCharCode.apply(null,m)}Qbm(c){let n=0;for(let m=0;3>m;++m){const w=this.Ra.dyd.J(this.Ra.QAh+c)^182;++c;n|=(w&127)<<7*m;if(!(w&128))break}return{returnValue:n,thl:c}}}Object(D.a)(f,
"StringTable",null,[1487])},1306:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(1314);class c{constructor(n){this.trie=null;this.QAh=this.V3i=this.W3i=this.EGd=0;if(n){this.dyd=n;var m=0;if(n.Ky(m,4)!==c.NSb)throw Error.argument("bytes","Input does not represent a string table");m+=4;this.rgb=n.Ky(m,4);m+=4;this.style=n.Ky(m,4);m+=4;switch(this.style){case 0:const w=1===n.Ky(m,4);m+=4;w||(this.EGd=m,m+=4*this.rgb);n.Ky(m,4);this.trie=this.z2l(n,m+4);break;case 4:this.W3i=m;this.V3i=
m+=4*this.rgb;m+=4*this.rgb;n.Ky(m,4);this.QAh=m+4;break;default:throw Error.argument("bytes");}}}z2l(n,m){return new f.a(n,m)}}c.NSb=1025118440;Object(D.a)(c,"StringTableInit",null,[])},1310:function(D,P,b){D=b(0);var f=b(5),c=b(531),n=b(126),m=b(184),w=b(52),z=b(381),v=b(56),t;(function(Ra){Ra[Ra.none=0]="none";Ra[Ra.mergeConflict=1]="mergeConflict";Ra[Ra.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Ra[Ra.failedToApplyHints=3]="failedToApplyHints";Ra[Ra.validateUpdateHintsAreComplete=
4]="validateUpdateHintsAreComplete";Ra[Ra.other=5]="other"})(t||(t={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",t);var A=b(824),B=b(219),S=b(753);const C=Ra=>{const Pa=new m.a;Ra.forEach(bb=>{Pa.add(bb);return!0});return Pa};var H=b(1241),J=b(1208),M=b(1244);const G=(Ra,Pa)=>{if(Ra.length!==Pa.length)return!1;for(let bb=0;bb<Ra.length;bb++)Ra.J(bb).am=Pa.J(bb),Pa.J(bb).am=Ra.J(bb);return!0},R=(Ra,Pa,bb)=>{let hb,Pb,wb;hb=0;Pb=!1;wb=0;var Fb;if(!({OMa:Fb}=W(Ra,Pa)).returnValue)return n.a.instance.ya(18969440,
1,4,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Pa,Ra.So()),{returnValue:!1,Pjd:hb,yAb:Pb,Xsd:wb};if(!bb&&2===Ra.J(Fb).type)return{returnValue:!0,Pjd:Fb,yAb:Pb,Xsd:wb};if(!Ra.J(Fb).X7())return n.a.instance.ya(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Fb,bb,Ra.So()),{returnValue:!1,Pjd:hb,yAb:Pb,Xsd:wb};let Ta=!1,Zb=0;for(;Fb<Ra.length&&Ra.J(Fb).ij.equals(Pa);Fb++){if(bb===
Zb){Ta=!0;break}if(bb>Zb&&bb<Zb+Ra.J(Fb).length){Pb=Ta=!0;wb=bb-Zb;break}Zb+=Ra.J(Fb).length}Ta||bb!==Zb||(Ta=!0);Ta&&(hb=Fb);return{returnValue:Ta,Pjd:hb,yAb:Pb,Xsd:wb}},O=(Ra,Pa,bb)=>{let hb,Pb,wb;wb=Pb=0;hb=!1;let Fb=0,Ta=!1;for(;Pb<Ra.length;Pb++){if(Pa===Fb){Ta=!0;break}if(Pa>Fb&&Pa<Fb+Ra.J(Pb).length){hb=Ta=!0;wb=Pa-Fb;break}Fb+=Ra.J(Pb).length}Ta||Pa!==Fb||(Ta=!0);Ta||(Ra=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ra.length,Fb,Pa),n.a.instance.ya(573178201,
1,2,Ra),bb.wf(Object.assign(new M.a,{eventId:"8k6fz",info:Ra})));return{returnValue:Ta,yAb:hb,nwh:Pb,mwh:wb}},I=(Ra,Pa,bb)=>{let hb;if(Ra.J(Pa).X7()&&({$2i:hb}=Ra.J(Pa).XJm(bb)).returnValue)return Ra.aw(Pa+1,hb),Ra.hA(Pa),!0;n.a.instance.ya(18969441,1,4,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Pa,bb,Ra.So());return!1},K=(Ra,Pa,bb)=>{let hb,Pb;if(!({Pjd:bb,yAb:Pb,Xsd:hb}=R(Ra,Pa,bb)).returnValue)return{returnValue:!1,index:0};if(!Pb)return{returnValue:!0,
index:bb};if(I(Ra,bb,hb))return{returnValue:!0,index:bb+1};n.a.instance.ya(18969442,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Pa,hb,Ra.So());return{returnValue:!1,index:0}},Y=(Ra,Pa,bb)=>{let hb;if(!({yAb:hb,nwh:Pa,mwh:bb}=O(Ra,Pa,bb)).returnValue)return{returnValue:!1,index:0};if(!hb)return{returnValue:!0,index:Pa};if(I(Ra,Pa,bb))return{returnValue:!0,index:Pa+1};n.a.instance.ya(574433311,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",
bb,Ra.So());return{returnValue:!1,index:0}},W=(Ra,Pa)=>{let bb;bb=0;for(let hb=0;hb<Ra.length;hb++)if(Ra.J(hb).ij.equals(Pa))return bb=hb,{returnValue:!0,OMa:bb};n.a.instance.ya(18969443,1,4,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Pa,Ra.So());return{returnValue:!1,OMa:bb}},Z=(Ra,Pa)=>{let bb;bb=-1;for(let hb=Pa;hb<Ra.length;hb++)if(2===Ra.J(hb).type)return bb=hb,{returnValue:!0,Ela:bb};n.a.instance.ya(18969472,1,4,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",
Pa,Ra.So());return{returnValue:!1,Ela:bb}},U=(Ra,Pa,bb)=>{let hb;hb=-1;for(let Pb=bb;Pb<Ra.length;Pb++)if(2===Ra.J(Pb).type&&Ra.J(Pb).ij.equals(Pa))return hb=Pb,{returnValue:!0,Ela:hb};n.a.instance.ya(18969473,1,4,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",Pa,bb,Ra.So());return{returnValue:!1,Ela:hb}},X=(Ra,Pa)=>{let bb;bb=0;var hb;if(!({OMa:hb}=W(Ra,Pa)).returnValue)return n.a.instance.ya(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",
Pa,Ra),{returnValue:!1,length:bb};for(;hb<Ra.length;hb++)if(6!==Ra.J(hb).type){if(2===Ra.J(hb).type)return{returnValue:!0,length:bb};n.a.instance.shipAssertTag(17342617,1,Ra.J(hb).X7(),"We found something other than text with type "+Ra.J(hb).type);n.a.instance.shipAssertTag(17877021,1,Ra.J(hb).ij.equals(Pa),"Unexpected GraphNodeId {0} for ParaId {1}",Ra.J(hb).ij,Pa);bb+=Ra.J(hb).length}n.a.instance.ya(18969474,1,4,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Pa,Ra);return{returnValue:!1,
length:bb}},fa=Ra=>{const Pa=new m.a;for(let bb=0;bb<Ra.length;bb++)Pa.add(Ra.J(bb).clone());return Pa};var ma=b(1243),ka=b(1191);class oa{constructor(Ra,Pa,bb=null,hb=null){this.ij=Ra;this.type=Pa;this.text=bb;this.yb=hb}isEqual(Ra){return Ra.ij.equals(this.ij)&&this.type===Ra.type&&this.yb===Ra.yb&&ka.a.Vth(this.text,Ra.text)}toString(){let Ra=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.ij,this.yb,this.type);this.text&&(Ra+=String.format(" [TextLength: {0}]",this.text.length));
return Ra}}Object(D.a)(oa,"MergeBlockValidationState",null,[]);var za=b(212),Ja=b(766),pa=b(720),Na=b(478),Da=b(431),Aa=b(765),Ma=b(719),ba=b(1176),L=b(1412),V;(function(Ra){Ra[Ra.base=1]="base";Ra[Ra.favoredUpdate=2]="favoredUpdate";Ra[Ra.unfavoredUpdate=4]="unfavoredUpdate";Ra[Ra.min=1]="min";Ra[Ra.max=7]="max"})(V||(V={}));Object(D.b)("MergeBlockSource",V);class ha{constructor(Ra,Pa,bb,hb){this.We=Ra;this.cp=Pa;this.W2d=bb;this.pId=hb}}Object(D.a)(ha,"MergedListBlocksWithUpdatedFormattingIds",
null,[]);var la=b(1240);class ya extends la.a{constructor(Ra,Pa){super(6,Ra,Pa);this.yb=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.ij)}Mrc(){return"Selection"}clone(){return new ya(this.source,this.ij)}zz(){return!1}get length(){return 0}}Object(D.a)(ya,"SelectionMergeBlock",la.a,[]);var va;(function(Ra){Ra[Ra.success=0]="success";Ra[Ra.selfSplit=1]="selfSplit";Ra[Ra.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Ra[Ra.unexpected=3]="unexpected"})(va||(va=
{}));Object(D.b)("SplitTwinListResult",va);var xa=b(1297);class Ia extends xa.a{constructor(Ra,Pa,bb,hb){super(5,Ra,Pa);this._text=null;this.gDd(bb);this.dNj=hb}get text(){return this._text}gDd(Ra){this._text=Ra}get KHd(){return this.dNj}clone(){return new Ia(this.source,this.ij,this.text,this.KHd)}get $jb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(Ia,"UpdateHintTextMergeBlock",xa.a,[]);class mb{constructor(Ra,Pa,bb,hb){this.I5=
!1;this.qpb=new z.a;this.Tc=Ra;this.llh=hb;this.XUg=bb;this._base=Pa;this.NOe=fa(Pa);if(!G(this.base,this.ee))throw n.a.instance.ya(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ra.logger.wf(Object.assign(new ba.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get ee(){return this.NOe}get mergeConflict(){return this.I5}Zif(Ra,Pa){switch(Ra.type){case 1:return this.EZj(Ra,Pa);case 2:return this.jif(Ra,Pa);case 3:return this.g_j(Ra,
Pa);case 4:return this.PZj(Ra);case 5:return this.dZj(Ra,Pa);case 6:return this.hif(Ra);default:return!1}}Yif(Ra,Pa){switch(Ra.type){case 1:return this.rif(Ra,Pa);case 2:return this.iif(Ra,Pa);case 3:return this.f_j(Ra,Pa);case 4:return this.OZj(Ra);case 5:return this.cZj(Ra,Pa);case 6:return this.fif(Ra);default:return{returnValue:!1,Kt:null}}}EZj(Ra,Pa){let bb;const hb=({uma:bb}=this.NQa(Ra.We,Pa,!1,Ra.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(hb&&1!==hb)return 3!==hb&&(n.a.instance.ya(590202197,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",V[Pa],va[hb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.I5=!1;Pa=new Ia(Pa,Ra.We,Ra.text,Ra.id);this.CWf(Ra,bb,Pa);return!0}jif(Ra,Pa){let bb,hb=({uma:bb}=this.NQa(Ra.We,Pa,!1,Ra.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(hb&&1!==hb)return 3!==hb&&(n.a.instance.ya(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",
V[Pa],va[hb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Pb;({uma:Pb,returnValue:hb}=this.NQa(Ra.We,Pa,!1,Ra.cp+Ra.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(hb&&1!==hb)return 3!==hb&&(n.a.instance.ya(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",V[Pa],va[hb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),
!1;this.I5=!1;this.Ixf(Ra,bb,Pb);return!0}g_j(Ra,Pa){let bb;const hb=({wUf:bb}=this.F0h(Ra,Pa,!1)).returnValue;if(hb&&1!==hb)return 3!==hb&&(n.a.instance.ya(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",V[Pa],va[hb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.I5=!1;Pa=new H.a(Pa,Ra.jk,Ra.N1);this.CWf(Ra,bb,Pa);return!0}PZj(Ra){let Pa;if(!({uhe:Pa}=this.G0h(Ra,this.ee,
"Derived")).returnValue)return!1;this.Ixf(Ra,Pa,Pa+1);return!0}dZj(Ra,Pa){let bb;if(!({gag:Pa,vUf:bb}=this.Q1h(Ra,!1,Pa)).returnValue)return!1;this.CWf(Ra,bb,Pa);return!0}hif(Ra){let Pa;if(!({the:Pa}=this.B0h(Ra,this.ee,"Derived")).returnValue)return!1;this.Ixf(Ra,Pa,Pa+1);return!0}uth(Ra,Pa,bb){const hb=({uma:Pa}=this.NQa(Ra,bb,!1,Pa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(hb&&1!==hb)return 3!==hb&&(n.a.instance.ya(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",
V[bb],va[hb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.I5=!1;Ra=new ya(bb,Ra);this.ee.insert(Pa,Ra);return!0}rif(Ra,Pa){var bb=null;if(mb.Uhi(Ra.text.length))return{returnValue:!1,Kt:bb};let hb,Pb,wb;var Fb=({uma:hb,VBa:Pb,kla:wb}=this.NQa(Ra.We,Pa,!0,Ra.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(Fb&&2!==Fb)return 3!==Fb&&(n.a.instance.ya(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",
V[Pa],va[Fb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Kt:bb};this.I5=!1;({Ela:Fb}=Z(this.ee,Pb));Fb=this.ee.J(Fb).ij;bb=new Ia(Pa,Ra.We,Ra.text,Ra.id);Pa=new Ia(Pa,Fb,Ra.text,Ra.id);bb.am=Pa;Pa.am=bb;this.base.insert(hb,bb);this.ee.insert(Pb,Pa);bb=new m.a;bb.add(new Da.a(Fb,wb,Ra.text,Ra.id,Ra.fn));return{returnValue:!0,Kt:bb}}iif(Ra,Pa){let bb;bb=null;if(mb.Uhi(Ra.text.length))return{returnValue:!1,Kt:bb};let hb;var Pb,wb=
({uma:hb,VBa:Fb,kla:Pb}=this.NQa(Ra.We,Pa,!0,Ra.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(wb){if(2!==wb)return 3!==wb&&(n.a.instance.ya(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",V[Pa],va[wb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Kt:bb};var Fb=0;for({OMa:Pb}=W(this.base,Ra.We);Pb<this.base.length&&Fb<Ra.cp;Pb++)Fb+=
this.base.J(Pb).length;Fb-=this.base.J(Pb-1).length;({VBa:Fb,kla:Pb,returnValue:wb}=this.NQa(Ra.We,Pa,!0,Fb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(wb)return 3!==wb&&(n.a.instance.ya(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",V[Pa],va[wb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Kt:bb};this.I5=!1}var Ta,Zb;({uma:Ta,
VBa:Zb,kla:Db,returnValue:wb}=this.NQa(Ra.We,Pa,!0,Ra.cp+Ra.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(wb){if(2!==wb)return 3!==wb&&(n.a.instance.ya(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",V[Pa],va[wb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Kt:bb};var Db=0;for({OMa:Zb}=W(this.base,Ra.We);Zb<this.base.length&&Db<Ra.cp+
Ra.text.length;Zb++)Db+=this.base.J(Zb).length;({VBa:Zb,kla:Db,returnValue:wb}=this.NQa(Ra.We,Pa,!0,Db,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(wb)return 3!==wb&&(n.a.instance.ya(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",V[Pa],va[wb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Kt:bb};this.I5=!1}Pa="";bb=new m.a;for(--Zb;Zb>=
Fb;Zb--)if(6!==this.ee.J(Zb).type)if(this.ee.J(Zb).am)Pa=this.ee.J(Zb).text+Pa,this.ee.hA(Zb);else{if(5===this.ee.J(Zb).type)wb=Db-Pa.length;else if(2===this.ee.J(Zb).type){if(wb=0,!({length:Db}=X(this.ee,this.ee.J(Zb).ij)).returnValue)return n.a.instance.ya(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Kt:bb}}else return n.a.instance.ya(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Kt:bb};if(!({Ela:pb}=Z(this.ee,Zb+1)).returnValue)return n.a.instance.ya(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Kt:bb};var pb=this.ee.J(pb).ij;bb.add(new Na.DeleteTextUpdateHint(pb,
wb,Pa));Pa=""}for(--Ta;Ta>=hb;Ta--)this.base.hA(Ta);if(!({Ela:pb}=Z(this.ee,Fb)).returnValue)return n.a.instance.ya(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Kt:bb};pb=this.ee.J(pb).ij;Pa&&Pa.length&&bb.add(new Na.DeleteTextUpdateHint(pb,Pb,Pa,Ra.id,Ra.fn));return{returnValue:!0,Kt:bb}}f_j(Ra,Pa){var bb=null;let hb,Pb,wb;var Fb=({wUf:hb,bci:Pb,kla:wb}=
this.F0h(Ra,Pa,!0)).returnValue;if(Fb)return 3!==Fb&&(n.a.instance.ya(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",V[Pa],va[Fb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Kt:bb};var Ta;if(!({Ela:Ta}=Z(this.ee,Pb)).returnValue)return n.a.instance.ya(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,Kt:bb};Fb=this.ee.J(Ta).ij;const Zb=this.ee.J(Ta).yb;let Db,pb,nb;({jk:Ta,eF:Db,N1:pb,xG:nb}=this.i_k(Ra,Ta));this.LAh(this.ee,Ta,Db,nb,Pb);bb=new H.a(Pa,Ra.jk,Ra.N1);Pa=new H.a(Pa,Ta,pb);bb.am=Pa;Pa.am=bb;this.base.insert(hb,bb);this.ee.insert(Pb,Pa);bb=new m.a;bb.add(new Ma.a(Fb,Zb,wb,Ta,pb,Db,nb,Ra.id,Ra.fn));return{returnValue:!0,Kt:bb}}OZj(Ra){let Pa;Pa=null;let bb,hb;var Pb;if(!({uhe:bb}=this.G0h(Ra,this.base,"Base")).returnValue)return{returnValue:!1,Kt:Pa};if(!this.base.J(bb).am||
!({Ela:hb}=U(this.ee,this.base.J(bb).am.ij,0)).returnValue)return n.a.instance.ya(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.I5=!0,{returnValue:!1,Kt:Pa};if(!({Ela:Pb}=Z(this.ee,hb+1)).returnValue)return n.a.instance.ya(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.I5=!0,{returnValue:!1,Kt:Pa};let wb,Fb,Ta,Zb,Db,pb;({pha:Pb,qha:Ta,Wbg:wb,qOl:Zb,$Nl:Fb,aOl:Db}=this.QRk(Ra,hb,Pb));if(!({length:pb}=X(this.ee,Pb)).returnValue)return{returnValue:!1,Kt:Pa};this.KAh(this.ee,Pb,Ta,hb);this.ee.hA(hb);this.base.hA(bb);Pa=new m.a;Pa.add(new Aa.MergeParagraphUpdateHint(wb,Zb,pb,Fb,Db,Pb,Ta,Ra.id,Ra.fn));return{returnValue:!0,Kt:Pa}}cZj(Ra,Pa){var bb=null;let hb,Pb,wb;
if(!({gag:wb,vUf:hb}=this.Q1h(Ra,!0,Pa)).returnValue)return{returnValue:!1,Kt:bb};if(!({Vwb:Pb}=this.Pgd(this.base,this.ee,hb,!0)).returnValue)return n.a.instance.ya(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,Kt:bb};if(0<Pb&&2!==this.ee.J(Pb-1).type)return n.a.instance.ya(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Tc.logger.wf(Object.assign(new L.a,
{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.I5=!0,{returnValue:!1,Kt:bb};let Fb;if(!({jk:Fb}=this.cWh(Pb)).returnValue)return{returnValue:!1,Kt:bb};Pa=new H.a(Pa,Ra.We,Ra.yb);bb=wb;bb.am=Pa;Pa.am=bb;this.base.insert(hb,wb);this.ee.insert(Pb,Pa);bb=new m.a;bb.add(new Ja.AddParagraphUpdateHint(Ra.We,Ra.yb,Fb,Ra.id,Ra.fn));return{returnValue:!0,Kt:bb}}fif(Ra){let Pa;Pa=null;let bb;var hb;if(!({the:hb}=this.B0h(Ra,this.base,"Base")).returnValue)return{returnValue:!1,Kt:Pa};if(!this.base.J(hb).am||
!this.base.J(hb).am.ij.equals(Ra.We))return n.a.instance.ya(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.I5=!0,{returnValue:!1,Kt:Pa};if(!({Vwb:bb}=this.Pgd(this.base,this.ee,hb,!0)).returnValue)return n.a.instance.ya(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,Kt:Pa};if(0<bb&&2!==this.ee.J(bb).type)return n.a.instance.ya(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.I5=!0,{returnValue:!1,Kt:Pa};const Pb=this.ee.J(bb).ij,wb=this.ee.J(bb).yb;this.ee.hA(bb);this.base.hA(hb);({jk:hb}=this.cWh(bb));0<bb&&6===this.ee.J(bb-1).type&&this.e5l(bb-1,hb);Pa=new m.a;Pa.add(new pa.a(Pb,wb,hb,Ra.id,
Ra.fn));return{returnValue:!0,Kt:Pa}}tth(Ra,Pa,bb){let hb;var Pb=({uma:Pa,VBa:hb}=this.NQa(Ra,bb,!0,Pa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(Pb)return 3!==Pb&&(n.a.instance.ya(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",V[bb],va[Pb]),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Ela:Pb}=Z(this.ee,hb));Pb=this.ee.J(Pb).ij;Ra=
new ya(bb,Ra);bb=new ya(bb,Pb);Ra.am=bb;bb.am=Ra;this.base.insert(Pa,Ra);this.ee.insert(hb,bb);return!0}QRk(Ra,Pa,bb){let hb,Pb,wb;hb=Ra.pha.equals(Ra.We)?this.ee.J(Pa).ij:this.ee.J(bb).ij;Ra=Ra.qha===Ra.yb?this.ee.J(Pa).yb:this.ee.J(bb).yb;Pb=this.ee.J(Pa).ij;Pa=this.ee.J(Pa).yb;wb=this.ee.J(bb).ij;bb=this.ee.J(bb).yb;return{pha:hb,qha:Ra,Wbg:Pb,qOl:Pa,$Nl:wb,aOl:bb}}i_k(Ra,Pa){let bb;var hb=Ra.We.equals(Ra.jk)?Ra.eF:Ra.jk;const Pb=Ra.yb===Ra.N1?Ra.xG:Ra.N1;Ra.We.equals(Ra.jk)?bb=this.ee.J(Pa).ij:
(bb=hb,hb=this.ee.J(Pa).ij);Ra.yb===Ra.N1?(Ra=this.ee.J(Pa).yb,Pa=Pb):(Ra=Pb,Pa=this.ee.J(Pa).yb);return{jk:bb,eF:hb,N1:Ra,xG:Pa}}MAh(Ra,Pa,bb,hb){for(;hb<Ra.length;hb++){if(!Ra.J(hb).X7()&&6!==Ra.J(hb).type&&2!==Ra.J(hb).type){n.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ra.J(hb).type);break}Ra.J(hb).ij=Pa;if(2===Ra.J(hb).type){Ra.J(hb).yb=bb;break}}}LAh(Ra,Pa,bb,hb,Pb){this.MAh(Ra,bb,hb,Pb);mb.NAh(Ra,Pa,Pb)}KAh(Ra,Pa,bb,hb){this.MAh(Ra,Pa,bb,hb+1);mb.NAh(Ra,Pa,hb)}G0h(Ra,
Pa,bb){let hb,Pb=-1;if(!({Ela:hb}=U(Pa,Ra.We,0)).returnValue)return n.a.instance.ya(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+bb+"for GraphNodeId "+Ra.We),{returnValue:!1,uhe:hb};if(!({Ela:Pb}=Z(Pa,hb+1)).returnValue||!Pa.J(Pb).ij.equals(Ra.eF))return n.a.instance.ya(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+hb+1+" in "+bb+" of length "+Pa.length),{returnValue:!1,uhe:hb};this.KAh(Pa,Ra.pha,Ra.qha,hb);return{returnValue:!0,uhe:hb}}F0h(Ra,Pa,bb){let hb;
const Pb=bb?this.base:this.ee,wb=bb?"Base":"Derived",Fb=({uma:Pa,VBa:bb,kla:hb}=this.NQa(Ra.We,Pa,bb,Ra.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Fb||2===Fb)return n.a.instance.ya(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+wb),{returnValue:Fb,wUf:Pa,bci:bb,kla:hb};this.LAh(Pb,Ra.jk,Ra.eF,Ra.xG,Pa);return{returnValue:Fb,wUf:Pa,bci:bb,kla:hb}}B0h(Ra,Pa,bb){return({OMa:Ra}=W(Pa,Ra.We)).returnValue?2!==Pa.J(Ra).type?(n.a.instance.ya(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
bb),{returnValue:!1,the:-1}):{returnValue:!0,the:Ra}:(n.a.instance.ya(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+bb),{returnValue:!1,the:-1})}e5l(Ra,Pa){var bb=this.ee.J(Ra);if(Pa){let hb;({Ela:hb}=U(this.ee,Pa,0));bb=bb.clone();bb.ij=Pa;this.ee.hA(Ra);this.ee.insert(hb,bb)}else this.ee.length>Ra&&(this.ee.J(Ra+1).X7()||2===this.ee.J(Ra+1).type)&&(bb.ij=this.ee.J(Ra+1).ij)}Q1h(Ra,Pa,bb){var hb=Pa?this.base:this.ee;Pa=Pa?"Base":"Derived";bb=new H.a(bb,Ra.We,Ra.yb);if(Ra.jk){if(!({Ela:hb}=
U(hb,Ra.jk,0)).returnValue)return n.a.instance.ya(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ra.jk,Pa),{returnValue:!1,gag:bb,vUf:hb};hb+=1}else hb=0;return{returnValue:!0,gag:bb,vUf:hb}}cWh(Ra){let Pa;Pa=null;let bb=Ra-1;if(-1===bb)return{returnValue:!0,jk:Pa};6===this.ee.J(bb).type&&bb--;if(2===this.ee.J(bb).type||4===this.ee.J(bb).type)return Pa=this.ee.J(bb).ij,{returnValue:!0,jk:Pa};n.a.instance.ya(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.ee.J(Ra-1).type);return{returnValue:!1,jk:Pa}}Pgd(Ra,Pa,bb,hb){let Pb,wb=!0;Pb=-1;if(bb>Ra.length)return n.a.instance.ya(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Vwb:Pb};if(bb<Ra.length){if(-1<bb&&bb<Ra.length&&!Ra.J(bb).am){wb=!1;for(var Fb=bb+1;Fb<Ra.length;Fb++)if(Ra.J(Fb).am){bb=Fb;wb=!0;break}}if(!wb)return{returnValue:!1,Vwb:Pb};wb=!1;for(Fb=0;Ra.J(bb)&&Fb<Pa.length;Fb++)if(Pa.J(Fb).am===Ra.J(bb)){Pb=Fb;wb=!0;break}if(!wb)return{returnValue:!1,
Vwb:Pb}}else Pb=Pa.length;if(0<Pb&&hb&&!Pa.J(Pb-1).am){for(Ra=Pb-1;0<=Ra&&!Pa.J(Ra).am;Ra--);Pb=Ra+1;6===Pa.J(Pb).type&&5!==this.Tc.input.source&&Pb++}return{returnValue:!0,Vwb:Pb}}NQa(Ra,Pa,bb,hb,Pb,wb){let Fb;var Ta;let Zb;var Db=this.base;let pb=this.ee,nb=!1;bb||(Db=this.ee,pb=this.base);Zb=Ta=Fb=0;let ub,kb,zc=0;if(!({Pjd:hb,yAb:ub,Xsd:kb}=R(Db,Ra,hb)).returnValue)return n.a.instance.ya(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,uma:Fb,VBa:Ta,kla:Zb};0<=hb&&hb<Db.length&&!Db.J(hb).am&&ub&&!Pb&&(n.a.instance.ya(17044296,1,3,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",wb),this.I5=!0,zc=Pa===Db.J(hb).source?1:2,nb=!0);Pb&&!Db.J(hb)&&hb--;Pb&&ub&&!Db.J(hb).am&&(ub=!1,kb=0);if(!bb&&!({OMa:Ra}=W(pb,Ra)).returnValue&&!ub)return{returnValue:0,uma:hb,VBa:Ta,kla:Zb};if(!({Vwb:Ra}=this.Pgd(Db,pb,hb,bb&&!ub)).returnValue&&!nb&&(Pa=
!1,1===this.llh&&0<hb&&!kb&&(hb--,{Vwb:Ra,returnValue:Pa}=this.Pgd(Db,pb,hb,bb&&!ub),Pa&&(hb++,Ra<pb.length-1?Ra++:Pa=!1)),!Pa))return n.a.instance.ya(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Tc.logger.wf(Object.assign(new L.a,{Qh:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.I5=!0,{returnValue:3,uma:Fb,VBa:Ta,kla:Zb};if(ub&&(!I(Db,hb,kb)||!nb&&!I(pb,Ra,kb)))return n.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,uma:Fb,VBa:Ta,kla:Zb};Fb=hb;Ta=Ra;ub&&(Fb=hb+1,nb||(Ta=Db.J(hb),bb=pb.J(Ra),Ta.am=bb,bb.am=Ta,Db=Db.J(hb+1),Ta=pb.J(Ra+1),Db.am=Ta,Ta.am=Db,Ta=Ra+1));if(Ta>=pb.length)return n.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Ta+" secondaryList length was "+pb.length),{returnValue:3,uma:Fb,VBa:Ta,kla:Zb};
for(Db=0;Db<Ta;Db++)pb.J(Db).ij.equals(pb.J(Ta).ij)&&(Zb+=pb.J(Db).length);return{returnValue:zc,uma:Fb,VBa:Ta,kla:Zb}}Ixf(Ra,Pa,bb){this.XUg.contains(Ra.id)&&this.qpb.W(Ra.id,new m.a);for(--bb;bb>=Pa;bb--)this.XUg.contains(Ra.id)?this.qpb.J(Ra.id).insert(this.qpb.J(Ra.id).length,this.ee.J(bb)):this.ee.J(bb).am&&(this.ee.J(bb).am.am=null),this.ee.hA(bb)}CWf(Ra,Pa,bb){if(this.qpb.La(Ra.fn)){const hb=this.qpb.J(Ra.fn);for(let Pb=0;Pb<hb.length;Pb++)hb.J(Pb).ij=bb.ij,Object(za.a)(H.a,bb)&&Object(za.a)(H.a,
hb.J(Pb))&&(hb.J(Pb).yb=bb.yb);this.ee.aw(Pa,this.qpb.J(Ra.fn));this.qpb.remove(Ra.fn)}else this.ee.insert(Pa,bb)}p9k(Ra){let Pa,bb;bb=Pa=-1;if(!Ra.am)return{returnValue:!1,Lpc:Pa,Wxf:bb};var hb;let Pb=0,wb=!1;if(!({OMa:hb}=W(this.ee,Ra.am.ij)).returnValue)return{returnValue:!1,Lpc:Pa,Wxf:bb};for(;hb<this.ee.length;hb++){if(Ra.am===this.ee.J(hb)){Pa=hb;bb=Pb;wb=!0;break}Pb+=this.ee.J(hb).length}return{returnValue:wb,Lpc:Pa,Wxf:bb}}yEf(Ra){let Pa;Pa=new m.a;let bb=0,hb=0;for(;bb<Ra.length;){if(hb>=
this.base.length)return n.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,gHc:Pa};if(Ra.J(bb).length>this.base.J(hb).length){if(!I(Ra,bb,this.base.J(hb).length))return n.a.instance.ya(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",bb,this.base.J(hb).length),{returnValue:!1,gHc:Pa}}else if(Ra.J(bb).length<this.base.J(hb).length){var Pb=
!!this.base.J(hb).am,wb=0;if(Pb&&!({Vwb:wb}=this.Pgd(this.base,this.ee,hb,!1)).returnValue)return n.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",hb),{returnValue:!1,gHc:Pa};if(!I(this.base,hb,Ra.J(bb).length)||Pb&&!I(this.ee,wb,Ra.J(bb).length))return n.a.instance.ya(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,gHc:Pa};if(Pb){Pb=this.base.J(hb);var Fb=this.ee.J(wb);Pb.am=Fb;Fb.am=Pb;Pb=this.base.J(hb+1);wb=this.ee.J(wb+1);Pb.am=wb;wb.am=Pb}}if(this.base.J(hb).am&&5!==this.base.J(hb).type&&this.base.J(hb).X7()&&(wb=this.base.J(hb),Pb=Ra.J(bb),!wb.hK.equals(Pb.hK)||!wb.JF.zz(Pb.JF))){let Ta;if(!({Lpc:Fb,Wxf:Ta}=this.p9k(this.base.J(hb))).returnValue)return{returnValue:!1,gHc:Pa};Pa.add(new ha(this.ee.J(Fb).ij,Ta,wb,Pb))}bb++;hb++}return{returnValue:!0,gHc:Pa}}static NAh(Ra,Pa,bb){for(--bb;0<=
bb;bb--){if(!Ra.J(bb).X7()&&6!==Ra.J(bb).type){n.a.instance.shipAssertTag(17311187,1,2===Ra.J(bb).type||4===Ra.J(bb).type,"Found merge block of type "+Ra.J(bb).type);break}Ra.J(bb).ij=Pa}}static Uhi(Ra){return Ra?!1:(n.a.instance.ya(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(D.a)(mb,"ParagraphMergeUsingHintsTwinList",null,[1348]);var gb=b(1410),Za=b(1411),$a=b(1407),cb=b(1409),La=b(1408);class Ya{constructor(Ra,Pa,
bb,hb){this.cp=Ra;this.length=Pa;this.W2d=bb;this.pId=hb}}Object(D.a)(Ya,"UpdateFormattingIdsPosInfo",null,[]);class Eb{constructor(Ra,Pa,bb){this.I5=!1;this.qpb=new z.a;this.Tc=Ra;this.llh=bb;Ra.runtime.Qa&&Ra.runtime.Qa.isFeatureEnabled(111);this._base=Pa;this.NOe=fa(Pa);if(!G(this.base,this.ee))throw n.a.instance.ya(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ra.logger.wf(Object.assign(new M.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get ee(){return this.NOe}get mergeConflict(){return this.I5}Zif(Ra,
Pa){switch(Ra.type){case 11:return this.CZj(Ra,Pa);case 8:return this.jif(Ra,Pa);case 10:return this.hif(Ra);default:return!1}}Yif(Ra,Pa){switch(Ra.type){case 11:return this.BZj(Ra,Pa);case 8:return this.iif(Ra,Pa);case 10:return this.fif(Ra);default:return{returnValue:!1,Kt:null}}}uth(){n.a.instance.ya(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}tth(){n.a.instance.ya(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}yEf(Ra){let Pa;Pa=new m.a;let bb=0,hb=0,Pb=0;for(;bb<Ra.length;){if(hb>=this.base.length)return n.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,oId:Pa};if(Ra.J(bb).length>this.base.J(hb).length){if(!I(Ra,bb,this.base.J(hb).length))return n.a.instance.ya(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,oId:Pa}}else if(Ra.J(bb).length<this.base.J(hb).length&&!this.Rjb(Pb+Ra.J(bb).length,!0).returnValue)return n.a.instance.ya(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,oId:Pa};if(this.base.J(hb).am&&5!==this.base.J(hb).type&&this.base.J(hb).X7()){const wb=this.base.J(hb),Fb=Ra.J(bb);if(!wb.hK.equals(Fb.hK)||!wb.JF.zz(Fb.JF)){let Ta,Zb;if(({Lpc:Ta,FLh:Zb}=this.q9k(this.base.J(hb))).returnValue)Pa.add(new Ya(Zb,this.ee.J(Ta).length,wb,Fb));else return n.a.instance.ya(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,oId:Pa}}}Pb+=this.base.J(hb).length;bb++;hb++}return{returnValue:!0,oId:Pa}}CZj(Ra,Pa){let bb;if(!({SKa:bb}=this.Rjb(Ra.cp,!0)).returnValue)return n.a.instance.ya(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Pb=0;Pb<Ra.W2.length;Pb++)switch(Ra.W2.J(Pb).type){case 7:var hb=Ra.W2.J(Pb);this.ee.insert(bb,new Ia(Pa,null,hb.text,hb.id));break;case 9:hb=Ra.W2.J(Pb);this.ee.insert(bb,new H.a(Pa,hb.We,hb.yb));break;default:return n.a.instance.ya(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}jif(Ra,Pa){let bb,hb;if(!({SKa:bb}=this.Rjb(Ra.cp,!0)).returnValue||!({SKa:hb}=this.Rjb(Ra.cp+
Ra.text.length,!1)).returnValue)return n.a.instance.ya(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ra=hb;Ra>=bb;Ra--)this.ee.J(Ra).source!==Pa&&this.t8d(this.ee,Ra);return!0}hif(Ra){let Pa;if(!({SKa:Pa}=this.Rjb(Ra.cp,!0)).returnValue)return n.a.instance.ya(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.Lxf(this.ee,Ra,Pa);return!0}BZj(Ra,Pa){let bb;bb=null;let hb,Pb;if(!({VRb:hb,SKa:Pb}=this.Rjb(Ra.cp,!0)).returnValue)return n.a.instance.ya(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Kt:bb};var wb=this.wJf(this.ee,Pb-1);wb=new La.a(wb);for(let Fb=0;Fb<Ra.W2.length;Fb++)switch(Ra.W2.J(Fb).type){case 7:wb.W2.add(this.rif(Ra.W2.J(Fb),Pa,hb,Pb));break;
case 9:wb.W2.add(this.DZj(Ra.W2.J(Fb),Pa,hb,Pb));break;default:return n.a.instance.ya(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Kt:bb}}bb=new m.a;bb.add(wb);return{returnValue:!0,Kt:bb}}rif(Ra,Pa,bb,hb){const Pb=new Ia(Pa,Ra.We,Ra.text,Ra.id);Pa=new Ia(Pa,Ra.We,Ra.text,Ra.id);Pb.am=Pa;Pa.am=Pb;this.base.insert(bb,Pb);this.ee.insert(hb,Pa);bb=new cb.a(Ra.We,Ra.text);bb.id=Ra.id;return bb}DZj(Ra,
Pa,bb,hb){const Pb=new H.a(Pa,Ra.We,Ra.yb);Pa=new H.a(Pa,Ra.We,Ra.yb);Pb.am=Pa;Pa.am=Pb;this.base.insert(bb,Pb);this.ee.insert(hb,Pa);return new $a.a(Ra.We,Ra.yb)}iif(Ra){let Pa;Pa=new m.a;let bb;var hb;let Pb;if(!({VRb:bb,SKa:hb}=this.Rjb(Ra.cp,!0)).returnValue||!({VRb:Pb,SKa:wb}=this.Rjb(Ra.cp+Ra.text.length,!1)).returnValue)return n.a.instance.ya(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,Kt:Pa};for(Ra=wb;Ra>=hb;Ra--)if(this.ee.J(Ra).am){var wb=Ra;Pa.add(({hOl:Ra}=this.wFk(Ra,hb)).returnValue);this.t8d(this.ee,Ra,wb)}for(hb=Pb;hb>=bb;hb--)this.t8d(this.base,hb);return{returnValue:!0,Kt:Pa}}fif(Ra){let Pa;Pa=null;let bb,hb;if(!({VRb:bb,SKa:hb}=this.Rjb(Ra.cp,!0)).returnValue)return n.a.instance.ya(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Kt:Pa};
if(!this.Lxf(this.base,Ra,bb))return n.a.instance.ya(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Kt:Pa};this.Lxf(this.ee,Ra,hb)&&(Pa=new m.a,Pa.add(new gb.a(this.wJf(this.ee,hb-1),Ra.We,Ra.yb)));return{returnValue:!0,Kt:Pa}}Rjb(Ra,Pa){var bb;var hb=bb=-1;let Pb,wb;if(!({yAb:wb,nwh:Ra,mwh:Pb}=O(this.base,Ra,this.Tc.logger)).returnValue)return{returnValue:!1,VRb:bb,
SKa:hb};const Fb=Ra>=this.base.length;Fb&&Ra--;if(this.base.J(Ra).am){const Ta=this.DGk(this.ee,this.base.J(Ra));if(wb){if(0>Ta||!I(this.base,Ra,Pb)||!I(this.ee,Ta,Pb))return n.a.instance.ya(575706444,1,2,"SplitTwinListAndFindIdx"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,VRb:bb,SKa:hb};bb=this.base.J(Ra);hb=this.ee.J(Ta);bb.am=hb;hb.am=bb;bb=this.base.J(Ra+1);hb=this.ee.J(Ta+1);bb.am=hb;hb.am=bb;bb=Pa?Ra+1:Ra;hb=Pa?Ta+1:Ta}else Pa?(bb=
Fb?Ra+1:Ra,hb=Fb?Ta+1:Ta):(bb=Fb?Ra:Ra-1,hb=Fb?Ta:Ta-1)}else if(wb){if(I(this.base,Ra,Pb))bb=Pa?Ra+1:Ra;else return n.a.instance.ya(575706445,1,2,"SplitTwinListAndFindIdx"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,VRb:bb,SKa:hb};Pa?(hb=({O_b:hb}=this.crc(this.base,this.ee,Ra,!1)).returnValue?hb+1:0,hb=hb>=this.ee.length?this.ee.length-1:hb):(hb=({O_b:hb}=this.crc(this.base,this.ee,Ra,!0)).returnValue?hb-1:this.ee.length-1,hb=0>hb?0:hb)}else Pa?
(({O_b:hb}=this.crc(this.base,this.ee,Ra,!0)).returnValue||(({O_b:hb}=this.crc(this.base,this.ee,Ra,!1)).returnValue?hb+=1:(hb=Fb?this.ee.length-1:0,hb=0>hb?0:hb)),bb=Fb?Ra+1:Ra):(({O_b:hb}=this.crc(this.base,this.ee,Ra,!1)).returnValue||(({O_b:hb}=this.crc(this.base,this.ee,Ra,!0)).returnValue?--hb:(hb=Ra?this.ee.length-1:0,hb=0>hb?0:hb)),bb=Fb?Ra:Ra-1);return{returnValue:!0,VRb:bb,SKa:hb}}crc(Ra,Pa,bb,hb){let Pb=null;if(hb)for(;bb<Ra.length;bb++){if(Ra.J(bb).am){Pb=Ra.J(bb).am;break}}else for(;0<=
bb;bb--)if(Ra.J(bb).am){Pb=Ra.J(bb).am;break}if(Pb)for(Ra=0;Ra<Pa.length;Ra++)if(Pa.J(Ra)===Pb)return Pa=Ra,{returnValue:!0,O_b:Pa};return{returnValue:!1,O_b:-1}}DGk(Ra,Pa){for(let bb=0;bb<Ra.length;bb++)if(Ra.J(bb).am===Pa)return bb;return-1}t8d(Ra,Pa,bb=-1){for(bb=0>bb?Pa:bb;bb>=Pa;bb--)Ra.J(bb).am&&(Ra.J(bb).am.am=null),Ra.hA(bb)}wJf(Ra,Pa){let bb=0;for(;0<=Pa;Pa--)bb+=Ra.J(Pa).length;return bb}h8k(Ra){Ra=Object(v.a)(xa.a,Ra);Ra||(n.a.instance.ya(575706448,1,2,"GetTextBlock"),this.Tc.logger.wf(Object.assign(new M.a,
{Qh:"GetTextBlock",eventId:"8ujvq"})));return Ra}wFk(Ra,Pa){let bb="";for(;Ra>=Pa&&this.ee.J(Ra).am&&2!==this.ee.J(Ra).type;)bb=this.h8k(this.ee.J(Ra)).text+bb,Ra--;Pa=0>Ra?0:this.wJf(this.ee,Ra);Ra+=1;return{returnValue:new Za.a(Pa,bb),hOl:Ra}}q9k(Ra){let Pa,bb,hb=!1;bb=Pa=0;if(!Ra.am)return{returnValue:!1,Lpc:Pa,FLh:bb};for(Pa=0;Pa<this.ee.length;Pa++){if(this.ee.J(Pa).am===Ra){hb=!0;break}bb+=this.ee.J(Pa).length}return{returnValue:hb,Lpc:Pa,FLh:bb}}Lxf(Ra,Pa,bb){bb=bb===Ra.length?--bb:bb;bb>Ra.length-
1&&(n.a.instance.ya(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ra.J(bb).type){const hb=Ra.J(bb);if(hb.ij!==Pa.We||hb.yb!==Pa.yb)return!1;this.t8d(Ra,bb);return!0}return!1}}Object(D.a)(Eb,"ParagraphMergeUsingHintsTwinListLcs",null,[1348]);var qa=b(1217),Oa=b(1177),Ha=b(1406);b.d(P,"a",function(){return ab});class ab{constructor(Ra,Pa,bb,hb,Pb,wb,Fb=null,Ta=null,Zb=null){this.qS=this.Pza=this.jTa=this.Xxa=
null;this._initialized=!1;this.Tc=Ra;this.fD=Pa;this.Oza=hb;this.uya=bb;this.IV=Pb;this.zKe=new c.a;for(Pa=0;Pa<this.fD.length;Pa++)this.zKe.add(this.fD.J(Pa).id);this.y_g=new c.a;for(Pa=0;Pa<this.uya.length;Pa++)this.y_g.add(this.uya.J(Pa).id);this.Xkh=new c.a;for(Pa=0;Pa<this.Oza.length;Pa++)this.Xkh.add(this.Oza.J(Pa).id);this.qg=wb;this.r2c=Fb||S.a.instance;this.sP=Ta;this.F$=Zb;Ra=!!Ra.runtime.Qa&&Ra.runtime.Qa.isFeatureEnabled(111);this.qLb=1===(this.sP&&this.F$&&1===this.sP.IRa&&1===this.F$.IRa?
1:0)&&Ra;this.o1=0}get vxe(){return 1!==this.o1}ull(){var Ra=!0;if(this.sP&&this.F$)return Ra;if(this.sP||this.F$)return n.a.instance.ya(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Tc.runtime.Lw.La(B.a.fL)&&(Ra=this.Tc.runtime.Lw.J(B.a.fL),Ra=this.dPg(Ra,this.Tc.runtime.sKa.id,"favored")&&({updateHints:this.sP}=this.Ldi(Ra,this.zKe,
this.y_g,this.Tc.runtime.Lw,"favored")).returnValue);Ra&&this.Tc.runtime.Hp.La(B.a.fL)&&(Ra=this.Tc.runtime.Hp.J(B.a.fL),Ra=this.dPg(Ra,this.Tc.runtime.sKa.id,"unfavored")&&({updateHints:this.F$}=this.Ldi(Ra,this.zKe,this.Xkh,this.Tc.runtime.Hp,"unfavored")).returnValue);Ra&&this.Tc.input.Ytc&&(Ra=this.Tc.input.s9.last().Saa(B.a.fL),Ra=this.dPg(Ra,this.Tc.input.s9.last().wG.id,"alreadyMerged"));return Ra}Ujl(){const Ra=new c.a;if(this.qLb)return Ra;const Pa=this.sP?this.sP.updateHints.d9():new m.a;
let bb=0;for(;bb<Pa.length-1;){const hb=Pa.J(bb);let Pb,wb=!1;for(Pb=bb+1;Pb<Pa.length;Pb++){const Fb=Pa.J(Pb);if(hb.Q_f(Fb)){Ra.add(hb.id);Pa.hA(Pb);Pa.hA(bb);wb=!0;break}}wb||bb++}return Ra}dPg(Ra,Pa,bb){Ra=this.qg.getPropertyString(Ra,f.a.wxa);Ra=w.a.Ad(Ra);return Pa.equals(Ra)?!0:(this.tCd(2),n.a.instance.ya(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Tc.runtime.sKa.id,
Ra,bb),!1)}Ldi(Ra,Pa,bb,hb,Pb){let wb;wb=new Ha.a(new m.a,0);Ra=this.qg.getPropertyObjectIds(Ra,f.a.fV).d9();for(let Ta=0;Ta<Ra.length;Ta++){if(!hb.La(Ra.J(Ta)))return n.a.instance.ya(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Ra.J(Ta),Pb),{returnValue:!1,updateHints:wb};const Zb=hb.J(Ra.J(Ta));var Fb=w.a.Ad(this.qg.getPropertyString(Zb,f.a.gV));if(Pa.contains(Fb)||bb.contains(Fb)){Fb=this.r2c.gYa(Zb);
if(!Fb)return n.a.instance.ya(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Zb.id,Pb),{returnValue:!1,updateHints:wb};wb.updateHints.add(Fb)}}0<Ra.length&&n.a.instance.ya(17162308,1,4,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Pb,Ra.So(),wb.updateHints.So());return{returnValue:!0,updateHints:wb}}Ikl(){return({QL:this.Xxa,
idd:this.jTa,jHd:this.Pza}=qa.a.tIh(this.Tc,this.qg,this.fD,this.uya,this.Oza,this.IV,!0,!0)).returnValue?!0:!1}rll(Ra){const Pa=qa.a.n7d(this.qg,bb=>this.Tc.runtime.pj.J(bb),this.fD,1,this.IV,!0,!0).returnValue;if(!Pa)return n.a.instance.ya(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.qS=this.qLb?new Eb(this.Tc,Pa,1):new mb(this.Tc,Pa,Ra,this.sP?this.sP.IRa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.ull()||
!this.Ikl())return!1;const Ra=this.Ujl();return this.rll(Ra)?!0:!1}S1h(Ra){const Pa=new m.a;let bb="";for(let hb=0;hb<Ra.length;hb++){const Pb=Ra.J(hb);Pb.X7()?bb+=Ra.J(hb).text:2===Pb.type?(Pa.add(new oa(Pb.ij,Pb.type,bb,Pb.yb)),bb=""):4===Pb.type&&(Pa.add(new oa(Pb.ij,Pb.type)),bb="")}return Pa}validateUpdateHintsAreComplete(Ra,Pa,bb){Pa=this.S1h(Pa);Ra=this.S1h(Ra);let hb=Pa.length===Ra.length;if(hb)for(let Pb=0;Pb<Pa.length;Pb++)if(!Pa.J(Pb).isEqual(Ra.J(Pb))){hb=!1;break}hb||(this.tCd(4),n.a.instance.ya(17044288,
1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",bb,Ra.So(),Pa.So()));return hb}Mth(Ra,Pa,bb){(Pa=({Qkb:Ra}=this.y_j(Ra,Pa,bb)).returnValue)||this.tCd(this.qS.mergeConflict?1:3);return{returnValue:Pa,Qkb:Ra}}y_j(Ra,Pa,bb){let hb;hb=new m.a;let Pb=!0;var wb=0;let Fb=null,Ta=this.sP?this.sP.updateHints.length:0;for(var Zb=0;Zb<Ta&&Pb;Zb++)Fb=this.sP.updateHints.J(Zb),wb<this.F$.updateHints.length&&
Fb.id.equals(this.F$.updateHints.J(wb).id)&&5!==this.Tc.input.source?({returnValue:Pb}=this.qS.Yif(Fb,2),wb++):Pb=this.qS.Zif(Fb,2);if(!Pb)return n.a.instance.ya(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Fb.toString()),{returnValue:!1,Qkb:hb};if(!this.validateUpdateHintsAreComplete(this.qS.ee,this.jTa,"Favored"))return{returnValue:!1,Qkb:hb};if(Ra&&1===this.Tc.input.s3&&!this.qS.uth(Pa,bb,2))return n.a.instance.ya(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Pa,bb),{returnValue:!1,Qkb:hb};Pb=!0;Zb=new m.a;for(Ta=this.F$?this.F$.updateHints.length:0;wb<Ta&&Pb;wb++){Fb=this.F$.updateHints.J(wb);let Db;({Kt:Db,returnValue:Pb}=this.qS.Yif(Fb,4));Pb&&Db&&Zb.aw(Zb.length,Db)}return Pb?this.validateUpdateHintsAreComplete(this.qS.base,this.Pza,"Unfavored")?Ra&&2===this.Tc.input.s3&&!this.qS.tth(Pa,bb,4)?(n.a.instance.ya(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Pa,bb),{returnValue:!1,Qkb:hb}):{returnValue:!0,
Qkb:Zb}:{returnValue:!1,Qkb:hb}:(n.a.instance.ya(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Fb.id,Fb.type),{returnValue:!1,Qkb:hb})}iZk(){let Ra,Pa=0;let bb=0,hb=w.a.nil;for(Ra=new z.a;bb<this.qS.base.length;){const Fb=this.qS.base.J(bb);hb.equals(Fb.ij)||(Pa=0,hb=Fb.ij);if(5===Fb.type){var Pb=Pa+Fb.length;var wb=void 0;let Ta;const Zb=fa(this.Pza);if(!({index:wb}=K(Zb,Fb.ij,Pa)).returnValue||!({index:Ta}=K(Zb,Fb.ij,Pb)).returnValue)return n.a.instance.ya(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Fb.KHd),{returnValue:!1,Gui:Ra};for(Pb=new m.a;wb<Ta;wb++)Pb.add(Zb.J(wb));Ra.W(Fb.KHd,Pb)}Pa+=Fb.length;bb++}return{returnValue:!0,Gui:Ra}}jZk(){let Ra;Ra=new z.a;let Pa=0;for(let hb=0;hb<this.qS.base.length;hb++){const Pb=this.qS.base.J(hb);if(5===Pb.type){var bb=void 0;let wb;const Fb=fa(this.Pza);if(!({index:bb}=Y(Fb,Pa,this.Tc.logger)).returnValue||!({index:wb}=
Y(Fb,Pa+Pb.length,this.Tc.logger)).returnValue)return n.a.instance.ya(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,Hui:Ra};const Ta=new m.a;for(;bb<wb;bb++)Ta.add(Fb.J(bb));Ra.W(Pb.KHd,Ta)}Pa+=Pb.length}return{returnValue:!0,Hui:Ra}}QZj(Ra){let Pa;Pa=new m.a;let bb;if(this.qLb){if(!({Hui:bb}=this.jZk()).returnValue)return{returnValue:!1,qsd:Pa}}else if(!({Gui:bb}=this.iZk()).returnValue)return{returnValue:!1,qsd:Pa};let hb;hb=this.qLb?
new Eb(this.Tc,fa(this.jTa),1):new mb(this.Tc,fa(this.jTa),new c.a,this.sP?this.sP.IRa:0);for(var Pb=0;Pb<Ra.length;Pb++)if(!hb.Zif(Ra.J(Pb),4))return{returnValue:!1,qsd:Pa};for(Ra=hb.ee.length-1;0<=Ra;Ra--)5===hb.ee.J(Ra).type&&(Pb=hb.ee.J(Ra).KHd,hb.ee.hA(Ra),hb.ee.aw(Ra,bb.J(Pb)));this.qLb&&(this.nKh(hb.ee),this.nKh(this.qS.ee));if(!this.validateUpdateHintsAreComplete(this.qS.ee,hb.ee,"Merged"))return{returnValue:!1,qsd:Pa};Pa=hb.ee;return{returnValue:!0,qsd:Pa}}nKh(Ra){const Pa=new z.a;for(let bb=
Ra.length-1;0<=bb;bb--){const hb=Object(v.a)(H.a,Ra.J(bb));hb&&(Pa.La(hb.yb)?Pa.J(hb.yb).source!==hb.source&&Ra.hA(bb):Pa.add(hb.yb,hb))}}x_j(Ra){let Pa;if(!({oId:Pa}=this.qS.yEf(fa(this.Pza))).returnValue)return!1;for(let hb=0;hb<Pa.length;hb++){const Pb=Pa.J(hb);let wb,Fb;if(!({index:wb}=Y(Ra,Pb.cp,this.Tc.logger)).returnValue||!({index:Fb}=Y(Ra,Pb.cp+Pb.length,this.Tc.logger)).returnValue)return n.a.instance.ya(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Tc.logger.wf(Object.assign(new M.a,
{Qh:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var bb=!1;for(let Ta=wb;Ta<Fb&&!bb;Ta++)bb=!Pb.W2d.hK.equals(Ra.J(Ta).hK);if(!bb){for(bb=wb;bb<Fb;bb++)Ra.hA(wb);Ra.insert(wb,Pb.pId)}}return!0}w_j(Ra){let Pa;if(!({gHc:Pa}=this.qS.yEf(fa(this.Pza))).returnValue)return!1;for(let Pb=0;Pb<Pa.length;Pb++){var bb=Pa.J(Pb);let wb,Fb;if(({index:wb}=K(Ra,bb.We,bb.cp)).returnValue&&({index:Fb}=K(Ra,bb.We,bb.cp+bb.pId.length)).returnValue){var hb=!1;for(let Ta=wb;Ta<Fb&&!hb;Ta++)hb=!bb.W2d.hK.equals(Ra.J(Ta).hK)||
!bb.W2d.JF.zz(Ra.J(Ta).JF);if(hb){if(this.sP&&1===this.sP.IRa||this.F$&&1===this.F$.IRa)return!1}else{for(hb=wb;hb<Fb;hb++)Ra.hA(wb);Ra.insert(wb,bb.pId)}}else if(bb=bb.pId.epl,n.a.instance.ya(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",bb),bb||this.sP&&1===this.sP.IRa||this.F$&&1===this.F$.IRa)return!1}return!0}X1k(Ra){let Pa,bb;bb=new m.a;Pa=this.Tc.runtime.Jl.J(B.a.fL);let hb;({uag:hb}=ab.wWh(this.Tc,
this.qg));const Pb=new m.a;for(let Fb=0;Fb<Ra.length;Fb++){if(hb.contains(Ra.J(Fb).id,(Zb,Db)=>Zb.equals(Db)))continue;if(this.Tc.runtime.Jl.La(Ra.J(Fb).id))return n.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ra.J(Fb).id),{returnValue:!1,cte:Pa,bte:bb};Pb.add(Ra.J(Fb).id);var wb=Ra.J(Fb).Taa();const Ta=new Oa.a(wb);wb=wb.Hl();for(const Zb of wb)Ta.oC(Zb);bb.add(Ta)}Ra=this.qg.getPropertyObjectIds(Pa.Oi,f.a.fV);Ra.aw(Ra.length,Pb);this.qg.setPropertyObjectIds(Pa.Oi,
f.a.fV,Ra);return{returnValue:!0,cte:Pa,bte:bb}}Xce(Ra){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ra.name,Ra.message,Ra.stack)}tCd(Ra){this.o1||(this.o1=Ra)}VGc(){let Ra;Ra=null;let Pa,bb;var hb;try{if({Jl:Ra,cte:Pa,bte:bb,returnValue:hb}=this.zSm(),hb){if(Pa&&bb){this.Tc.runtime.Jl.W(Pa.Oi.id,Pa);for(hb=0;hb<bb.length;hb++){const Ta=bb.J(hb);this.Tc.runtime.Jl.W(Ta.Oi.id,Ta)}const Pb=Pa.Oi,wb=this.qg.getPropertyObjectIds(Pb,f.a.fV),Fb=this.qg.getPropertyString(Pb,f.a.wxa);n.a.instance.ya(17162312,
1,4,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",wb.So(),Fb)}else n.a.instance.ya(593826831,1,4,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Jl:Ra}}}catch(Pb){n.a.instance.ya(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.Xce(Pb))}this.tCd(5);n.a.instance.ya(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.o1,this.vxe);this.Vzb();this.sP&&1===this.sP.IRa&&this.Tc.logger.wf(Object.assign(new ma.a,{eventId:"bc04c",Qh:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.o1]+"/LCS"}));return{returnValue:!1,Jl:Ra}}zSm(){let Ra,Pa,bb;bb=Pa=Ra=null;let hb;hb=this.initialize();this.Tc.logger.nM("PMUH Initialize");let Pb=null;hb=hb&&({Qkb:Pb}=this.Mth(!1,w.a.nil,0)).returnValue;this.Tc.logger.nM("PMUH ApplyUpdateHints");let wb=new m.a;hb=hb&&({qsd:wb}=this.QZj(Pb)).returnValue;this.Tc.logger.nM("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
hb=this.qLb?hb&&this.x_j(wb):hb&&this.w_j(wb);this.Tc.logger.nM("PMUH ApplyUnfavoredFormattingChanges");this.qLb&&!this.gpm(wb)&&(n.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Tc.logger.wf(Object.assign(new M.a,{Qh:"ReuseParaIdsIfPossible",eventId:"8ettb"})),hb=!1);const Fb=this.nee(wb);hb=hb&&({ate:Ra}=qa.a.phd(this.Tc,this.qg,this.IV,wb,Fb)).returnValue;this.Tc.logger.nM("PMUH GetMergeableObjectsFromMergeBlocks");this.sP&&1===this.sP.IRa&&this.F$&&1===this.F$.IRa||(hb=
hb&&({cte:Pa,bte:bb}=this.X1k(C(Pb))).returnValue,this.Tc.logger.nM("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:hb,mergeConflict:!!this.qS&&this.qS.mergeConflict,Jl:Ra,cte:Pa,bte:bb}}nee(Ra){const Pa=new m.a;for(let bb=0;bb<Ra.length;bb++)2===Ra.J(bb).type&&Pa.add(Ra.J(bb).ij);return Pa}qKf(Ra){const Pa=new m.a;for(let bb=0;bb<Ra.length;bb++)2===Ra.J(bb).type&&Pa.add(Ra.J(bb));return Pa}gpm(Ra){var Pa=this.qKf(this.Xxa),bb=this.qKf(this.jTa),hb=this.qKf(this.Pza),Pb=this.nee(Pa),
wb=this.nee(bb),Fb=this.nee(hb);wb=J.b(Pb,wb,Fb);Pb=new m.a;for(Fb=0;Fb<wb.length;Fb++)Pb.aw(Pb.length,wb.J(Fb).FGk());wb=this.KGk(Ra);Pa=this.GGk(wb,Pb,Pa,bb,hb);bb=0;hb=new c.a;for(Pb=0;Pb<Ra.length;Pb++)if(wb=Ra.J(Pb),2===wb.type)if(hb.contains(wb.ij))if(bb<Pa.length)Ra.hA(Pb),Ra.insert(Pb,Pa.J(bb)),bb++;else return!1;else hb.add(wb.ij);0<Ra.length&&2!==Ra.J(Ra.length-1).type&&bb<Pa.length&&Ra.insert(Ra.length,Pa.J(bb));return!0}KGk(Ra){const Pa=new c.a;for(let bb=0;bb<Ra.length;bb++)2===Ra.J(bb).type&&
Pa.add(Ra.J(bb).ij);return Pa}GGk(Ra,Pa,bb,hb,Pb){const wb=new m.a;for(let Fb=0;Fb<Pa.length;Fb++){const Ta=Pa.J(Fb);if(!Ra.contains(Ta)){let Zb;(({block:Zb}=this.lEf(hb,Ta)).returnValue||({block:Zb}=this.lEf(Pb,Ta)).returnValue||({block:Zb}=this.lEf(bb,Ta)).returnValue)&&Zb&&wb.add(Zb)}}return wb}lEf(Ra,Pa){for(let bb=0;bb<Ra.length;bb++)if(2===Ra.J(bb).type&&Ra.J(bb).ij===Pa)return Ra=Ra.J(bb),{returnValue:!0,block:Ra};return{returnValue:!1,block:null}}Vzb(){const Ra=new m.a;qa.a.Bxc(this.qg,"BaseObjects_",
this.fD,Ra);qa.a.Bxc(this.qg,"FavoredObjects_",this.uya,Ra);qa.a.Bxc(this.qg,"ConflictObjects_",this.Oza,Ra)}g8j(){let Ra,Pa;Ra=w.a.nil;Pa=-1;let bb=0;for(let hb=0;hb<this.qS.ee.length;hb++){const Pb=this.qS.ee.J(hb);if(Pb.X7())bb+=Pb.length;else if(6!==Pb.type)bb=0;else return Ra=Pb.ij,Pa=bb,{returnValue:!0,objectId:Ra,cp:Pa}}n.a.instance.ya(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ra,cp:Pa}}CHd(Ra,Pa){let bb,hb;hb=Pa;bb=Ra;try{let Pb=
this.initialize();if(Pb=(Pb=Pb&&this.Mth(!0,Ra,Pa).returnValue)&&({objectId:bb,cp:hb}=this.g8j()).returnValue)return n.a.instance.ya(17409924,1,4,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",bb,hb),{returnValue:!0,rib:bb,pwa:hb}}catch(Pb){n.a.instance.ya(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.Xce(Pb))}this.tCd(5);n.a.instance.ya(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.o1,this.vxe);this.Vzb();return{returnValue:!1,rib:bb,pwa:hb}}static wWh(Ra,Pa){let bb;bb=new m.a;if(!Ra.input.Ytc)return{returnValue:!0,uag:bb};Ra=Ra.input.s9.last().Saa(B.a.fL);bb=Pa.getPropertyObjectIds(Ra,f.a.fV);return{returnValue:!0,uag:bb}}static E5l(Ra){if(!qa.a.Yzf(Ra))return!0;const Pa=new A.a;Ra.runtime.Jl.W(B.a.fL,qa.a.vll(Ra,Pa));return!0}static m5l(Ra){if(!Ra.runtime.Jl.La(B.a.fL)||!Ra.runtime.Hp.La(B.a.fL))return!0;const Pa=new A.a,bb=Ra.runtime.Jl.J(B.a.fL);var hb=Pa.getPropertyString(bb.Oi,
f.a.wxa);if(w.a.Ad(hb).equals(w.a.nil))return!0;hb=Pa.getPropertyObjectIds(bb.Oi,f.a.fV);const Pb=Pa.getPropertyObjectIds(Ra.runtime.Hp.J(B.a.fL),f.a.fV);let wb;({uag:wb}=ab.wWh(Ra,Pa));for(let Fb=0;Fb<Pb.length;Fb++)hb.contains(Pb.J(Fb),(Ta,Zb)=>Ta.equals(Zb))||wb.contains(Pb.J(Fb),(Ta,Zb)=>Ta.equals(Zb))||(hb.add(Pb.J(Fb)),Ra.runtime.Jl.W(Pb.J(Fb),new Oa.a(Ra.runtime.Hp.J(Pb.J(Fb)).gF())));Pa.setPropertyObjectIds(bb.Oi,f.a.fV,hb);return!0}}Object(D.a)(ab,"ParagraphMergeUsingHints",null,[1314])},
1314:function(D,P,b){D=b(0);class f{constructor(v){this.mxi=v;this.succeeded=!1;this.PGc=v?v.PGc:0;this.Jyl=!1;this.length=this.iOm=0}}Object(D.a)(f,"TrieResult",null,[]);class c{constructor(v,t,A){this.Zzb=new f(null);this.UHl=v;this.Krd=t;this.Ssi=t+A-1}get result(){return this.Zzb}c2h(){let v;return this.Krd<=this.Ssi?(v=this.UHl.charAt(this.Krd),++this.Krd,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}Iqg(v,t,A){v&&(this.Zzb.Jyl=!0,this.Zzb.iOm=t);this.Zzb.length=this.Krd;this.Zzb.succeeded=
!0;this.Zzb.PGc=A;this.Krd!==this.Ssi+1&&(this.Zzb=new f(this.Zzb))}}Object(D.a)(c,"LookUpStringVisitor",null,[1502]);var n=b(1422);class m{constructor(){this.tAh=this.xyh=this.zyh=this.wyh=this.yyh=this.Zlf=this.Ylf=this.amf=this.Xlf=0}}Object(D.a)(m,"TRIESTATS",null,[]);class w{constructor(){this.symbol=this.utd=0}}Object(D.a)(w,"TrieSymbol",null,[]);b.d(P,"a",function(){return z});class z{constructor(v,t){this.i8=null;this.one=this.fti=this.dti=this.hti=this.$si=this.gti=this.eti=this.iti=this.ati=
0;this.JK=v;if(v.Ky(t,4)!==z.NSb)throw Error.argument("Input does not represent a trie");t+=4;this.Usi=1===v.Ky(t,4);t+=4;this.RHl=1===v.Ky(t,4);t+=4;this.OHl=v.Ky(t,4);t+=4;if(v.Ky(t,4)){v=t+4;this.i8=this.Vbm(v);this.ati=t=v+z.Y6j;this.iti=t+=z.J3d*(this.i8.Xlf+(this.i8.Xlf%2?1:0));this.eti=t+=z.J3d*(this.i8.amf+(this.i8.amf%2?1:0));this.gti=t+=z.J3d*(this.i8.Ylf+(this.i8.Ylf%2?1:0));this.$si=t+=z.J3d*(this.i8.Zlf+(this.i8.Zlf%2?1:0));this.hti=t+=z.cmf*this.i8.wyh;this.dti=t+=z.dmf*this.i8.zyh;
this.fti=t+=z.dmf*this.i8.xyh;t+=z.dmf*this.i8.yyh;if(t!==v+this.i8.tAh)throw Error.argument("Corrupted trie binary");this.one=t}else this.i8=null}ssi(v,t,A,B){v=new c(v,t,A);this.gej(v,B);return v.result}W5h(v){if(this.Usi)if(v)--v;else return"";if(!this.i8)throw Error.argument("Invalid trieID");const t=new n.a;t.RF=0;this.Ncc(t);const A=[];for(;;){if(t.RF&z.vlb)if(v)--v;else return Array.add(A,t.Kdc),String.fromCharCode.apply(null,A);const B=!!(t.RF&z.RHe),S=this.$rc(t,!0);if(B||v<S){if(Array.add(A,
t.Kdc),!this.Ncc(t))throw Error.argument("Invalid trieID");}else if(v-=S,!this.DGd(t))throw Error.argument("Invalid trieID");}}gej(v,t){let A=0;this.Usi&&(v.Iqg(this.RHl,this.OHl,0),++A);if(this.i8){var B=new n.a;B.RF=0;if(this.Ncc(B))for(;;){var S=void 0;if(!({ch:S}=v.c2h()).returnValue)break;t&&(S=t(S));S=S.toString().charCodeAt(0);let C=!1;for(;!C;){const H=!!(B.RF&z.vlb);if(B.Kdc===S){if(C=!0,H&&v.Iqg(!!(B.RF&z.BRg),B.fDe,A),!this.Ncc(B))return}else if(A+=this.$rc(B,!0),!this.DGd(B))return;H&&
++A}}}}Ncc(v){if(!v.RF)return this.XJg(v),!0;if(!(v.RF&z.QHe))return!1;v.sYa=0;v.Gx=v.Uwb;this.XJg(v);return!0}DGd(v){if(v.RF&z.RHe)return!1;this.XJg(v);return!0}$rc(v,t){return v.RF&z.ARg?v.I3d:v.RF&z.QHe?!t&&v.RF&z.RHe?this.pRk(v):1:0}pRk(v){v=z.Fpf(v);if(!this.Ncc(v))return 0;let t=0;do v.RF&z.vlb&&++t,t+=this.$rc(v,!1);while(this.DGd(v));return t}XJg(v){v.RF||(v.sYa=0,v.Gx=this.one);var t=this.f8d(this.ati,v.Gx),A=t.symbol;v.Gx+=t.utd;t=this.JK.Ky(this.$si+z.cmf*A,z.cmf);v.Kdc=t&65535;v.RF=t>>
16;v.RF&z.ARg&&(v.I3d=this.frk(v));v.RF&z.BRg&&(t=this.f8d(this.iti,v.Gx),A=t.symbol,v.Gx+=t.utd,v.fDe=this.JK.Ky(this.hti+4*A,4));v.RF&z.Okj?(v.Uwb=this.one+((this.JK.J(v.Gx)<<8|this.JK.J(v.Gx+1))<<8|this.JK.J(v.Gx+2)),v.Gx+=3):v.RF&z.Pkj?(v.Uwb=v.Gx,v.sYa=v.Uwb):v.RF&z.Qkj?(t=this.f8d(this.eti,v.Gx),A=t.symbol,v.Gx+=t.utd,v.Uwb=this.one+this.JK.Ky(this.dti+4*A,4)):v.RF&z.QHe&&(t=this.f8d(this.gti,v.Gx),A=t.symbol,v.Gx+=t.utd,v.sYa||(v.sYa=v.Gx),v.sYa+=this.JK.Ky(this.fti+4*A,4),v.Uwb=v.sYa)}f8d(v,
t){const A=new w;let B=0;for(;;){B+=this.JK.J(t);++t;++A.utd;const S=this.JK.Ky(v,2);if(B<S)break;A.symbol+=S;B-=S;v+=2;B<<=8}A.symbol+=B;return A}frk(v){let t=this.JK.J(v.Gx);192<=t?(t=(t&63)<<15|(this.JK.J(v.Gx+1)&127)<<8,t|=this.JK.J(v.Gx+2),v.Gx+=3):128<=t?(t=(t&127)<<8|this.JK.J(v.Gx+1),v.Gx+=2):v.Gx+=1;return t}Vbm(v){const t=new m;t.Xlf=this.JK.Ky(v+12,2);t.amf=this.JK.Ky(v+14,2);t.Ylf=this.JK.Ky(v+16,2);t.Zlf=this.JK.Ky(v+18,2);t.yyh=this.JK.Ky(v+24,4);t.wyh=this.JK.Ky(v+28,4);t.zyh=this.JK.Ky(v+
32,4);t.xyh=this.JK.Ky(v+36,4);t.tAh=this.JK.Ky(v+40,4);return t}static Fpf(v){const t=new n.a;t.Kdc=v.Kdc;t.RF=v.RF;t.I3d=v.I3d;t.Gx=v.Gx;t.Uwb=v.Uwb;t.sYa=v.sYa;t.fDe=v.fDe;return t}}z.NSb=1654263084;z.Y6j=48;z.J3d=2;z.dmf=4;z.cmf=4;z.vlb=1;z.RHe=2;z.ARg=4;z.BRg=8;z.QHe=16;z.Pkj=64;z.Qkj=128;z.Okj=256;Object(D.a)(z,"Trie",null,[1499])},1402:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(184);class c{constructor(){this.RBb=this.SBb=this.Jab=this.mxb=this.QBb=this.Psb=this.kxb=this.uhb=
this.Ssb=this.lxb=null;this.reset()}reset(){this.lxb=new f.a;this.Ssb=new f.a;this.uhb=new f.a;this.kxb=new f.a;this.Psb=new f.a;this.QBb=new f.a;this.mxb=new f.a;this.Jab=new f.a;this.Jab=new f.a;this.SBb=new f.a;this.RBb=new f.a}w1m(n){return this.kYa(this.lxb,n)&&this.kYa(this.Ssb,n)&&this.kYa(this.uhb,n)&&this.kYa(this.kxb,n)&&this.kYa(this.Psb,n)&&this.kYa(this.QBb,n)&&this.kYa(this.mxb,n)&&this.kYa(this.Jab,n)&&this.kYa(this.SBb,n)&&this.kYa(this.RBb,n)}kYa(n,m){return!n||!n.length||n.length===
m}}Object(D.a)(c,"MergeableTrackedChangesProperties",null,[])},1403:function(D,P,b){b.d(P,"a",function(){return m});D=b(0);var f=b(690),c=b(203),n=b(42);class m{constructor(w,z,v){this.yGj=w;this.ZCj=z;this.vCj=v;this.lWe=new c.a(Object(n.a)(this,this.Aak,"checkIfDifferent"))}get VBb(){return this.yGj}get oldValue(){return this.ZCj}get newValue(){return this.vCj}get gNa(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===
this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get iU(){return this.gNa||this.isDeleted||this.lWe.value}Aak(){return this.gNa||this.isDeleted?!0:!f.a.auh(this.VBb,this.oldValue,this.newValue)}}Object(D.a)(m,"PropertyDiff",null,[])},1404:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1242);class f extends b.a{constructor(){super();this.pyc=this.psd=this.Mn=null;this.fxd=0}get pta(){return"Property"}sYb(){this.detail.W("Type",this.pta);this.detail.W("ComplexMerger",
null!=this.Mn?this.Mn:-1);this.detail.W("Strategy",null!=this.psd?this.psd:-1);this.detail.W("ClassId",null!=this.pyc?this.pyc:-1);this.detail.W("PropId",this.fxd);return this.detail}}Object(D.a)(f,"PropertyMergeFailureDetail",b.a,[])},1405:function(D,P,b){b.d(P,"a",function(){return n});D=b(0);var f=b(184),c=b(531);class n{constructor(){this.sSa=new f.a;this.iTa=new f.a;this.nVa=new f.a}get URb(){return this.sSa}get DDf(){return this.iTa}get tFb(){return this.nVa}get isEmpty(){return!this.sSa.length&&
!this.iTa.length&&!this.nVa.length}get K$f(){return Math.max(Math.max(this.sSa.length,this.iTa.length),this.nVa.length)}get jMl(){return Math.min(Math.min(this.sSa.length,this.iTa.length),this.nVa.length)}b2d(m){this.sSa.add(m)}d2d(m){this.iTa.add(m)}i2d(m){this.nVa.add(m)}FGk(){const m=new c.a,w=new f.a;let z=0;for(;z<this.sSa.length||z<this.iTa.length||z<this.nVa.length;)z<this.sSa.length&&!m.contains(this.sSa.J(z))&&(w.add(this.sSa.J(z)),m.add(this.sSa.J(z))),z<this.iTa.length&&!m.contains(this.iTa.J(z))&&
(w.add(this.iTa.J(z)),m.add(this.iTa.J(z))),z<this.nVa.length&&!m.contains(this.nVa.J(z))&&(w.add(this.nVa.J(z)),m.add(this.nVa.J(z))),z++;return w}}Object(D.a)(n,"ObjectCollection",null,[])},1406:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c,n){this.IRa=n;this.updateHints=c}}Object(D.a)(f,"UpdateHintCollection",null,[])},1407:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1209);class f extends b.a{constructor(c,n){super();this.We=c;this.yb=n}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.We,this.yb)}}Object(D.a)(f,"LcsInsertParaUpdateHint",b.a,[])},1408:function(D,P,b){b.d(P,"a",function(){return c});D=b(0);var f=b(184);b=b(1209);class c extends b.a{constructor(n){super();this.W2=new f.a;this.cp=n}get type(){return 11}toString(){let n="";for(let m=0;m<this.W2.length;m++)n+=String.format("({0}), ",this.W2.J(m).toString());return String.format("[Cp:{0}] {1}",this.cp,n)}}Object(D.a)(c,"LcsInsertUpdateHint",b.a,[])},1409:function(D,P,b){b.d(P,"a",function(){return f});
D=b(0);b=b(1209);class f extends b.a{constructor(c,n){super();this.text=n;this.We=c}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.We,this.text)}}Object(D.a)(f,"LcsInsertTextUpdateHint",b.a,[])},1410:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1209);class f extends b.a{constructor(c,n,m){super();this.cp=c;this.We=n;this.yb=m}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.We,this.yb)}}Object(D.a)(f,"LcsDeleteParaUpdateHint",b.a,[])},1411:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1209);class f extends b.a{constructor(c,n){super();this.cp=c;this.text=n}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(D.a)(f,"LcsDeleteTextUpdateHint",b.a,[])},1412:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);b=b(1176);class f extends b.a{constructor(){super()}get pta(){return"Conflict"}}
Object(D.a)(f,"ConflictMergeFailureDetail",b.a,[])},1414:function(D,P,b){b.r(P);b.d(P,"InsightsMenuItemFactory",function(){return m});D=b(0);var f=b(1126),c=b(304),n=b(16);class m{constructor(w=null){this.Bxj=w||CommonUIStrings.l_InsightsButtonText}get J0a(){return 10}N6(w){var z=w.FF;w=f.a.lZa()?f.a.Dsb(z,1):f.a.Yoc(z);z=String.format(this.Bxj,z);return this.aLk(w,z)}aLk(w,z){return c.a(m.Dei,f.a.lZa()?"1914896509":"3317204163",n.a.we(z),f.a.dXf,null,n.a.we(w),n.a.we(z),null,null)}}m.Dei="bInsights";
Object(D.a)(m,"InsightsMenuItemFactory",null,[1080])},1415:function(D,P,b){b.d(P,"a",function(){return n});D=b(0);var f=b(304),c=b(16);class n{constructor(m,w,z,v,t){this.T7e=m;this.S7e=w;this.OLj=z;this.uwj=v;this.W2g=t}get J0a(){return 4}N6(m,w=null){w=w.sessionId+"|"+w.Ema+"|"+m.FF;if(this.W2g||this.uwj){let z=this.W2g||c.a.Vw(CommonUIStrings.l_HelpTooltip)===c.a.Vw(m.FF.trim());if(this.OLj&&2<m.FF.length){const v=m.FF;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===
n.BTf&&(z=!0)}m=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.FF);return this.RVh(w,c.a.we(m),z)}return this.RVh(w,c.a.we(String.format(CommonUIStrings.l_TextWithQuotation,m.FF)),!1)}RVh(m,w,z){return f.a(n.BTf,z?this.S7e:this.T7e,w,"OfficeAssistant_16x16x32","A0",c.a.we(m),w,null,null)}}n.BTf="bSearchHelp";Object(D.a)(n,"AssistanceMenuItemFactory",null,[1080])},1416:function(D,P,b){b.d(P,"a",function(){return w});D=b(0);var f=b(2),c=b(304),n=
b(92),m=b(16);class w{get J0a(){return 13}N6(){return w.x4j()}static x4j(){return c.b(w.FTh,"798637440",m.a.we(CommonUIStrings.l_LookupFirstRunExperienceTitle),f.AFrameworkApplication.Sp,n.getImageClass("Info_32x32x32"),null,null,m.a.we(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,m.a.we(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.FTh="bTellMeFirstRun";Object(D.a)(w,"FirstRunMenuItemFactory",null,[1080])},1417:function(D,P,b){b.d(P,"a",function(){return m});
D=b(0);var f=b(2),c=b(304),n=b(16);class m{constructor(w=null,z=null){this.A$g=w;this.BCj=z||CommonUIStrings.l_LookupNoResultsDescription}get J0a(){return 14}N6(w){w=String.format(this.BCj,w.FF);return this.q5j(w)}q5j(w){return c.b(m.sxi,"798637440",n.a.we(CommonUIStrings.l_LookupNoResultsTitle),this.A$g?f.AFrameworkApplication.Sp:null,this.A$g,null,null,n.a.we(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,n.a.we(w),null,null)}}m.sxi="lookupNoResults";Object(D.a)(m,"NoCommandsFoundMenuItemFactory",
null,[1080])},1418:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(c,n){this.FontWeight=0;this.Text=null;this.FontWeight=c;this.Text=n}}Object(D.a)(f,"LabelFormatted",null,[])},1419:function(D,P,b){b.d(P,"a",function(){return Y});D=b(0);var f=b(74),c=b(1133),n=b(1294),m=b(1194),w=b(1170),z=b(1211),v=b(1420),t=b(1178),A=b(1195),B=b(1145),S=b(1160),C=b(1150),H=b(1439),J=b(1210),M=b(1129),G=b(1126),R=b(2),O=b(1207),I=b(30),K=b(129);class Y{constructor(W,Z,U){this.l0c=this.bYd=
this.cYd=this.aYd=!1;this.rS=null;this.a5=-1;this.VPb=this.Y0c=null;this.u1c="";this.MLb=0;this.sc=W;const X=G.a.lZa();this.Wmb=Z||[];this.Re=R.AFrameworkApplication.je;this.Ghh=W.vhg;this.dYd=W.uhg;this.$8e=X&&this.Vac();this.b9e=X&&this.Xac();this.KJj=X&&this.Yac();this.c9e=this.Zac();this.Ihh=this.JDd();W.MGg&&G.a.gCg(W)&&(this.Y0c=new H.a(W),this.aYd=W.IFd,this.cYd=W.KFd,this.bYd=W.nfb,this.l0c=this.aYd&&this.IK("File")||this.cYd&&this.IK("People")||this.bYd&&this.IK("Notes"));this.$Xd=this.EEm();
this.gYd=W.Wud;this.O9=this.c8k();this.uTg=new v.a(W);this.UZc=U;this.W7e=new n.a;this.gYd&&(this.uTg=new v.a(W))}IK(W){return Array.contains(this.Wmb,W)?!0:!1}Yaa(){return"TellMeService"}Wta(){return this.sc.eM?1===this.sc.eM?1:this.IK("Command")||this.IK("Recommended")?2:3:0}$7k(W){let Z="";if(!W&&this.IK("Command")&&this.sc.E0f){Z+="MultiLingualCommandWAC,";var U=this.sc.c6i;0<U.length&&(Z+=U+",")}W&&this.IK("Recommended")&&this.dYd&&(U=this.sc.d6i,0<U.length&&(Z+=U+","));!W&&this.IK("Help")&&
(W=this.sc.b6i,0<W.length&&(Z+=W+","));0<Z.length&&(Z=Z.substr(0,Z.length-1));return Z}Z7(W,Z,U,X=c.a.tellMe,fa=null){const ma=new C.a(W);U=G.a.eCa(W);if(this.l0c&&(!this.MLb||window.performance.now()-this.MLb>=G.a.ODe)){var ka=this.W7e.d8k();if(ka)this.MLb=window.performance.now(),ka.then(pa=>{this.u1c=pa},pa=>{M.TellMeActor.instance.tf.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+pa)});else if(M.TellMeActor.instance.tf)M.TellMeActor.instance.tf.onError("TellMeServiceProvider:IssueQuery",
"undefined token promise")}var oa=this.l0c&&!!this.u1c;ka=oa||U&&this.IK("Recommended")&&this.dYd;oa=oa||!U&&(this.Ghh&&this.IK("Command")||this.$8e&&this.IK("Answer")||this.b9e&&this.IK("Definition")||this.Ihh&&this.IK("Image")||this.gYd&&this.IK("Help")||this.c9e&&this.IK("WolframAnswer"));if(ka||oa)if(this.VPb=X,X={"Content-Type":"application/json",Accept:"application/json"},X["X-Office-Version"]=R.AFrameworkApplication.buildVersion,X["X-Office-Application"]=R.AFrameworkApplication.K.Oa("Application"),
X["X-Office-Platform"]="WAC",X["X-TellMe-SqmUserId"]=R.AFrameworkApplication.K.Oa("LoggableUserId")||"",X["X-TellMe-SessionId"]=M.TellMeActor.instance.vfe(),this.u1c&&(X.Authorization="Bearer "+this.u1c),ka=this.$7k(U),0<ka.length&&(X["X-TellMe-Flights"]=ka),ka=[],!U&&this.IK("Answer")&&this.$8e&&(fa?Array.contains(fa,8):1)&&Array.add(ka,"Answer"),!U&&this.IK("Command")&&this.Ghh&&!t.isCommandHookQuery(W.Bh)&&(fa?Array.contains(fa,16):1)&&Array.add(ka,"Command"),!U&&this.IK("Definition")&&this.b9e&&
(fa?Array.contains(fa,9):1)&&Array.add(ka,"Definition"),!U&&this.IK("Help")&&this.gYd&&(fa?Array.contains(fa,7):1)&&Array.add(ka,"Help"),!U&&this.IK("WolframAnswer")&&this.c9e&&(fa?Array.contains(fa,11):1)&&Array.add(ka,"WolframAnswer"),U&&this.IK("Recommended")&&this.dYd&&!M.TellMeActor.instance.HId&&(fa?Array.contains(fa,17):1)&&Array.add(ka,"Recommended"),!U&&this.IK("Image")&&this.Ihh&&(fa?Array.contains(fa,18):1)&&Array.add(ka,"Image"),this.u1c&&this.l0c&&(fa?Array.contains(fa,13)||Array.contains(fa,
14)||Array.contains(fa,19):1)&&(this.Y0c.hxe(),this.aYd&&this.IK("File")&&Array.add(ka,"File"),this.cYd&&this.IK("People")&&Array.add(ka,"People"),this.bYd&&this.IK("Notes")&&Array.add(ka,"Notes")),ka.length){X["X-TellMe-SuggestionTypes"]=ka.join(",");X["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;X["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;var za=this.rS=K.a.create().toString();X["Client-Request-Id"]=za;var Ja=window.performance.now();this.hKa();this.a5=window.setTimeout(()=>
{if(za===this.rS){this.rS="";this.a5=-1;Z.resultsUpdated(ma);const pa={};pa[m.a.provider]=this.Yaa();pa[m.a.KAc]=W.t8b;M.TellMeActor.instance.tf.$G(w.a.timedOut,this.UZc,pa)}},this.UZc);this.Re.Ki(this.O9,2,this.b8k(W.Bh),X,!1,0,pa=>{this.d7b(pa,W,Z,za,Ja,fa)},pa=>{this.M6b(pa,W,Z,za,Ja)},null,null,!1,4E3,6E3)}else M.TellMeActor.instance.tf.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),Z.resultsUpdated(ma);else Z.resultsUpdated(ma)}hKa(){-1!==this.a5&&(window.clearTimeout(this.a5),
this.a5=-1)}d7b(W,Z,U,X,fa,ma){const ka=new C.a(Z);if(X===this.rS){this.hKa();M.TellMeActor.instance.tf.Mba(Z.Bh.length,this.Wmb.join(","),W.data.mf.toString(),Math.round(window.performance.now()-fa),J.a.tellMe,!0,z.a.rYa);X=W.data.wd;W=null;try{W=I.b(X)}catch(Aa){M.TellMeActor.instance.tf.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Aa);return}X=G.a.eCa(Z);if("Groups"in W&&W.Groups){var oa=W.Groups;for(var za of oa)if("GroupType"in za&&"Suggestions"in za&&za.Suggestions)if("Commands"===
za.GroupType&&(ma?Array.contains(ma,16):1)||"Recommended"===za.GroupType&&(ma?Array.contains(ma,17):1)){var Ja=(oa="Recommended"===za.GroupType)?"DLIS":"NaiveBayes";"Source"in za&&za.Source&&(Ja=za.Source);var pa=za.Suggestions;new f.a;var Na=[];for(var Da of pa)this.Azl(Da)&&(pa=Da.Type,("Command"===pa||oa&&"Recommended"===pa)&&Na.push(new A.a(Da.CommandId,Da.Score)));t.logCommandSuggestions(Na,!Z.Bh.trim().length,za.GroupType,Ja);Ja=M.TellMeActor.instance.Tda;pa=[];for(const Aa of Na)oa&&Ja&&Ja.Jrf(Aa.commandId)||
pa.push(Aa);Na=t.getResultGroup(Z,pa,this.sc,null,null,null,oa?17:16);0<Na.results.length&&(this.VPb!==c.a.contextMenu&&(Na.displayName=oa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ka.cF(Na))}else if("Answer"===za.GroupType){pa=za.Suggestions;oa=null;Na=2147483647;Ja="";for(const Aa of pa)if(this.zzl(Aa))if(Ja=Aa.Type,pa=this.oZb(Ja),"Answer"===Ja&&this.$8e){oa=this.OIh(Ja,Aa,Z.Bh);break}else pa&&pa<Na&&(Na=pa,oa=this.OIh(Ja,Aa,Z.Bh));Na=G.a.Jom(Z.Bh,Ja);
oa&&(ma?Array.contains(ma,oa.type):1)&&(Ja=[],this.$Xd?(Ja.push(appChrome.actions.setControlLabel(oa.value,oa.FF)),Ja.push(appChrome.actions.updateCompoundButtonDescription(oa.value,oa.description)),Ja.push(appChrome.actions.setCompoundButtonCommandValueId(oa.value,Na))):(Ja.push(appChrome.actions.setControlLabel(oa.value,oa.FF+" - "+oa.description)),Ja.push(appChrome.actions.setButtonCommandValueId(oa.value,Na))),appChrome.api.dispatch(Ja),Na=this.aJh(oa.type),Na.dI(oa),ka.cF(Na))}else"Help"===za.GroupType&&
za.Suggestions.length&&(ma?Array.contains(ma,7):1)?this.gYd&&(oa=this.uTg.sdl(Z,za.Suggestions))&&0<oa.results.length&&ka.cF(oa):"Substrate"===za.GroupType&&this.l0c&&"Type"in za&&("File"===za.Type&&this.aYd&&(ma?Array.contains(ma,14):1)?(oa=this.Y0c.f_h(za.Suggestions,X,this.VPb))&&0<oa.results.length&&ka.cF(oa):"People"===za.Type&&this.cYd&&(ma?Array.contains(ma,13):1)?(oa=this.Y0c.G3h(za.Suggestions,this.VPb))&&0<oa.results.length&&ka.cF(oa):"Notes"===za.Type&&this.bYd&&(ma?Array.contains(ma,13):
1)&&(oa=this.Y0c.v2h(za.Suggestions,X,Z))&&0<oa.results.length&&ka.cF(oa));else M.TellMeActor.instance.tf.onError("OnSuccessCallBack","GroupType"in za?"Invalid group suggestions found for "+za.GroupType:"Invalid group found")}if(W.Intents){za=W.Intents;for(const Aa of za)this.Mzl(Aa)&&"Image"===Aa.GroupType&&Aa.ConfidenceScore>Aa.ConfidenceThreshold&&(ma?Array.contains(ma,18):1)&&(za=[],M.TellMeActor.instance.u_()&&M.TellMeActor.instance.u_().mfb?(Da=this.sc.L2f?G.a.VKf(Z.Bh,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):
Z.Bh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.sc.JAe||za.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):Da=Z.Bh+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader,za.push(appChrome.actions.setControlLabel("ImageForSearch",Da)),Da=G.a.Dsb(Z.Bh,9,Object.assign(new O.a,{landingTab:"Image"})),za.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",Da)),appChrome.api.dispatch(za),za=new B.a("ImageForSearch",12),
za.score=Aa.ConfidenceScore,Da=this.aJh(za.type),Da.dI(za),ka.cF(Da))}U.resultsUpdated(ka);M.TellMeActor.instance.tf.Mba(Z.Bh.length,this.Wmb.join(","),"",Math.round(window.performance.now()-fa),"",!0,z.a.provider)}}M6b(W,Z,U,X,fa){const ma=new C.a(Z);X===this.rS&&(this.hKa(),M.TellMeActor.instance.tf.Mba(Z.Bh.length,this.Wmb.join(","),W.data.mf.toString(),Math.round(window.performance.now()-fa),J.a.tellMe,!1,z.a.rYa));U.resultsUpdated(ma)}oZb(W){switch(W){case "Entity":return this.KJj?3:0;case "Definition":return this.b9e?
5:0;case "WolframAnswer":return this.c9e?2:0;default:return 0}}OIh(W,Z,U){switch(W){case "Answer":return new B.a(this.$Xd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===Z.Title?U:Z.Title,Z.Description);case "Entity":return new B.a(this.$Xd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===Z.Title?U:Z.Title,Z.Description);case "Definition":return new B.a(this.$Xd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===Z.Title?U:Z.Title,Z.Description);case "WolframAnswer":return new B.a("WolframForSearch",
3,""===Z.Title?U:Z.Title,Z.Description);default:return null}}aJh(W){switch(W){case 0:return new S.a(8,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new S.a(10,CommonUIStrings.l_TellMeEntityTitle);case 1:return new S.a(9,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new S.a(11,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new S.a(18,CommonUIStrings.l_TellMeImageTitle);default:return null}}zzl(W){return"Type"in W&&!!W.Type&&""!==W.Type&&"Description"in W&&!!W.Description&&""!==
W.Description}Azl(W){return"Type"in W&&!!W.Type&&""!==W.Type&&"CommandId"in W&&!!W.CommandId&&""!==W.CommandId&&"Score"in W&&!!W.Score}Mzl(W){if("GroupType"in W&&W.GroupType&&"ConfidenceScore"in W&&W.ConfidenceScore&&"ConfidenceThreshold"in W&&W.ConfidenceThreshold)return!0;M.TellMeActor.instance.tf.onError("IsValidIntentGroup","Invalid intents found");return!1}b8k(W){const Z=G.a.Jli(W),U={};U.Query=W;Z&&this.dYd&&(U.CommandClickedEvents=M.TellMeActor.instance.CMe,U.CommandActionEvents=M.TellMeActor.instance.ZVg,
U.TellMeCommandClickMruEvents=M.TellMeActor.instance.b$g,U.ContentType=M.TellMeActor.instance.U7d);return I.c(U)}Vac(){return!!this.sc&&this.sc.Vac||!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.oa.mb.Vac}Xac(){return!!this.sc&&this.sc.Xac||!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.oa.mb.Xac}Yac(){return!!this.sc&&this.sc.Yac||!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.oa.mb.Yac}Zac(){return!!this.sc&&this.sc.Zac||!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.oa.mb.Zac}JDd(){return!!this.sc&&
this.sc.JDd}EEm(){return!!this.sc&&!this.sc.mfb}hmi(){return!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}imi(){return!!R.AFrameworkApplication.oa&&R.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}c8k(){if(R.AFrameworkApplication.K){if(this.imi())return R.AFrameworkApplication.K.Oa("TellMeServiceProdEndpointForSearch");if(this.hmi())return R.AFrameworkApplication.K.Oa("TellMeServiceEdogEndpointForSearch");
if(G.a.mZf())return R.AFrameworkApplication.K.Oa("TellMeServiceIntEndpointForSearch")}return R.AFrameworkApplication.a6i}static kJh(W,Z){if(Z)return new Y(W,["Command","Recommended"],W.bUk);Z=G.a.lZa()?"Answer Definition Help WolframAnswer Image File People Notes".split(" "):["Help","WolframAnswer","File","People","Notes"];return new Y(W,Z,W.I5h)}}Object(D.a)(Y,"TellMeServiceProvider",null,[1249])},1420:function(D,P,b){b.d(P,"a",function(){return z});D=b(0);b(1133);var f=b(1145),c=b(1160),n=b(1150),
m=b(1126),w=b(16);class z{constructor(v){this.sc=v}Yaa(){return"Assistance"}Wta(){return this.sc.eM?1===this.sc.eM?1:this.sc.Wud?3:2:0}Z7(v,t,A=!1,B,S=null){B=new n.a(v);if((!S||Array.contains(S,7))&&!m.a.eCa(v)){S=new c.a(7);if(A){A=w.a.Vw(CommonUIStrings.l_HelpTooltip)===w.a.Vw(v.Bh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.Bh);const C=[];this.sc.mfb&&(this.sc.JAe||C.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),
A=this.q2h(v.Bh));const H="||"+v.Bh;C.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",A));C.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(C);v=new f.a("GetHelpFromTellMe",4,v.Bh)}else v=new f.a("bSearchHelp",4,v.Bh);S.dI(v);S.displayName=CommonUIStrings.l_HelpButtonTitle;B.cF(S)}t.resultsUpdated(B)}sdl(v,t=null){const A=new c.a(7),B=w.a.Vw(CommonUIStrings.l_HelpTooltip)===w.a.Vw(v.Bh.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
v.Bh);for(let C=0;C<t.length&&2>C;C++){var S=void 0;S=[];let H="GetHelpWithDescriptionFromTellMe"+(C+1).toString(),J=4;if(this.sc.zDd)S.push(appChrome.actions.setControlLabel(H,B)),S.push(appChrome.actions.setCompoundButtonCommandValueId(H,v.Bh)),S.push(appChrome.actions.updateCompoundButtonDescription(H,this.nQf(t.length)));else if(this.sc.ADd){let M=this.B7h(t[C]);H="GetHelpFromTellMe"+(C+1).toString();this.sc.mfb&&(M=this.q2h(M));J=9;S.push(appChrome.actions.setControlLabel(H,M));S.push(appChrome.actions.setButtonCommandValueId(H,
this.V8k(t[C])))}appChrome.api.dispatch(S);S=new f.a(H,J);S.label=this.B7h(t[C]);S.description=this.U8k(t[C]);A.dI(S);if(this.sc.ADd)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}nQf(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}q2h(v){return this.sc.L2f?m.a.VKf(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}B7h(v){return v.name?v.name:""}U8k(v){return v.description?v.description:
""}V8k(v){return v.id?"AssetID="+v.id:""}}Object(D.a)(z,"AssistanceResultsProvider",null,[1249])},1421:function(D,P,b){b.d(P,"a",function(){return B});D=b(0);b(1133);var f=b(1178),c=b(1145),n=b(1160),m=b(1150),w=b(1304),z=b(1129),v=b(1126),t=b(2),A=b(16);class B{constructor(S,C,H,J){this.Tda=S;this.pqb=C;this.Nkh=J;this.uuj=H;this.sc=z.TellMeActor.instance.u_();this.xJj=!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDisabledMRUCommands",
!1)}Yaa(){return"EmptyQuery"}Wta(){return 1===this.sc.eM?1:0}Z7(S,C,H=!1,J,M=null){J=new m.a(S);if((!M||Array.contains(M,4)||Array.contains(M,5)||Array.contains(M,3))&&v.a.eCa(S)){this.Tda.Nfd().length||!this.uuj||this.Nkh||(S=new n.a(5),M=new c.a(null,13),S.dI(M),J.cF(S));S=new n.a(3);if(0<this.Tda.Nfd().length){S.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.Tda.Nfd();var G=[];for(var R of M)G.push(R.Id);f.updateCommandsState(G,this.sc);for(var O of M)if(!this.xJj||f.isCommandEnabled(O.Id))"Find"===
O.Id&&this.sc&&this.sc.Cjb||S.dI(new c.a(O.Id,5));J.cF(S)}if(this.Nkh&&0<this.pqb.length&&this.Tda.Nfd().length<B.jui){R=new n.a(4);R.displayName=CommonUIStrings.l_TellMeTryQueryTitle;O=B.jui-S.results.length;S=[];for(M=0;M<this.pqb.length&&M<O;++M){if(H){G=v.a.UKg+(M+1);const I=this.pqb[M].key,K=A.a.replaceAll(I,'"',"");S.push(appChrome.actions.setControlLabel(G,I));S.push(appChrome.actions.setButtonCommandValueId(G,K));G=new w.a(I,7,K,G)}else G=new w.a(this.pqb[M].key,7,this.pqb[M].value);R.dI(G)}0<
S.length&&appChrome.api.dispatch(S);J.cF(R)}}C.resultsUpdated(J)}}B.jui=5;Object(D.a)(B,"EmptyQueryResultsProvider",null,[1249])},1422:function(D,P,b){b.d(P,"a",function(){return f});D=b(0);class f{constructor(){this.fDe=this.sYa=this.Uwb=this.Gx=this.I3d=this.RF=this.Kdc=0}}Object(D.a)(f,"TRIESCAN",null,[])},1431:function(D,P,b){b.r(P);var f=b(0),c=b(1133),n=b(1194),m=b(1170);class w{constructor(ib,Ab){this.UEa=ib;this.Ri=Ab}resultsUpdated(ib){this.UEa.Jzm(this.Ri,ib)}}Object(f.a)(w,"AggregatorResultsProviderCallback",
null,[1335]);var z=b(1160),v=b(1150);class t{constructor(ib){this.Oxa=null;this.sc=ib;this.sc.J9a&&(this.Oxa=this.sc.Qbe())}Yaa(){return"AppsForOffice"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb,lc,Hc=null){Tb=new v.a(ib);if(!Hc||Array.contains(Hc,1))Hc=new z.a(1),this.Oxa.lTj(Hc,ib.Bh),Tb.cF(Hc);Ab.resultsUpdated(Tb)}}Object(f.a)(t,"AppsForOfficeRecommendationResultsProvider",null,[1249]);var A=b(1420),B=b(1118),S=b(1141),C=b(212);class H{constructor(ib,Ab){this.Ra=ib;this.QHl=Ab}isMatch(ib,
Ab){if(!Object(C.a)(1458,ib))throw Error.argument("objToTest","Expected feature bundle");let Tb;return({value:Tb}=ib.Xp(this.Ra.fAa)).returnValue?this.Ra.gPg.isMatch(Tb,Ab):this.QHl}}Object(f.a)(H,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1491]);class J{constructor(ib,Ab){this.Ra=ib;this.H9f=Ab}isMatch(ib){if(!Object(C.a)(1458,ib))throw Error.argument("objToTest","Expected feature bundle");return!!(this.H9f^ib.Xp(this.Ra.fAa).returnValue)}}Object(f.a)(J,"AnnotatedWithAnnotationFilter",
null,[1491]);class M{constructor(ib){this.Ra=ib}isMatch(ib,Ab){if(!Object(C.a)(1462,ib))throw Error.argument("objToTest","Expected struct value");return this.Ra.gPg.isMatch(ib.Eub(this.Ra.oXa),Ab)}}Object(f.a)(M,"FieldValueMatchesStructFilter",null,[1491]);class G{constructor(ib,Ab){ib&&(this.oXa=ib.J(0),this.gPg=Ab.Hta(ib.J(1)))}}Object(f.a)(G,"FieldValueMatchesStructFilterInit",null,[]);class R{constructor(ib){this.H9f=ib}isMatch(ib){if(!Object(C.a)(1458,ib))throw Error.argument("objToTest","Expected feature bundle");
return!!(this.H9f^ib.GSf)}}Object(f.a)(R,"HasAnnotationsAnnotationFilter",null,[1491]);class O{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab){if(!Object(C.a)(1461,ib))throw Error.argument("objToTest","Expected list value");switch(this.Cba){case 0:for(const Tb of ib.items)if(this.Ra.filter.isMatch(Tb,Ab))return!0;return!1;case 1:for(const Tb of ib.items)if(!this.Ra.filter.isMatch(Tb,Ab))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(O,"ItemTestListFilter",null,[1491]);
class I{constructor(ib){this.Ra=ib}isMatch(ib,Ab){if(!Object(C.a)(1461,ib))throw Error.argument("objToTest","Expected list value");return this.Ra.filter.isMatch(ib.items.length,Ab)}}Object(f.a)(I,"LengthMatchesListFilter",null,[1491]);class K{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab,Tb=null){let lc=!this.Cba;for(const Hc of this.Ra.zBh)if((lc=Hc.isMatch(ib,Ab,Tb))?1===this.Cba:!this.Cba)return lc;2===this.Cba&&(lc=!lc);return lc}}Object(f.a)(K,"NonterminalFilter",null,[1491]);class Y{constructor(ib,
Ab){if(ib){var Tb=ib.J(0);this.zBh=Array(Tb);for(let lc=0;lc<Tb;++lc)this.zBh[lc]=Ab.Hta(ib.J(1+lc))}}}Object(f.a)(Y,"NonterminalFilterInit",null,[]);class W{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab){if("number"!==typeof ib)throw Error.argument("objToTest","Expected number value");let Tb=this.Ra.number;if(this.Ra.query){Ab=this.Ra.query.Qs(null,Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return number");Tb+=Ab}switch(this.Cba){case 0:return ib===Tb;case 1:return ib<
Tb;case 2:return ib<=Tb;case 3:return ib>Tb;case 4:return ib>=Tb;default:throw Error.notImplemented();}}}Object(f.a)(W,"NumberFilter",null,[1491]);class Z{constructor(ib,Ab){ib&&(this.number=ib.J(0),this.query=ib.J(1)?Ab.aM(ib.J(1)):null)}}Object(f.a)(Z,"NumberFilterInit",null,[]);class U{constructor(ib,Ab,Tb){this.ade=this.cUk;this.WHl=ib;this.Ysi=Ab;this.Xsi=Tb}Unf(ib){this.Ysi=ib}cUk(ib){if(!ib)throw Error.argument("name","Invalid named feature bundle reference");const Ab=ib.substr(1);return 1===
ib.charCodeAt(0)&&Ab===this.WHl?this.Ysi:this.Xsi?this.Xsi.ade(ib):null}}Object(f.a)(U,"SimpleNamedFeatureBundleResolver",null,[1506]);class X{constructor(ib){this.Ra=ib}isMatch(ib,Ab){if(!Object(C.a)(1458,ib))throw Error.argument("objToTest","Expected feature bundle");ib=this.Ra.query.Qs(null,new U(this.Ra.dGe,ib,Ab));if("boolean"!==typeof ib)throw Error.invalidOperation("Query did not return bool");return ib}}Object(f.a)(X,"PredicateAnnotationFilter",null,[1491]);class fa{constructor(ib,Ab){ib&&
(this.dGe=Ab.getString(ib.J(0)),this.query=Ab.aM(ib.J(1)))}}Object(f.a)(fa,"PredicateAnnotationFilterInit",null,[]);class ma{constructor(ib){this.Ra=ib}isMatch(ib,Ab){if("boolean"!==typeof ib)throw Error.argument("objToTest","Expected bool value");Ab=this.Ra.query.Qs(null,Ab);if("boolean"!==typeof Ab)throw Error.invalidOperation("Query did not return bool");return ib===Ab}}Object(f.a)(ma,"QueryBooleanFilter",null,[1491]);class ka{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab){if("number"!==
typeof ib)throw Error.argument("objToTest","Expected integer");Ab=this.Ra.query.Qs(null,Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return an enum value");switch(this.Cba){case 0:return ib===Ab;case 1:return 0!==(ib&Ab);case 2:return ib===(ib&Ab);case 3:return Ab===(ib&Ab);default:throw Error.notImplemented();}}}Object(f.a)(ka,"QueryEnumFilter",null,[1491]);class oa{constructor(ib,Ab){ib&&(this.kke=1===ib.J(0),this.query=Ab.aM(ib.J(1)))}}Object(f.a)(oa,"QueryEnumFilterInit",
null,[]);class za{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab){if(!Object(C.a)(1461,ib))throw Error.argument("objToTest","Expected list value");Ab=this.Ra.query.Qs(null,Ab);if(!Object(C.a)(1461,Ab))throw Error.invalidOperation("Query did not return list value");if(ib.l8!==Ab.l8)return!1;switch(this.Cba){case 0:return B.Annotations.PFb(B.Annotations.KYk(ib.l8),ib,Ab);case 1:for(const Tb of ib.items)for(const lc of Ab.items)if(B.Annotations.PFb(ib.l8,Tb,lc))return!0;return!1;case 2:for(const Tb of ib.items)for(const lc of Ab.items)if(!B.Annotations.PFb(ib.l8,
Tb,lc))return!1;return!0;case 3:for(const Tb of Ab.items)for(const lc of ib.items)if(!B.Annotations.PFb(ib.l8,Tb,lc))return!1;return!0;default:throw Error.notImplemented();}}}Object(f.a)(za,"QueryListFilter",null,[1491]);class Ja{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib,Ab){if("string"!==typeof ib)throw Error.argument("objToTest","Expected string");Ab=this.Ra.query.Qs(null,Ab);if("string"!==typeof Ab)throw Error.invalidOperation("Query did not return string");this.Ra.oYf&&(ib=ib.toUpperCase(),
Ab=Ab.toUpperCase());switch(this.Cba){case 0:return ib===Ab;case 1:return 0<=ib.indexOf(Ab);case 2:return ib.startsWith(Ab);case 3:return ib.endsWith(Ab);case 4:return 0<=Ab.indexOf(ib);case 5:return Ab.startsWith(ib);case 6:return Ab.endsWith(ib);default:throw Error.notImplemented();}}}Object(f.a)(Ja,"QueryStringFilter",null,[1491]);class pa{constructor(ib,Ab){ib&&(this.query=Ab.aM(ib.J(0)),this.oYf=1===ib.J(1))}}Object(f.a)(pa,"QueryStringFilterInit",null,[]);class Na{constructor(ib){this.Ra=ib}isMatch(ib,
Ab){if(!Object(C.a)(1462,ib))throw Error.argument("objToTest","Expected struct value");Ab=this.Ra.query.Qs(null,Ab);if(!Object(C.a)(1462,Ab))throw Error.invalidOperation("Query did not return struct value");return ib.isEqual(ib)}}Object(f.a)(Na,"QueryStructFilter",null,[1491]);class Da{constructor(ib){this.Ra=ib}isMatch(ib,Ab){ib=this.Ra.query.Qs(null,Ab);if("boolean"!==typeof ib)throw Error.invalidOperation("Query did not return bool");return ib}}Object(f.a)(Da,"QueryWhereConstraintFilter",null,
[1491]);class Aa{constructor(ib){this.Ra=ib}isMatch(ib){if("string"!==typeof ib)throw Error.argument("objToTest","Expected string");return this.Ra.Kpg.test(ib)}}Object(f.a)(Aa,"RegexStringFilter",null,[1491]);class Ma{constructor(ib,Ab){ib&&(this.Kpg=Ab.Vsc(ib.J(0)))}}Object(f.a)(Ma,"RegexStringFilterInit",null,[]);class ba{constructor(ib,Ab){ib&&(this.filter=Ab.Hta(ib.J(0)))}}Object(f.a)(ba,"SingleFilterFilterInit",null,[]);class L{constructor(ib,Ab){ib&&(this.query=Ab.aM(ib.J(0)))}}Object(f.a)(L,
"SingleQueryFilterInit",null,[]);class V{constructor(ib){this.Ra=ib}isMatch(ib){if("boolean"!==typeof ib)throw Error.argument("objToTest","Expected bool value");return ib===this.Ra.value}}Object(f.a)(V,"StoredValueBooleanFilter",null,[1491]);class ha{constructor(ib){ib&&(this.value=1===ib.J(0))}}Object(f.a)(ha,"StoredValueBooleanFilterInit",null,[]);class la{constructor(ib,Ab){this.Ra=ib;this.Cba=Ab}isMatch(ib){if("number"!==typeof ib)throw Error.argument("objToTest","Expected integer");switch(this.Cba){case 0:return this.Ra.kke?
this.Ra.value?!!(ib&this.Ra.value):!ib:ib===this.Ra.value;case 1:return this.Ra.kke?(ib&this.Ra.value)===this.Ra.value:32>ib&&(1<<ib&this.Ra.value)===this.Ra.value;case 2:return this.Ra.kke?!!(ib&this.Ra.value):32>ib&&!!(1<<ib&this.Ra.value);default:throw Error.notImplemented();}}}Object(f.a)(la,"StoredValueEnumFilter",null,[1491]);class ya{constructor(ib){ib&&(this.kke=1===ib.J(0),this.value=ib.J(1))}}Object(f.a)(ya,"StoredValueEnumFilterInit",null,[]);class va{constructor(){this.R1l=null;this.bmf=
this.K_b=0}}Object(f.a)(va,"WHEREConstraintData",null,[]);class xa{constructor(ib){this.Ra=ib}isMatch(ib,Ab){if(!Object(C.a)(va,ib))throw Error.argument("objToTest","Expected WHERE constraint data");let Tb=-1,lc=-1;const Hc=ib.R1l;switch(this.Ra.pnf){case 4:Tb=Hc.Vdd;lc=Hc.WEg;break;case 5:Tb=ib.K_b;lc=Hc.Vdd-ib.K_b;break;case 6:Tb=Hc.Vdd+Hc.WEg;lc=ib.K_b+ib.bmf-Tb;break;case 1:case 2:case 3:let hd=!1;for(let ta=Hc.C6m;ta;ta=ta.next)if(this.Ra.t0m===ta.name){hd=!0;1===this.Ra.pnf?(Tb=ta.Vdd,lc=ta.WEg):
2===this.Ra.pnf?(Tb=ib.K_b,lc=ta.Vdd-ib.K_b):(Tb=ta.Vdd+ta.WEg,lc=ib.K_b+ib.bmf-Tb);break}if(!hd)return!1;break;case 7:Tb=ib.K_b;lc=ib.bmf;break;default:throw Error.notImplemented();}return null!==this.Ra.sKm.H8m(Hc.scn,Tb,lc,Tb,!0,2,Ab)}}Object(f.a)(xa,"SubSreWhereConstraintFilter",null,[1491]);class Ia{constructor(ib,Ab){if(ib){var Tb=Ab.getString(ib.J(0));this.pnf=Tb.charCodeAt(0);this.t0m=Tb.substr(1);this.sKm=Ab.W4k(ib.J(1))}}}Object(f.a)(Ia,"SubSreWhereConstraintFilterInit",null,[]);class mb{constructor(ib){this.Ra=
ib}isMatch(ib,Ab,Tb=null){if(!Object(C.a)(1458,ib))throw Error.argument("objToTest","Expected feature bundle");if(null==Tb)throw Error.argumentNull("parentTextForSpan");if(this.Ra.$rh&&!this.Ra.$rh.isMatch(ib,Ab))return!1;if(this.Ra.xIg){let lc;if(({value:lc}=ib.Xp(this.Ra.CJm)).returnValue){if(!this.Ra.xIg.isMatch(lc,Ab))return!1}else{let Hc,hd;if(!({value:Hc}=ib.Xp(this.Ra.E2i)).returnValue||!({value:hd}=ib.Xp(this.Ra.D2i)).returnValue||0>Hc||0>hd||Hc+hd>Tb.length||!this.Ra.xIg.isMatch(Tb.substr(Hc,
hd),Ab))return!1}}if(this.Ra.o3i){let lc;if(!({value:lc}=ib.Xp(this.Ra.E2i)).returnValue||!this.Ra.o3i.isMatch(lc,Ab))return!1}if(this.Ra.ooi){let lc;if(!({value:lc}=ib.Xp(this.Ra.D2i)).returnValue||!this.Ra.ooi.isMatch(lc,Ab))return!1}return!0}}Object(f.a)(mb,"TextSpanFilter",null,[1491]);class gb{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.E2i=ib.J(0),this.D2i=ib.J(1),this.CJm=ib.J(2),this.xIg=ib.J(3)?Ab.Hta(ib.J(3)):null,this.$rh=ib.J(4)?Ab.Hta(ib.J(4)):null,this.o3i=ib.J(5)?Ab.Hta(ib.J(5)):null,
this.ooi=ib.J(6)?Ab.Hta(ib.J(6)):null)}}Object(f.a)(gb,"TextSpanFilterInit",null,[]);class Za{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.fAa=ib.J(0),this.gPg=ib.J(1)?Ab.Hta(ib.J(1)):null)}}Object(f.a)(Za,"ValueFilterAnnotationFilterInit",null,[]);var $a=b(1161);class cb{Hta(ib,Ab){const Tb=ib.J(0),lc=new $a.a;lc.gub(ib,1,ib.count-1);switch(Tb){case 1:return new K(new Y(lc,Ab),0);case 2:return new K(new Y(lc,Ab),1);case 3:return new K(new Y(lc,Ab),2);case 101:return new Aa(new Ma(lc,Ab));case 103:return new Ja(new pa(lc,
Ab),0);case 104:return new Ja(new pa(lc,Ab),1);case 105:return new Ja(new pa(lc,Ab),2);case 106:return new Ja(new pa(lc,Ab),3);case 107:return new Ja(new pa(lc,Ab),4);case 108:return new Ja(new pa(lc,Ab),5);case 109:return new Ja(new pa(lc,Ab),6);case 201:return new V(new ha(lc));case 202:return new ma(new L(lc,Ab));case 301:return new W(new Z(lc,Ab),0);case 302:return new W(new Z(lc,Ab),1);case 303:return new W(new Z(lc,Ab),2);case 304:return new W(new Z(lc,Ab),3);case 305:return new W(new Z(lc,
Ab),4);case 401:return new la(new ya(lc),0);case 402:return new la(new ya(lc),1);case 403:return new la(new ya(lc),2);case 404:return new ka(new oa(lc,Ab),0);case 405:return new ka(new oa(lc,Ab),1);case 406:return new ka(new oa(lc,Ab),2);case 407:return new ka(new oa(lc,Ab),3);case 501:return new M(new G(lc,Ab));case 502:return new Na(new L(lc,Ab));case 601:return new O(new ba(lc,Ab),0);case 602:return new O(new ba(lc,Ab),1);case 603:return new I(new ba(lc,Ab));case 604:return new za(new L(lc,Ab),
0);case 605:return new za(new L(lc,Ab),1);case 606:return new za(new L(lc,Ab),2);case 607:return new za(new L(lc,Ab),3);case 701:return new R(!1);case 702:return new R(!0);case 703:return new J(new Za(lc,Ab),!1);case 704:return new J(new Za(lc,Ab),!0);case 705:return new H(new Za(lc,Ab),!1);case 706:return new H(new Za(lc,Ab),!0);case 707:return new X(new fa(lc,Ab));case 901:return new mb(new gb(lc,Ab));case 1002:return new Da(new L(lc,Ab));case 1001:return new xa(new Ia(lc,Ab));default:throw Error.argument("initData");
}}}Object(f.a)(cb,"FilterFactory",null,[1457]);var La=b(1124);class Ya{constructor(ib){this.Ra=ib}get cE(){return this.Ra.cE}get Q8(){return this.Ra.Q8}get ICe(){return this.Ra.ICe}get cje(){return this.Ra.cje}load(ib,Ab){return this.Qs(ib,ib?new U("root",ib,Ab):Ab)}store(ib,Ab,Tb){this.nFc(ib,Ab,ib?new U("root",ib,Tb):Tb,null)}Qs(ib,Ab){if(!this.cje&&!this.Ra.Le.Svc(this.cE,ib))throw Error.argument("input","Input value not of expected type");let Tb=this.Ra.LTh;for(;Tb;)ib=Tb.load(ib,Ab),Tb=Tb.next;
return ib}nFc(ib,Ab,Tb,lc){if(!this.ICe)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.cje&&!this.Ra.Le.Svc(this.cE,ib))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ra.Le.Svc(this.Q8,Ab))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ra.LTh.store(ib,Ab,Tb,lc)}static uDh(ib,Ab,Tb,lc){if(Tb===lc)return Ab;if(B.Annotations.dJ(Tb)&&B.Annotations.dJ(lc)){Tb=B.Annotations.Mcb(Tb);lc=B.Annotations.Mcb(lc);
const Hc=new La.a(ib,lc);for(const hd of Ab.items)Array.add(Hc.items,Ya.uDh(ib,hd,Tb,lc));return Hc}if(Tb===B.Annotations.BRa){if(lc===B.Annotations.rxa)return Ab;if(lc===B.Annotations.Bca)return Ab.toString()}else if(Tb===B.Annotations.rxa){if(lc===B.Annotations.BRa)return Math.floor(Ab);if(lc===B.Annotations.Bca)return Ab.toString()}else if(Tb===B.Annotations.Bca){if(lc===B.Annotations.BRa)return parseInt(Ab);if(lc===B.Annotations.rxa)return parseFloat(Ab)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(f.a)(Ya,"AnnotationQuery",null,[1497]);class Eb{constructor(){this.Q8=this.cE=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}Pcb(ib){if(this.next)return{returnValue:this.next,RQa:ib};if(ib){const Ab=ib.iGh;ib=ib.MHi;return{returnValue:Ab,RQa:ib}}return{returnValue:null,RQa:ib}}}Object(f.a)(Eb,"AnnotationQueryStep",null,[1527]);class qa extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){Ab=this.Ra.query.Qs(ib,Ab);if(B.Annotations.dJ(this.cE)){var Tb=B.Annotations.Mcb(this.cE);
let Hc=new La.a(this.Ra.Le,Tb);if(B.Annotations.dJ(this.Ra.query.Q8)){if(ib.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let hd=0,ta=ib.items.length;hd<ta;++hd)Array.add(Hc.items,this.Q3d(ib.items[hd],Ab.items[hd],Tb===B.Annotations.rxa))}else for(var lc of ib.items)Array.add(Hc.items,this.Q3d(lc,Ab,Tb===B.Annotations.rxa));return Hc}if(B.Annotations.dJ(this.Ra.query.Q8)){lc=new La.a(this.Ra.Le,this.cE);for(Tb of Ab.items)Array.add(lc.items,
this.Q3d(ib,Tb,this.cE===B.Annotations.rxa));return lc}return this.Q3d(ib,Ab,this.cE===B.Annotations.rxa)}Q3d(ib,Ab,Tb){ib=this.wnc(ib,Ab);return Tb?ib:Math.floor(ib)}}Object(f.a)(qa,"NumericAnnotationQueryStep",Eb,[]);class Oa extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return ib+Ab}}Object(f.a)(Oa,"AddAnnotationQueryStep",qa,[]);class Ha extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(this.cE===B.Annotations.kEa&&this.Ra.query.Q8===B.Annotations.kEa){let Hc;if(({result:Hc}=this.Mzh(ib)).returnValue)return Hc}if(B.Annotations.dJ(this.cE)){var Tb=
new La.a(this.Ra.Le,B.Annotations.kEa);Ab=this.Ra.query.Qs(ib,Ab);if(B.Annotations.dJ(this.Ra.query.Q8)){if(ib.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Hc=0,hd=ib.items.length;Hc<hd;++Hc)Array.add(Tb.items,this.i8c(Ab.items[Hc],ib.items[Hc]))}else for(var lc of ib.items)Array.add(Tb.items,this.i8c(Ab,lc));return Tb}lc=this.Ra.query.Qs(ib,Ab);if(B.Annotations.dJ(this.Ra.query.Q8)){Ab=new La.a(this.Ra.Le,B.Annotations.kEa);
for(Tb of lc.items)Array.add(Ab.items,this.i8c(Tb,ib));return Ab}return this.i8c(lc,ib)}}Object(f.a)(Ha,"BinaryBooleanAnnotationQueryStep",Eb,[]);class ab extends Ha{constructor(ib){super(ib)}Mzh(ib){return{returnValue:!ib,result:!1}}i8c(ib,Ab){return ib&&Ab}}Object(f.a)(ab,"AndAnnotationQueryStep",Ha,[]);class Ra{constructor(ib){ib&&(this.Le=ib)}}Object(f.a)(Ra,"AnnotationsOnlyQueryStepInit",null,[]);class Pa extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){Ab=this.Ra.query.Qs(ib,Ab);ib=
ib.clone();B.Annotations.dJ(this.Ra.query.Q8)?Array.addRange(ib.items,Ab.items):Array.add(ib.items,Ab);return ib}}Object(f.a)(Pa,"AppendAnnotationQueryStep",Eb,[]);class bb extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(this.cE===B.Annotations.kY)return this.Ucd(ib,Ab);const Tb=new La.a(this.Ra.Le,B.Annotations.kY);for(const lc of ib.items)Array.add(Tb.items,this.Ucd(lc,Ab));return Tb}Ucd(ib,Ab){const Tb=new S.a(this.Ra.Le);Tb.cab(ib);ib=new S.a(this.Ra.Le);this.Ra.script.eXa(null,new U("Input",
Tb,new U("Output",ib,Ab)));return ib}}Object(f.a)(bb,"ApplyAnnotationQueryStep",Eb,[]);class hb extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(this.cE===B.Annotations.kY)return Ab=this.Ucd(ib,Ab),Ab.Xp(this.Ra.Yrh).returnValue||new La.a(this.Ra.Le,B.Annotations.kY),Ab;const Tb=new La.a(this.Ra.Le,B.Annotations.kY);for(const lc of ib.items)if(ib=this.Ucd(lc,Ab),({value:ib}=ib.Xp(this.Ra.Yrh)).returnValue)for(const Hc of ib.items)Array.add(Tb.items,Hc);return Tb}Ucd(ib,Ab){const Tb=new S.a(this.Ra.Le);
Tb.cab(ib);ib=new S.a(this.Ra.Le);this.Ra.script.eXa(null,new U("Input",Tb,new U("Output",ib,Ab)));return ib}}Object(f.a)(hb,"ApplyExpandAnnotationQueryStep",Eb,[]);class Pb{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.script=Ab.IXb(ib.J(0)),this.Yrh=ib.J(1))}}Object(f.a)(Pb,"ApplyExpandQueryStepInit",null,[]);class wb{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.script=Ab.IXb(ib.J(0)))}}Object(f.a)(wb,"ApplyQueryStepInit",null,[]);class Fb extends Eb{constructor(ib){super();this.Ra=ib}load(ib){if(this.cE===
B.Annotations.kY)return this.Fme(ib);const Ab=new La.a(this.Ra.Le,this.Ra.Le.getAttributeType(this.Ra.fAa));for(const Tb of ib.items)Array.add(Ab.items,this.Fme(Tb));return Ab}store(ib,Ab,Tb,lc){if(this.cE===B.Annotations.kY){var Hc=Ab,hd=({RQa:lc}=this.Pcb(lc)).returnValue;hd&&(Hc=hd.store(B.Annotations.zW(this.Fme(ib)),Ab,Tb,lc));ib.Ly(this.Ra.fAa,Hc)}else{var ta=Ab;if(Hc=({RQa:lc}=this.Pcb(lc)).returnValue){ta=new La.a(this.Ra.Le,this.Ra.Le.getAttributeType(this.Ra.fAa));for(hd of ib.items)Array.add(ta.items,
this.Fme(hd));ta=Hc.store(ta,Ab,Tb,lc)}Ab=ta;if(Ab.items.length!==ib.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let jb=0,Mb=ib.items.length;jb<Mb;++jb)Tb=ib.items[jb],Tb.isReadOnly&&(Tb=Tb.clone(),ib.items[jb]=Tb),Tb.Ly(this.Ra.fAa,Ab.items[jb])}return ib}Fme(ib){({value:ib}=ib.Xp(this.Ra.fAa)).returnValue||(ib=this.Ra.Le.CNk(this.Ra.fAa));return ib}}Object(f.a)(Fb,"AttrAnnotationQueryStep",Eb,[]);class Ta{constructor(ib,Ab){ib&&(this.Le=
Ab,this.fAa=ib.J(0))}}Object(f.a)(Ta,"AttrQueryStepInit",null,[]);class Zb extends Eb{constructor(ib){super();this.Ra=ib}load(ib){const Ab=new S.a(this.Ra.Le);Ab.cab(ib);return this.Ra.module.execute(Ab)}}Object(f.a)(Zb,"CallModuleAnnotationQueryStep",Eb,[]);class Db{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.module=Ab.KMf(ib.J(0)))}}Object(f.a)(Db,"CallModuleQueryStepInit",null,[]);class pb extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(B.Annotations.dJ(this.cE)){var Tb=this.Ra.query.Qs(ib,
Ab);Ab=new La.a(this.Ra.Le,B.Annotations.Bca);let hd="string"===typeof Tb;for(var lc of ib.items)if(hd)Array.add(Ab.items,lc+Tb);else for(var Hc of Tb.items)Array.add(Ab.items,lc+Hc);return Ab}lc=this.Ra.query.Qs(ib,Ab);if("string"===typeof lc)return ib+lc;Hc=new La.a(this.Ra.Le,B.Annotations.Bca);for(Tb of lc.items)Array.add(Hc.items,ib+Tb);return Hc}}Object(f.a)(pb,"ConcatAnnotationQueryStep",Eb,[]);class nb extends Eb{constructor(ib){super();this.Ra=ib}load(ib){return Ya.uDh(this.Ra.Le,ib,this.cE,
this.Q8)}}Object(f.a)(nb,"ConvertAnnotationQueryStep",Eb,[]);class ub extends Eb{constructor(){super()}load(ib){return ib.items.length}}Object(f.a)(ub,"CountAnnotationQueryStep",Eb,[]);class kb extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return ib/Ab}}Object(f.a)(kb,"DivideAnnotationQueryStep",qa,[]);class zc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){Ab=new U(this.Ra.dGe,null,Ab);for(const Tb of ib.items)if(Ab.Unf(Tb),this.Ra.query.Qs(Tb,Ab))return!0;return!1}}Object(f.a)(zc,"ExistsAnnotationQueryStep",
Eb,[]);class Qc extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return Math.pow(ib,Ab)}}Object(f.a)(Qc,"ExpAnnotationQueryStep",qa,[]);class md{constructor(ib,Ab){ib&&(this.nXa=Ab.getString(ib.J(0)))}}Object(f.a)(md,"FeatureBundleNameQueryStepInit",null,[]);class vd extends Eb{constructor(ib){super();this.Ra=ib}load(ib){if(B.Annotations.dJ(this.cE)){const Ab=new La.a(this.Ra.Le,this.Ra.Le.BZb(B.Annotations.Mcb(this.cE),this.Ra.oXa));for(const Tb of ib.items)Array.add(Ab.items,Tb.Eub(this.Ra.oXa));
return Ab}return ib.Eub(this.Ra.oXa)}store(ib,Ab,Tb,lc){if(B.Annotations.dJ(this.cE)){var Hc=Ab,hd=({RQa:lc}=this.Pcb(lc)).returnValue;if(hd){Hc=new La.a(this.Ra.Le,this.Ra.Le.BZb(B.Annotations.Mcb(this.cE),this.Ra.oXa));for(var ta of ib.items)Array.add(Hc.items,ta.Eub(this.Ra.oXa));Hc=hd.store(Hc,Ab,Tb,lc)}Ab=Hc;if(Ab.items.length!==ib.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let jb=0,Mb=ib.items.length;jb<Mb;++jb)Tb=ib.items[jb],Tb.isReadOnly&&
(Tb=Tb.clone(),ib.items[jb]=Tb),Tb.Wyg(this.Ra.oXa,Ab.items[jb])}else hd=Ab,(ta=({RQa:lc}=this.Pcb(lc)).returnValue)&&(hd=ta.store(B.Annotations.zW(ib.Eub(this.Ra.oXa)),Ab,Tb,lc)),ib.Wyg(this.Ra.oXa,hd);return ib}}Object(f.a)(vd,"FieldAnnotationQueryStep",Eb,[]);class Jb{constructor(ib,Ab){ib&&(this.Le=Ab,this.oXa=ib.J(0))}}Object(f.a)(Jb,"FieldQueryStepInit",null,[]);class mc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){for(const Tb of ib.items)if(this.Ra.filter.isMatch(Tb,Ab))return Tb;
throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ib,Ab,Tb,lc){let Hc=Ab,hd=-1;for(let jb=0,Mb=ib.items.length;jb<Mb;jb++)if(this.Ra.filter.isMatch(ib.items[jb],Tb)){hd=jb;break}if(0>hd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const ta=({RQa:lc}=this.Pcb(lc)).returnValue;ta&&(Hc=ta.store(B.Annotations.zW(ib.items[hd]),Ab,Tb,lc));ib.items[hd]=Hc;return ib}}Object(f.a)(mc,"FirstItemMatchingAnnotationQueryStep",
Eb,[]);class sc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){Ab=new U(this.Ra.dGe,null,Ab);for(const Tb of ib.items)if(Ab.Unf(Tb),!this.Ra.query.Qs(Tb,Ab))return!1;return!0}}Object(f.a)(sc,"ForAllAnnotationQueryStep",Eb,[]);class Mc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){ib=Ab?Ab.ade(this.Ra.nXa):null;if(!ib)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ra.nXa+'"');return ib}store(ib,Ab,Tb,lc){ib=Tb?Tb.ade(this.Ra.nXa):null;if(!ib)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ra.nXa+'"');let Hc=Ab;const hd=({RQa:lc}=this.Pcb(lc)).returnValue;hd&&(Hc=hd.store(ib,Ab,Tb,lc));ib!==Hc&&ib.cab(Hc);return ib}}Object(f.a)(Mc,"GetAnnotationQueryStep",Eb,[]);class Nb{constructor(ib,Ab){this.Sqj=ib;this.fGj=Ab}get iGh(){return this.Sqj}get MHi(){return this.fGj}}Object(f.a)(Nb,"AnnotationQueryStoreContinuation",null,[1529]);class Kb extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){return this.Ra.tDe.Qs(ib,Ab)?this.Ra.I8i.Qs(ib,Ab):this.Ra.Y$d?this.Ra.Y$d.Qs(ib,Ab):
ib}store(ib,Ab,Tb,lc){var Hc=this.Ra.tDe.Qs(ib,Tb);this.next&&(lc=new Nb(this.next,lc));if(Hc)return this.Ra.I8i.nFc(ib,Ab,Tb,lc);if(this.Ra.Y$d)return this.Ra.Y$d.nFc(ib,Ab,Tb,lc);Hc=Ab;let hd=null;lc&&(hd=lc.iGh,lc=lc.MHi);hd&&(Hc=hd.store(B.Annotations.zW(ib),Ab,Tb,lc));return Hc}}Object(f.a)(Kb,"IfAnnotationQueryStep",Eb,[]);class Yb{constructor(ib,Ab){ib&&(this.tDe=Ab.aM(ib.J(0)),this.I8i=Ab.aM(ib.J(1)),this.Y$d=ib.J(2)?Ab.aM(ib.J(2)):null)}}Object(f.a)(Yb,"IfQueryStepInit",null,[]);class Bb{constructor(ib,
Ab){ib&&(this.Ril=Ab.aM(ib.J(0)),this.Wmi=Ab.aM(ib.J(1)))}}Object(f.a)(Bb,"IndexAndItemQueryStepInit",null,[]);class Lb extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){const Tb=this.Ra.Ril.Qs(ib,Ab);Ab=this.Ra.Wmi.Qs(ib,Ab);ib=ib.clone();if(0>Tb||Tb>ib.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(B.Annotations.dJ(this.Ra.Wmi.Q8))for(let lc=0;lc<Ab.items.length;++lc)Array.insert(ib.items,Tb+lc,Ab.items[lc]);else Array.insert(ib.items,Tb,Ab);
return ib}}Object(f.a)(Lb,"InsertAtAnnotationQueryStep",Eb,[]);class gc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){return!(!Ab||!Ab.ade(this.Ra.nXa))}}Object(f.a)(gc,"IsDefinedAnnotationQueryStep",Eb,[]);class Gc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){Ab=this.cO(ib,Ab);return ib.items[Ab]}store(ib,Ab,Tb,lc){const Hc=this.cO(ib,Tb);let hd=Ab;const ta=({RQa:lc}=this.Pcb(lc)).returnValue;ta&&(hd=ta.store(B.Annotations.zW(ib.items[Hc]),Ab,Tb,lc));ib.items[Hc]=hd;return ib}cO(ib,
Ab){Ab=this.Ra.query.Qs(ib,Ab);if(0>Ab||Ab>=ib.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ab}}Object(f.a)(Gc,"ItemAnnotationQueryStep",Eb,[]);class fc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){const Tb=new La.a(this.Ra.Le,B.Annotations.Mcb(this.cE));for(const lc of ib.items)this.Ra.filter.isMatch(lc,Ab)&&Array.add(Tb.items,lc);return Tb}}Object(f.a)(fc,"ItemsMatchingAnnotationQueryStep",Eb,[]);class dd extends Eb{constructor(ib){super();
this.Ra=ib}load(ib,Ab){Ab=this.cO(ib,Ab);return ib.items[ib.items.length-Ab-1]}store(ib,Ab,Tb,lc){const Hc=this.cO(ib,Tb);let hd=Ab;const ta=({RQa:lc}=this.Pcb(lc)).returnValue;ta&&(hd=ta.store(B.Annotations.zW(ib.items[ib.items.length-Hc-1]),Ab,Tb,lc));ib.items[ib.items.length-Hc-1]=hd;return ib}cO(ib,Ab){Ab=this.Ra.query?this.Ra.query.Qs(ib,Ab):0;if(0>Ab||Ab>=ib.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ab}}Object(f.a)(dd,"LastItemAnnotationQueryStep",
Eb,[]);class Td extends Eb{constructor(ib){super();this.Ra=ib}load(ib){if(B.Annotations.dJ(this.cE)){const Ab=new La.a(this.Ra.Le,B.Annotations.BRa);for(const Tb of ib.items)Array.add(Ab.items,Tb.length);return Ab}return ib.length}}Object(f.a)(Td,"LengthAnnotationQueryStep",Eb,[]);class Bd extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(B.Annotations.dJ(this.cE)){const Tb=new La.a(this.Ra.Le,B.Annotations.kEa);for(const lc of ib.items)Array.add(Tb.items,this.Ra.filter.isMatch(lc,Ab));
return Tb}return this.Ra.filter.isMatch(ib,Ab)}}Object(f.a)(Bd,"MatchesAnnotationQueryStep",Eb,[]);class ce extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){return this.Ra.filter.isMatch(ib,Ab)}}Object(f.a)(ce,"MatchesAsListAnnotationQueryStep",Eb,[]);class Ec extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return ib%Ab}}Object(f.a)(Ec,"ModuloAnnotationQueryStep",qa,[]);class kc extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return ib*Ab}}Object(f.a)(kc,"MultiplyAnnotationQueryStep",qa,
[]);class hc extends Eb{constructor(ib){super();this.Ra=ib}load(ib){if(B.Annotations.dJ(this.cE)){const Ab=new La.a(this.Ra.Le,B.Annotations.kEa);for(const Tb of ib.items)Array.add(Ab.items,!Tb);return Ab}return!ib}}Object(f.a)(hc,"NotAnnotationQueryStep",Eb,[]);class Gd extends Ha{constructor(ib){super(ib)}Mzh(ib){return{returnValue:ib,result:!0}}i8c(ib,Ab){return ib||Ab}}Object(f.a)(Gd,"OrAnnotationQueryStep",Ha,[]);class nc extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){const Tb=this.Ra.YFg.Qs(ib,
Ab);ib=this.Ra.n9c.Qs(ib,Ab);Ab=new La.a(this.Ra.Le,B.Annotations.BRa);for(let lc=0;lc<ib;++lc)Array.add(Ab.items,Tb+lc);return Ab}}Object(f.a)(nc,"RangeAnnotationQueryStep",Eb,[]);class uc{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.filter=Ab.Hta(ib.J(0)))}}Object(f.a)(uc,"SingleFilterQueryStepInit",null,[]);class yc{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.query=ib.J(0)?Ab.aM(ib.J(0)):null)}}Object(f.a)(yc,"SingleOptionalQueryQueryStepInit",null,[]);class ke{constructor(ib,Ab){ib&&(this.Le=Ab.Le,
this.query=Ab.aM(ib.J(0)))}}Object(f.a)(ke,"SingleQueryQueryStepInit",null,[]);class Qe{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.YFg=Ab.aM(ib.J(0)),this.n9c=ib.J(1)?Ab.aM(ib.J(1)):null)}}Object(f.a)(Qe,"StartAndCountOrLengthQueryStepInit",null,[]);class Gg extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){let Tb;({startIndex:Ab,length:Tb}=this.hfe(ib,Ab));const lc=new La.a(this.Ra.Le,ib.l8);for(let Hc=0;Hc<Tb;++Hc)Array.add(lc.items,ib.items[Ab+Hc]);return lc}store(ib,Ab,Tb,lc){let Hc,hd;
({startIndex:Hc,length:hd}=this.hfe(ib,Tb));var ta=Ab;const jb=({RQa:lc}=this.Pcb(lc)).returnValue;if(jb){ta=new La.a(this.Ra.Le,ib.l8);for(let Mb=0;Mb<hd;++Mb)Array.add(ta.items,ib.items[Hc+Mb]);ta=jb.store(ta,Ab,Tb,lc)}Ab=ta;for(Tb=0;Tb<hd;++Tb)Array.removeAt(ib.items,Hc);for(let Mb=0,xb=Ab.items.length;Mb<xb;++Mb)Array.insert(ib.items,Hc+Mb,Ab.items[Mb]);return ib}hfe(ib,Ab){let Tb;Tb=this.Ra.YFg.Qs(ib,Ab);if(0>Tb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ab=this.Ra.n9c?
this.Ra.n9c.Qs(ib,Ab):ib.items.length-Tb;if(0>Ab||Tb+Ab>ib.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Tb,length:Ab}}}Object(f.a)(Gg,"SublistAnnotationQueryStep",Eb,[]);class Kg extends Eb{constructor(ib){super();this.Ra=ib}load(ib,Ab){if(B.Annotations.dJ(this.cE)){const Tb=new La.a(this.Ra.Le,B.Annotations.Bca);for(let lc=0,Hc=ib.items.length;lc<Hc;++lc)Array.add(Tb.items,this.g6h(ib.items[lc],Ab));return Tb}return this.g6h(ib,
Ab)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}g6h(ib,Ab){let Tb;({startIndex:Ab,length:Tb}=this.hfe(ib,Ab));return ib.substr(Ab,Tb)}hfe(ib,Ab){let Tb;Tb=this.Ra.YFg.Qs(ib,Ab);if(0>Tb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ab=this.Ra.n9c?this.Ra.n9c.Qs(ib,Ab):ib.length-Tb;if(0>Ab||Tb+Ab>ib.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Tb,length:Ab}}}
Object(f.a)(Kg,"SubstringAnnotationQueryStep",Eb,[]);class mf extends qa{constructor(ib){super(ib)}wnc(ib,Ab){return ib-Ab}}Object(f.a)(mf,"SubtractAnnotationQueryStep",qa,[]);class Kf extends Eb{constructor(ib){super();this.Ra=ib}load(ib){const Ab=new La.a(this.Ra.Le,B.Annotations.Bca);for(let Tb=0;Tb<ib.length;++Tb)Array.add(Ab.items,ib.charAt(Tb).toString());return Ab}}Object(f.a)(Kf,"ToCharListAnnotationQueryStep",Eb,[]);class yb extends Eb{constructor(ib){super();this.Ra=ib}load(ib){const Ab=
new La.a(this.Ra.Le,this.cE);Array.add(Ab.items,ib);return Ab}}Object(f.a)(yb,"ToListAnnotationQueryStep",Eb,[]);class Ob extends Eb{constructor(ib){super();this.Ra=ib}load(){return this.Ra.value}}Object(f.a)(Ob,"ValueAnnotationQueryStep",Eb,[]);class Lc{constructor(ib,Ab){if(ib){var Tb=ib.J(0),lc=1;this.value=({pma:lc}=Ab.PWa(Tb,ib,lc,null,null,null)).returnValue;B.Annotations.i3b(this.value)}}}Object(f.a)(Lc,"ValueQueryStepInit",null,[]);class nd{constructor(ib,Ab){ib&&(this.dGe=Ab.getString(ib.J(0)),
this.query=Ab.aM(ib.J(1)))}}Object(f.a)(nd,"VarNameAndQueryQueryStepInit",null,[]);class Rd{constructor(ib,Ab){this.j0g=null;if(ib){this.Le=Ab.Le;var Tb=0;this.cE=ib.J(Tb);++Tb;this.Q8=ib.J(Tb);++Tb;this.ICe=1===ib.J(Tb);++Tb;this.cje=1===ib.J(Tb);++Tb;var lc=ib.J(Tb);++Tb;if(lc){var Hc=Tb,hd=Tb+lc,ta=Tb+2*lc;Tb+=3*lc;var jb=ib.count-Tb,Mb=null;for(let Nc=0;Nc<lc;++Nc){var xb=Tb+ib.J(ta+Nc);const rc=(Nc===lc-1?jb:ib.J(ta+Nc+1))-ib.J(ta+Nc),wd=new $a.a;wd.gub(ib,xb,rc);xb=Rd.k_k(ib.J(hd+Nc),wd,Ab);
xb.cE=ib.J(Hc+Nc);xb.Q8=Nc===lc-1?this.Q8:ib.J(Hc+Nc+1);Mb?Mb.next=xb:this.j0g=xb;Mb=xb}}}}get LTh(){return this.j0g}static k_k(ib,Ab,Tb){switch(ib){case 1:return new Mc(new md(Ab,Tb));case 2:return new gc(new md(Ab,Tb));case 3:return new Fb(new Ta(Ab,Tb.Le));case 4:return new vd(new Jb(Ab,Tb.Le));case 5:return new Kb(new Yb(Ab,Tb));case 6:return new Bd(new uc(Ab,Tb));case 43:return new ce(new uc(Ab,Tb));case 45:return new bb(new wb(Ab,Tb));case 49:return new hb(new Pb(Ab,Tb));case 46:return new Ob(new Lc(Ab,
Tb.Le));case 51:return new Zb(new Db(Ab,Tb));case 52:return new nc(new Qe(Ab,Tb));case 53:return new nb(new Ra(Tb.Le));case 13:return new Gc(new ke(Ab,Tb));case 14:return new dd(new yc(Ab,Tb));case 15:return new ub;case 18:return new mc(new uc(Ab,Tb));case 16:return new sc(new nd(Ab,Tb));case 17:return new zc(new nd(Ab,Tb));case 22:return new Lb(new Bb(Ab,Tb));case 24:return new Pa(new ke(Ab,Tb));case 26:return new Gg(new Qe(Ab,Tb));case 27:return new fc(new uc(Ab,Tb));case 30:return new yb(new Ra(Tb.Le));
case 31:return new Kg(new Qe(Ab,Tb));case 32:return new pb(new ke(Ab,Tb));case 47:return new Td(new Ra(Tb.Le));case 48:return new Kf(new Ra(Tb.Le));case 34:return new Oa(new ke(Ab,Tb));case 35:return new mf(new ke(Ab,Tb));case 36:return new kc(new ke(Ab,Tb));case 37:return new kb(new ke(Ab,Tb));case 38:return new Ec(new ke(Ab,Tb));case 39:return new Qc(new ke(Ab,Tb));case 40:return new ab(new ke(Ab,Tb));case 41:return new Gd(new ke(Ab,Tb));case 42:return new hc(new Ra(Tb.Le));default:throw Error.argument("currStepInitData");
}}}Object(f.a)(Rd,"AnnotationQueryInit",null,[]);class Yf{constructor(ib){this.Ra=ib}execute(ib,Ab){this.eXa(ib,ib?new U("root",ib,Ab):Ab)}eXa(ib,Ab){for(const Tb of this.Ra.commands)Ab=Tb.execute(ib,Ab)}}Object(f.a)(Yf,"AnnotationScript",null,[1496]);class Pd{constructor(ib){this.Ra=ib}execute(ib,Ab){const Tb=this.Ra.Kll.Qs(ib,Ab),lc=this.Ra.v0l.Qs(ib,Ab);this.Ra.script.eXa(ib,new U("Input",Tb,new U("Output",lc,Ab)));return Ab}}Object(f.a)(Pd,"ApplyAnnotationScriptCommand",null,[1523]);class Mf{constructor(ib,
Ab){ib&&(this.Kll=Ab.aM(ib.J(0)),this.v0l=Ab.aM(ib.J(1)),this.script=Ab.IXb(ib.J(2)))}}Object(f.a)(Mf,"ApplyScriptCommandInit",null,[]);class Me{constructor(ib){this.Ra=ib}execute(ib,Ab){const Tb=this.Ra.awg.Qs(ib,Ab);this.Ra.fne.nFc(ib,Tb,Ab,null);return Ab}}Object(f.a)(Me,"AssignAnnotationScriptCommand",null,[1523]);class Xd{constructor(ib){this.Ra=ib}execute(ib,Ab){const Tb=this.Ra.fne.Qs(ib,Ab);ib=this.Ra.awg.Qs(ib,Ab);Tb!==ib&&Tb.cab(ib);return Ab}}Object(f.a)(Xd,"CopyAnnotationScriptCommand",
null,[1523]);class Fe{constructor(ib){this.Ra=ib}execute(ib,Ab){let Tb=this.Ra.t5f.Qs(ib,Ab);if(this.Ra.t5f.ICe){Tb=B.Annotations.zW(Tb);var lc=new U(this.Ra.nXa,null,Ab);for(let hd=0,ta=Tb.items.length;hd<ta;++hd){var Hc=this.lRh(ib,Tb.items[hd],lc);if(0>this.Ra.pxe)Tb.items[hd]=Hc;else if(({value:Hc}=Hc.Xp(this.Ra.pxe)).returnValue)Tb.items[hd]=Hc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ra.t5f.nFc(ib,Tb,Ab,null)}else{lc=new U(this.Ra.nXa,
null,Ab);for(let hd=0,ta=Tb.items.length;hd<ta;++hd)this.lRh(ib,Tb.items[hd],lc)}return Ab}lRh(ib,Ab,Tb){let lc;0>this.Ra.pxe?lc=B.Annotations.zW(Ab):(lc=new S.a(this.Ra.Le),lc.Ly(this.Ra.pxe,Ab));Tb.Unf(lc);this.Ra.x2j.eXa(ib,Tb);return lc}}Object(f.a)(Fe,"EnumerateAnnotationScriptCommand",null,[1523]);class re{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.nXa=Ab.getString(ib.J(0)),this.t5f=Ab.aM(ib.J(1)),this.x2j=Ab.IXb(ib.J(2)),this.pxe=ib.J(3))}}Object(f.a)(re,"EnumerateScriptCommandInit",null,[]);
class Ad{constructor(ib){this.Ra=ib}execute(ib,Ab){this.Ra.tDe.Qs(ib,Ab)?this.Ra.nSm.eXa(ib,Ab):this.Ra.dSh&&this.Ra.dSh.eXa(ib,Ab);return Ab}}Object(f.a)(Ad,"IfAnnotationScriptCommand",null,[1523]);class zf{constructor(ib,Ab){ib&&(this.tDe=Ab.aM(ib.J(0)),this.nSm=Ab.IXb(ib.J(1)),this.dSh=ib.J(2)?Ab.IXb(ib.J(2)):null)}}Object(f.a)(zf,"IfScriptCommandInit",null,[]);class Id{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.fne=Ab.aM(ib.J(0)),this.awg=Ab.aM(ib.J(1)))}}Object(f.a)(Id,"LvalueAndRvalueQueryScriptCommandInit",
null,[]);class Ac{constructor(ib){this.Ra=ib}execute(ib,Ab){const Tb=this.Ra.awg.Qs(this.Ra.fne.Qs(ib,Ab),Ab);this.Ra.fne.nFc(ib,Tb,Ab,null);return Ab}}Object(f.a)(Ac,"ModifyAnnotationScriptCommand",null,[1523]);class ah{constructor(ib){this.Ra=ib}execute(ib,Ab){const Tb=new S.a(this.Ra.Le);this.Ra.query&&Tb.cab(this.Ra.query.Qs(ib,Ab));return Ab=new U(this.Ra.nXa,Tb,Ab)}}Object(f.a)(ah,"NewAnnotationScriptCommand",null,[1523]);class cg{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.nXa=Ab.getString(ib.J(0)),
this.query=ib.J(1)?Ab.aM(ib.J(1)):null)}}Object(f.a)(cg,"NewScriptCommandInit",null,[]);class Zi{constructor(ib){this.Ra=ib}execute(ib,Ab){ib=this.Ra.query.Qs(ib,Ab);if(this.Ra.query.Q8===B.Annotations.kY)ib.SPa(this.Ra.fAa);else for(const Tb of ib.items)Tb.SPa(this.Ra.fAa);return Ab}}Object(f.a)(Zi,"RemoveAnnotationScriptCommand",null,[1523]);class uh{constructor(ib,Ab){ib&&(this.Le=Ab.Le,this.query=Ab.aM(ib.J(0)),this.fAa=ib.J(1))}}Object(f.a)(uh,"RemoveScriptCommandInit",null,[]);class Jk{constructor(ib,
Ab){if(ib){var Tb=0,lc=ib.J(Tb);++Tb;if(lc){var Hc=Tb,hd=Tb+lc;Tb+=2*lc;var ta=ib.count-Tb;this.commands=Array(lc);for(let jb=0;jb<lc;++jb){const Mb=Tb+ib.J(hd+jb),xb=(jb===lc-1?ta:ib.J(hd+jb+1))-ib.J(hd+jb),Nc=new $a.a;Nc.gub(ib,Mb,xb);this.commands[jb]=Jk.b_k(ib.J(Hc+jb),Nc,Ab)}}}}static b_k(ib,Ab,Tb){switch(ib){case 1:return new Me(new Id(Ab,Tb));case 2:return new Ac(new Id(Ab,Tb));case 3:return new Zi(new uh(Ab,Tb));case 6:return new ah(new cg(Ab,Tb));case 7:return new Fe(new re(Ab,Tb));case 8:return new Ad(new zf(Ab,
Tb));case 9:return new Xd(new Id(Ab,Tb));case 10:return new Pd(new Mf(Ab,Tb));default:throw Error.argument("initData");}}}Object(f.a)(Jk,"AnnotationScriptInit",null,[]);var uj=b(1314);class Uf{constructor(ib){this.L4=ib;this.Wx=0}Zba(){const ib=this.L4.Ky(this.Wx,4);this.Wx+=4;return ib}get b5c(){return this.L4}get offset(){return this.Wx}set offset(ib){this.Wx=ib}}Object(f.a)(Uf,"ByteArrayReader",null,[]);class bf{constructor(){this.JK=null;this.bti=this.nha=0}J(ib){if(0>ib||ib>=this.nha)throw Error.argumentOutOfRange("index");
return this.JK.Ky(this.bti+4*ib,4)}get count(){return this.nha}static Nlk(ib,Ab,Tb){const lc=new bf;lc.JK=ib;lc.bti=Ab;lc.nha=Tb;return lc}}Object(f.a)(bf,"ReadOnlyListOverByteArray",null,[1489]);class Il{constructor(ib,Ab){this.Wsi=this.Vsi=!1;this.gw=this.UZa=this.v9f=this.Zsi=null;try{this.gw=Ab.Le;const Tb=Ab.uub(ib.J(0)),lc=new Uf(Tb);if(-914743053!==lc.Zba())throw Error.argument("Input does not represent a flat lexicon");this.Vsi=1===lc.Zba();this.Wsi=1===lc.Zba();const Hc=lc.Zba();lc.offset+=
Hc;const hd=lc.Zba();this.v9f=Il.V1l(lc,hd,this.gw);const ta=lc.Zba();this.Zsi=Il.f2l(lc,ta);const jb=lc.Zba();this.UZa=new uj.a(lc.b5c,lc.offset);lc.offset+=jb}catch(Tb){throw Error.argument("initData");}}get trie(){return this.UZa}ePk(ib){return"i"===ib&&this.Wsi?"\u0130":ib.toUpperCase()}oYf(){return this.Vsi}YMk(ib){let Ab;Ab=new La.a(this.gw,B.Annotations.kY);if(1!==ib)if(0===ib)ib=new S.a(this.gw),Array.add(Ab.items,ib);else if(ib&1073741824){ib=this.Zsi[ib&-1073741825];for(let lc=0;lc<ib.length;++lc){var Tb=
ib[lc];Tb=0===Tb?new S.a(this.gw):this.v9f[Tb-2];Array.add(Ab.items,Tb)}}else Array.add(Ab.items,this.v9f[ib-2]);return{returnValue:!0,VCl:Ab}}static V1l(ib,Ab,Tb){if(Ab%4)throw Error.argument("reader");const lc=bf.Nlk(ib.b5c,ib.offset,Ab/4);ib.offset+=Ab;ib=[];for(Ab=0;Ab<lc.count;){const Hc=({pma:Ab}=Tb.PWa(B.Annotations.kY,lc,Ab,null,null,null)).returnValue;Array.add(ib,Hc)}return ib}static f2l(ib,Ab){Ab=ib.offset+Ab;const Tb=[];for(;ib.offset<Ab;){const lc=ib.Zba(),Hc=Array(lc);for(let hd=0;hd<
lc;++hd){const ta=ib.Zba();Hc[hd]=ta}Array.add(Tb,Hc)}return Tb}}Object(f.a)(Il,"RawFlatLexicon",null,[1495]);var vj=b(1305),Ie=b(1306);class Rf{constructor(ib){if(null==ib)throw Error.argumentNull("base64String");const Ab=ib.length;if(Ab%4)throw Error.argument("base64String's length must be a multiple of 4");this.nha=.75*Ab;this.w3b=Array(Math.ceil(this.nha/4));ib.endsWith("==")?this.nha-=2:ib.endsWith("=")&&--this.nha;let Tb=0;for(let lc=0;lc<Ab;lc+=4){const Hc=Rf.aye[ib.charCodeAt(lc)-43]<<18|
Rf.aye[ib.charCodeAt(lc+1)-43]<<12|Rf.aye[ib.charCodeAt(lc+2)-43]<<6|Rf.aye[ib.charCodeAt(lc+3)-43];let hd=Hc>>16&255;this.w3b[Math.floor(Tb/4)]|=hd<<Tb%4*8;++Tb;hd=Hc>>8&255;this.w3b[Math.floor(Tb/4)]|=hd<<Tb%4*8;++Tb;hd=Hc&255;this.w3b[Math.floor(Tb/4)]|=hd<<Tb%4*8;++Tb}}get length(){return this.nha}J(ib){if(0>ib||ib>=this.nha)throw Error.argumentOutOfRange("i");return this.yXh(ib)}Ky(ib,Ab){if(0>ib||0>Ab||ib+Ab>this.nha)throw Error.argument("Bad range");let Tb=0;for(let lc=0;lc<Ab;++lc)Tb|=this.yXh(ib+
lc)<<8*lc;return Tb}Xbm(ib,Ab){let Tb=0,lc=0,Hc=Math.floor(ib/8);for(ib%=8;lc<Ab;){const hd=8-ib>Ab-lc?Ab-lc:8-ib,ta=this.J(Hc);Tb|=(ta>>ib&~(255<<hd))<<lc;lc+=hd;++Hc;ib=0}return Tb}yXh(ib){return this.w3b[Math.floor(ib/4)]>>ib%4*8&255}}Rf.aye=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(f.a)(Rf,"ByteArray",null,[]);class Bj{constructor(ib,
Ab,Tb){this.iE=ib;this.SHl=Ab;this.VHl=Tb;this.jti=Array(ib.b?ib.b.length:0);this.Q9f=new vj.a(new Ie.a(this.uub(this.iE.s)));this.Bba=Array(ib.t.length);this.XF=new B.Annotations(this.rub(0),this)}get Le(){return this.XF}get $xk(){return this.iE.d}EZk(){if(!(""in this.iE.m))throw Error.argument("name","Unrecognized module");return this.KMf(this.iE.m[""])}uub(ib){if(0>ib||!this.iE.b||ib>=this.iE.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.jti[ib]||(this.jti[ib]=new Rf(this.iE.b[ib]))}getString(ib){if(1>
ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Bba[ib]){const Ab=this.rub(ib).J(0);this.Bba[ib]=this.Q9f.getString(Ab)}return this.Bba[ib]}Vsc(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Bba[ib]){var Ab=this.rub(ib);const Tb=this.getString(Ab.J(0));Ab=1===Ab.J(1);
this.Bba[ib]=new RegExp(Tb,Ab?"i":"")}return this.Bba[ib]}W4k(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}KMf(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not an NL module");return this.Bba[ib]||(this.Bba[ib]=this.VHl.TZk(this.rub(ib),this))}aM(ib){if(1>ib||
ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not an annotation query");return this.Bba[ib]||(this.Bba[ib]=new Ya(new Rd(this.rub(ib),this)))}IXb(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Bba[ib]||(this.Bba[ib]=new Yf(new Jk(this.rub(ib),this)))}Hta(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");
if(7!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not a filter");return this.Bba[ib]||(this.Bba[ib]=this.SHl.Hta(this.rub(ib),this))}C3k(ib){if(1>ib||ib>=this.iE.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.iE.t[ib])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Bba[ib]||(this.Bba[ib]=new Il(this.rub(ib),this))}rub(ib){const Ab=this.iE.n[ib];ib=(ib<this.iE.t.length-1?this.iE.n[ib+1]:this.iE.n.length)-Ab;if(0>Ab||0>ib||Ab+
ib>this.iE.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ab+","+ib+")");const Tb=new $a.a;Tb.LGf(this.iE.n,Ab,ib);return Tb}}Object(f.a)(Bj,"ObjectFetcher",null,[1456]);class Jl{constructor(ib,Ab,Tb){if(!ib)throw Error.argumentNull("prediction");if(!Ab)throw Error.argumentNull("fieldNames");if(!Tb)throw Error.argumentNull("values");if(Ab.length!==Tb.length)throw Error.argument("values","fieldNames and values do not have same length");this.UFj=ib;this.x3b=Ab;this.Nrd=
Tb}get prediction(){return this.UFj}get pSh(){return this.x3b.length}DKf(ib){return 0<=ib&&ib<this.x3b.length?this.x3b[ib]:null}getValue(ib){return 0<=ib&&ib<this.Nrd.length?this.Nrd[ib]:null}}Object(f.a)(Jl,"PredictionData",null,[]);class $i{constructor(ib,Ab){if(!ib)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("tokenAttributes");this.YHl=ib;this.cIl=Ab}eOf(){return this.YHl}uWh(){return this.cIl}}Object(f.a)($i,"PredictionDataWithTokenAttributes",null,[]);class Cg{constructor(ib,
Ab){this.prediction=null;this.score=0;this.prediction=ib;this.score=Ab}}Object(f.a)(Cg,"PredictionWithScore",null,[]);class qk{constructor(ib,Ab){if(!ib)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("attributes");this.VFj=ib;this.Rnj=Ab}eOf(){return this.VFj}uWh(){return this.Rnj}}Object(f.a)(qk,"PredictionsWithTokenAttributes",null,[]);class fj{constructor(ib,Ab,Tb){if(!ib)throw Error.argumentNull("attributeName");if(!Ab)throw Error.argumentNull("fieldNames");if(!Tb)throw Error.argumentNull("values");
if(Ab.length!==Tb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Qnj=ib;this.x3b=Ab;this.Nrd=Tb}get attributeName(){return this.Qnj}get pSh(){return this.x3b.length}DKf(ib){return 0<=ib&&ib<this.x3b.length?this.x3b[ib]:null}getValue(ib){return 0<=ib&&ib<this.Nrd.length?this.Nrd[ib]:null}}Object(f.a)(fj,"TokenAttributes",null,[]);var dj=b(42),wi=b(593);class ef{constructor(ib,Ab,Tb,lc,Hc){this.TJd=0;this.YQg=null;this.UJd=this.nIc=0;this.NGe=this.bec=this.Lxa=
this.oIc=null;this.ZQg=0;this.Z0e=this.cC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.kV=ib;this.phj=this.thj=Ab;this.ohj=this.rhj=Tb;this.RJd=this.qhj=lc;this.SJd=this.shj=Hc}uhj(){this.UJd=0;return this.WQg}WQg(){if(!(this.UJd<this.RJd))return this.XQg;this.oIc=this.phj.items[this.UJd+this.ohj];this.Lxa=new S.a(this.kV.Ra.Le);1!==this.RJd&&this.kV.Ra.Emd||this.Lxa.cab(this.oIc);if(0<=this.kV.Ra.Loe){({value:this.bec}=
this.Lxa.Xp(this.kV.Ra.Loe)).returnValue?this.bec=this.bec.zW():this.bec=new La.a(this.kV.Ra.Le,B.Annotations.kY);this.NGe=this.SJd.items;this.ZQg=this.NGe.length;for(this.TJd=0;this.TJd<this.ZQg;++this.TJd)this.YQg=this.NGe[this.TJd],Array.add(this.bec.items,this.YQg);this.Lxa.Ly(this.kV.Ra.Loe,this.bec)}else 0<=this.kV.Ra.wEg?this.Lxa.Ly(this.kV.Ra.wEg,this.SJd.items[0]):0<=this.kV.Ra.Pkf?this.Lxa.Ly(this.kV.Ra.Pkf,!0):this.kV.Ra.iki?this.SJd.items[0].dbe((ib,Ab)=>this.Lxa.Ly(ib,Ab)):(this.Lxa.cab(this.SJd.items[0]),
1!==this.RJd&&this.kV.Ra.Emd||(({value:this.nIc}=this.oIc.Xp(this.kV.Ra.s6)).returnValue&&this.Lxa.Ly(this.kV.Ra.s6,this.nIc),({value:this.nIc}=this.oIc.Xp(this.kV.Ra.T$)).returnValue&&this.Lxa.Ly(this.kV.Ra.T$,this.nIc),this.oIc.Xp(this.kV.Ra.arb).returnValue&&this.Lxa.Ly(this.kV.Ra.arb,this.nIc)));this.cC=this.Lxa;this._state=2;return this.whj}XQg(){this._state=3}vhj(){this.UJd++;return this.WQg}whj(){return 1<this.RJd&&this.kV.Ra.Emd?this.XQg:this.vhj}dispose(){}getEnumerator(){return-1===this._state?
(this._state=0,this):(new ef(this.kV,this.thj,this.rhj,this.qhj,this.shj)).getEnumerator()}[Symbol.iterator](){return Object(wi.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.Z0e=this.uhj());for(;1===this._state;)this.Z0e=this.Z0e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.cC}}Object(f.a)(ef,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[12,80,140]);class he{constructor(ib,Ab,Tb){this.Lrd=this.cti=0;this.Hxc=null;this.R9f=this.B9f=this.Fxc=this.mne=this.E9f=0;this.nne=!1;this.M9f=ib;this.T9f=Ab;this.XHl=Tb}c2h(){null===this.Hxc&&({p6i:this.Hxc,Xbi:this.E9f,length:this.mne,MDk:ib}=this.M9f.z7h(this.T9f.items[this.Lrd],this.XHl),this.nne=ib||this.nne);if(this.Fxc<this.mne){var ib=this.Hxc.charAt(this.E9f+this.Fxc);++this.Fxc;return{returnValue:!0,ch:ib}}if(this.Lrd===this.T9f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Lrd;
this.Fxc=0;this.Hxc=null;return{returnValue:!0,ch:" "}}Iqg(ib,Ab){this.Fxc===this.mne&&this.Hxc&&(this.R9f=Ab,this.B9f=this.Lrd-this.cti+1)}Pnm(ib){if(0>ib||ib>=this.T9f.items.length)throw Error.argumentOutOfRange("iToken");this.Lrd=this.cti=ib;this.Hxc=null;this.B9f=this.Fxc=this.mne=this.E9f=0;this.R9f=-1;this.nne=!1}UYk(){return{W6j:this.B9f,jBl:this.R9f,LDk:this.nne}}}Object(f.a)(he,"TriePrefixVisitor",null,[1502]);class We{constructor(ib){this.Ra=ib}execute(ib){if(!({value:Tb}=ib.Xp(this.Ra.PVa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Ab;({value:Ab}=ib.Xp(this.Ra.P9a)).returnValue||(Ab=null);var Tb=this.pMk(Tb,Ab);ib=B.Annotations.zW(ib);ib.Ly(this.Ra.PVa,Tb);return ib}pMk(ib,Ab){let Tb=null;const lc=this.Ra.flatLexicon.trie,Hc=new he(this,ib,Ab);let hd=null;this.Ra.flatLexicon.oYf()&&(hd=Object(dj.a)(this.Ra.flatLexicon,this.Ra.flatLexicon.ePk,"getCaseInsensitiveForm"));let ta=0,jb;var Mb;let xb;for(;ta<ib.items.length;){const Nc=ib.items[ta];Hc.Pnm(ta);lc.gej(Hc,hd);({W6j:jb,jBl:Mb,LDk:xb}=Hc.UYk());if(0<jb){({VCl:Mb}=this.Ra.flatLexicon.YMk(Mb));
for(let rc of this.xnk(ib,ta,jb,Mb)){1<jb&&this.Ra.Emd&&this.Ynk(ib,Ab,ta,Nc,jb,xb,rc);if(!Tb)for(Tb=new La.a(this.Ra.Le,B.Annotations.kY),Mb=0;Mb<ta;++Mb)Array.add(Tb.items,ib.items[Mb]);Array.add(Tb.items,rc)}ta+=jb}else Tb&&Array.add(Tb.items,Nc),++ta}return Tb||ib}Ynk(ib,Ab,Tb,lc,Hc,hd,ta){if(hd)hd=!0;else if(this.Ra.Rji){hd=!1;var jb=-1;for(var Mb=0;Mb<Hc;Mb++){var xb=ib.items[Tb+Mb];let Fc;var Nc=void 0;if(!({value:Fc}=xb.Xp(this.Ra.s6)).returnValue||!({value:Nc}=xb.Xp(this.Ra.T$)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Mb){if(Fc>jb+1){hd=!0;break}if(0>jb||null===Ab||jb>=Ab.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ab.charAt(jb)){hd=!0;break}}jb=Fc+Nc}}else hd=!1;if(hd){Nc=new Sys.StringBuilder;for(hd=0;hd<Hc;++hd)({p6i:jb,Xbi:Mb,length:xb}=this.z7h(ib.items[Tb+hd],Ab)),0<hd&&Nc.append(" "),Nc.append(jb.substr(Mb,xb));ta.Ly(this.Ra.arb,Nc.toString())}ib=ib.items[Tb+Hc-1];let rc,wd;({value:lc}=lc.Xp(this.Ra.s6)).returnValue&&
({value:rc}=ib.Xp(this.Ra.s6)).returnValue&&({value:wd}=ib.Xp(this.Ra.T$)).returnValue?(ta.Ly(this.Ra.s6,lc),ta.Ly(this.Ra.T$,rc+wd-lc)):(ta.SPa(this.Ra.s6),ta.SPa(this.Ra.T$))}xnk(ib,Ab,Tb,lc){return new ef(this,ib,Ab,Tb,lc)}z7h(ib,Ab){let Tb,lc;if(({value:Tb}=ib.Xp(this.Ra.arb)).returnValue)lc=!0,Ab=0,ib=Tb.length;else{lc=!1;if(null===Ab)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Tb=Ab;if(!({value:Ab}=ib.Xp(this.Ra.s6)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ib}=ib.Xp(this.Ra.T$)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ab||0>ib||Ab+ib>Tb.length)throw Error.argument("Token start/length values out of range","token");}return{p6i:Tb,Xbi:Ab,length:ib,MDk:lc}}}Object(f.a)(We,"FlatLexiconNLModule",null,[1488]);class nh{constructor(ib,Ab){this.Pkf=this.Loe=this.wEg=this.arb=this.T$=this.s6=this.P9a=this.PVa=0;this.iki=this.Rji=this.Emd=!1;this.flatLexicon=null;this.Le=Ab.Le;let Tb=0;
try{this.PVa=ib.J(Tb),++Tb,this.P9a=ib.J(Tb),++Tb,this.s6=ib.J(Tb),++Tb,this.T$=ib.J(Tb),++Tb,this.arb=ib.J(Tb),++Tb,this.wEg=ib.J(Tb),++Tb,this.Loe=ib.J(Tb),++Tb,this.Pkf=ib.J(Tb),++Tb,this.Emd=1===ib.J(Tb),++Tb,this.Rji=1===ib.J(Tb),++Tb,this.iki=1===ib.J(Tb),++Tb,this.flatLexicon=Ab.C3k(ib.J(Tb))}catch(lc){throw Error.argument("initData");}}}Object(f.a)(nh,"FlatLexiconNLModuleInit",null,[]);class Qj{constructor(){this.Ukd=0;this.eEf=null;this.kBd=0}}Object(f.a)(Qj,"FeatureGenStackRec",null,[]);
class Fh{constructor(ib){this.iJg=Array(ib);this.FGc=Array(ib);this.tGg=[];this.Y3i=[]}}Object(f.a)(Fh,"TokenStringLattice",null,[]);const wf=(ib,Ab,Tb)=>{for(let lc=0;lc<ib.length;lc++)Tb=Ab(Tb,ib[lc]);return Tb},Cj=(ib,Ab)=>{const Tb=Array(ib.length);for(let lc=0;lc<ib.length;lc++)Tb[lc]=Ab(ib[lc]);return Tb},yd=(ib,Ab)=>{Ab=Array(Math.min(Ab,ib.length));for(let Tb=0;Tb<Ab.length;Tb++)Ab[Tb]=ib[Tb];return Ab},te=(ib,Ab)=>{const Tb=[];for(const lc of ib)Ab(lc)&&Array.add(Tb,lc);return Tb};class me{constructor(ib,
Ab){this.key=ib;this.value=Ab}}Object(f.a)(me,"KeyValuePair",null,[]);const pk=(ib,Ab)=>({returnValue:Ab in ib,value:ib[Ab]}),Bi=ib=>{const Ab=[];for(let Tb in ib){const lc=new me(Tb,ib[Tb]);Array.add(Ab,lc)}return Ab};class td{constructor(ib){this.y7h=this.M8k;this.Ra=ib;this.pne=this.K9f=this.L9f=0;for(const Ab of this.Ra.cae)this.L9f=Math.max(this.L9f,Ab.Jkg),this.K9f=Math.max(this.K9f,Ab.Dkg),this.pne=Math.max(this.pne,Ab.oEb.length)}get eFk(){return this.Ra.PDe.trie}execute(ib){if(!ib)throw Error.argumentNull("input");
let Ab,Tb;({Sia:Ab,TBl:Tb}=this.N8k(ib));let lc=null,Hc=null,hd={};if(this.Ra.gnd){Ab=B.Annotations.zW(Ab);for(var ta=0;ta<Ab.items.length;++ta)Ab.items[ta]=B.Annotations.zW(Ab.items[ta])}else({jSh:Hc,returnValue:lc}=this.O2h(ib,hd));ta=Array(this.pne);const jb=Array(this.pne);for(var Mb=0;Mb<jb.length;++Mb)jb[Mb]=new Qj;for(Mb=-this.L9f;Mb<Ab.items.length+this.K9f;++Mb){let xb=null;this.Ra.gnd&&(xb=Ab.items[Mb],hd={},{jSh:Hc,returnValue:lc}=this.O2h(xb,hd));for(const Nc of this.Ra.cae){if(0>Mb&&
-Mb>Nc.Jkg||Mb>=Ab.items.length&&Mb-Ab.items.length+1>Nc.Dkg)continue;let rc=!0;for(let wd=0;wd<Nc.oEb.length;++wd){const Fc=Mb+Nc.oEb[wd];ta[wd]=Fc;if(0>Fc?0>this.Ra.Kkg:Fc>=Ab.items.length?0>this.Ra.Ekg:!Tb.FGc[Fc]){rc=!1;break}}rc&&({sqk:lc,tqk:Hc}=this.Dnl(Nc,Tb,lc,Hc,hd,jb,ta))}this.Ra.gnd&&(xb.Ly(this.Ra.Heb?this.Ra.Ymc:this.Ra.Wmc,lc),this.Ra.Heb&&xb.Ly(this.Ra.Xmc,Hc))}ib=B.Annotations.zW(ib);this.Ra.gnd?ib.Ly(this.Ra.PVa,Ab):(ib.Ly(this.Ra.Heb?this.Ra.Ymc:this.Ra.Wmc,lc),this.Ra.Heb&&ib.Ly(this.Ra.Xmc,
Hc));return ib}N8k(ib){let Ab,Tb;if(!ib||!({value:Ab}=ib.Xp(this.Ra.PVa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let lc;({value:lc}=ib.Xp(this.Ra.P9a)).returnValue||(lc="");Tb=new Fh(Ab.items.length);const Hc=te(this.Ra.mJg,hd=>!hd.Hld||hd.Hld.isMatch(ib,null));for(let hd=0;hd<Ab.items.length;++hd){const ta=Ab.items[hd];let jb=null;Tb.iJg[hd]=Tb.tGg.length;let Mb=Tb.FGc[hd]=0;for(const xb of Hc)0<xb.$rd&&Tb.FGc[hd]+Mb>=xb.$rd||xb.iGd&&!xb.iGd.isMatch(ta,
null)||({jGd:jb,Y5c:Mb}=xb.apply(this,ta,hd,Tb,lc,jb,Mb))}return{Sia:Ab,TBl:Tb}}Dnl(ib,Ab,Tb,lc,Hc,hd,ta){let jb=0;hd[0].Ukd=-1;for(hd[0].eEf=ib.XRi;;){var Mb=ta[jb],xb=0>Mb||Mb>=Ab.FGc.length?1:Ab.FGc[Mb];let wd=!1;for(;hd[jb].Ukd<xb-1;){++hd[jb].Ukd;var Nc=void 0,rc=void 0;0>Mb?(Nc=this.Ra.Kkg,rc=1):Mb>=Ab.iJg.length?(Nc=this.Ra.Ekg,rc=1):(rc=Ab.iJg[Mb]+hd[jb].Ukd,Nc=Ab.tGg[rc],rc=Ab.Y3i[rc]);hd[jb].kBd=rc*(jb?hd[jb-1].kBd:ib.score);if(({value:Nc}=pk(hd[jb].eEf,Nc.toString())).returnValue){jb===
ib.oEb.length-1?(Mb=Nc,hd[jb].kBd&&(({value:xb}=pk(Hc,Mb.toString())).returnValue||(xb=-1),0>xb&&(Tb=B.Annotations.zW(Tb),Array.add(Tb.items,Mb)),this.Ra.Heb&&(lc=B.Annotations.zW(lc),0>xb?Array.add(lc.items,hd[jb].kBd):lc.items[xb]+=hd[jb].kBd),0>xb&&(this.Ra.zmi||this.Ra.Heb)&&(Hc[Mb.toString()]=Tb.items.length-1))):(++jb,hd[jb].Ukd=-1,hd[jb].eEf=Nc);wd=!0;break}}if(!wd&&(--jb,0>jb))break}return{sqk:Tb,tqk:lc}}O2h(ib,Ab){let Tb;if(({value:Tb}=ib.Xp(this.Ra.Heb?this.Ra.Ymc:this.Ra.Wmc)).returnValue)for(let lc=
0;lc<Tb.items.length;++lc)Ab[Tb.items[lc].toString()]=lc;else Tb=new La.a(this.Ra.Le,B.Annotations.BRa);if(this.Ra.Heb){if(({value:Ab}=ib.Xp(this.Ra.Xmc)).returnValue||(Ab=new La.a(this.Ra.Le,B.Annotations.rxa)),Ab.items.length!==Tb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ra.Le.bja(B.Annotations.kY,ib));}else Ab=null;return{returnValue:Tb,jSh:Ab}}get UQm(){return this.Ra.PDe}M8k(ib,Ab){var Tb;if(({value:Tb}=
Ab.Xp(this.Ra.arb)).returnValue)ib=Tb;else{if(!({value:Tb}=Ab.Xp(this.Ra.s6)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ab}=Ab.Xp(this.Ra.T$)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Tb||0>Ab||Tb+Ab>ib.length)throw Error.argument("Token indices are out of range");ib=ib.substr(Tb,Ab)}return ib}}Object(f.a)(td,"NGramNLModule",null,[1488,1490]);class ci{constructor(ib){this.oEb=null;this.score=this.Dkg=this.Jkg=0;this.XRi=null;if(ib){var Ab=
0;try{if(ib.J(Ab)!==ci.NSb)throw Error.argument("initData","Input does not represent a feature template");++Ab;const Tb=ib.J(Ab);++Ab;this.oEb=Array(Tb);for(let lc=0;lc<Tb;++lc)this.oEb[lc]=ib.J(Ab),++Ab;this.Jkg=ib.J(Ab);++Ab;this.Dkg=ib.J(Ab);++Ab;this.score=ib.J(Ab);++Ab;this.XRi=({Rbi:Ab}=ci.VKi(ib,Ab)).returnValue}catch(Tb){throw Error.argument("initData");}}}static VKi(ib,Ab){const Tb=ib.J(Ab);++Ab;const lc={};for(let Hc=0;Hc<Tb;++Hc){const hd=ib.J(Ab);++Ab;ib.J(Ab)?lc[hd.toString()]=({Rbi:Ab}=
ci.VKi(ib,Ab)).returnValue:(++Ab,lc[hd.toString()]=ib.J(Ab),++Ab)}return{returnValue:lc,Rbi:Ab}}}ci.NSb=240803228;Object(f.a)(ci,"FeatureTemplate",null,[1505]);var Dg=b(1249);class Qi{constructor(ib,Ab){this.Heb=this.zmi=this.gnd=!1;this.arb=this.T$=this.s6=this.PVa=this.P9a=this.Xmc=this.Ymc=this.Wmc=0;this.PDe=null;this.Ekg=this.Kkg=0;this.cae=this.mJg=null;if(ib){this.Le=Ab.Le;var Tb=0;try{this.gnd=1===ib.J(Tb);++Tb;this.zmi=1===ib.J(Tb);++Tb;this.Heb=1===ib.J(Tb);++Tb;this.Wmc=ib.J(Tb);++Tb;this.Ymc=
ib.J(Tb);++Tb;this.Xmc=ib.J(Tb);++Tb;this.P9a=ib.J(Tb);++Tb;this.PVa=ib.J(Tb);++Tb;this.s6=ib.J(Tb);++Tb;this.T$=ib.J(Tb);++Tb;this.arb=ib.J(Tb);++Tb;this.PDe=this.v2l(Ab.uub(ib.J(Tb)));++Tb;this.Kkg=ib.J(Tb);++Tb;this.Ekg=ib.J(Tb);++Tb;const lc=ib.J(Tb);++Tb;this.mJg=Array(lc);for(let hd=0;hd<lc;++hd){const ta=ib.J(Tb);++Tb;const jb=this.PDe.trie,Mb=new $a.a;Mb.gub(ib,Tb,ta);this.mJg[hd]=this.y2l(Mb,Ab,jb);Tb+=ta}const Hc=ib.J(Tb);++Tb;this.cae=Array(Hc);for(Ab=0;Ab<Hc;++Ab){const hd=ib.J(Tb);++Tb;
const ta=new $a.a;ta.gub(ib,Tb,hd);this.cae[Ab]=this.g2l(ta);Tb+=hd}}catch(lc){throw Error.argument("initData");}}}v2l(ib){return new vj.a(new Ie.a(ib))}y2l(ib,Ab,Tb){return Dg.a.create(ib,Ab,Tb)}g2l(ib){return new ci(ib)}}Object(f.a)(Qi,"NGramNLModuleInit",null,[]);class ti{constructor(ib){this.Ra=ib}execute(ib){if(!ib)throw Error.argumentNull("input");ib=ib.clone();this.Ra.script.execute(ib,null);return ib}}Object(f.a)(ti,"ScriptNLModule",null,[1488]);class Ke{constructor(ib,Ab){ib&&(this.script=
Ab.IXb(ib.J(0)))}}Object(f.a)(Ke,"ScriptNLModuleInit",null,[]);const gi=ib=>{ib=Cj(ib,Ab=>Ab*Ab);return Math.sqrt(wf(ib,(Ab,Tb)=>Ab+Tb,0))},nf=ib=>wf(ib,(Ab,Tb)=>Ab>Tb?Ab:Tb,ib[0]);class Dh{constructor(ib){this.Ra=ib}execute(ib){if(!ib)throw Error.argumentNull("input");var Ab=[],Tb=[];this.rek(ib,Ab,Tb);this.uWj(Ab,Tb);const lc={};for(let hd=0;hd<Ab.length;++hd){var Hc=Ab[hd];const ta=this.Ra.gfi.J(Hc);Hc=this.Ra.hfi.J(Hc);for(let jb=0;jb<Hc;++jb){const Mb=this.Ra.j2.J(this.Ra.JBh.J(ta+jb)),xb=this.Ra.KBh.J(ta+
jb);let Nc;({value:Nc}=pk(lc,Mb)).returnValue||(Nc=0);lc[Mb]=Nc+Tb[hd]*xb}}Tb=Bi(lc);Tb.sort((hd,ta)=>{var jb=hd.value,Mb=ta.value;(jb=-(jb>Mb?1:jb<Mb?-1:0))||(jb=hd.key.localeCompare(ta.key));return jb});Ab=new La.a(this.Ra.Le,B.Annotations.kY);for(const hd of yd(Tb,this.Ra.OJl))Tb=new S.a(this.Ra.Le),Tb.Ly(this.Ra.S0j,hd.key),Tb.Ly(this.Ra.U0j,hd.value),Array.add(Ab.items,Tb);ib.Ly(this.Ra.T0j,Ab);return ib}rek(ib,Ab,Tb){if(({value:ib}=ib.Xp(this.Ra.R0j)).returnValue){let lc;if(({value:lc}=ib.Xp(this.Ra.Ymc)).returnValue){let Hc;
if(!({value:Hc}=ib.Xp(this.Ra.Xmc)).returnValue||lc.items.length!==Hc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.x5d(lc,Hc,Ab,Tb)}if(({value:lc}=ib.Xp(this.Ra.W0j)).returnValue){let Hc;if(!({value:Hc}=ib.Xp(this.Ra.X0j)).returnValue||lc.items.length!==Hc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.x5d(lc,Hc,Ab,Tb)}({value:lc}=ib.Xp(this.Ra.Wmc)).returnValue&&
this.x5d(lc,null,Ab,Tb);({value:lc}=ib.Xp(this.Ra.V0j)).returnValue&&this.x5d(lc,null,Ab,Tb)}}x5d(ib,Ab,Tb,lc){for(let hd=0;hd<ib.items.length;++hd){var Hc=void 0;ib.l8===B.Annotations.Bca?({value:Hc}=pk(this.Ra.oOh,ib.items[hd])).returnValue||(Hc=-1):(Hc=ib.items[hd],Hc=Hc>=this.Ra.Lag&&Hc<=this.Ra.pKl?this.Ra.scg?this.Ra.scg.J(Hc-this.Ra.Lag)-1:Hc-this.Ra.Lag:-1);if(0<=Hc){let ta;ta=Ab?Ab.items[hd]:1;0<ta&&(Array.add(Tb,Hc),Array.add(lc,ta))}}}uWj(ib,Ab){if(ib.length){switch(this.Ra.X9l){case 0:break;
case 1:for(var Tb=0;Tb<Ab.length;++Tb)Ab[Tb]=1+Math.log(Ab[Tb]);break;case 2:Tb=nf(Ab);for(let lc=0;lc<Ab.length;++lc)Ab[lc]=.5+Ab[lc]/Tb*.5;break;case 3:for(Tb=0;Tb<Ab.length;++Tb)Ab[Tb]=1;break;default:throw Error.notImplemented();}if(this.Ra.rie)for(Tb=0;Tb<Ab.length;++Tb)Ab[Tb]*=this.Ra.rie.J(ib[Tb]);ib=gi(Ab);for(Tb=0;Tb<Ab.length;++Tb)Ab[Tb]/=ib}}}Object(f.a)(Dh,"TfIdfRankerNLModule",null,[1488]);class Rj{constructor(ib,Ab=0){if(!ib)throw Error.argumentNull("byteArray");this.qne=Ab;if(604662927!==
ib.Ky(this.qne+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.gh=ib.Ky(this.qne+4,4);this.Nsi=ib.Ky(this.qne+8,4);this.MHl=ib}J(ib){if(0>ib||ib>=this.count)throw Error.argumentOutOfRange("index");return this.MHl.Xbm(8*this.qne+96+ib*this.Nsi,this.Nsi)}get count(){return this.gh}}Object(f.a)(Rj,"CompactIntArray",null,[1489]);const se=(ib,Ab)=>{Ab=Array(Ab);for(let hd=0;hd<Ab.length;hd++){var Tb=hd,lc=ib.Zba(),Hc=1===(lc>>31&1)?-1:1;const ta=lc&8388607;lc=
lc>>23&255;256===lc+1?Hc=ta?Number.NaN:1===Hc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:lc?(lc-=127,Hc=Hc*qf(ta,1)*Math.pow(2,lc)):Hc=Hc*qf(ta,0)*Math.pow(2,-126);Ab[Tb]=Hc}return Ab},qf=(ib,Ab)=>{let Tb=0;for(let lc=0;23>lc;lc++)Tb+=(ib>>22-lc&1)/Math.pow(2,lc+1);return Ab+Tb};class rk{constructor(ib,Ab){this.scg=null;this.cyi=0;this.hfi=this.gfi=this.rie=null;this.byi=0;this.KBh=this.JBh=null;this.Le=Ab.Le;let Tb=0;this.V0j=ib.J(Tb);++Tb;this.Wmc=ib.J(Tb);++Tb;this.W0j=ib.J(Tb);++Tb;this.X0j=
ib.J(Tb);++Tb;this.Ymc=ib.J(Tb);++Tb;this.Xmc=ib.J(Tb);++Tb;this.R0j=ib.J(Tb);++Tb;this.T0j=ib.J(Tb);++Tb;this.S0j=ib.J(Tb);++Tb;this.U0j=ib.J(Tb);++Tb;var lc=ib.J(Tb);++Tb;var Hc=Array(lc);for(var hd=0;hd<lc;++hd)Hc[hd]=Ab.getString(ib.J(Tb)),++Tb;this.j2=$a.a.fvf(Hc);this.OJl=ib.J(Tb);++Tb;this.X9l=ib.J(Tb);++Tb;lc=ib.J(Tb);++Tb;this.oOh={};for(Hc=0;Hc<lc;++Hc){hd=Ab.getString(ib.J(Tb));++Tb;const ta=ib.J(Tb);++Tb;this.oOh[hd]=ta}this.Lag=ib.J(Tb);++Tb;this.pKl=ib.J(Tb);++Tb;lc=ib.J(Tb);++Tb;0<
lc&&(lc=Ab.uub(ib.J(Tb)),++Tb,this.scg=this.Wse(new Uf(lc)));++Tb;ib=Ab.uub(ib.J(Tb));this.l2l(ib)}Wse(ib){return new Rj(ib.b5c,ib.offset)}l2l(ib){try{const Ab=new Uf(ib);this.cyi=Ab.Zba();1===Ab.Zba()?this.rie=$a.a.fvf(se(Ab,this.cyi)):this.rie=null;const Tb=Ab.Zba();this.gfi=this.Wse(Ab);Ab.offset+=Tb;const lc=Ab.Zba();this.hfi=this.Wse(Ab);Ab.offset+=lc;this.byi=Ab.Zba();const Hc=Ab.Zba();this.JBh=this.Wse(Ab);Ab.offset+=Hc;this.KBh=$a.a.fvf(se(Ab,this.byi))}catch(Ab){throw Error.argument("byteReader");
}}}Object(f.a)(rk,"TfIdfRankerNLModuleInit",null,[]);class Ue{constructor(ib,Ab,Tb,lc){this.Wig=ib;this.yTh=Tb;this.Sia=lc;this.Ssa=Ab;this.sDc=-1;this.Iye=0}}Object(f.a)(Ue,"TokenizerData",null,[]);class Tc{constructor(ib){this.Ra=ib}execute(ib){if(!ib)throw Error.argumentNull("input");if(!({value:lc}=ib.Xp(this.Ra.P9a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ab;({value:Ab}=ib.Xp(this.Ra.s6)).returnValue||(Ab=0);let Tb;({value:Tb}=
ib.Xp(this.Ra.T$)).returnValue||(Tb=lc.length-Ab);if(0>Ab||Ab>lc.length)throw Error.argument("input","Start index out of range");if(0>Tb||Tb>lc.length)throw Error.argument("input","Length out of range");if(Ab+Tb>lc.length)throw Error.argument("input","Bad start-length range");var lc=new Ue(lc,Ab,Ab+Tb,new La.a(this.Ra.Le,B.Annotations.kY));this.VQm(lc);ib=ib.isReadOnly?ib.clone():ib;ib.Ly(this.Ra.PVa,lc.Sia);return ib}VQm(ib){for(;ib.Ssa<ib.yTh;){if(this.Ra.zRf){var Ab=this.Ra.zRf.ssi(ib.Wig,ib.Ssa,
ib.yTh-ib.Ssa,null);!Ab.succeeded&&Ab.mxi&&(Ab=Ab.mxi);if(Ab.succeeded){this.wBi(ib,Ab.length,this.Ra.q9h);ib.Ssa+=Ab.length;continue}}Ab=ib.Wig.substr(ib.Ssa);let Tb=-1,lc=-1,Hc=-1;for(let hd=0;hd<this.Ra.Sxe.length;++hd){const ta=this.Ra.Sxe[hd].exec(Ab);ta&&0<ta[1].length&&(0>Tb||ta[0].length>lc)&&(Tb=hd,lc=ta[0].length,Hc=ta[1].length)}0<=Tb?(this.wBi(ib,Hc,this.Ra.Uvg[Tb]),ib.Ssa+=Hc):ib.Ssa+=1}}wBi(ib,Ab,Tb){if(this.Ra.wli)Tb!==Tc.e7j&&(0>ib.sDc&&(ib.sDc=ib.Ssa),ib.Iye=ib.Ssa+Ab-ib.sDc,Tb===
Tc.d7j&&(0<=ib.sDc&&0<ib.Iye&&(Ab=new S.a(this.Ra.Le),Ab.Ly(this.Ra.s6,ib.sDc),Ab.Ly(this.Ra.T$,ib.Iye),Ab.Ly(this.Ra.Mjf,Tc.f7j),Ab.Ly(this.Ra.P9a,ib.Wig),Array.add(ib.Sia.items,Ab)),ib.sDc=-1,ib.Iye=0));else{let lc=new S.a(this.Ra.Le);lc.Ly(this.Ra.s6,ib.Ssa);lc.Ly(this.Ra.T$,Ab);lc.Ly(this.Ra.Mjf,Tb);Array.add(ib.Sia.items,lc)}}}Tc.e7j="GAP";Tc.d7j="EOS_CHUNK";Tc.f7j="SENTENCE";Object(f.a)(Tc,"TokenizerNLModule",null,[1488]);class Kj{constructor(ib,Ab){this.T$=this.s6=this.Mjf=this.PVa=this.P9a=
0;this.wli=!1;this.Uvg=this.Sxe=this.q9h=this.zRf=null;if(ib){this.Le=Ab.Le;var Tb=0;try{this.P9a=ib.J(Tb);++Tb;this.PVa=ib.J(Tb);++Tb;this.Mjf=ib.J(Tb);++Tb;this.s6=ib.J(Tb);++Tb;this.T$=ib.J(Tb);++Tb;this.wli=1===ib.J(Tb);++Tb;var lc=ib.J(Tb);++Tb;0<lc&&(this.zRf=Ab.KMf(lc).eFk);this.q9h=ib.J(Tb)?Ab.getString(ib.J(Tb)):"";++Tb;const Hc=ib.J(Tb);++Tb;this.Sxe=Array(Hc);this.Uvg=Array(Hc);for(lc=0;lc<Hc;++lc)this.Sxe[lc]=new RegExp(Ab.getString(ib.J(Tb))),++Tb,this.Uvg[lc]=Ab.getString(ib.J(Tb)),
++Tb}catch(Hc){throw Error.argument("initData");}}}}Object(f.a)(Kj,"TokenizerNLModuleInit",null,[]);class di{constructor(ib){this.Ra=ib}execute(ib){if(!ib)throw Error.argumentNull("input");let Ab;if(!({value:Ab}=ib.Xp(this.Ra.Quh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Tb of this.Ra.HFg)Ab=Tb.apply(Ab);ib=B.Annotations.zW(ib);ib.Ly(this.Ra.Ruh,Ab);return ib}static Xif(ib,Ab){const Tb=new Sys.StringBuilder;for(let lc=0;lc<ib.length;++lc)Tb.append(Ab(ib.substr(lc,
1)));return Tb.toString()}}Object(f.a)(di,"TransliteratorNLModule",null,[1488]);class rj{constructor(ib){ib&&(this.style=ib.J(0))}apply(ib){return di.Xif(ib,Ab=>rj.u$j(Ab,this.style))}static u$j(ib,Ab){switch(Ab){case 0:return ib.toLowerCase();case 1:return"I"===ib?"\u0131":ib.toLowerCase();case 2:return ib.toUpperCase();case 3:return"i"===ib?"\u0130":ib.toUpperCase();default:throw Error.invalidOperation();}}}rj.OSb=0;Object(f.a)(rj,"ChangeCaseTransliterationStage",null,[1501]);class Ag{apply(ib){return di.Xif(ib,
Ag.ORm)}static ORm(ib){const Ab=ib.charCodeAt(0);return 65281<=Ab&&65374>=Ab?String.fromCharCode(Ab-65248):ib}}Ag.OSb=4;Object(f.a)(Ag,"LatinFullWidthToHalfWidthTransliterationStage",null,[1501]);class Sj{constructor(ib,Ab){ib&&(this.Kpg=Ab.Vsc(ib.J(0)),this.kmm=Ab.getString(ib.J(1)))}apply(ib){return ib.replace(this.Kpg,this.kmm)}}Sj.OSb=1;Object(f.a)(Sj,"RegexReplaceTransliterationStage",null,[1501]);class fg{constructor(ib,Ab){if(ib){var Tb=ib.J(0),lc=Ab.getString(ib.J(1)),Hc=new Rj(Ab.uub(ib.J(2)));
ib=0>ib.J(3)?null:new Rj(Ab.uub(ib.J(3)));this.KGg={};for(Ab=0;Ab<Tb;++Ab)this.KGg[lc.charAt(Ab).toString()]=lc.substr(Hc.J(Ab),ib?ib.J(Ab):1)}}apply(ib){return di.Xif(ib,Ab=>Ab in this.KGg?this.KGg[Ab]:Ab)}}fg.OSb=2;Object(f.a)(fg,"SingleCharSubstitutionsTransliterationStage",null,[1501]);class Bl{constructor(ib,Ab){this.Ruh=this.Quh=0;this.HFg=null;if(ib){this.Le=Ab.Le;var Tb=0;try{this.Quh=ib.J(Tb);++Tb;this.Ruh=ib.J(Tb);++Tb;const lc=ib.J(Tb);++Tb;this.HFg=Array(lc);for(let Hc=0;Hc<lc;++Hc){const hd=
ib.J(Tb);++Tb;const ta=ib.J(Tb);++Tb;const jb=new $a.a;jb.gub(ib,Tb,ta);Tb+=ta;this.HFg[Hc]=this.u2l(hd,jb,Ab)}}catch(lc){throw Error.argument("initData");}}}u2l(ib,Ab,Tb){switch(ib){case rj.OSb:return new rj(Ab);case Sj.OSb:return new Sj(Ab,Tb);case fg.OSb:return new fg(Ab,Tb);case Ag.OSb:return new Ag;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(f.a)(Bl,"TransliteratorNLModuleInit",null,[]);class fe{TZk(ib,Ab){const Tb=ib.J(0),lc=new $a.a;
lc.gub(ib,1,ib.count-1);switch(Tb){case 0:return new ti(new Ke(lc,Ab));case 2:return new Tc(new Kj(lc,Ab));case 3:return new td(new Qi(lc,Ab));case 5:return new We(new nh(lc,Ab));case 9:return new di(new Bl(lc,Ab));case 10:return new Dh(new rk(lc,Ab));default:throw Error.notImplemented();}}}Object(f.a)(fe,"NLModuleFactory",null,[1460]);class ac{constructor(ib){this.b7j=";";if(!ib)throw Error.argumentNull("resource");this.jna=new Bj(ib,new cb,new fe);this.M9f=this.jna.EZk();this.Msi=this.jna.Le.Wed("Text.Text");
this.Ksi=this.jna.Le.Wed("Classification.Predictions");this.z9f=this.jna.Le.Wed("Classification.PredictionString");this.Lsi=this.jna.Le.Wed("Classification.Probability");this.LHl=this.jna.Le.Wed("NLMod.Tokens");if(0>this.Msi||0>this.Ksi||0>this.z9f||0>this.Lsi)throw Error.argument("resourceObj","Resource does not represent a ranker");}XNk(){const ib=[];this.PCf(void 0,this.eXh(ib),null);return ib}ZNk(ib,Ab){const Tb=[],lc=[];this.PCf(ib,this.eXh(Tb),(Hc,hd)=>{const ta=this.jna.Le.UWh(Hc),jb=[],Mb=
[];Ab&&Ab.length&&-1===Array.indexOf(Ab,ta)||(Hc=this.jna.Le.getAttributeType(Hc),this.ZGi(Hc,hd,jb,Mb),hd=new fj(ta,jb,Mb),Array.add(lc,hd))});return new qk(Tb,lc)}YNk(ib){const Ab=[];this.PCf(ib,Tb=>{let lc;if(({value:lc}=Tb.Xp(this.z9f)).returnValue){let Hc;({value:Hc}=Tb.Xp(this.Lsi)).returnValue&&Array.add(Ab,new Cg(lc,Hc))}},null);return Ab}PCf(ib,Ab,Tb){var lc=new S.a(this.jna.Le);lc.Ly(this.Msi,ib);ib=this.M9f.execute(lc);if(({value:lc}=ib.Xp(this.Ksi)).returnValue)for(const Hc of lc.items)Ab(Hc);
if(Tb&&({value:Ab}=ib.Xp(this.LHl)).returnValue)for(const Hc of Ab.items)Hc.dbe(Tb)}ZGi(ib,Ab,Tb,lc){if(B.Annotations.dJ(ib))for(var Hc of Ab.items)this.ZGi(Ab.l8,Hc,Tb,lc);else if(B.Annotations.b$i(ib)){Hc=this.jna.Le.w2h(ib);for(let hd=0;hd<Hc;hd++)Array.add(Tb,this.jna.Le.Y5h(ib,hd)),Array.add(lc,this.jna.Le.bja(this.jna.Le.BZb(ib,hd),Ab.Eub(hd)))}else Array.add(Tb,"VALUE"),Array.add(lc,this.jna.Le.bja(ib,Ab))}eXh(ib){return Ab=>{let Tb;({value:Tb}=Ab.Xp(this.z9f)).returnValue&&Array.add(ib,this.y2k(Tb))}}y2k(ib){const Ab=
ib.indexOf(this.b7j);return 0>Ab?ib:ib.substring(0,Ab)}}Object(f.a)(ac,"Ranker",null,[]);var bh=b(1178),Ae=b(1195),Bk=b(1145),ze=b(1129),Nh=b(1126),Eg=b(2);class Oh{constructor(ib,Ab){this.v7g="";this.t5e=null;this.u5e=!1;this.Oxa=null;this.Tnj=["TellMe.TellMeParamCollection"];this.sc=ib;this.V6a=Ab;this.sc.J9a&&(this.Oxa=this.sc.Qbe())}get Eue(){if(!this.t5e&&!this.u5e){let ib=null;try{ib=window.TellMeModel}catch(Ab){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("QueryRanker",
"TellMeModel not found. Exception: "+Ab)}if(ib){try{this.t5e=new ac(ib)}catch(Ab){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ab)}this.u5e=!0}else if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("QueryRanker","Classifier model not found")}return this.t5e}Yaa(){return"Command"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb=!1,lc=c.a.tellMe,Hc=null){const hd=new v.a(ib);if((!Hc||Array.contains(Hc,
0))&&!Nh.a.eCa(ib)){if(!this.Eue&&this.u5e){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.sc.J9a&&this.Oxa&&this.Oxa.initialize();if(bh.isCommandHookQuery(ib.Bh)&&(Hc=bh.getCommandsFromQuery(ib.Bh),0<Hc.results.length)){Hc.displayName="Classifier Debug";hd.cF(Hc);Ab.resultsUpdated(hd);return}Hc=ib?this.v7g=ib.Bh:this.v7g;if(Eg.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Hc=
this.A2k(Hc);var ta=this.oce(Hc.eOf());Hc=Hc.uWh()}else Hc=this.z2k(Hc),ta=this.$Pk(Hc),Hc=[];bh.logCommandSuggestions(ta,!1,"Classifier","TFIDF");ta=bh.getResultGroup(ib,ta,this.sc,this.Oxa,this.V6a,Hc,0);0<ta.results.length&&lc!==c.a.contextMenu&&(ta.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Tb||ta.results.length||this.sc.oO||this.sc.z1a||(ib=new Bk.a("lookupNoResults",14,ib.Bh),ta.dI(ib));0<ta.results.length&&hd.cF(ta);hd.attributes=Hc}Ab.resultsUpdated(hd)}eOf(){let ib=[];try{ib=
this.Eue.XNk()}catch(Ab){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("GetPredictions","Exception: "+Ab)}return ib}z2k(ib){let Ab=[];try{Ab=this.Eue.YNk(ib)}catch(Tb){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("GetPredictionsWithScore","Exception: "+Tb)}return Ab}A2k(ib){try{return this.Eue.ZNk(ib,this.Tnj)}catch(Ab){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("GetPredictionsWithTokenAttributes","Exception: "+Ab)}return new qk([],[])}oce(ib){const Ab=
[];if(ib)for(const Tb of ib)Ab.push(new Ae.a(Tb,-99999));return Ab}$Pk(ib){const Ab=[];if(ib)for(const Tb of ib)Ab.push(new Ae.a(Tb.prediction,Tb.score));return Ab}}Object(f.a)(Oh,"CommandResultsProvider",null,[1249]);var Dd=b(1421);class sg{constructor(ib,Ab,Tb,lc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ib;this.CommandId=Ab;this.CommandValueId=Tb;this.InputText=lc}}Object(f.a)(sg,"FindInDocumentProp",null,[]);var hk=b(1207),Af=b(16);class le{constructor(ib){this.$8g=
3;this.GMb=[];this.Aob=[];this.sc=ib;le.YWb=ib.wEf;le.ZSh="FindInDocumentSuggestion";le.uGi="FindInDocumentSuggestion3";this.zSd=Object.assign(new hk.a,{landingTab:"Indoc",data:null});this.$Ij=this.sc.o1a||!!Eg.AFrameworkApplication.oa&&Eg.AFrameworkApplication.oa.mb.o1a}Yaa(){return"FindInDocument"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb=!1,lc,Hc=null){const hd=new v.a(ib);if(Hc&&!Array.contains(Hc,2))Ab.resultsUpdated(hd);else if(Array.clear(this.GMb),Nh.a.eCa(ib)){if(Tb&&this.Cjb()){Tb=
new z.a(2);Tb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;if(0<this.Aob.length){lc=1;for(var ta of this.Aob)this.Ybj(Tb,ta.Label,ta.CommandValueId,le.ZSh+lc,ta.InputText),lc++}ta=Nh.a.Dsb("",15,this.zSd);this.Ybj(Tb,CommonUIStrings.l_TellMeOpenFindPaneText,ta,le.uGi,"");hd.cF(Tb)}Ab.resultsUpdated(hd)}else ta=this.sc.dde(ib.Bh),lc="",Tb&&(Tb=this.$Ij?Nh.a.Dsb(ib.Bh,15,this.zSd):Af.a.we(ib.Bh),Hc=[],this.sc.mfb?(this.sc.JAe&&Hc.push(appChrome.actions.setControlIconSet(le.YWb,{"default":"FindInDocument_20"})),
lc=this.sc.L2f?Nh.a.VKf(ib.Bh,CommonUIStrings.l_FindInDocumentScopedButtonText):ib.Bh+CommonUIStrings.l_FindInDocumentScopedButtonText):lc=String.format(CommonUIStrings.l_TextWithQuotation,ib.Bh),Hc.push(appChrome.actions.setControlLabel(le.YWb,lc)),Hc.push(appChrome.actions.setButtonCommandValueId(le.YWb,Tb)),appChrome.api.dispatch(Hc),this.lXi(lc,le.YWb,Tb,ib.Bh)),ta.then(jb=>{const Mb=new Bk.a(le.YWb,8,ib.Bh);Mb.count=jb;jb=new z.a(2);jb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;
jb.dI(Mb);hd.cF(jb);Ab.resultsUpdated(hd)},jb=>{ze.TellMeActor.instance.tf.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+jb);jb=new Bk.a(le.YWb,8,ib.Bh);const Mb=new z.a(2);Mb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Mb.dI(jb);hd.cF(Mb);Ab.resultsUpdated(hd)})}Cjb(){return!!this.sc&&this.sc.Cjb}Ybj(ib,Ab,Tb,lc,Hc=null){const hd=[];Ab&&hd.push(appChrome.actions.setControlLabel(lc,Ab));hd.push(appChrome.actions.setButtonCommandValueId(lc,Tb));
appChrome.api.dispatch(hd);this.lXi(Ab,lc,Tb,"");ib.dI(new Bk.a(lc,8,Hc,null,-99999))}lXi(ib,Ab,Tb,lc){this.Cjb()&&this.GMb.length<this.$8g&&(ib=new sg(ib,Ab,Tb,lc),Array.add(this.GMb,ib))}tym(ib){for(let Ab=0;Ab<this.GMb.length;Ab++)if(this.GMb[Ab].CommandId===ib){const Tb=this.GMb[Ab].Label;let lc=!1;if(0<this.Aob.length){let Hc=0;for(const hd of this.Aob){if(hd.Label===Tb){Array.removeAt(this.Aob,Hc);lc=!0;break}Hc++}}!lc&&this.Aob.length>=this.$8g-1&&Array.removeAt(this.Aob,1);Array.insert(this.Aob,
0,this.GMb[Ab])}}}le.YWb=null;le.ZSh=null;le.uGi=null;Object(f.a)(le,"FindInDocumentResultsProvider",null,[1249]);class Cl{constructor(ib){this.sc=ib}Yaa(){return"Insights"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb=!1,lc,Hc=null){lc=new v.a(ib);if(!Hc||Array.contains(Hc,12))if(this.KEm()||!Nh.a.eCa(ib)){Hc=new z.a(12);var hd=new Bk.a("SmartLookupFromTellMe",10,ib.Bh);if(Tb){let ta=null;Nh.a.lZa()?""===ib.Bh.trim()?Tb=this.sc.LEm?CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:
(Tb=String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ib.Bh),ta=Nh.a.Dsb(ib.Bh,1)):(Tb=String.format(CommonUIStrings.l_InsightsButtonText,ib.Bh),ta=Nh.a.Yoc(ib.Bh));const jb=[];ta?(jb.push(appChrome.actions.setControlLabel("SmartLookupFromTellMe",Tb)),jb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ta))):(jb.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeZeroTerm",Tb)),hd=new Bk.a("SmartLookupFromTellMeZeroTerm",10,ib.Bh));hd.label=Tb;appChrome.api.dispatch(jb)}Hc.dI(hd);
lc.cF(Hc)}Ab.resultsUpdated(lc)}KEm(){return Nh.a.lZa()&&this.sc.IOm}}Object(f.a)(Cl,"InsightsResultsProvider",null,[1249]);var Ph=b(1418);class mn{constructor(ib){this.sc=ib}Yaa(){return"Learning"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb,lc,Hc=null){Tb=new v.a(ib);Hc&&!Array.contains(Hc,20)||!Nh.a.eCa(ib)||(Hc=[],lc=this.sc.hoi,Hc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",lc)),lc=mn.fVk(lc),Hc.push(appChrome.actions.setControlLabel("LearningForSearch",lc)),
appChrome.api.dispatch(Hc),ib=new Bk.a("LearningForSearch",22,ib.Bh),Hc=new z.a(20),Hc.dI(ib),Tb.cF(Hc));Ab.resultsUpdated(Tb)}static fVk(ib){const Ab=[];Array.add(Ab,new Ph.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ab,new Ph.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Ab,new Ph.a(600,ib));Array.add(Ab,new Ph.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ib={};ib.parts=Ab;return JSON.stringify(ib)}}Object(f.a)(mn,"LearningProvider",null,[1249]);var Fi=
b(423);class Kk{constructor(ib,Ab){this.iic=this.Jlc=this.cpb=this.uTd=null;this.Au=!1;this.Nic=ib;this.mrj=Ab;ib&&this.TRh(ib)}xEe(){this.Nic.xEe()&&this.TRh(this.Nic)}h7k(ib){let Ab=[];var Tb=[];ib=Kk.bPl(ib);var lc="";Array.clear(Tb);for(let Hc=0;Hc<ib.length;Hc++){const hd=ib.charAt(Hc);-1!==" ".indexOf(hd)?(lc.length&&Array.add(Tb,lc),lc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(hd)?(lc.length&&Array.add(Tb,lc),lc=hd,Array.add(Tb,lc),lc=""):lc+=hd}lc.length&&Array.add(Tb,lc);for(ib=
0;ib<Tb.length;ib++)lc=this.ZPk(Tb[ib]),lc=this.Fik(lc),Ab=Kk.bLl(Ab,lc);return Ab=this.YRj(Ab)}B0f(){this.Au||this.xEe();return this.Au}e8d(ib){return this.uTd[ib.toString()]}YRj(ib){for(let Ab=0;Ab<ib.length;Ab++){const Tb=this.cpb[Ab];if(ib[Ab].commandId!==this.e8d(Tb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let lc;(lc=ib[Ab]).score=lc.score+Tb[1]}return ib}Fik(ib){const Ab=[];for(var Tb=0;Tb<this.cpb.length;Tb++)Ab.push(new Ae.a(this.e8d(this.cpb[Tb][0]),-5));Tb=new Fi.a;
for(var lc=0;lc<ib.length;lc++)Tb.add(this.e8d(ib[lc][0]));for(lc=0;lc<Ab.length;lc++){const hd=Ab[lc];for(let ta=0;ta<ib.length;ta++){var Hc=ib[ta];const jb=this.e8d(Hc[0]);Hc=Hc[1];if(jb===hd.commandId){hd.score=Hc;Tb.remove(jb);break}}if(!Tb.count)break}return Ab}ZPk(ib){const Ab=1>ib.length;for(let ta=0;2>=ta;ta++){const jb=this.iic;for(let Mb in jb){var Tb=jb[Mb],lc=ib,Hc=Mb;const xb=Hc.length+1,Nc=Array((lc.length+1)*xb);for(var hd=0;hd<=lc.length;hd++)Nc[hd*xb]=hd;for(hd=0;hd<=Hc.length;hd++)Nc[hd]=
hd;for(hd=0;hd<Hc.length;hd++)for(let rc=0;rc<lc.length;rc++)Nc[(rc+1)*xb+(hd+1)]=lc.charAt(rc)===Hc.charAt(hd)?Nc[rc*xb+hd]:Math.min(Math.min(Nc[rc*xb+(hd+1)]+1,Nc[(rc+1)*xb+hd]+1),Nc[rc*xb+hd]+1);lc=Nc[lc.length*xb+Hc.length];if((!lc||!Ab)&&lc<=ta)return Tb}}return this.Jlc}TRh(ib){this.uTd=ib.HMf();this.cpb=ib.f3k();this.Jlc=ib.B9k();this.iic=ib.FXk();if(this.Au=!!this.uTd&&!!this.cpb&&!!this.iic&&!!this.Jlc)this.Au=0<this.cpb.length&&Kk.eYf(this.cpb);this.Au&&(this.Au=0<this.Jlc.length&&Kk.eYf(this.Jlc));
this.Au&&(this.iic=Kk.j$k(this.iic));this.Au||(this.iic=this.Jlc=this.cpb=this.uTd=null)}W8k(ib){ib=this.h7k(ib);return this.ZEk(ib,this.mrj)}ZEk(ib,Ab){let Tb=[];for(let lc=0;lc<ib.length;lc++)ib[lc].score>=Ab&&Tb.push(ib[lc]);Tb.sort((lc,Hc)=>lc.score<Hc.score?1:lc.score>Hc.score?-1:0);0<Tb.length-10&&(Tb=Tb.slice(0,10));return Tb}static bLl(ib,Ab){if(!ib.length)return Ab;if(ib.length!==Ab.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let Tb=0;Tb<ib.length;Tb++){if(ib[Tb].commandId!==Ab[Tb].commandId)throw Error.create("Incorrect CommandId");let lc;(lc=ib[Tb]).score=lc.score+Ab[Tb].score}return ib}static bPl(ib){return Af.a.Cf(ib)}static eYf(ib){for(let Ab=0;Ab<ib.length;Ab++)if(2!==ib[Ab].length)return!1;return!0}static j$k(ib){const Ab={};for(let Hc in ib){var Tb=Hc,lc=ib[Hc];const hd=lc;hd.length&&Kk.eYf(hd)&&(Ab[Tb]=lc)}return Ab}}Object(f.a)(Kk,"NaiveBayesClassifierModel",null,[]);class Lj{constructor(ib,Ab){this.Oxa=
null;this.sc=ib;this.sWc=new Kk(Ab,ib.UZk);this.sc.J9a&&(this.Oxa=this.sc.Qbe())}Yaa(){return"NBCommand"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb=!1,lc=c.a.tellMe,Hc=null){const hd=new v.a(ib);if((!Hc||Array.contains(Hc,0))&&!Nh.a.eCa(ib)){if(bh.isCommandHookQuery(ib.Bh)&&(Hc=bh.getCommandsFromQuery(ib.Bh),0<Hc.results.length)){Hc.displayName="Classifier Debug";hd.cF(Hc);Ab.resultsUpdated(hd);return}if(!this.sWc.B0f()){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("CRASH",
"NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.sc.J9a&&this.Oxa&&this.Oxa.initialize();Hc=this.sWc.W8k(ib.Bh);bh.logCommandSuggestions(Hc,!1,"Classifier","NaiveBayesian");Hc=bh.getResultGroup(ib,Hc,this.sc,this.Oxa,null,null,0);0<Hc.results.length&&lc!==c.a.contextMenu&&(Hc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Tb||Hc.results.length||this.sc.oO||this.sc.z1a||(ib=new Bk.a("lookupNoResults",
14,ib.Bh),Hc.dI(ib));0<Hc.results.length&&hd.cF(Hc)}Ab.resultsUpdated(hd)}}Object(f.a)(Lj,"NaiveBayesCommandProvider",null,[1249]);class il{constructor(){this.BMb=null;this.Au=!1;this.xEe()}xEe(){this.Au||(this.BMb=window.NBCRM)&&4===this.BMb.length&&(this.Au=!0);return this.Au}f3k(){return this.Au?this.BMb[1]:null}B9k(){return this.Au?this.BMb[2]:null}FXk(){return this.Au?this.BMb[3][0]:null}HMf(){return this.Au?this.BMb[0][0]:null}}Object(f.a)(il,"NaiveBayesModelAdapter",null,[1362]);var xd=b(74),
lg=b(293),cd=b(1211),Pf=b(1193),sk=b(1210),jl=b(30),Sb=b(129),Th=b(1114);class Gi{constructor(ib){this.rS=null;this.a5=-1;this.N$f=14;this.Q$f=12;this.attributes=this.query=null;this.owc=!1;this.NWd=[];this.Re=Eg.AFrameworkApplication.je;Eg.AFrameworkApplication.K&&(this.N$f=Eg.AFrameworkApplication.K.vb("TellMeMaxTermedResults",this.N$f),this.Q$f=Eg.AFrameworkApplication.K.vb("TellMeMaxZeroTermResults",this.Q$f));this.h8=ib}get Uw(){return this.NWd}cF(ib){let Ab=!1;for(let Tb=0;Tb<this.Uw.length;Tb++)if(21!==
this.Uw[Tb].groupType&&this.Uw[Tb].groupType===ib.groupType){this.pSj(this.Uw[Tb],ib);Ab=!0;break}Ab||this.Uw.push(ib)}pSj(ib,Ab){for(let Tb=0;Tb<Ab.results.length;Tb++)ib.dI(Ab.results[Tb])}bOi(ib){const Ab=[];for(const Tb of this.Uw)Tb.groupType!==ib&&Ab.push(Tb);this.Uw.length!==Ab.length&&(this.NWd=Ab)}hjm(ib){let Ab=null,Tb=null,lc=null;for(let Hc=0;Hc<ib.length;Hc++){const hd=ib[Hc];if(hd&&hd.Uw&&hd.Uw.length)for(const ta of hd.Uw)16===ta.groupType||17===ta.groupType?Ab=ta:ta.groupType&&15!==
ta.groupType||(Tb=ta,lc=hd)}Ab&&Tb&&(16===Ab.groupType&&({Kef:Tb,Bff:Ab}=bh.addHighConfidenceResultsFromLocalMLProvider(Tb,Ab,this.h8.u_()?this.h8.u_().JPk:-.6)),lc.bOi(Tb.groupType))}lJm(){new xd.a;this.PEg(this.h8.nti)}Vod(ib,Ab){return this.h8.u_()&&this.h8.u_().Fki&&this.query.Bh.length>this.h8.u_().u4h&&this.ewl(ib,Ab)||this.h8.u_()&&this.h8.u_().Oli&&this.query.Bh.length>this.h8.u_().v4h&&this.hyl(ib,Ab)?!0:!1}hyl(ib,Ab){return ib&&ib.length&&Ab&&Ab.length?-1===Ab.toLowerCase().indexOf(ib.toLowerCase())?
!1:!0:!1}ewl(ib,Ab){return ib&&ib.length&&Ab&&Ab.length?Ab.toLowerCase().startsWith(ib.toLowerCase()):!1}dFk(ib){const Ab=[];for(const Tb of this.Uw)ib.contains(Tb.groupType)||Ab.push(Tb);this.NWd=Ab}yZm(ib,Ab){const Tb=[];for(const lc of this.Uw){const Hc=lc;if(12!==Hc.groupType){const hd=ib[Pf.a[Hc.groupType].toLowerCase()];let ta="False";hd<Ab&&(ta="True");Hc.displayName=Hc.displayName+" ("+ta+": "+hd+")"}Tb.push(Hc)}this.NWd=Tb}PEg(ib){const Ab=new xd.a;for(;this.Uw.length;){var Tb=this.Uw.pop();
const lc=Pf.a[Tb.groupType].toLowerCase(),Hc=ib[lc];if(Th.c(Hc))throw Error.create("GroupId "+lc+" missed from group SortingOrder");Ab.add(new lg.a(Hc,Tb))}Ab.Sc((lc,Hc)=>lc.key<Hc.key?-1:1);for(ib=0;ib<Ab.count;ib++)Tb=Ab.J(ib).value,this.Uw.push(Tb)}mJm(){var ib=!1;let Ab=!1,Tb=!1;for(let Hc=0;Hc<this.Uw.length;Hc++){var lc=this.Uw[Hc];const hd=lc.groupType;if(7===hd||14===hd||13===hd){lc=lc.results;for(let ta=0;ta<lc.length;ta++){if(7===hd&&this.Vod(this.query.Bh,lc[ta].label)){ib=!0;break}if(14===
hd&&this.Vod(this.query.Bh,lc[ta].label)){Ab=!0;break}if(13===hd){if(this.Vod(this.query.Bh,lc[ta].label)||this.Vod(this.query.Bh,lc[ta].description)){Tb=!0;break}const jb=lc[ta].label.split(" ");for(const Mb of jb)if(this.Vod(this.query.Bh,Mb)){Tb=!0;break}}}}}ib=this.h8.R4k(ib,Ab,Tb);this.PEg(ib)}d7b(ib,Ab,Tb,lc,Hc,hd){if(Hc===this.rS){Hc=ib.data.wd;var ta=null;try{ta=jl.b(Hc)}catch(rc){ze.TellMeActor.instance.tf.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
rc);return}if("RankerResults"in ta&&ta.RankerResults){this.hKa();var jb=ta.RankerResults;ta=new xd.a;Hc=new xd.a;var Mb=0;for(var xb of jb){jb=xb.ProviderId;var Nc=xb.Score;Mb+=Nc;ta.add(new lg.a(jb,Nc))}ta.Sc((wd,Fc)=>wd.value>Fc.value?-1:1);xb=hd?hd.w5h:1E-6;jb={};Nc={};let rc=0;for(let wd=0;wd<ta.count;wd++){let Fc=parseInt(ta.J(wd).key),qe=ta.J(wd).value/Mb;1===Fc&&(Nc.answer=rc++,Nc.entity=rc++,Nc.definition=rc++,Nc.wolframanswer=rc++,qe<xb&&(Hc.add(8),Hc.add(10),Hc.add(9),Hc.add(11)),jb.answer=
qe,jb.entity=qe,jb.definition=qe,jb.wolframanswer=qe);2===Fc&&(Nc.assistance=rc++,qe<xb&&Hc.add(7),jb.assistance=qe);3===Fc&&(Nc.classifier=rc++,Nc.serviceclassifier=rc++,qe<xb&&(Hc.add(0),Hc.add(16)),jb.classifier=qe,jb.serviceclassifier=qe);4===Fc&&(Nc.people=rc++,qe<xb&&Hc.add(13),jb.people=qe);5===Fc&&(Nc.document=rc++,qe<xb&&Hc.add(14),jb.document=qe);6===Fc&&(Nc.findindocument=rc++,qe<xb&&Hc.add(2),jb.findindocument=qe);7===Fc&&(Nc.notes=rc++,qe<xb&&Hc.add(19),jb.notes=qe);8===Fc&&(Nc.image=
rc++,qe<xb&&Hc.add(18),jb.image=qe)}ta=new xd.a;ta.add("classifier");ta.add("serviceclassifier");ta.add("appsforoffice");ta.add("findindocument");ta.add("assistance");ta.add("document");ta.add("people");ta.add("answer");ta.add("wolframanswer");ta.add("definition");ta.add("entity");ta.add("image");for(Mb=0;Mb<ta.count;Mb++)ta.J(Mb)in Nc||(Nc[ta.J(Mb)]=rc++);Nc.learning=rc++;Nc.insights=rc++;this.PEg(Nc);hd&&hd.yji&&this.yZm(jb,xb);hd&&hd.zji&&this.dFk(Hc);lc.resultsUpdated(this);lc=ze.TellMeActor.instance.tf;
this.owc&&lc&&(Hc=this.query.t8b,ta=lc.cNd,hd.mle&&Hc>ta&&(lc.j8f(this.query.Bh),lc.Iyg(Hc)));lc.Mba(Ab.length,"RankerInference",ib.data.mf.toString(),Math.round(window.performance.now()-Tb),sk.a.Z5i,!0,cd.a.rYa)}}}M6b(ib,Ab,Tb,lc){lc===this.rS&&(this.hKa(),ze.TellMeActor.instance.tf.Mba(Ab.length,"RankerInference",ib.data.mf.toString(),Math.round(window.performance.now()-Tb),sk.a.Z5i,!1,cd.a.rYa))}hKa(){-1!==this.a5&&(window.clearTimeout(this.a5),this.a5=-1)}nJm(ib){const Ab=ze.TellMeActor.instance.tf.i6h(this.Uw,
this.query.Bh);var Tb=this.h8.u_().dPf;""!==Tb&&(Tb="_"+Tb);Tb=ze.TellMeActor.instance.tf.Z6h("RankerInference"+Tb);const lc=this.rS=Sb.a.create().toString();Tb["Client-Request-Id"]=lc;const Hc=window.performance.now(),hd=this.h8.u_()?this.h8.u_().x5h:1E3;this.hKa();this.a5=window.setTimeout(()=>{if(lc===this.rS){this.rS="";this.a5=-1;ib.resultsUpdated(this);const ta={};ta[n.a.provider]="Ranker";ta[n.a.KAc]=this.query.t8b;ze.TellMeActor.instance.tf.$G(m.a.timedOut,hd,ta)}},hd);this.Re.Ki(ze.TellMeActor.instance.tf.$6h(),
2,Ab,Tb,!1,0,ta=>{this.d7b(ta,this.query.Bh,Hc,ib,lc,this.h8.u_())},ta=>{this.M6b(ta,this.query.Bh,Hc,lc)},null,null,!1,4E3,6E3)}iSm(){var ib=0,Ab=new xd.a,Tb=this.h8.lti,lc=this.h8.mti;for(var Hc=0;Hc<this.Uw.length;Hc++){var hd=this.Uw[Hc],ta=Pf.a[hd.groupType].toLowerCase(),jb=Tb[ta];ib+=hd.results.length;hd.results.length>jb&&(ta=lc[ta],Th.c(ta)||Ab.add(new lg.a(ta,hd)))}lc=!this.query||""===this.query.Bh.trim();Hc=ib-(lc?this.Q$f:this.N$f);if(!(0>=Hc)){lc=window.performance.now();ib=ib.toString()+
" total,"+Hc.toString()+" to remove.";if(0<Ab.count)for(Ab.Sc((Mb,xb)=>Mb.key>xb.key?-1:1),hd=0;hd<Ab.count&&0<Hc;hd++){ta=Ab.J(hd).value;jb=Pf.a[ta.groupType].toLowerCase();let Mb=ta.results.length-Tb[jb];Mb>Hc&&(Mb=Hc);0<Mb&&(ta.Qrg(Mb),ib+=jb+": "+Mb.toString()+" results removed.",Hc-=Mb)}if(0<Hc){ib+=Hc.toString()+" results left after trimming.";Ab=new xd.a;Tb=this.h8.oti;for(hd=0;hd<this.Uw.length;hd++)ta=this.Uw[hd],jb=Tb[Pf.a[ta.groupType].toLowerCase()],Th.c(jb)||Ab.add(new lg.a(jb,ta));Ab.Sc((Mb,
xb)=>Mb.key<xb.key?-1:1);for(Tb=0;0<Hc;)hd=Ab.J(Tb++).value,Hc>=hd.results.length?(Array.remove(this.Uw,hd),ib+=Pf.a[hd.groupType]+": "+hd.results.length.toString()+" results force removed.",Hc-=hd.results.length):(hd.Qrg(Hc),ib+=Pf.a[hd.groupType]+": "+Hc.toString()+" results force removed.",Hc=0)}ze.TellMeActor.instance.tf&&(Ab={},Ab[n.a.message]=ib,ze.TellMeActor.instance.tf.$G("ShowOptimal",window.performance.now()-lc,Ab))}}}Object(f.a)(Gi,"CombineResultsUpdatedEventArgs",null,[1328]);var Lk=
b(1303);class Dj{constructor(ib,Ab,Tb,lc=!1,Hc=""){this.W3e=this.P6e=!1;this.Vs=ib;this.kOb=[];this.aeh=Ab.length;this.sc=ze.TellMeActor.instance.u_();this.VRd=lc;this.VPb=Hc;this.e1c={};for(ib=0;ib<Ab.length;++ib)this.e1c[ib.toString()]=Tb?0:Ab[ib].Wta()}Jzm(ib,Ab){Ab&&Ab.query&&Ab.query.t8b<ze.TellMeActor.instance.mza||(this.kOb[ib]=Ab,this.W3e?this.P6e=!0:this.OYa())}U2l(){this.W3e=!0}TUm(){this.W3e=!1;this.P6e&&(this.P6e=!1,this.OYa())}Yuk(){if(this.kOb.length<this.aeh)return!1;for(let ib=0;ib<
this.aeh;++ib)if(!this.kOb[ib])return!1;return!0}OYa(){var ib=this.Yuk();const Ab=window.performance.now(),Tb=new Gi(ze.TellMeActor.instance.D1g);Tb.hjm(this.kOb);for(var lc=0;lc<this.kOb.length;++lc){var Hc=this.kOb[lc];if(Hc&&Hc.Uw&&Hc.Uw.length&&(Tb.query=Hc.query,Hc.attributes&&0<Hc.attributes.length&&(Tb.attributes=Hc.attributes),Hc&&Hc.Uw&&(ib||this.fbk(lc,this.kOb))))for(const hd of Hc.Uw)Tb.cF(hd)}Tb.Uw&&Tb.Uw.length&&(Tb.owc=ib,this.sc&&this.sc.jEe&&Tb.iSm(),Lk.a.Hli()&&(this.sc&&this.sc.jli&&
Tb.query.Bh&&0<Tb.query.Bh.length?Tb.mJm():Tb.lJm()),this.Vs.resultsUpdated(Tb),Lk.a.Hli()&&this.sc&&this.sc.A0f&&this.VRd&&Tb.query.Bh&&0<Tb.query.Bh.length&&Tb.owc&&this.VPb!==c.a.contextMenu&&Tb.nJm(this.Vs),ib=ze.TellMeActor.instance.tf,Tb.owc&&ib&&(lc=Tb.query.t8b,Hc=ib.cNd,Tb.query.Bh&&0<Tb.query.Bh.length&&this.VRd&&this.sc.mle&&this.VPb!==c.a.contextMenu&&lc>Hc&&!this.sc.A0f&&(ib.j8f(Tb.query.Bh),ib.Iyg(lc)),ib.$G(m.a.Lom,window.performance.now()-Ab)))}fbk(ib,Ab){if(!(this.e1c&&ib.toString()in
this.e1c)||Ab.length<=ib||!Ab[ib])return!1;if(!Ab[ib].Uw.length)return!0;const Tb=this.e1c[ib.toString()];if(!Tb)return!0;const lc=this.e1c;for(let hd in lc){var Hc=lc[hd];const ta=Number.parseInvariant(hd);if(ta!==ib&&Hc===Tb&&!(Ab.length>ta&&Ab[ta]))return!1}return!0}}Object(f.a)(Dj,"ResultsAggregator",null,[]);var bl=b(1439);class If{constructor(){this.uGc=this.vGc=this.tGc=this.logCount=this.logRank=this.invertedRank=0}JQj(ib,Ab){switch(ib){case 1:this.invertedRank=Ab;break;case 3:this.logRank=
Ab;break;case 2:this.logCount=Ab;break;case 5:this.tGc=Ab;break;case 4:this.vGc=Ab;break;case 6:this.uGc=Ab}}}Object(f.a)(If,"CommandFeatures",null,[]);class eo{constructor(ib){this.D_g=0;this.ZBj=ib;this.Zpj={}}get modelId(){return this.ZBj}get featureIntercept(){return this.D_g}get O7c(){return this.Zpj}dQj(ib,Ab,Tb){Ab?(this.O7c[ib]||(this.O7c[ib]=new If),this.O7c[ib].JQj(Ab,Tb)):this.D_g=Tb}}Object(f.a)(eo,"CoefficientsModel",null,[]);const ql=(ib,Ab)=>Math.pow(10,-Ab/(60*Math.LN10/Math.LN2*ib));
class Mk{constructor(ib,Ab){this.gh=1;this.zOd=new If;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ib?1/ib:0;this.features.logRank=2/Math.pow(2,ib);this.features.tGc=ql(10,Ab);this.features.vGc=ql(2,Ab);this.features.uGc=ql(1,Ab)}get count(){return this.gh}get features(){return this.zOd}kuc(){this.gh=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}qZm(ib){const Ab=2/Math.pow(2,ib);this.features.invertedRank=Math.max(this.features.invertedRank,
ib?1/ib:0);this.features.logRank=Math.max(this.features.logRank,Ab)}u_m(ib){const Ab=ql(10,ib),Tb=ql(2,ib);ib=ql(1,ib);this.features.tGc=Math.max(this.features.tGc,Ab);this.features.vGc=Math.max(this.features.vGc,Tb);this.features.uGc=Math.max(this.features.uGc,ib)}}Object(f.a)(Mk,"CommandModel",null,[]);class Gh{constructor(ib){this.xNc=null;if(!ib&&ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("PredictionEngine","IModelAdapter can't be null");this.Nic=ib;this.tTd=this.B5f()}B5f(){const ib=
this.Nic.AZk(),Ab=this.Nic.HMf();if(void 0===ib||null===ib||void 0===Ab||null===Ab)return!1;try{window.performance.now();this.xNc={};for(let Tb=0;Tb<ib.length;Tb++){const lc=ib[Tb],Hc=Ab[lc[0].toString()].trim(),hd=lc[1],ta=hd?Ab[lc[2].toString()].trim():"",jb=lc[3];Hc in this.xNc||(this.xNc[Hc]=new eo(Hc));this.xNc[Hc].dQj(ta,hd,jb)}}catch(Tb){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("LoadModelData","Error Loading Suggestions Model: "+Tb);return!1}return!0}$Kk(){const ib=
this.Nic.gXk(),Ab={};if(!ib)return Ab;let Tb=1;for(let lc=0;lc<ib.length;lc++){const Hc=ib[lc];Hc.Id in Ab?(Ab[Hc.Id].kuc(),Ab[Hc.Id].qZm(Tb),Ab[Hc.Id].u_m(Hc.TimeElapsedSinceClick)):Ab[Hc.Id]=new Mk(Tb,Hc.TimeElapsedSinceClick);Tb++}return Ab}B0f(){this.tTd||(this.tTd=this.B5f());return this.tTd}x2k(){let ib=[];if(!this.tTd){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("GetPredictedCommands","IModelAdapter returned no data");return ib}const Ab=this.$Kk(),Tb=this.xNc;for(let Hc in Tb){const hd=
Tb[Hc],ta=hd.modelId;let jb=0;for(let Mb in Ab){var lc=Mb;const xb=Ab[Mb].features;(lc=lc in hd.O7c?hd.O7c[lc]:null)&&(jb+=xb.invertedRank*lc.invertedRank+xb.logRank*lc.logRank+xb.logCount*lc.logCount+xb.tGc*lc.tGc+xb.vGc*lc.vGc+xb.uGc*lc.uGc)}jb+=hd.featureIntercept;ib.push(new Ae.a(ta,jb))}ib.sort((Hc,hd)=>Hc.score<hd.score?1:Hc.score>hd.score?-1:0);0<ib.length-10&&(ib=ib.slice(0,10));return ib}}Object(f.a)(Gh,"PredictionEngine",null,[]);class Ck{constructor(){this.Dgh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}oce(ib,Ab){return Ab&&"word"===Ab.application.toLowerCase()&&
ib in this.Dgh?this.Dgh[ib]:[]}}Object(f.a)(Ck,"SuggestionResultsUtility",null,[]);class Um{constructor(ib,Ab,Tb){this.sc=Ab;this.sWc=new Gh(ib);this.Tda=Tb;this.Wih=new Ck}Yaa(){return"Suggestion"}Wta(){return this.sc.eM?1===this.sc.eM?1:2:0}Z7(ib,Ab,Tb,lc=c.a.tellMe,Hc=null){Tb=new v.a(ib);ze.TellMeActor.instance.HId=!1;if((!Hc||Array.contains(Hc,15))&&Nh.a.eCa(ib)){if(!this.sWc.B0f()){if(ze.TellMeActor.instance.tf)ze.TellMeActor.instance.tf.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.Tke()&&0<this.Wih.oce(ze.TellMeActor.instance.U7d,this.sc).length){const ta=this.Wih.oce(ze.TellMeActor.instance.U7d,this.sc);Hc=[];for(var hd of ta)this.sc.Cjb&&"Find"===hd||Hc.push(new Ae.a(hd,0));ze.TellMeActor.instance.HId=!0}else Hc=this.sWc.x2k();bh.logCommandSuggestions(Hc,!0,"Recommended","LRE");hd=[];for(const ta of Hc)this.Tda&&this.Tda.Jrf(ta.commandId)||hd.push(ta);ib=bh.getResultGroup(ib,hd,this.sc,
null,null,null,15);0<ib.results.length&&lc!==c.a.contextMenu&&(ib.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ib.results.length&&Tb.cF(ib)}Ab.resultsUpdated(Tb)}Tke(){return!!this.sc&&this.sc.Tke}}Object(f.a)(Um,"SuggestionResultsProvider",null,[1249]);class Ej{gXk(){return ze.TellMeActor.instance.CMe}AZk(){return window.TellMeSuggestionModel}HMf(){return window.CoefficientModelIdMap}}Object(f.a)(Ej,"SuggestionsModelAdapter",null,[1360]);var Xi=b(1419);b.d(P,"AggregatorResultsProvider",
function(){return Hi});class Hi{constructor(ib=!1){this.Zjc={};this.Zjc[c.a.tellMe]=[];this.Zjc[c.a.contextMenu]=[];this.VRd=ib}Vmi(ib,Ab,Tb,lc,Hc=null){let hd;var ta=!1;switch(lc){case c.a.contextMenu:hd=this.Zjc[c.a.contextMenu];ta=!0;break;default:hd=this.Zjc[c.a.tellMe]}Ab=new Dj(Ab,hd,ta,this.VRd,lc);Ab.U2l();for(ta=0;ta<hd.length;++ta){const Mb=window.performance.now();var jb=new w(Ab,ta);hd[ta].Z7(ib,jb,Tb,lc,Hc);ze.TellMeActor.instance.tf&&(jb={},jb[n.a.provider]=hd[ta].Yaa(),jb[n.a.KAc]=
ib.t8b,ze.TellMeActor.instance.tf.$G(m.a.Z7,window.performance.now()-Mb,jb))}Ab.TUm()}Yaa(){return"Aggregator"}Wta(){return 0}Z7(ib,Ab,Tb=!1,lc=c.a.tellMe,Hc=null){if(ze.TellMeActor.instance.uMl)this.Vmi(ib,Ab,Tb,lc,Hc);else{const hd=window.performance.now();ze.TellMeActor.instance.s2m.then(()=>{ze.TellMeActor.instance.tf&&ze.TellMeActor.instance.tf.$G(m.a.vMl,window.performance.now()-hd);this.Vmi(ib,Ab,Tb,lc,Hc);return!0})}}T1(ib,Ab){this.Zjc[Ab].push(ib)}iRj(ib){switch(ib){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ab=
this.Zjc[c.a.tellMe];for(const Tb of Ab)if("FindInDocument"===Tb.Yaa()){Tb.tym(ib);break}}}static createInstance(ib,Ab,Tb,lc){const Hc=lc&&Nh.a.hCg(Ab);var hd=Hc&&Ab.uhg;const ta=new Hi(Hc);if(Ab.f0i){var jb=new mn(Ab);ta.T1(jb,c.a.tellMe)}jb=Ab.Bp?Eg.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):Eg.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Mb=!jb&&Eg.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");ta.T1(new Dd.a(ib,Ab.zTm,Mb,!1),c.a.tellMe);
jb&&ta.T1(new Um(new Ej,Ab,ib),c.a.tellMe);ib=Eg.AFrameworkApplication.oa.mb.Y2f?new Lj(Ab,new il):new Oh(Ab,Tb);ta.T1(ib,c.a.contextMenu);(Hc&&Ab.vhg||hd)&&ta.T1(Xi.a.kJh(Ab,!0),c.a.tellMe);ta.T1(ib,c.a.tellMe);!Ab.XSh||"Word"===Ab.application&&Ab.rae||ta.T1(new le(Ab),c.a.tellMe);Ab.J9a&&(hd=new t(Ab),ta.T1(hd,c.a.tellMe),ta.T1(hd,c.a.contextMenu));!Ab.JRb||Ab.ADd||Ab.zDd||ta.T1(new A.a(Ab),c.a.tellMe);lc&&(Ab.oO||Nh.a.lZa())&&(hd=new Cl(Ab),ta.T1(hd,c.a.tellMe),ta.T1(hd,c.a.contextMenu));Hc&&ta.T1(Xi.a.kJh(Ab,
!1),c.a.tellMe);lc&&!Ab.MGg&&Nh.a.gCg(Ab)&&(ta.T1(new bl.a(Ab),c.a.tellMe),Ab.y4i&&ta.T1(new bl.a(Ab),c.a.contextMenu));return ta}}Object(f.a)(Hi,"AggregatorResultsProvider",null,[1249])},1433:function(D,P,b){D=b(0);var f=b(18),c=b(5),n=b(126),m=b(184),w=b(381),z=b(531),v=b(52),t=b(56),A=b(766),B=b(720),S=b(478),C=b(431),H=b(1410),J=b(1411),M=b(1407),G=b(1409),R=b(1408),O=b(765),I=b(719);class K{constructor(Aa,Ma,ba){this.qVh=Aa;this.Lvh=Ma;this.PAh=ba}}Object(D.a)(K,"BacktraceAndMakeUpdateHintsInput",
null,[]);var Y=b(1191),W;(function(Aa){Aa[Aa.EOP=0]="EOP";Aa[Aa.character=1]="character";Aa[Aa.embeddedMarker=2]="embeddedMarker"})(W||(W={}));Object(D.b)("LCSBlockType",W);class Z{toString(){return String.format("[Type: {0}]",W[this.type])}}Object(D.a)(Z,"ALCSBlock",null,[]);class U extends Z{constructor(Aa,Ma){super();this.KLe=Ma;this.B3e=Aa}get type(){return 1}get character(){return this.KLe}get Ll(){return this.B3e}zz(Aa){return 1===Aa.type&&Y.a.Wth(Aa.character,this.character)}toString(){return String.format("{0} [Char: {1}]",
super.toString(),this.character)}}Object(D.a)(U,"CharacterLCSBlock",Z,[]);class X{constructor(Aa){this.KX=0;this.Ll=null;this.yb=0;this.JVa=Aa}}Object(D.a)(X,"CurrentParagraphState",null,[]);class fa extends Z{constructor(Aa,Ma,ba,L){super();this.B3e=Aa;this.mC=Ma;this.yqa=ba;this.YGj=L}get type(){return 0}get yb(){return this.mC}get length(){return this.yqa}get Ll(){return this.B3e}zz(Aa){return Aa.type?!1:this.YGj?Aa.Ll===this.Ll&&Aa.yb===this.yb:Aa.yb===this.yb}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",
super.toString(),this.Ll.toString(),this.yb,this.length)}}Object(D.a)(fa,"EOPLCSBlock",Z,[]);class ma extends U{constructor(Aa,Ma,ba){super(Aa,"\ufffc");this.T_e=Ma;this.cPd=ba}get type(){return 2}get To(){return this.T_e}get Og(){return this.cPd}zz(Aa){return 2!==Aa.type?!1:Aa.To===this.To&&this.Og.equals(Aa.Og)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.To,this.Og)}}Object(D.a)(ma,"EmbeddedMarkerLCSBlock",U,[]);class ka{constructor(Aa,Ma){this.x=Aa;this.y=
Ma}equals(Aa){return Aa.x===this.x&&Aa.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(ka,"IntPair",null,[973]);var oa=b(1243),za=b(1217);class Ja{constructor(){this.block=null;this.Vsf=0}}Object(D.a)(Ja,"ParagraphToSkip",null,[]);var pa=b(1244),Na=b(1406);b.d(P,"a",function(){return Da});class Da{constructor(Aa,Ma){this.qg=Aa;this.Tc=Ma;this.DAj=Ma.runtime.Qa?Ma.runtime.Qa.isFeatureEnabled(111):!1}pJh(Aa,Ma,ba,L,V,ha,la){let ya;ya=null;({Jcd:Ma,returnValue:Aa}=this.Asc(Aa,Ma));
if(!Aa)return n.a.instance.ya(593826840,1,2,"Failed to get LCS blocks from objects for base"),this.Tc.logger.nM("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ya};({Jcd:L,returnValue:ba}=this.Asc(ba,L));if(!ba)return n.a.instance.ya(593826839,1,2,"Failed to get LCS blocks from objects for changed"),this.Tc.logger.nM("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ya};this.Tc.logger.nM("GetLCSBlocksFromObject");ya=this.Jpk(Aa,ba,Ma,L,V,ha,la);return ya?{returnValue:!0,updateHints:ya}:
(n.a.instance.ya(593826838,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ya})}qJh(Aa,Ma,ba,L,V,ha,la){let ya;ya=null;({returnValue:Aa}=this.Asc(Aa,Ma));if(!Aa)return n.a.instance.ya(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Tc.logger.nM("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ya};({returnValue:ba}=this.Asc(ba,L));if(!ba)return n.a.instance.ya(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Tc.logger.nM("GetLCSBlocksFromObject"),
{returnValue:!1,updateHints:ya};this.Tc.logger.nM("GetLCSBlocksFromObject");ya=this.Kpk(Aa,ba,V,ha,la);return ya?{returnValue:!0,updateHints:ya}:(n.a.instance.ya(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ya})}QSh(Aa,Ma,ba,L){({returnValue:Aa}=this.Asc(Aa,Ma));if(!Aa)return-1;({returnValue:ba}=this.Asc(ba,L));if(!ba)return-1;({b8d:ba}=this.sEf(Aa,ba));return ba}Asc(Aa,Ma){let ba;const L=new m.a;ba=new m.a;if(!Aa.length)return n.a.instance.ya(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),
this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,Jcd:ba};for(let la=0;la<Aa.length;la++)if(393230===Aa.J(la).Ab){const ya=this.qg.getPropertyString(Aa.J(la),f.a.Zk),va=this.qg.getPropertyUint32(Aa.J(la),c.a.yb);if(null==va)return n.a.instance.ya(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,Jcd:ba};let xa=this.qg.getPropertyUint32s(Aa.J(la),
f.a.WB);xa=za.a.XXi(xa,ya.length);const Ia=this.qg.getPropertyObjectIds(Aa.J(la),f.a.DA);let mb;for(mb=0;mb<xa.length-1;mb++){var V=Ma(Ia.Ye(mb)),ha=void 0;ha=V?(ha=this.qg.getPropertyBool(V,f.a.n4))?ha:!1:!1;if(ha)L.add(this.vlk(Aa.J(la).id,V));else for(V=xa.Ye(mb);V<xa.Ye(mb+1);V++)L.add(new U(Aa.J(la).id,Y.a.charAt(ya,V)))}L.add(new fa(Aa.J(la).id,va,xa.J(mb),this.DAj));ba.add(L.length-1)}else return n.a.instance.ya(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",
Aa.J(la).Ab),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,Jcd:ba};this.Tc.runtime.NF("LCS: GetLCSBlocks for base");return{returnValue:L,Jcd:ba}}vlk(Aa,Ma){const ba=null==this.qg.getPropertyInt32(Ma,c.a.pq)?0:this.qg.getPropertyInt32(Ma,c.a.pq);return new ma(Aa,ba,Ma.id)}Jpk(Aa,Ma,ba,L,V,ha,la){ha=({b8d:V}=this.sEf(Aa,Ma,V,ha,la)).returnValue;this.Tc.logger.nM("FindFurthestPaths");Aa=this.B1j(new K(ha,Aa,Ma),ba,L,V);this.Tc.logger.nM("BacktraceAndMakeUpdateHints");
return Aa}Kpk(Aa,Ma,ba,L,V){L=({b8d:ba}=this.sEf(Aa,Ma,ba,L,V)).returnValue;this.Tc.logger.nM("FindFurthestPaths");Aa=new K(L,Aa,Ma);Aa=new Na.a(this.C1j(Aa,ba),1);this.Tc.logger.nM("BacktraceAndMakeUpdateHints");return Aa}sEf(Aa,Ma,ba=-1,L=-1,V=-1){let ha;if(-1===ba||-1===L||-1===V)V=L=ba=-1;ha=-1;const la=new w.a;la.W(new ka(-1,1),new ka(0,-1));if(-1!==ba){la.W(new ka(0,0),new ka(ba,ba));var ya=1}else ya=0,L=Aa.length,V=Ma.length;for(ba=0;ya<=Aa.length+Ma.length;ya++){let va=!1;for(let xa=-ya;xa<=
ya;xa+=2){let Ia,mb;xa===-ya?(Ia=la.J(new ka(ya-1,xa+1)).x,mb=la.J(new ka(ya-1,xa+1)).y+1):xa===ya?(Ia=la.J(new ka(ya-1,xa-1)).x+1,mb=la.J(new ka(ya-1,xa-1)).y):la.J(new ka(ya-1,xa-1)).x>=la.J(new ka(ya-1,xa+1)).x?(Ia=la.J(new ka(ya-1,xa-1)).x+1,mb=la.J(new ka(ya-1,xa-1)).y):(Ia=la.J(new ka(ya-1,xa+1)).x,mb=la.J(new ka(ya-1,xa+1)).y+1);for(;Ia<L&&mb<V&&Aa.J(Ia).zz(Ma.J(mb));)Ia++,mb++;la.W(new ka(ya,xa),new ka(Ia,mb));if(Ia===L&&mb===V){va=!0;ha=ya;ba=xa;break}}if(va)break;this.Tc.runtime.NF("LCS FindFurthestPaths")}if(ba!==
L-V)return{returnValue:null,b8d:ha};la.W(new ka(ha,ba),new ka(L+1,V+1));n.a.instance.ya(593826837,1,3,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Aa.length,Ma.length,ha);return{returnValue:la,b8d:ha}}B1j(Aa,Ma,ba,L){const V=Aa.qVh,ha=Aa.Lvh;Aa=Aa.PAh;const la=new Na.a(new m.a,1);let ya=ba.length-1,va=ba.J(ya);const xa=Object.assign(new Ja,{block:null,Vsf:-1});var Ia=ha.J(ha.length-1),mb=new z.a;for(var gb=0;gb<Ma.length;gb++)mb.add(ha.J(Ma.J(gb)).Ll);
Ia=Object.assign(new X(mb),{KX:Ia.length,Ll:Ia.Ll,yb:Ia.yb});mb=ha.length;for(gb=Aa.length;0<mb||0<gb;){const $a=mb-1,cb=gb-1;if(Aa.J(va).type)return n.a.instance.ya(594124866,1,2,"Abandoning LCS due to unexpected non-EOP block"),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"900bc"})),null;const La=Aa.J(va);if(this.dGi(V,L,mb,gb)){var Za=Aa.J(cb);if(1===Za.type||2===Za.type)this.UPj(la,Ia,Za);else{if(Za.type)return n.a.instance.ya(594124869,1,2,"Abandoning LCS due to unexpected block to insert of type {0}",
Za.type),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"900bf"})),null;if(Za===xa.block)Da.EIm(xa.Vsf,Ia,Za),xa.block=null;else if(!xa.block&&gb<Aa.length&&0<mb&&Aa.J(gb).type&&ha.J($a).type){if(!this.splitPara(Aa,ba,la,ya,xa,Ia,La,Za))return n.a.instance.ya(594060172,1,2,"Abandoning LCS due to inability to find above new EOP"),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"90kom"})),null}else this.addPara(ha,la,xa,Ia,$a,Za)}gb--;
L--}else if(this.cGi(V,L,mb,gb)){Za=ha.J($a);if(1===Za.type||2===Za.type)this.deleteText(la,Ia,Za);else{if(Za.type)return n.a.instance.ya(594124868,1,2,"Abandoning LCS due to unsupported missing block of type {0}",Za.type),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"900be"})),null;const Ya=this.yvl(Za.Ll,Aa,ba);if(Ya||Za.length)if(Za.yb!==Ia.yb)Ya?this.mergePara(la,Ia,Za):this.mLl(la,Ia,Za,$a,ha)||(n.a.instance.ya(591140042,1,2,""),this.Tc.logger.wf(Object.assign(new oa.a,
{Qh:"MergeParaMoveText",eventId:""})));else return n.a.instance.ya(594124867,1,2,"Abandoning LCS due to unexpected missing EOP block"),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"900bd"})),null;else this.deletePara(la,Ia,Za,ha,Ma,$a)}mb--;L--}else if(mb&&gb&&ha.J($a).zz(Aa.J(cb)))mb--,gb--,Da.P7l(ha,Aa,Ia,$a,cb);else return n.a.instance.ya(594124870,1,2,"Abandoning LCS due to being unable to find a path"),this.Tc.logger.wf(Object.assign(new oa.a,{Qh:"BacktraceAndMakeUpdateHints",
eventId:"900bg"})),null;0<cb&&cb<Aa.length&&!Aa.J(cb).type&&Aa.J(cb)!==La&&(ya--,va=cb)}this.Tc.runtime.NF("LCS: CreateUpdateHintsFromLCSBlocks");return la}C1j(Aa,Ma){const ba=Aa.qVh,L=Aa.Lvh;Aa=Aa.PAh;const V=new m.a;let ha=L.length,la=Aa.length;for(;0<ha||0<la;){var ya=ha-1,va=la-1;if(this.dGi(ba,Ma,ha,la)){ya=Aa.J(va);if(1===ya.type||2===ya.type)this.pnl(V,ha,ya);else{if(ya.type)return n.a.instance.ya(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ya.type),this.Tc.logger.wf(Object.assign(new pa.a,
{Qh:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;this.Uml(V,ha,ya)}la--;Ma--}else if(this.cGi(ba,Ma,ha,la)){va=L.J(ya);if(1===va.type||2===va.type)this.rtk(V,ya,va);else{if(va.type)return n.a.instance.ya(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",va.type),this.Tc.logger.wf(Object.assign(new pa.a,{Qh:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;this.etk(V,ya,va)}ha--;Ma--}else if(ha&&la&&L.J(ya).zz(Aa.J(va)))ha--,la--;else return n.a.instance.ya(575706454,
1,2,"Abandoning LCS due to being unable to find a path"),this.Tc.logger.wf(Object.assign(new pa.a,{Qh:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Tc.runtime.NF("LCS: CreateUpdateHintsFromLCSBlocks");return V}cGi(Aa,Ma,ba,L){Ma=new ka(Ma-1,ba-L-1);return Aa.La(Ma)&&Aa.J(Ma).x===ba-1&&Aa.J(Ma).y===L}dGi(Aa,Ma,ba,L){Ma=new ka(Ma-1,ba-L+1);return Aa.La(Ma)&&Aa.J(Ma).x===ba&&Aa.J(Ma).y===L-1}addPara(Aa,Ma,ba,L,V,ha){var la=null;ba.block?la=ba.block.Ll:0<=V&&!Aa.J(V).type&&(la=Aa.J(V).Ll);ba=
Aa=ha.Ll;if(L.JVa.contains(Aa))for(V=0,Aa=v.a.Ad("{00000000-0000-0000-0000-000000000000}{"+V+"}");L.JVa.contains(Aa);)V++,Aa=v.a.Ad("{00000000-0000-0000-0000-000000000000}{"+V+"}");la=new A.AddParagraphUpdateHint(Aa,ha.yb,la);la.bEi=ba;Ma.updateHints.add(la);L.Ll=Aa;L.yb=ha.yb;L.JVa.add(Aa);L.KX=0}Uml(Aa,Ma,ba){ba=new M.a(ba.Ll,ba.yb);let L=!1;if(0<Aa.length&&11===Aa.Ye(Aa.length-1).type){const V=Aa.Ye(Aa.length-1);V.cp===Ma&&(L=!0,V.W2.add(ba))}L||(Ma=new R.a(Ma),Ma.W2.add(ba),Aa.add(Ma))}splitPara(Aa,
Ma,ba,L,V,ha,la,ya){Aa=this.aGk(ha.Ll,Aa,Ma,L);if(!Aa)return!1;Ma=new I.a(ha.Ll,ha.yb,ha.KX,Aa.Ll,Aa.yb,la.Ll,la.yb);ba.updateHints.add(Ma);ha.yb=Aa.yb;Aa!==ya?(V.block=Aa,V.Vsf=ha.KX,V=new A.AddParagraphUpdateHint(ya.Ll,ya.yb,Aa.Ll),ba.updateHints.add(V),ha.Ll=ya.Ll,ha.yb=ya.yb,ha.JVa.add(ya.Ll),ha.KX=0):ha.JVa.add(la.Ll);return!0}UPj(Aa,Ma,ba){let L=!1;if(0<Aa.updateHints.length&&1===Aa.updateHints.Ye(Aa.updateHints.length-1).type){const V=Aa.updateHints.Ye(Aa.updateHints.length-1);V.We.equals(Ma.Ll)&&
V.cp===Ma.KX&&(V.text=ba.character.toString()+V.text,L=!0)}L||Aa.updateHints.add(new C.a(Ma.Ll,Ma.KX,ba.character.toString()))}pnl(Aa,Ma,ba){var L=!1;if(0<Aa.length&&11===Aa.Ye(Aa.length-1).type){const V=Aa.Ye(Aa.length-1);V.cp===Ma&&((L=Object(t.a)(G.a,V.W2.J(V.W2.length-1)))?L.text=ba.character.toString()+L.text:V.W2.add(new G.a(ba.Ll,ba.character.toString())),L=!0)}L||(Ma=new R.a(Ma),Ma.W2.add(new G.a(ba.Ll,ba.character.toString())),Aa.add(Ma))}deletePara(Aa,Ma,ba,L,V,ha){let la=-1;for(let ya=
0;ya<V.length;ya++)if(V.J(ya)===ha){0<ya&&(la=ya-1);break}ha=null;0<=la&&(ha=L.J(V.J(la)));L=new B.a(ba.Ll,ba.yb,ha?ha.Ll:null);Aa.updateHints.add(L);ha&&Ma.Ll.equals(ba.Ll)&&(Ma.KX=ha.length,Ma.Ll=ha.Ll,Ma.yb=ha.yb);Ma.JVa.remove(ba.Ll)}etk(Aa,Ma,ba){Ma=new H.a(Ma,ba.Ll,ba.yb);Aa.add(Ma)}mergePara(Aa,Ma,ba){Aa.updateHints.add(new O.MergeParagraphUpdateHint(ba.Ll,ba.yb,ba.length,Ma.Ll,Ma.yb,ba.Ll,Ma.yb));Ma.KX=ba.length;Ma.JVa.remove(Ma.Ll);Ma.Ll=ba.Ll}mLl(Aa,Ma,ba,L,V){let ha=null;for(var la=L-1;0<=
la;la--)if(!V.J(la).type){ha=V.J(la);break}let ya;if(!({Eig:la,kQg:ya}=this.iGk(Aa,L,ba,V)).returnValue)return!1;L=this.p8k(L,V);Aa.updateHints.add(new S.DeleteTextUpdateHint(ba.Ll,0,L));Aa.updateHints.add(new B.a(ba.Ll,ba.yb,ha?ha.Ll:null));Aa.updateHints.add(new C.a(la,0,L));Ma.KX+=L.length;Ma.JVa.remove(ba.Ll);Ma.Ll=la;Ma.yb=ya;return!0}iGk(Aa,Ma,ba,L){var V=null;for(Ma+=1;Ma<L.length;Ma++)if(!L.J(Ma).type){V=L.J(Ma);break}L=null;for(Ma=Aa.updateHints.length-1;0<=Ma&&!(L=Object(t.a)(A.AddParagraphUpdateHint,
Aa.updateHints.J(Ma)));Ma--);return L&&L.jk===ba.Ll?(Aa=L.We,V=L.yb,{returnValue:!0,Eig:Aa,kQg:V}):V?(Aa=V.Ll,V=V.yb,{returnValue:!0,Eig:Aa,kQg:V}):{returnValue:!1,Eig:null,kQg:0}}yvl(Aa,Ma,ba){for(let L=0;L<ba.length;L++)if(Ma.J(ba.J(L)).Ll.equals(Aa))return!0;return!1}p8k(Aa,Ma){let ba="";for(--Aa;0<=Aa;Aa--){const L=Object(t.a)(fa,Ma.J(Aa)),V=Object(t.a)(U,Ma.J(Aa));if(L)break;else V&&(ba=V.character+ba)}return ba}deleteText(Aa,Ma,ba){let L=!1;if(0<Aa.updateHints.length&&2===Aa.updateHints.Ye(Aa.updateHints.length-
1).type){const V=Aa.updateHints.Ye(Aa.updateHints.length-1);V.We.equals(Ma.Ll)&&V.cp===Ma.KX&&(V.cp=Ma.KX-1,V.text=ba.character.toString()+V.text,L=!0)}L||Aa.updateHints.add(new S.DeleteTextUpdateHint(Ma.Ll,Ma.KX-1,ba.character.toString()));--Ma.KX}rtk(Aa,Ma,ba){let L=!1;if(0<Aa.length&&8===Aa.Ye(Aa.length-1).type){const V=Aa.Ye(Aa.length-1);V.cp===Ma+1&&(V.text=ba.character.toString()+V.text,--V.cp,L=!0)}L||Aa.add(new J.a(Ma,ba.character.toString()))}aGk(Aa,Ma,ba,L){for(;0<=L;){var V=Ma.J(ba.J(L));
if(V.type)break;if(V.Ll.equals(Aa))return V;L--}return null}static EIm(Aa,Ma,ba){Ma.Ll=ba.Ll;Ma.yb=ba.yb;Ma.KX=Aa}static P7l(Aa,Ma,ba,L,V){Aa.J(L).type?--ba.KX:(Aa=Aa.J(L),ba.Ll=Aa.Ll,ba.yb=Aa.yb,ba.KX=Aa.length,Ma=Ma.J(V),Ma.Ll!==Aa.Ll&&(ba.JVa.remove(Aa.Ll),ba.JVa.add(Ma.Ll)))}}Object(D.a)(Da,"LCSUpdateHintGenerator",null,[])},1437:function(D,P,b){b.r(P);D=b(0);var f=b(18),c=b(5),n=b(126),m=b(381),w=b(531),z=b(184),v=b(52),t=b(42),A=b(1176);class B extends A.a{constructor(){super()}get pta(){return"ChildNodeListMerge"}}
Object(D.a)(B,"ChildNodeListMergeFailureDetail",A.a,[]);class S{oFb(X,fa,ma){return fa.uz(X,ma.J(X))}e9i(X,fa,ma,ka){let oa;return({value:oa}=fa.tb(X)).returnValue||({value:oa}=ma.tb(X)).returnValue?oa:ka.J(X)}}Object(D.a)(S,"ChildNodeListMergeUtils",null,[1331]);var C=b(1208),H=b(1455),J=b(1300);class M{constructor(X,fa){this.classId=X;this.STm=fa}}Object(D.a)(M,"NodeChildrenTransformation",null,[]);var G=b(690),R=b(1192);class O{constructor(X,fa,ma){this.dF=X;this.txa=ma;this.yaa=fa}gue(X){let fa,
ma;return({RIi:fa}=this.g9i(this.txa,X)).returnValue&&fa.iU||({RIi:ma}=this.g9i(this.yaa,X)).returnValue&&ma.iU}g9i(X,fa){let ma;return{returnValue:({value:ma}=(new R.a(this.dF,X)).bia.tb(G.a.Ya(fa))).returnValue,RIi:ma}}}Object(D.a)(O,"NodeTriplet",null,[]);var I=b(1405);class K{constructor(X,fa,ma){this.Tc=X;this.qg=fa;this.H$=ma;this.Tih=!0}get fo(){return this.Tc}get Xc(){return this.qg}get AEa(){return this.H$}get success(){return this.Tih}W1k(){n.a.instance.ya(4220310,1,4,"Evaluating ParentObjects");
const X=new m.a;this.Flf(X,fa=>this.fo.runtime.pj.J(fa));this.Flf(X,fa=>this.AEa.oFb(fa,this.fo.runtime.Lw,this.fo.runtime.pj));this.Flf(X,fa=>this.AEa.oFb(fa,this.fo.runtime.Hp,this.fo.runtime.pj));return X}Flf(X,fa){const ma=fa(b(1437).ChildNodeListMerge.Ase);this.Xc.getPropertyObjectIds(ma,f.a.ff).forEach(ka=>{this.Xc.getPropertyObjectIds(fa(ka),f.a.ff).forEach(oa=>{X.La(oa)&&!ka.equals(X.J(oa))&&(this.Tih=!1,n.a.instance.ya(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
oa,ka,X.J(oa)));X.W(oa,ka);return!0});return!0})}}Object(D.a)(K,"OutlineGroupParentFinder",null,[]);var Y=b(1177),W=b(1245),Z=b(1301);b.d(P,"ChildNodeListMerge",function(){return U});class U{constructor(X,fa=null,ma=null,ka=null,oa=null){this.qg=X;this.G1l=fa||H.a.y9i;this.kpe=ma||this.L_k();this.AEa=ka||new S;this.Jui=oa||this.lZk()}get Xc(){return this.qg}L_k(){return[new M(393227,Object(t.a)(this,this.R0l,"pageContentNodeThreewayChildMerge")),new M(1073872968,Object(t.a)(this,this.u3m,"wordSectionNodeThreewayChildMerge")),
new M(393241,Object(t.a)(this,this.rse,"outlineElementContainerThreewayChildMerge")),new M(393252,Object(t.a)(this,this.FNm,"tableCellThreewayChildMergev2")),new M(1074135125,Object(t.a)(this,this.rse,"outlineElementContainerThreewayChildMerge")),new M(1074135123,Object(t.a)(this,this.rse,"outlineElementContainerThreewayChildMerge")),new M(1074135127,Object(t.a)(this,this.rse,"outlineElementContainerThreewayChildMerge"))]}lZk(){return[Object(t.a)(this,this.c6l,"prepareObjectGroupings"),Object(t.a)(this,
this.Ncl,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.o3l,"performThreewayChildMerge")]}aLl(X){let fa=0;for(;fa<this.Jui.length;fa++)if(!(0,this.Jui[fa])(X))return n.a.instance.ya(4273296,1,3,"MergeChildNodeLists: Merged failed. [Function: {0}]",fa),X.logger.Ume("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",fa),!1;return!0}c6l(X){const fa=new m.a,ma=new m.a,ka=new w.a;X.runtime.Lw.forEach((oa,za)=>U.LFi(za,fa));X.runtime.Hp.forEach((oa,za)=>U.LFi(za,ma));for(let oa=0;oa<this.kpe.length;oa++){const za=
this.kpe[oa].classId;X.runtime.IAb.W(za,new m.a);fa.La(za)&&fa.J(za).forEach(Ja=>{var pa=X.runtime.pj.J(Ja.id);pa&&(pa=new O(pa,Ja,X.runtime.Hp.uz(Ja.id,pa)),X.runtime.IAb.J(za).add(Ja.id,pa),ka.add(Ja.id));return!0});ma.La(za)&&ma.J(za).forEach(Ja=>{if(ka.contains(Ja.id))return!0;const pa=X.runtime.pj.J(Ja.id);pa&&X.runtime.IAb.J(za).add(Ja.id,new O(pa,pa,Ja));return!0})}X.runtime.NF("PrepareObjectGroupings");X.logger.gna("PrepareObjectGroupings");return!0}o3l(X){let fa=!0;for(let ma=0;fa&&ma<this.kpe.length;ma++){const ka=
this.kpe[ma],oa=ka.classId;X.runtime.IAb.J(oa).forEach((za,Ja)=>{X.runtime.hWa.contains(Ja.dF.id)||(fa=ka.STm(X,Ja)&&fa);fa||(n.a.instance.ya(4273297,1,3,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",oa,Ja.dF.id),X.logger.wf(Object.assign(new B,{Qh:"PerformThreewayChildMerge",eventId:"aqtsr"})));return fa});X.runtime.NF("PerformThreewayChildMerge"+ma)}X.logger.gna("PerformThreewayChildMerge");return fa}R0l(X,fa){if(fa.gue(f.a.ff)){var ma=this.Xc.getPropertyObjectIds(fa.dF,
f.a.ff);const ka=this.Xc.getPropertyObjectIds(fa.yaa,f.a.ff);fa=this.Xc.getPropertyObjectIds(fa.txa,f.a.ff);ma=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ma.length,ka.length,fa.length,X.input.source);n.a.instance.ya(4030551,1,3,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ma);X.logger.wf(Object.assign(new B,{Qh:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:ma}));return!1}return!0}u3m(X,fa){if(fa.gue(f.a.ff)){const Na=
new w.a,Da=new w.a,Aa=new w.a,Ma=new w.a;var ma=this.Xc.getPropertyObjectIds(fa.dF,f.a.ff),ka=ma.zH(),oa,za=({dHh:oa}=this.Vdj(fa.yaa,ka,Na,"Favored")).returnValue,Ja=({dHh:pa}=this.Vdj(fa.txa,ka,Da,"Unfavored")).returnValue;if(!za||!Ja)return ma=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ka.count,Na.count,Da.count,oa,pa),X.logger.wf(Object.assign(new B,{Qh:"WordSectionNodeThreewayChildMerge",
info:ma})),!1;ma.forEach(ba=>{Na.contains(ba)||Aa.add(ba);Da.contains(ba)||Ma.add(ba);return!0});fa=fa.dF.gF();ka=new z.a;for(oa=0;oa<ma.length;oa++){var pa=ma.Ye(oa);if(Aa.contains(pa)||Ma.contains(pa)){if(X.runtime.hWa.add(pa),ka.length&&(za=ka.Ye(ka.length-1),za=X.runtime.IAb.J(393241).J(za),Ja=X.runtime.IAb.J(393241).J(pa),za&&Ja))Aa.contains(pa)?Ma.contains(pa)||(za.dF=za.dF.gF(),za.txa=za.txa.gF(),this.c2d(za.dF,Ja.dF),this.c2d(za.txa,Ja.txa)):(za.dF=za.dF.gF(),za.yaa=za.yaa.gF(),this.c2d(za.dF,
Ja.dF),this.c2d(za.yaa,Ja.yaa))}else ka.add(pa)}this.Xc.setPropertyObjectIds(fa,f.a.ff,ka);ma=new Y.a(fa);ma.oC(f.a.ff);X.runtime.Jl.W(fa.id,ma)}return!0}c2d(X,fa){const ma=this.Xc.getPropertyObjectIds(X,f.a.ff);fa=this.Xc.getPropertyObjectIds(fa,f.a.ff);const ka=ma.d9();fa.forEach(oa=>{ka.add(oa);return!0});this.Xc.setPropertyObjectIds(X,f.a.ff,ka)}Vdj(X,fa,ma,ka){let oa=0,za=!0;this.Xc.getPropertyObjectIds(X,f.a.ff).forEach(Ja=>{fa.contains(Ja)?ma.add(Ja):(za=!1,n.a.instance.ya(573912977,1,3,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",
ka,Ja),oa++);return!0});return{returnValue:za,dHh:oa}}Ncl(X){let fa=!0;X.runtime.IAb.J(393241).forEach((ma,ka)=>{if(this.Ctl(ka)){n.a.instance.ya(4220302,1,3,"OutlineGroup {0} requires inter-OG merge.",ka.dF.id);let oa;const za=new K(X,this.Xc,this.AEa);if(({nEi:ma,Kgj:oa}=this.LSm(X,za.W1k(),ka)).returnValue)return n.a.instance.ya(4220303,1,3,"Merging WordSection {0} as a unit.",oa),fa=za.success&&this.BLl(X,oa,ma)&&fa,fa||(n.a.instance.ya(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ka.dF.id,za.success),X.logger.wf(Object.assign(new B,{Qh:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",za.success)}))),fa}return!0});return fa}Ctl(X){if(!X.gue(f.a.ff))return!1;const fa=this.Xc.getPropertyObjectIds(X.dF,f.a.ff).J(0),ma=this.Xc.getPropertyObjectIds(X.yaa,f.a.ff);X=this.Xc.getPropertyObjectIds(X.txa,f.a.ff);return!ma.contains(fa,(ka,oa)=>ka.equals(oa))||!X.contains(fa,(ka,oa)=>ka.equals(oa))}LSm(X,fa,ma){fa=
fa.J(ma.dF.id);n.a.instance.ya(4220304,1,3,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ma.dF.id,fa);if(X.runtime.hWa.contains(fa))return n.a.instance.ya(4220305,1,4,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",fa),{returnValue:!1,nEi:null,Kgj:fa};const ka=new I.a;ma=X.runtime.pj.J(fa);this.Xc.getPropertyObjectIds(ma,f.a.ff).forEach(oa=>
{ka.b2d(oa);return!0});ma=this.AEa.oFb(fa,X.runtime.Lw,X.runtime.pj);this.Xc.getPropertyObjectIds(ma,f.a.ff).forEach(oa=>{ka.d2d(oa);return!0});X=this.AEa.oFb(fa,X.runtime.Hp,X.runtime.pj);this.Xc.getPropertyObjectIds(X,f.a.ff).forEach(oa=>{ka.i2d(oa);return!0});return{returnValue:!0,nEi:ka,Kgj:fa}}glg(X,fa,ma,ka,oa){let za=!0;X.forEach(Ja=>{const pa=fa(Ja);this.Xc.getPropertyObjectIds(pa,f.a.ff).forEach(Na=>{ma.add(Na);if(ka.La(Na))return(za=ka.J(Na).equals(Ja)&&za)||n.a.instance.ya(4273300,1,2,
"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",oa,Na,Ja,ka.J(Na)),za;ka.W(Na,Ja);return!0});return!0});return za}E0k(X,fa){let ma,ka,oa,za;ma=new z.a;ka=new z.a;oa=new z.a;za=new m.a;const Ja=X.runtime.pj;return this.glg(fa.URb,pa=>Ja.J(pa),ma,za,"Base")&&this.glg(fa.DDf,pa=>this.AEa.oFb(pa,X.runtime.Lw,Ja),ka,za,"Favored")&&this.glg(fa.tFb,pa=>this.AEa.oFb(pa,X.runtime.Hp,Ja),oa,za,"Unfavored")?{returnValue:!0,Nvh:ma,fSh:ka,r$i:oa,
tyi:za}:{returnValue:!1,Nvh:ma,fSh:ka,r$i:oa,tyi:za}}MGk(X,fa,ma,ka){let oa=!0;const za=X.runtime.pj,Ja=X.runtime.Lw,pa=X.runtime.Hp,Na=X.runtime.Jl,Da=new z.a,Aa=new m.a;ma.forEach(Ma=>{const ba=ka.J(Ma);if(!ba)return n.a.instance.ya(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",Ma),X.logger.wf(Object.assign(new B,{Qh:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),oa=!1;ba.equals(Da.last())||(Da.add(ba),Aa.add(ba,new z.a));Aa.J(ba).add(Ma);X.runtime.hWa.add(Ma);
return!0});if(!oa)return!1;Aa.forEach((Ma,ba)=>{const L=this.AEa.e9i(Ma,Ja,pa,za).gF();this.Xc.setPropertyObjectIds(L,f.a.ff,ba);Na.W(Ma,new Y.a(L));Na.J(Ma).oC(f.a.ff);X.runtime.hWa.add(Ma);return oa});ma=this.AEa.e9i(fa,Ja,pa,za).gF();this.Xc.setPropertyObjectIds(ma,f.a.ff,Da);Na.W(fa,new Y.a(ma));Na.J(fa).oC(f.a.ff);X.runtime.hWa.add(fa);return oa}BLl(X,fa,ma){let ka,oa;if(!({Nvh:za,fSh:ka,r$i:oa,tyi:ma}=this.E0k(X,ma)).returnValue)return!1;var za=C.b(za,ka,oa);za=this.Xhg(X,za);return!!za&&this.MGk(X,
fa,za,ma)}rse(X,fa){return this.jEi(X,fa)}jEi(X,fa){if(fa.gue(f.a.ff)){var ma=this.D0k(fa);ma=this.Xhg(X,ma);if(!ma)return n.a.instance.ya(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",fa.dF.id),X.logger.wf(Object.assign(new B,{Qh:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),J.a(fa.dF,"OutlineElementContainerThreewayChildMerge_Base",1),J.a(fa.yaa,
"OutlineElementContainerThreewayChildMerge_Favored",1),J.a(fa.txa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ka=this.Xc.getPropertyObjectIds(fa.dF,f.a.ff);const oa=ma.zH();ka.forEach(za=>{oa.contains(za)||(za=this.Xc.getPropertyObjectIds(fa.dF,f.a.pfa),0<za.length&&X.runtime.Fig.add(za.J(0)));return!0});ka=fa.yaa.gF();this.Xc.setPropertyObjectIds(ka,f.a.ff,ma);X.runtime.Jl.W(ka.id,new Y.a(ka));X.runtime.Jl.J(ka.id).oC(f.a.ff)}return!0}n2b(X){if(!X)return n.a.instance.ya(573957964,
1,2,"Feature helper is null"),!1;X.eo(184);return X.isFeatureEnabled(184)}FNm(X,fa){if(!this.n2b(X.runtime.Qa))return this.zHg(X,fa);var ma=fa.dF.id,ka=Z.e(X,fa.dF,null);if(ka.equals(v.a.nil))return n.a.instance.ya(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ma),X.logger.wf(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),!1;var oa=X.runtime.BTb.J(ka);if(oa&&(oa=oa.J(ma)))if(oa.qe)fa=fa.yaa.gF(),fa.removeProperty(f.a.ff),this.Xc.setPropertyBool(fa,
c.a.ghostCell,!0),null!=oa.colSpan?this.Xc.setPropertyUint32(fa,c.a.colSpan,oa.colSpan):fa.removeProperty(c.a.colSpan),X.runtime.Jl.W(fa.id,new Y.a(fa)),X.runtime.Jl.J(fa.id).oC(f.a.ff),X.runtime.Jl.J(fa.id).oC(c.a.ghostCell),X.runtime.Jl.J(fa.id).oC(c.a.colSpan);else{let za,Ja;({U2d:ka,Z$d:za,QEe:Ja}=this.CYk(X,fa,oa,ka));if(!za.length&&!Ja.length)return n.a.instance.ya(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ma),X.logger.wf(Object.assign(new W.a,
{info:"A non-ghost cell does not have OE nodes on either side"})),!1;za.length?Ja.length?(ma=C.b(ka,za,Ja),ma=this.Xhg(X,ma)):ma=za:ma=Ja;if(!ma)return n.a.instance.ya(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",fa.dF.id),X.logger.wf(Object.assign(new B,{Qh:"TableCellThreewayChildMergev2",eventId:"8n426"})),J.a(fa.dF,"TableCellThreewayChildMergev2_Base",1),J.a(fa.yaa,"TableCellThreewayChildMergev2_Favored",
1),J.a(fa.txa,"TableCellThreewayChildMergev2_Unfavored",1),!1;fa=fa.yaa.gF();this.Xc.setPropertyObjectIds(fa,f.a.ff,ma);fa.removeProperty(c.a.ghostCell);ma=oa.rowSpan;oa=oa.colSpan;null!=ma&&null!=oa&&(1<ma||1<oa)?(this.Xc.setPropertyUint32(fa,c.a.rowSpan,ma),this.Xc.setPropertyUint32(fa,c.a.colSpan,oa)):(fa.removeProperty(c.a.rowSpan),fa.removeProperty(c.a.colSpan));X.runtime.Jl.W(fa.id,new Y.a(fa));X.runtime.Jl.J(fa.id).oC(f.a.ff);X.runtime.Jl.J(fa.id).oC(c.a.ghostCell);X.runtime.Jl.J(fa.id).oC(c.a.rowSpan);
X.runtime.Jl.J(fa.id).oC(c.a.colSpan)}else return this.zHg(X,fa);X.logger.gna("TableCellThreewayChildMergev2");return!0}CYk(X,fa,ma,ka){let oa,za;({U2d:fa,Z$d:oa,QEe:za}=this.SZh(fa));fa||(fa=new z.a);oa||(oa=new z.a);za||(za=new z.a);var Ja=fa.zH(),pa=oa.zH(),Na=za.zH(),Da=ma.Ape;if(Da)for(var Aa=0;Aa<Da.length;Aa++){var Ma=Da.J(Aa),ba=X.runtime.pj.J(Ma);!Ja.contains(Ma)&&ba&&(Ja.add(Ma),fa.add(Ma));!pa.contains(Ma)&&X.runtime.Lw.uz(Ma,ba)&&(pa.add(Ma),oa.add(Ma));!Na.contains(Ma)&&X.runtime.Hp.uz(Ma,
ba)&&(Na.add(Ma),za.add(Ma))}X.logger.gna("OENodesAddedToChildrenList");if(Da=ma.mRf)for(Aa=0;Aa<Da.length;Aa++)if(Ma=Da.J(Aa),ba=X.runtime.pj.J(Ma)){var L=this.Xc.getPropertyObjectIds(ba,f.a.ff);if(L)for(var V=0;V<L.length;V++){var ha=L.J(V);Ja.contains(ha)||(Ja.add(ha),fa.add(ha))}L=X.runtime.Lw.uz(Ma,ba);if(L=this.Xc.getPropertyObjectIds(L,f.a.ff))for(V=0;V<L.length;V++)ha=L.J(V),pa.contains(ha)||(pa.add(ha),oa.add(ha));Ma=X.runtime.Hp.uz(Ma,ba);if(Ma=this.Xc.getPropertyObjectIds(Ma,f.a.ff))for(ba=
0;ba<Ma.length;ba++)L=Ma.J(ba),Na.contains(L)||(Na.add(L),za.add(L))}X.logger.gna("GhostCellOENodesAddedToChildrenList");if(ma=ma.ucg)for(Ja=0;Ja<ma.length;Ja++)if(pa=ma.J(Ja),pa=X.runtime.BTb.J(ka).J(pa))if(pa=pa.Ape){pa=pa.zH();Na=new z.a;for(Da=0;Da<fa.length;Da++)pa.contains(fa.J(Da))||Na.add(fa.J(Da));fa=Na;Na=new z.a;for(Da=0;Da<oa.length;Da++)pa.contains(oa.J(Da))||Na.add(oa.J(Da));oa=Na;Na=new z.a;for(Da=0;Da<za.length;Da++)pa.contains(za.J(Da))||Na.add(za.J(Da));za=Na}X.logger.gna("NonGhostCellsOENodesRemovedFromChildrenList");
return{U2d:fa,Z$d:oa,QEe:za}}zHg(X,fa){let ma=fa.yaa.hasProperty(f.a.ff),ka=fa.txa.hasProperty(f.a.ff);ma&&(ma=!!this.Xc.getPropertyObjectIds(fa.yaa,f.a.ff).length);ka&&(ka=!!this.Xc.getPropertyObjectIds(fa.txa,f.a.ff).length);if(ma!==ka)if(this.vyl(X.runtime.Qa))X.logger.eri(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return X.logger.wf(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.jEi(X,
fa)}D0k(X){let fa,ma;({U2d:X,Z$d:fa,QEe:ma}=this.SZh(X));return C.b(X,fa,ma)}Xhg(X,fa){n.a.instance.ya(4220309,1,4,"Considering {0} OutlineElement collections for merge.",fa.length);const ma=new z.a;let ka=!0;fa.forEach(oa=>{if(!oa)return n.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),X.logger.wf(Object.assign(new B,{Qh:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ka=!1;if(1===oa.jMl&&1===oa.K$f){const L=oa.URb.J(0),V=oa.DDf.J(0),ha=oa.tFb.J(0);if(L&&L.equals(V)&&
L.equals(ha))return ma.add(L),!0;if(1!==fa.length)return n.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",L,V,ha,fa.length),X.logger.wf(Object.assign(new B,{Qh:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ka=!1}const za=new m.a,Ja=new z.a,pa=new z.a,Na=new z.a,Da=new z.a,Aa=new z.a,Ma=new z.a,ba=X.runtime.pj;
oa.URb.forEach(L=>ka=this.bmg(X,L,V=>ba.J(V),Ja,Da,za,"Base"));if(!ka)return n.a.instance.ya(4285026,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),X.logger.wf(Object.assign(new B,{Qh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;oa.DDf.forEach(L=>ka=this.bmg(X,L,V=>this.AEa.oFb(V,X.runtime.Lw,ba),pa,Aa,za,"Favored"));if(!ka)return n.a.instance.ya(4285027,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
X.logger.wf(Object.assign(new B,{Qh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;oa.tFb.forEach(L=>ka=this.bmg(X,L,V=>this.AEa.oFb(V,X.runtime.Hp,ba),Na,Ma,za,"Unfavored"));if(!ka)return n.a.instance.ya(4285056,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),X.logger.wf(Object.assign(new B,{Qh:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;X.runtime.Qa&&X.runtime.Qa.rvb(1000005)&&(Aa.length&&this.XDk(Aa,X.runtime.Lw)?
(this.zph(Aa,X,ma,za),this.c1d(X,za,Ma)):this.zph(Ma,X,ma,za));if(Ja.length){oa=null;if(!({Jl:oa}=this.G1l(X,Ja,pa,Na,oa)).returnValue||!oa)return ka=!1;oa.forEach(L=>{0<L.Alc.count&&X.runtime.Jl.W(L.Oi.id,L);ma.add(za.J(L.Oi.id));return!0})}return!0});return ka?ma:null}XDk(X,fa){for(let ma=0;ma<X.length;ma++)if(fa.get(X.Ye(ma).id))return!0;return!1}c1d(X,fa,ma){ma.forEach(ka=>{X.runtime.XEc.add(ka.id);X.runtime.XEc.add(fa.J(ka.id));return!0});H.a.c1d(X,this.Xc,ma.J(0))}zph(X,fa,ma,ka){X.forEach(oa=>
{const za=new Y.a(oa.gF());fa.runtime.Jl.W(oa.id,za);ma.add(ka.J(oa.id));return!0})}bmg(X,fa,ma,ka,oa,za,Ja){var pa=ma(fa);if(!pa)return n.a.instance.ya(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",Ja,fa),X.logger.wf(Object.assign(new B,{Qh:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",Ja)})),!1;const Na=this.Xc.getPropertyObjectIds(pa,f.a.pfa);if(!Na||!Na.length)return n.a.instance.ya(4285058,1,
1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",Ja,fa),X.logger.wf(Object.assign(new B,{Qh:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",Ja)})),J.a(pa,"ProcessOutlineElement_"+Ja,1),!1;pa=Na.Ye(0);ma=ma(pa);if(!ma)return n.a.instance.ya(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",Ja,pa,fa),X.logger.wf(Object.assign(new B,{Qh:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",Ja)})),!1;if((Ja=this.Xc.getPropertyString(ma,c.a.GM))&&""!==Ja&&X.runtime.Qa&&(X.runtime.Qa.xRf(1000005),X.runtime.Qa.rvb(1000005)))return oa.add(ma),za.add(pa,fa),X.runtime.hWa.add(pa),!0;ka.add(ma);za.add(pa,fa);X.runtime.hWa.add(pa);return!0}SZh(X){let fa,ma;fa=this.Xc.getPropertyObjectIds(X.dF,f.a.ff);ma=this.Xc.getPropertyObjectIds(X.yaa,f.a.ff);X=this.Xc.getPropertyObjectIds(X.txa,f.a.ff);
return{U2d:fa,Z$d:ma,QEe:X}}vyl(X){if(!X)return n.a.instance.ya(51422868,1,2,"Feature Helper is null"),!1;X.eo(182);return X.isFeatureEnabled(182)}static LFi(X,fa){fa.La(X.Ab)||fa.W(X.Ab,new z.a);fa.J(X.Ab).add(X);return!0}}U.Ase=v.a.Ad("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(U,"ChildNodeListMerge",null,[1317])},1439:function(D,P,b){D=b(0);var f=b(1133),c=b(1294),n=b(1194),m=b(1170),w=b(1211);class z{constructor(X,fa){this.DimensionValue=this.DimensionName=null;this.DimensionName=
X;this.DimensionValue=fa}}Object(D.a)(z,"Dimension",null,[]);class v{constructor(X,fa,ma,ka,oa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=X;this.Query=fa;this.From=ma;this.Size=ka;oa&&(this.Filter=oa)}}Object(D.a)(v,"EntityRequest",null,[]);class t{constructor(X){this.QueryString=null;this.QueryString=X}}Object(D.a)(t,"Query",null,[]);var A=b(1145);class B{constructor(X,fa){this.Dimensions=this.Name=null;this.Name=X;this.Dimensions=fa}}Object(D.a)(B,"Scenario",
null,[]);var S=b(1160),C=b(1150);class H{constructor(X,fa,ma,ka){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=X;this.TimeZone=fa;this.Cvid=ma;this.Scenario=ka}}Object(D.a)(H,"SubstrateBody",null,[]);var J=b(1210),M=b(1129),G=b(1126),R=b(2),O=b(1390),I=b(1389),K=b(1207),Y=b(30),W=b(16),Z=b(129);b.d(P,"a",function(){return U});class U{constructor(X){this.EXc=this.Fpb=this.QTd=this.LQc=this.EYc=0;this.I$g=this.bdh=this.rS=null;this.MLb=0;this.a5=-1;this.Z0c="";this.Re=
R.AFrameworkApplication.je;this.sc=X;this.p$e=this.g7k();this.W7e=new c.a;this.c9g=this.sc.jEe?3:2;this.Mjh=this.sc.jEe&&this.sc.n1i?5:3;this.Lmh=this.sc.Cjb?2:3;this.cTd=this.sc.z2h;this.gih=this.sc.Txl;this.UZc=X.I5h;R.AFrameworkApplication.K&&(this.bdh=R.AFrameworkApplication.K.Oa("AppCatalogUrl")+R.AFrameworkApplication.K.Oa("SearchPersonaPhotoBaseUrl"))}Yaa(){return"Substrate"}Wta(){return this.sc.eM?1===this.sc.eM?1:3:0}Z7(X,fa,ma,ka=f.a.tellMe,oa=null){const za=new C.a(X);if(!oa||Array.contains(oa,
13)||Array.contains(oa,14)||Array.contains(oa,19))if(!this.MLb||window.performance.now()-this.MLb>=G.a.ODe)if(ma=this.W7e.e6h())this.MLb=window.performance.now(),ma.then(Ja=>{Ja&&""!==Ja?(this.Z0c=Ja,""!==this.rS&&this.d6h(X,ka,this.Z0c,fa,oa)):(M.TellMeActor.instance.tf.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),fa.resultsUpdated(za))},Ja=>{M.TellMeActor.instance.tf.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ja);fa.resultsUpdated(za)});
else{if(M.TellMeActor.instance.tf)M.TellMeActor.instance.tf.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");fa.resultsUpdated(za)}else this.Z0c&&""!==this.Z0c?this.d6h(X,ka,this.Z0c,fa,oa):(fa.resultsUpdated(za),M.TellMeActor.instance.tf.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else fa.resultsUpdated(za)}hxe(){this.Fpb=this.EXc=this.QTd=this.LQc=this.EYc=0}d6h(X,fa,ma,ka,oa){this.hxe();const za=new C.a(X),Ja=this.rS=Z.a.create().toString();
this.hKa();this.a5=window.setTimeout(()=>{if(Ja===this.rS){this.rS="";this.a5=-1;ka.resultsUpdated(za);const Da={};Da[n.a.provider]=this.Yaa();Da[n.a.KAc]=X.t8b;M.TellMeActor.instance.tf.$G(m.a.timedOut,this.UZc,Da)}},this.UZc);const pa={"Content-Type":"application/json",Accept:"application/json"};pa.Authorization="Bearer "+ma;pa["X-Office-Version"]=R.AFrameworkApplication.buildVersion;pa["X-Office-Application"]=R.AFrameworkApplication.K.Oa("Application");pa["X-Office-Platform"]="WAC";pa["X-TellMe-SessionId"]=
M.TellMeActor.instance.vfe();pa["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;pa["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;pa["Client-Request-Id"]=Ja;const Na=window.performance.now();this.Re.Ki(this.b7k(),2,this.c7k(X.Bh,this.sc.application,M.TellMeActor.instance.vfe(),G.a.eCa(X)),pa,!1,0,Da=>{this.d7b(Da,X,ka,Ja,Na,fa,oa)},Da=>{this.M6b(Da,X,ka,Ja,Na)},null,null,!1,4E3,6E3)}hKa(){-1!==this.a5&&(window.clearTimeout(this.a5),this.a5=-1)}d7b(X,fa,ma,ka,oa,za,Ja){M.TellMeActor.instance.tf.Mba(fa.Bh.length,
this.p$e.join(","),X.data.mf.toString(),Math.round(window.performance.now()-oa),J.a.substrate,!0,w.a.rYa);const pa=G.a.eCa(fa),Na=new C.a(fa);if(ka===this.rS){this.hKa();X=Y.b(X.data.wd);if(X.Groups){X=X.Groups;for(const Da of X)"People"===Da.Type&&this.sc.KFd&&(Ja?Array.contains(Ja,13):1)?(X=this.G3h(Da.Suggestions,za),0<X.results.length&&Na.cF(X)):"File"===Da.Type&&this.sc.IFd&&(Ja?Array.contains(Ja,14):1)?(X=this.f_h(Da.Suggestions,pa,za),0<X.results.length&&Na.cF(X)):"Notes"===Da.Type&&this.sc.nfb&&
za!==f.a.contextMenu&&(Ja?Array.contains(Ja,19):1)&&(X=this.v2h(Da.Suggestions,pa,fa),0<X.results.length&&Na.cF(X))}ma.resultsUpdated(Na);M.TellMeActor.instance.tf.Mba(fa.Bh.length,this.p$e.join(","),"",Math.round(window.performance.now()-oa),"",!0,w.a.provider)}else ma.resultsUpdated(Na)}v2h(X,fa,ma){const ka=new S.a(19);ka.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const oa of X)this.Pzl(oa)&&(X=oa.NotesType,X=W.a.Cf(X),X=this.T_k(X,oa.LastModifiedTime,oa.BodyPreview,oa.Subject,
fa,ma,oa))&&(X.groupType=19,ka.dI(X));return ka}G3h(X,fa){const ma=new S.a(13);ma.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const oa of X)if(this.Qzl(oa)){var ka=oa.Id.split("@")[0];X=oa.EmailAddresses[0];let za=oa.Type;if(void 0===za||null===za)za="User";if(ka=this.f2k(za,oa.DisplayName,oa.JobTitle,X,ka,fa))ka.description=X,X=oa.JobTitle,"Department"in oa&&"CompanyName"in oa&&(X+="@"+oa.Department+"@"+oa.CompanyName),ka.rN=X,ma.dI(ka)}return ma}f_h(X,fa,ma){const ka=new S.a(14);
ka.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ja of X)if(this.Ezl(Ja)){var oa=Ja.FileName;X=Ja.FileExtension;const pa=oa.length>X.length?oa.substr(0,oa.length-X.length-1):Ja.Title;var za=void 0;X=0;"DateCreated"in Ja?(X=G.a.hQf(Ja.DateCreated),za=G.a.p7h(Ja.DateCreated),za=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ja.Author,za)):za=Ja.Author;const Na=Ja.AccessUrl+"?web=1",Da=W.a.fhe(Na);oa=String.format('<a href="{0}">{1}</a>',Da,W.a.Y2(oa));if(ma!==f.a.contextMenu||
W.a.cR(Na))if(oa=this.hUk(pa,ma===f.a.contextMenu?oa:Na,za,Ja.FileExtension,Ja.Text,fa))oa.description=Ja.Author,oa.H1d=X,ka.dI(oa)}return ka}M6b(X,fa,ma,ka,oa){ka===this.rS&&(this.hKa(),M.TellMeActor.instance.tf.Mba(fa.Bh.length,this.p$e.join(","),X.data.mf.toString(),Math.round(window.performance.now()-oa),J.a.substrate,!1,w.a.rYa));X=new C.a(fa);ma.resultsUpdated(X)}f2k(X,fa,ma,ka,oa,za){if(!window.LPC&&!G.a.mZf()||this.EYc===this.c9g)return null;this.EYc+=1;const Ja="PeopleSuggestion"+this.EYc.toString();
var pa=this.bdh+"?size=1&accountName="+ka;X=Object.assign(new O.a,{PersonaType:X,Smtp:ka,ProfilePictureUrl:pa,AadObjectId:oa});pa=Object.assign(new I.a,{identifiers:X,displayName:fa});X=[];X.push(appChrome.actions.setPersonaButtonCoauthor(Ja,pa,fa,ma));ma=za===f.a.contextMenu;za===f.a.contextMenu&&(oa=G.a.Hok(fa,ka,oa),X.push(appChrome.actions.setButtonCommandValueId(Ja,oa)));X.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ja,ma));appChrome.api.dispatch(X);return new A.a(Ja,11,
fa,ka)}T_k(X,fa,ma,ka,oa,za,Ja){if(oa&&!this.sc.kmi||this.QTd===this.cTd||this.EXc===this.cTd||this.Fpb===this.cTd)return null;var pa=null;this.QTd+=1;oa="";const Na=[],Da={};Ja.Type="Note";this.I$g=Object.assign(new K.a,{landingTab:"Notes",data:Ja});za=G.a.Dsb(za.Bh,32,this.I$g);if("onenotepagepreviews"===X){if(!("ClickthroughUrl"in Ja&&Ja.ClickthroughUrl)||""===Ja.ClickthroughUrl)return null;this.EXc+=1;oa="OnenoteNotesSuggestion"+this.EXc.toString();Da["default"]="SaveAsonetoc2_20";pa=Ja.ClickthroughUrl;
Na.push(appChrome.actions.setControlIconSet(oa,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(oa,pa));pa=new A.a(oa,19)}else if("stickynote"===X){if(!this.gih)return null;this.Fpb+=1;oa="NotesSuggestion"+this.Fpb.toString();Da["default"]="ShowAllNotes_20";Na.push(appChrome.actions.setControlIconSet(oa,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(oa,za));pa=new A.a(oa,21)}else if("samsung"===X){if(!this.gih)return null;this.Fpb+=1;oa="NotesSuggestion"+this.Fpb.toString();
Da["default"]="CategoryCollapsed_20";Na.push(appChrome.actions.setControlIconSet(oa,Da));Na.push(appChrome.actions.setCompoundButtonCommandValueId(oa,za));pa=new A.a(oa,20)}""!==oa&&(X=G.a.p7h(fa),X=String.format(CommonUIStrings.l_LastModifiedString,X),pa.label=ka,pa.H1d=G.a.hQf(fa),Na.push(appChrome.actions.setControlLabel(oa,ka)),Na.push(appChrome.actions.updateCompoundButtonDescription(oa,X)),Na.push(appChrome.actions.setControlCustomTooltip(oa,ma)),appChrome.api.dispatch(Na));return pa}hUk(X,
fa,ma,ka,oa,za){if(this.LQc===(za?this.Lmh:this.Mjh))return null;this.LQc+=1;za="FileSuggestion"+this.LQc.toString();const Ja=[],pa={};pa["default"]=G.a.sWk(ka);Ja.push(appChrome.actions.setControlLabel(za,X));Ja.push(appChrome.actions.setControlIconSet(za,pa));Ja.push(appChrome.actions.updateCompoundButtonDescription(za,ma));Ja.push(appChrome.actions.setCompoundButtonCommandValueId(za,fa));Ja.push(appChrome.actions.setControlCustomTooltip(za,oa));appChrome.api.dispatch(Ja);return new A.a(za,6,X,
ma)}g7k(){const X=[];this.sc.KFd&&Array.add(X,"People");this.sc.IFd&&Array.add(X,"File");this.sc.nfb&&Array.add(X,"Notes");return X}c7k(X,fa,ma,ka){var oa=new t(X);ka=new v("File",oa,0,ka?this.Lmh:this.Mjh,null);X=new v("People",oa,0,this.c9g,G.a.d3l);oa=new v("Notes",oa,0,this.cTd,null);fa=new z("app",fa.toLowerCase());var za=[];Array.add(za,fa);fa=new B("tellmesearch",za);za=[];this.sc.IFd&&Array.add(za,ka);this.sc.KFd&&Array.add(za,X);this.sc.nfb&&Array.add(za,oa);ma=new H(za,"UTC",ma,fa);return Y.c(ma)}b7k(){let X=
this.sc.zMm;this.sc.nfb&&(X+="?&setflight=NotesFrom3S");""!==this.sc.f6h&&(X=X+"&"+this.sc.f6h);return X}Qzl(X){return"DisplayName"in X&&"Id"in X&&"EmailAddresses"in X&&!!X.Id&&!!X.EmailAddresses}Ezl(X){return"FileExtension"in X&&!!X.FileExtension&&"FileName"in X&&!!X.FileName&&""!==X.FileName&&"AccessUrl"in X&&!!X.AccessUrl&&""!==X.AccessUrl}Pzl(X){return"Id"in X&&!!X.Id&&"NotesType"in X&&!!X.NotesType&&"Subject"in X&&!!X.Subject&&""!==X.Subject}}Object(D.a)(U,"SubstrateResultsProvider",null,[1249])},
1453:function(D,P,b){D=b(0);var f=b(184),c=b(1299),n=b(127),m=b(1191);class w extends c.a{constructor(v,t,A,B,S,C,H,J,M,G,R,O,I,K){super(v,3,t,A,B,S,C,J,M,G,R,O,I,K);this.KLe=H}get character(){return this.KLe}get text(){return this.character.toString()}gDd(){throw n.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Mrc(){return"CharRun"}clone(){return new w(this.t4c,this.source,this.ij,this.We,this.runId,this.hK,this.character,this.DAb,this.fZa,this.jma,this.vMa,this.o8b,
this.JF,this.mB)}zz(v,t,A,B=!1){return super.zz(v,t,A,B)?v.character===this.character?!0:m.a.Wth(v.character,this.character):!1}}Object(D.a)(w,"CharRunMergeBlock",c.a,[]);b.d(P,"a",function(){return z});class z extends c.a{constructor(v,t,A,B,S,C,H,J,M,G,R,O,I,K,Y){super(v,1,t,A,B,S,C,J,G,R,O,I,K,Y);this._text=H;this.z$e=M}get text(){return this._text}gDd(v){this._text=v}get $jb(){return this.z$e&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),
this.z$e)}Mrc(){return"TextRun"}clone(){return new z(this.t4c,this.source,this.ij,this.We,this.runId,this.hK,this._text,this.DAb,this.z$e,this.fZa,this.jma,this.vMa,this.o8b,this.JF,this.mB)}zz(v,t,A,B=!1){return super.zz(v,t,A,B)?m.a.Vth(this._text,v._text):!1}wEd(){const v=new f.a;for(let A=0;A<this.text.length;A++){var t=m.a.charAt(this._text,A);if(m.a.ryl(m.a.nQm(t))){let B="";B+=t;t=m.a.charAt(this._text,++A);B+=t;t=new z(this.t4c,this.source,this.ij,this.We,this.runId,this.hK,B,this.DAb,!1,
this.fZa,this.jma,this.vMa,this.o8b,this.JF,this.mB);v.add(t)}else t=new w(this.t4c,this.source,this.ij,this.We,this.runId,this.hK,t,this.DAb,this.fZa,this.jma,this.vMa,this.o8b,this.JF,this.mB),v.add(t)}return v}}Object(D.a)(z,"TextRunMergeBlock",c.a,[])},1454:function(D,P,b){D=b(0);var f=b(817),c=b(18),n=b(381),m=b(184),w=b(52);b(690);var z=b(531),v=b(126),t=b(127),A=b(824),B;(function(M){M[M.none=0]="none";M[M.browser=1]="browser";M[M.serverPutChanges=2]="serverPutChanges";M[M.syncDiff=3]="syncDiff";
M[M.docxMerge=4]="docxMerge";M[M.undo=5]="undo"})(B||(B={}));Object(D.b)("GraphMergeSource",B);var S=b(1437),C=b(1208),H=b(1433);b.d(P,"a",function(){return J});class J{constructor(M){this.XA=new A.a;this.pS=new n.a;this.kkh=new n.a(0);this.OKd=new m.a;this.v2g=new m.a;this.h$g=new m.a;this.Q7g=new m.a;this.u9g="";this.bnb=null;this.Jm=this.lZe=0;this.LUd=new n.a(0);this.dRe=this.wch=this.qSd=0;const {MarkerValidation:G}=b(1550);this._state=M;this.nBj=new G}get XZa(){return this.nBj}zAm(M){this.lZe=
M}Ume(M,G){this.u9g=String.format("{0}-{1}",M,G)}Dze(M){this.ick();this.dRe=M}Szg(){this.dRe=0}ick(){this.bnb&&this.OKd.add(this.bnb);this.bnb=null}wf(M){this.bnb||(this.bnb=M);switch(this.dRe){case 1:this.v2g.add(M);break;case 2:this.h$g.add(M);break;case 3:this.Q7g.add(M);break;default:this.bnb&&this.OKd.add(M)}}eri(M){this.OKd.add(M)}hGl(){this.Jm=this.OLa();this.gna("MergeEnd")}gna(M){const G=this.OLa();this.kkh.W(M,G-this.lZe);this.lZe=G}Zym(){this.qSd=this.OLa();this.wch++}nM(M){const G=this.OLa();
let R;({value:R}=this.LUd.tb(M)).returnValue?(R+=G-this.qSd,this.LUd.W(M,R)):this.LUd.W(M,G-this.qSd);this.qSd=G}mZk(){this.pS.W("Id",this._state.input.O3b.toString());this.pS.W("Source",B[this._state.input.source]);this.pS.W("Base",J.JEa(this.QNk()));this.pS.W("Favored",J.JEa(this.V4h(!0)));this.pS.W("Unfavored",J.JEa(this.V4h(!1)));this.pS.W("NodesRolledBackIfFailed",J.JEa(this.N_k()));if(!this._state.output.succeeded){let M,G,R,O,I;({L1j:M,$Dk:G,CUm:R,M1j:O,DUm:I}=this.kFk(this._state.runtime));
this.pS.W("CharactersLost",this.uPk(M,G,R));this.pS.W("CharactersLostInComments",this.cQk());this.pS.W("CharactersLostInTables",this.RMk(I,O))}this.pS.W("FuncStep",this.u9g);this.pS.W("FailureDetail",J.JEa(this.sYb()));this.pS.W("FailDetailHints",this.Zce(this.v2g));this.pS.W("FailDetailNaiveMerge",this.Zce(this.h$g));this.pS.W("FailDetailLcs",this.Zce(this.Q7g));this.pS.W("ExtraDetails",this.Zce(this.OKd));this.pS.W("Timeline",J.JEa(this.kkh));this.pS.W("ParagraphMergesCount",this.wch);this.pS.W("ParagraphMergeDurations",
J.JEa(this.LUd));this.pS.W("MarkerInfo",J.JEa(this.XZa.zZh()));this.pS.W("Result",J.JEa(this.nZk()));return JSON.stringify(J.JEa(this.pS))}OLa(){return(new Date).getTime()}QNk(){const M=new n.a,G=this._state.input.KEa,R=this._state.runtime.sKa?this._state.runtime.sKa.id:w.a.nil;let O=!1,I=0;for(;I<G.length;I++)if(G.J(I).id.equals(R)){O=!0;break}M.W("LastId",R.toString());M.W("Length",O?I+1:-1);return M}V4h(M){const G=new n.a;if(!this._state.input.s3)return null;M=M?2===this._state.input.s3?this._state.input.s9:
this._state.input.KEa:2===this._state.input.s3?this._state.input.KEa:this._state.input.s9;G.W("FirstId",M.J(0).id.toString());G.W("LastId",M.length?M.J(M.length-1).id.toString():null);G.W("Length",M.length);return G}N_k(){if(!this._state.runtime.Ndi)return null;const M=this._state.runtime.Hp,G=new n.a(0);M.forEach((R,O)=>{({value:R}=G.tb(O.Ab.toString()));G.W(O.Ab.toString(),R+1);return!0});return G}uPk(M,G,R){let O=null,I=null,K=null;const Y=this._state.runtime.Hp;let W=0;try{K=new H.a(this.XA,this._state);
O=C.b(M,G,R);I=new z.a;for(M=0;M<O.length;M++)if(!O.J(M).URb.Ln(O.J(M).tFb,(Z,U)=>Z.equals(U))){const Z=this.kMh(O.J(M),K);W+=Z;I.add(O.J(M))}O&&Y.forEach((Z,U)=>{if(393230===U.Ab){U=null;for(let X=0;X<O.length;X++)if(!I.contains(O.J(X))&&O.J(X).tFb.contains(Z,(fa,ma)=>fa===ma)){U=O.J(X);break}U&&(Z=this.kMh(U,K),I.add(U),W+=Z)}return!0});return W}catch(Z){return v.a.instance.ya(579190992,1,2,"Exception in GetCharactersLost: "+Z.toString()),-1}}kFk(M){let G,R,O,I,K;M.NF=W=>{if(750<this.OLa()-this._state.input.YDa)throw v.a.instance.ya(579190991,
1,2,"Timed out while calculating characters lost: {0}",W),t.a.invalidOperation(W);};G=new m.a;R=new m.a;O=new m.a;I=new m.a;const Y=new m.a;K=new m.a;try{if(M.pj){const W=M.pj.J(S.ChildNodeListMerge.Ase);let Z,U;Z=M.Lw.J(S.ChildNodeListMerge.Ase)||W;U=M.Hp.J(S.ChildNodeListMerge.Ase)||W;this.jEf(W,X=>M.pj.J(X),G,I);this.jEf(Z,X=>M.Lw.J(X)||M.pj.J(X),R,Y);this.jEf(U,X=>M.Hp.J(X)||M.pj.J(X),O,K)}}catch(W){v.a.instance.ya(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+W.toString())}return{L1j:G,
$Dk:R,CUm:O,M1j:I,DUm:K}}RMk(M,G){try{let O=0;const I=this._state.runtime;var R=W=>I.Hp.J(W)||I.pj.J(W);const K=new z.a,Y=this.BGk(M,I,R,K);for(M=0;M<Y.count;M++){let W=Y.keys.J(M);const Z=Y.J(W);if(!K.contains(W)){let U=this.z6h(I,R,K,W,Z);if(-1!==U)O+=U;else return v.a.instance.ya(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(R=0;R<G.length;R++){let W=G.J(0);if(!K.contains(W)){let Z=this.zfe(I.pj.J(W));if(-1===Z)return v.a.instance.ya(573089734,1,2,
"Error calculating characters lost in table deleted from base"),-1;O+=Z}}return O}catch(O){return v.a.instance.ya(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+O.toString()),-1}}z6h(M,G,R,O,I){M.NF("GetTableCharactersLost");let K=0;I=this.XA.getPropertyObjectIds(I,c.a.ff);for(let X=0;X<I.length;X++){var Y=G(I.J(X));Y=this.XA.getPropertyObjectIds(Y,c.a.ff);for(let fa=0;fa<Y.length;fa++){var W=G(Y.J(fa));if(M.pj.J(I.J(X))&&M.pj.J(Y.J(fa))){var Z=M.pj.J(Y.J(fa));if(!Z)return v.a.instance.ya(573089737,
1,2,"Base cell unexpectedly null"),-1;W=this.XA.getPropertyObjectIds(Z,c.a.ff);var U=M.Lw.J(Y.J(fa))||M.pj.J(Y.J(fa));U=this.XA.getPropertyObjectIds(U,c.a.ff);Z=this.XA.getPropertyObjectIds(Z,c.a.ff);W=C.b(W,U,Z);for(Z=0;Z<W.length;Z++){U=W.J(Z);const ma=this.J7k(M,G,R,U);if(-1===ma)return v.a.instance.ya(573089738,1,2,"Error getting characters lost for parition {0}",U.toString()),-1;K+=ma}}else{Z=this.l8k(G,W,R);if(-1===Z)return v.a.instance.ya(573089736,1,2,"Error getting text length of cell {0}",
W.id.toString()),-1;K+=Z}}}R.add(O);return K}J7k(M,G,R,O){let I=0;var K=new m.a,Y=new m.a;const W=new n.a;new n.a;for(var Z=0;Z<O.URb.length;Z++){var U=M.pj.J(O.URb.J(Z));U=this.XA.getPropertyObjectIds(U,c.a.pfa);if(1!==U.length)return v.a.instance.ya(573089739,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;var X=M.pj.J(U.J(0));393230===X.Ab?K.add(X):393250===X.Ab&&W.add(U.J(0),X)}for(Z=0;Z<O.tFb.length;Z++){U=G(O.tFb.J(Z));U=this.XA.getPropertyObjectIds(U,c.a.pfa);if(1!==U.length)return v.a.instance.ya(573089740,
1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;X=G(U.J(0));if(393230===X.Ab)Y.add(X);else if(393250===X.Ab){X=this.z6h(M,G,R,U.J(0),X);if(-1===X)return v.a.instance.ya(573089741,1,2,"Error diffing table {0}",U.J(0).toString()),-1;I+=X}}Z=new H.a(this.XA,this._state);if(0<K.length&&0<Y.length){K=Z.QSh(K,fa=>M.pj.J(fa),Y,fa=>G(fa));if(-1===K)return v.a.instance.ya(573089742,1,2,"Problem diffing parition {0} with LCS",O.toString()),-1;I+=K}else if(0<K.length)for(O=0;O<K.length;O++)I+=this.XA.getPropertyString(K.J(O),
c.a.Zk).length+1;else if(0<Y.length)for(O=0;O<Y.length;O++)I+=this.XA.getPropertyString(Y.J(O),c.a.Zk).length+1;for(O=0;O<W.count;O++)if(K=W.keys.J(O),!R.contains(K)){Y=this.zfe(W.J(K));if(-1===Y)return v.a.instance.ya(573089743,1,2,"Error getting length of table {0}",K.toString()),-1;I+=Y}return I}l8k(M,G,R){let O=0;G=this.XA.getPropertyObjectIds(G,c.a.ff);for(let Y=0;Y<G.length;Y++){var I=M(G.J(Y));I=this.XA.getPropertyObjectIds(I,c.a.pfa);if(1!==I.length)return v.a.instance.ya(573089744,1,2,"Unexpected number of ContentNodes: {0}",
I.length),-1;var K=M(I.J(0));if(393230===K.Ab)O+=this.XA.getPropertyString(K,c.a.Zk).length+1;else if(393250===K.Ab){K=this.zfe(K);if(-1===K)return v.a.instance.ya(573089745,1,2,"Problem finding text length of table {0}",I.J(0).toString()),-1;O+=K;R.add(I.J(0))}}return O}zfe(M){this._state.runtime.NF("GetTextLengthOfTable");let G=0;const R=W=>this._state.runtime.Hp.J(W)||this._state.runtime.pj.J(W);M=this.XA.getPropertyObjectIds(M,c.a.ff);for(let W=0;W<M.length;W++){var O=R(M.J(W));O=this.XA.getPropertyObjectIds(O,
c.a.ff);for(let Z=0;Z<O.length;Z++){var I=R(O.J(Z));I=this.XA.getPropertyObjectIds(I,c.a.ff);for(let U=0;U<I.length;U++){var K=R(I.J(U));K=this.XA.getPropertyObjectIds(K,c.a.pfa);if(1!==K.length)return v.a.instance.ya(573089746,1,2,"Unexpected number of ContentNodes: {0}",K.length),-1;var Y=R(K.J(0));if(393230===Y.Ab)G+=this.XA.getPropertyString(Y,c.a.Zk).length+1;else if(393250===Y.Ab){Y=this.zfe(Y);if(-1===Y)return v.a.instance.ya(573089747,1,2,"Error finding the text length of table {0}",K.J(0)),
-1;G+=Y}}}}return G}BGk(M,G,R,O){const I=new n.a;for(let K=0;K<M.length;K++){let Y=!1;G.Hp.J(M.J(K))&&(Y=!0);const W=R(M.J(K)),Z=this.XA.getPropertyObjectIds(W,c.a.ff);if(!Y)for(let U=0;U<Z.length;U++)if(G.Hp.J(Z.J(U))){Y=!0;break}Y?I.add(M.J(K),W):O.add(M.J(K))}return I}kMh(M,G){return this.jMh(M.URb,M.tFb,G)}jMh(M,G,R){const O=new m.a;for(var I=0;I<M.length;I++)O.add(this._state.runtime.pj.J(M.J(I)));M=new m.a;for(I=0;I<G.length;I++)M.add(this._state.runtime.Hp.J(G.J(I))||this._state.runtime.pj.J(G.J(I)));
return R.QSh(O,K=>this._state.runtime.pj.J(K),M,K=>this._state.runtime.Hp.J(K)||this._state.runtime.pj.J(K))}jEf(M,G,R,O){if(393227===M.Ab){M=this.XA.getPropertyObjectIds(M,c.a.ff);for(let I=0;I<M.length;I++){const K=this.XA.getPropertyObjectIds(G(M.J(I)),c.a.ff);for(let Y=0;Y<K.length;Y++){const W=this.XA.getPropertyObjectIds(G(K.J(Y)),c.a.ff);for(let Z=0;Z<W.length;Z++){const U=this.XA.getPropertyObjectIds(G(W.J(Z)),c.a.pfa);if(1!==U.length)return;const X=G(U.J(0));393230===X.Ab?R.add(U.J(0)):393250===
X.Ab?O.add(U.J(0)):v.a.instance.ya(573089748,1,2,"Unsupported class id in GetCharactersLost: "+f.a[X.Ab])}}}}}kEf(M,G){M=this.XA.getPropertyObjectIds(M,c.a.ff);const R=new m.a;for(let O=0;O<M.length;O++){const I=this.XA.getPropertyObjectIds(G(M.J(O)),c.a.pfa);if(1!==I.length)return null;R.add(I.J(0))}return R}cQk(){let M=0;const G=this._state.runtime,R=G.Hp,O=K=>G.Hp.J(K)||G.pj.J(K);let I=null;G.NF=K=>{if(750<this.OLa()-this._state.input.YDa)throw v.a.instance.ya(573089749,1,2,"Timed out while calculating comment characters lost: {0}",
K),t.a.invalidOperation(K);};try{R.forEach((K,Y)=>{if(1074135127===Y.Ab){K=this.kEf(Y,O);var W=G.pj.J(Y.id);if(W)W=this.kEf(W,U=>G.pj.J(U)),I||(I=new H.a(this.XA,this._state)),M+=this.jMh(W,K,I);else for(W=0;W<K.length;W++)M+=this.XA.getPropertyString(G.Hp.J(K.J(W)),c.a.Zk).length+1}if(1074135126===Y.Ab&&(K=this.XA.getPropertyObjectIds(Y,c.a.ff).zH(),Y=G.pj.J(Y.id)))for(Y=this.XA.getPropertyObjectIds(Y,c.a.ff),W=0;W<Y.length;W++)if(!K.contains(Y.J(W))){var Z=G.pj.J(Y.J(W));Z=this.kEf(Z,U=>G.pj.J(U));
for(let U=0;U<Z.length;U++)M+=this.XA.getPropertyString(G.pj.J(Z.J(U)),c.a.Zk).length+1}return!0})}catch(K){return v.a.instance.ya(573089750,1,2,"Exception in GetCommentCharactersLost: "+K.toString()),-1}return M}sYb(){return this.bnb?this.bnb.sYb():null}Zce(M){const G=new m.a;M.forEach(R=>{G.add(J.JEa(R.sYb()));return!0});return G.toArray()}nZk(){const M=new n.a;M.W("Succeeded",this._state.output.succeeded);M.W("Timeout",this._state.output.timeout);M.W("Crash",this._state.output.crash);M.W("MergedRevisions",
this._state.output.LK?this._state.output.LK.length:-1);M.W("Duration",this.Jm-this._state.input.YDa);return M}static JEa(M){if(!M)return null;const G={};M.forEach((R,O)=>{G[R.toString()]=O;return!0});return G}}Object(D.a)(J,"MergeLogger",null,[])},1455:function(D,P,b){D=b(0);var f=b(203),c=b(18),n=b(5),m=b(97),w=b(690),z=b(126),v=b(2),t=b(184),A=b(381),B=b(1119);class S{constructor(J,M,G){this.position=J;this.leader=M;this.val=G}equals(J){return this.position===J.position&&this.leader===J.leader&&
this.val===J.val}toString(){return this.position.toString()}}Object(D.a)(S,"TabStop",null,[]);var C=b(1551);b.d(P,"a",function(){return H});class H extends B.a{constructor(){super()}get Mn(){return 20}get xC(){return 0}uk(){const J=super.uk();J.W(w.a.Ya(c.a.Zk),1);J.W(w.a.Ya(c.a.DA),1);J.W(w.a.Ya(c.a.WB),1);J.W(w.a.Ya(n.a.Ao),1);J.W(w.a.Ya(n.a.zm),1);J.W(w.a.Ya(n.a.yb),1);J.W(w.a.Ya(c.a.XDa),1);J.W(w.a.Ya(n.a.ZT),1);J.W(w.a.Ya(n.a.xR),1);J.W(w.a.Ya(c.a.pR),1);J.W(w.a.Ya(n.a.HYa),1);J.W(w.a.Ya(n.a.KAa),
1);J.W(w.a.Ya(n.a.IYa),1);J.W(w.a.Ya(n.a.LWa),1);J.W(w.a.Ya(n.a.JYa),1);J.W(w.a.Ya(n.a.MWa),1);J.W(w.a.Ya(n.a.N_a),1);J.W(w.a.Ya(n.a.j2a),1);J.W(w.a.Ya(n.a.k2a),1);J.W(w.a.Ya(n.a.rRa),1);J.W(w.a.Ya(n.a.gs),1);J.W(w.a.Ya(n.a.dH),1);J.W(w.a.Ya(n.a.eH),1);J.W(w.a.Ya(n.a.Jy),1);J.W(w.a.Ya(m.a.vA),6);J.W(w.a.Ya(m.a.D4),6);J.W(w.a.Ya(n.a.D$a),7);J.W(w.a.Ya(m.a.vA),6);J.W(w.a.Ya(n.a.HEg),2);J.W(w.a.Ya(m.a.uhk),2);J.W(w.a.Ya(m.a.w1l),2);J.W(w.a.Ya(n.a.JGc),2);J.W(w.a.Ya(n.a.bEe),2);J.W(w.a.Ya(n.a.Lcc),2);
J.W(w.a.Ya(n.a.Bkb),2);J.W(w.a.Ya(n.a.KGc),2);J.W(w.a.Ya(n.a.LGc),2);J.W(w.a.Ya(n.a.lockNotFullySupportedParagraphInBlockContentControl),2);return J}cD(J,M){if(M===w.a.Ya(c.a.Zk)||M===w.a.Ya(c.a.DA)||M===w.a.Ya(c.a.WB)||M===w.a.Ya(n.a.Ao)||M===w.a.Ya(n.a.zm)||M===w.a.Ya(n.a.yb)||M===w.a.Ya(c.a.XDa)||M===w.a.Ya(n.a.ZT)||M===w.a.Ya(n.a.xR)||M===w.a.Ya(c.a.pR)||M===w.a.Ya(n.a.HYa)||M===w.a.Ya(n.a.KAa)||M===w.a.Ya(n.a.IYa)||M===w.a.Ya(n.a.LWa)||M===w.a.Ya(n.a.JYa)||M===w.a.Ya(n.a.MWa)||M===w.a.Ya(n.a.N_a)||
M===w.a.Ya(n.a.j2a)||M===w.a.Ya(n.a.k2a)||M===w.a.Ya(n.a.rRa)||M===w.a.Ya(n.a.gs)||M===w.a.Ya(n.a.GM)){var G=J.Zm.value.Kr,R=J.Zm.value.Ie;M=J.Lf.value.Ie;if(J.fo.runtime.hWa.contains(G.id))return z.a.instance.ya(18989579,1,3,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",G.id),!0;var O=J.fo.runtime.Qa;v.AFrameworkApplication.Dp("Word-TOCMerge;Word-TOCMergecf");if(O.rvb(1000005)&&this.HIm(J,M,R))return J.jl=M.gF(),H.Goh(J),H.c1d(J.fo,
J.Xc,R),!0;O=new t.a;O.add(G);G=new t.a;G.add(R);R=new t.a;R.add(M);if(!({Jl:M}=H.y9i(J.fo,O,R,G)).returnValue)return J.JPg=!0,J.jl=null,!1;H.Goh(J);J.jl=M.Ye(0).Oi;return!0}return M===w.a.Ya(n.a.dH)||M===w.a.Ya(n.a.eH)||M===w.a.Ya(n.a.Jy)?(this.wSm(J),J.ig.add(w.a.Ya(n.a.dH)),J.ig.add(w.a.Ya(n.a.eH)),J.ig.add(w.a.Ya(n.a.Jy)),!0):!1}HIm(J,M,G){M=J.Xc.getPropertyString(M,n.a.GM);J=J.Xc.getPropertyString(G,n.a.GM);return M||J?!0:!1}wSm(J){const M=J.Xc,G=J.jl;var R=J.Zm.value.Ie,O=J.Lf.value.Ie;J=this.JJf(J.Zm.value.Kr,
M);O=this.JJf(O,M);R=this.JJf(R,M);({DLl:R,ELl:J,FLl:O}=this.oZk(J,O,R));R.length?(M.setPropertyUint32s(G,n.a.Jy,R),M.setPropertyUint32s(G,n.a.dH,J),M.setPropertyUint32s(G,n.a.eH,O)):this.Cim(G)}JJf(J,M){const G=M.getPropertyUint32s(J,n.a.Jy),R=M.getPropertyUint32s(J,n.a.dH);J=M.getPropertyUint32s(J,n.a.eH);M=new t.a;if(!G)return M;for(let O=0;O<G.length;++O)M.add(new S(G.J(O),R.J(O),J.J(O)));return M}oZk(J,M,G){({cEi:M,dEi:K,eEi:I}=this.nZh(J,M));let R,O;({cEi:G,dEi:R,eEi:O}=this.nZh(J,G));J=this.bcl(J,
K,I,R,O);var I=this.acl(J,M,G);J=new t.a;M=new t.a;var K=new t.a;for(G=0;G<I.length;++G)J.add(I.J(G).position),M.add(I.J(G).leader),K.add(I.J(G).val);return{DLl:J,ELl:M,FLl:K}}nZh(J,M){let G,R,O;G=new t.a;R=new A.a;O=new A.a;let I,K;for(I=K=0;I<J.length&&K<M.length;)J.J(I).position===M.J(K).position?(J.J(I).equals(M.J(K))||O.W(J.J(I).position,M.J(K)),++I,++K):J.J(I).position<M.J(K).position?(R.W(J.J(I).position,J.J(I)),++I):(G.add(M.J(K)),++K);for(;I<J.length;)R.W(J.J(I).position,J.J(I)),++I;for(;K<
M.length;)G.add(M.J(K)),++K;return{cEi:G,dEi:R,eEi:O}}bcl(J,M,G,R,O){const I=new t.a;for(let K=0;K<J.length;++K){const Y=J.J(K).position;M.La(Y)||(G.La(Y)?I.add(G.J(Y)):R.La(Y)||(O.La(Y)?I.add(O.J(Y)):I.add(J.J(K))))}return I}acl(J,M,G){M=this.Tui(M,G);return this.Tui(J,M)}Tui(J,M){const G=new t.a;let R,O;for(R=O=0;R<J.length&&O<M.length;)J.J(R).position<=M.J(O).position?(G.add(J.J(R)),J.J(R).position===M.J(O).position&&++O,++R):G.add(M.J(O++));for(;R<J.length;)G.add(J.J(R++));for(;O<M.length;)G.add(M.J(O++));
return G}Cim(J){J.removeProperty(n.a.Jy);J.removeProperty(n.a.dH);J.removeProperty(n.a.eH)}static uh(){return new H}static get instance(){return H.Vg.value}static Goh(J){J.ig.add(w.a.Ya(c.a.Zk));J.ig.add(w.a.Ya(c.a.DA));J.ig.add(w.a.Ya(c.a.WB));J.ig.add(w.a.Ya(n.a.Ao));J.ig.add(w.a.Ya(n.a.zm));J.ig.add(w.a.Ya(n.a.yb));J.ig.add(w.a.Ya(c.a.XDa));J.ig.add(w.a.Ya(n.a.ZT));J.ig.add(w.a.Ya(n.a.xR));J.ig.add(w.a.Ya(c.a.pR));J.ig.add(w.a.Ya(n.a.HYa));J.ig.add(w.a.Ya(n.a.KAa));J.ig.add(w.a.Ya(n.a.IYa));J.ig.add(w.a.Ya(n.a.LWa));
J.ig.add(w.a.Ya(n.a.JYa));J.ig.add(w.a.Ya(n.a.MWa));J.ig.add(w.a.Ya(n.a.N_a));J.ig.add(w.a.Ya(n.a.j2a));J.ig.add(w.a.Ya(n.a.k2a));J.ig.add(w.a.Ya(n.a.rRa));J.ig.add(w.a.Ya(n.a.gs));J.ig.add(w.a.Ya(n.a.GM))}static y9i(J,M,G,R){return(new C.a(J,M,G,R)).VGc()}static c1d(J,M,G){G=M.getPropertyObjectIds(G,c.a.DA);for(let O=0;O<G.length;O++){var R=J.runtime.Hp.J(G.Ye(O));if(R&&(R=M.getPropertyObjectId(R,n.a.ud))){J.runtime.XEc.add(R);break}}}}H.Vg=new f.a(H.uh);Object(D.a)(H,"ParagraphNodeComplexMerge",
B.a,[])},1550:function(D,P,b){b.r(P);b.d(P,"MarkerValidation",function(){return n});D=b(0);var f=b(381),c=b(1454);class n{constructor(){this.Quc=this.Puc=this.Ouc=0}zZh(){const m=new f.a(0);m.W("InvalidBookmarks",this.Ouc);m.W("InvalidComments",this.Puc);m.W("InvalidContentControls",this.Quc);return m}P$h(){return 0<this.Ouc||0<this.Puc||0<this.Quc?!0:!1}toString(){return JSON.stringify(c.a.JEa(this.zZh()))}}Object(D.a)(n,"MarkerValidation",null,[])},1551:function(D,P,b){b.d(P,"a",function(){return z});
D=b(0);var f=b(126),c=b(824),n=b(219),m=b(1310),w=b(1217);class z{constructor(v,t,A,B,S=null,C=null,H=null,J=null){this.Tc=v;this.fD=t;this.uya=A;this.Oza=B;this.MBj=S;this.Vtj=C;this.UMj=H;this.IV=J||this.Ntf();this.hWd=this.IV(111)}Ntf(){return v=>!!this.Tc.runtime.Qa&&this.Tc.runtime.Qa.isFeatureEnabled(v)}Yzf(){return!!this.Tc.runtime.pj.J(n.a.fL)}B2i(){let v;if(1===this.Tc.input.source||2===this.Tc.input.source)v=131;else if(4===this.Tc.input.source||3===this.Tc.input.source)v=60;else if(5===
this.Tc.input.source)v=212;else return!1;return this.Yzf()&&this.IV(v)}U3i(v,...t){return String.format.apply(null,[v].concat(t))}qee(v){const {ParagraphMerge:t}=b(1587);let A=this.Tc,B=this.uya,S=this.Oza;v||(A=this.MBj||this.Tc,B=this.Vtj||B,S=this.UMj||S);var C=w.a.BMf(this.fD);const H=w.a.BMf(B),J=w.a.BMf(S);C=this.U3i("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",A.input.source,A.runtime.sKa.id,
A.runtime.$$d,A.runtime.REe,C.So(),H.So(),J.So());return v?{returnValue:new m.a(A,this.fD,B,S,this.Ntf(),new c.a),So:C}:{returnValue:new t(A,this.fD,B,S,this.Ntf(),new c.a),So:C}}VGc(){let v;this.Tc.logger.Zym();var t=this.B2i();let A=({So:S}=this.qee(t)).returnValue;f.a.instance.ya(18994389,1,3,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",t,S);this.Tc.logger.nM("ParagraphMergeSelector initialization");t?this.Tc.logger.Dze(1):this.Tc.logger.Dze(2);this.Tc.runtime.Qa.eo(111);let B=({Jl:v}=
A.VGc()).returnValue;this.Tc.logger.Szg();var S=this.hWd?!B:t&&!B&&A.vxe;t=!!this.Tc.runtime.pj.J(n.a.fL)&&(t&&!B||!t);S&&({So:S,returnValue:A}=this.qee(!1),{Jl:v,returnValue:B}=A.VGc(),f.a.instance.ya(18994390,1,B?3:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",B,S));t&&(S=new c.a,w.a.Tnm(this.Tc,S));this.Tc.logger.nM("ParagraphMergeSelector finalization");return{returnValue:B,Jl:v}}CHd(v,t){let A,B,S;const C=this.B2i()&&this.IV(213);let H=({So:S}=this.qee(C)).returnValue,J=
({rib:A,pwa:B}=H.CHd(v,t)).returnValue;f.a.instance.ya(18994391,1,3,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",C,S);C&&!J&&H.vxe&&({So:S,returnValue:H}=this.qee(!1),{rib:A,pwa:B,returnValue:J}=H.CHd(v,t),f.a.instance.ya(18994392,1,J?3:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",J,S));return{returnValue:J,rib:A,pwa:B}}}Object(D.a)(z,"ParagraphMergeSelector",null,[1314])},1552:function(D,P,b){b.r(P);b.d(P,"SurfaceStringTokenStringGenerator",
function(){return c});D=b(0);var f=b(1249);class c extends f.a{constructor(n){super(n);this.Ra=n}apply(n,m,w,z,v,t,A){null==t&&(t=n.y7h(v,m));A=f.a.Aph(n,t,this.Ra.score,w,z,A);return{jGd:t,Y5c:A}}}c.Z5c=0;Object(D.a)(c,"SurfaceStringTokenStringGenerator",f.a,[])},1553:function(D,P,b){b.r(P);b.d(P,"QueryTokenStringGenerator",function(){return n});D=b(0);var f=b(1249),c=b(1118);class n extends f.a{constructor(m){super(m);this.Ra=m}apply(m,w,z,v,t,A,B){w=this.Ra.query.load(w,null);t=0;let S=null;this.Ra.query.Q8===
c.Annotations.kEa?w&&(S=this.Ra.name):((S=this.Ra.name)&&(S+="_"),S+=this.Ra.Le.bja(this.Ra.query.Q8,w));null!=S&&(t=f.a.Aph(m,S,this.Ra.score,z,v,t));return{jGd:A,Y5c:B+t}}}n.Z5c=1;Object(D.a)(n,"QueryTokenStringGenerator",f.a,[])},1554:function(D,P,b){b.r(P);b.d(P,"FuzzyMatchTokenStringGenerator",function(){return c});D=b(0);var f=b(1249);class c extends f.a{constructor(n){super(n);this.Ra=n}apply(n,m,w,z,v,t,A){null==t&&(t=n.y7h(v,m));n=this.Ra.NQh.CHl(t);if(this.Ra.DDi)for(var B of n)if(!B.tQ&&
B.Nae)return{jGd:t,Y5c:A};B=0;for(const S of n)if(S.tQ&&!({$lf:B}=this.Oth(S,!0,w,z,B)).returnValue)return{jGd:t,Y5c:A};if(this.Ra.Jci)for(const S of n)if(!({$lf:B}=this.Oth(S,!1,w,z,B)).returnValue)break;return{jGd:t,Y5c:A}}Oth(n,m,w,z,v){let t;m?(m=0,t=n.Nae?1:0):(m=n.Nae?1:0,t=n.count-m);for(let A=0;A<t;++A)if(f.a.Bph(n.Ytb+m+A,this.Ra.score,w,z),++v,0<this.Ra.M$f&&v>=this.Ra.M$f)return{returnValue:!1,$lf:v};return{returnValue:!0,$lf:v}}}c.Z5c=2;Object(D.a)(c,"FuzzyMatchTokenStringGenerator",f.a,
[])},1580:function(D,P,b){D=b(0);var f=b(5),c=b(203),n=b(1119);class m extends n.a{constructor(){super()}get Mn(){return 2}get xC(){return 7}static uh(){return new m}static get instance(){return m.Vg.value}}m.Vg=new c.a(m.uh);Object(D.a)(m,"AppBindingNodeComplexMerge",n.a,[]);var w=b(18),z=b(690),v=b(126),t=b(1177);class A extends n.a{constructor(){super()}get Mn(){return 3}get xC(){return 7}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.b8),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(w.a.b8)){const Mc=Jb.jl;
var sc=Jb.Xc;v.a.instance.ya(6633221,1,3,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Mc.id,Mc.Ab,mc);mc=sc.getPropertyMilliseconds(Jb.Lf.value.Ie,w.a.b8);sc=sc.getPropertyMilliseconds(Jb.Zm.value.Ie,w.a.b8);mc<sc&&this.uQk(Jb);Jb.ig.add(z.a.Ya(w.a.b8));return!0}v.a.instance.ya(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}uQk(Jb){this.Nlm(Jb.Zm.value.Ie,
Jb.jl);this.$If(Jb,f.a.V1d);this.$If(Jb,f.a.Lhf);this.$If(Jb,f.a.thf)}$If(Jb,mc){var sc=Jb.Xc,Mc=Jb.jl;if(sc.hasProperty(Mc,mc)&&(mc=sc.getPropertyObjectIds(Mc,mc))&&mc.length)for(sc=Jb.fo.runtime.Hp,Jb=Jb.fo.runtime.Jl,Mc=0;Mc<mc.length;Mc++){const Nb=mc.J(Mc);if(!sc.La(Nb))continue;const Kb=sc.J(Nb).gF();Jb.add(Nb,new t.a(Kb,!1))}}static uh(){return new A}static get instance(){return A.Vg.value}}A.Vg=new c.a(A.uh);Object(D.a)(A,"AppNodeComplexMerge",n.a,[]);class B extends n.a{constructor(){super()}get Mn(){return 4}get xC(){return 7}static uh(){return new B}static get instance(){return B.Vg.value}}
B.Vg=new c.a(B.uh);Object(D.a)(B,"AppPropNodeComplexMerge",n.a,[]);class S extends n.a{constructor(){super()}get Mn(){return 5}get xC(){return 7}static uh(){return new S}static get instance(){return S.Vg.value}}S.Vg=new c.a(S.uh);Object(D.a)(S,"AppRefNodeComplexMerge",n.a,[]);var C=b(381),H=b(531),J=b(184),M=b(16);class G{constructor(Jb,mc){this.id=Jb;this.DKm=mc}}Object(D.a)(G,"IdAndTime",null,[]);class R extends n.a{constructor(){super()}get Mn(){return 6}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.KVa),
1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.KVa)){const sc=Jb.jl,Mc=Jb.Xc;v.a.instance.ya(6633224,1,3,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",sc.id,sc.Ab,mc);mc=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.KVa);const Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.KVa),Kb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.KVa);mc=this.TKl(Jb,mc,Nb,Kb);0<mc.length?Mc.setPropertyObjectIds(sc,f.a.KVa,mc):sc.removeProperty(f.a.KVa);Jb.ig.add(z.a.Ya(f.a.KVa));
return!0}v.a.instance.ya(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}TKl(Jb,mc,sc,Mc){const Nb=this.b_a(mc,sc,Mc),Kb=mc.zH(),Yb=sc.zH(),Bb=Mc.zH();mc=n.a.filter(Nb,Gc=>!Kb.contains(Gc)&&Yb.contains(Gc));sc=n.a.filter(Nb,Gc=>!Kb.contains(Gc)&&Bb.contains(Gc));if(!mc.length||!sc.length)return Nb;const Lb=new C.a;mc.forEach(Gc=>{const fc=new G(Gc,this.QWh(Jb,Gc,!1));this.NWh(Jb,Gc,!1).forEach(dd=>
{Lb.add(dd,fc);return!0});return!0});const gc=new H.a;sc.forEach(Gc=>{const fc=this.QWh(Jb,Gc,!0);this.NWh(Jb,Gc,!0).forEach(dd=>Lb.La(dd)?(gc.add(Lb.J(dd).DKm>=fc?Gc:Lb.J(dd).id),!1):!0);return!0});return n.a.filter(Nb,Gc=>!gc.contains(Gc))}QWh(Jb,mc,sc){return(mc=this.Vta(Jb,mc,sc))?Jb.Xc.getPropertyMilliseconds(mc,w.a.b8):0}Vta(Jb,mc,sc){Jb=sc?Jb.fo.runtime.Hp:Jb.fo.runtime.Lw;return Jb.La(mc)?Jb.J(mc):null}NWh(Jb,mc,sc){const Mc=new J.a,Nb=new H.a,Kb=Jb.Xc;mc=this.Vta(Jb,mc,sc);var Yb=this.E4h(Kb,
mc);if(Yb)for(Mc.add(Yb),Nb.add(Yb),mc=Kb.getPropertyObjectIds(mc,f.a.V1d),Yb=0;mc&&Yb<mc.length;Yb++){const Bb=this.E4h(Kb,this.Vta(Jb,mc.J(Yb),sc));if(!Bb)break;Nb.contains(Bb)||(Mc.add(Bb),Nb.add(Bb))}return Mc}E4h(Jb,mc){if(!Jb.hasProperty(mc,f.a.Imc)||!Jb.hasProperty(mc,f.a.W1d)||!Jb.hasProperty(mc,f.a.X1d))return null;const sc=Jb.getPropertyString(mc,f.a.Imc),Mc=Jb.getPropertyString(mc,f.a.W1d);Jb=Jb.getPropertyString(mc,f.a.X1d);return M.a.Vw(sc+";"+Mc+";"+Jb)}static uh(){return new R}static get instance(){return R.Vg.value}}
R.Vg=new c.a(R.uh);Object(D.a)(R,"AppsNodeComplexMerge",n.a,[]);class O extends n.a{constructor(){super()}get Mn(){return 36}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.yFb),1);return Jb}cD(Jb,mc){v.a.instance.ya(51430790,1,3,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",mc);if(mc===z.a.Ya(f.a.yFb)){var sc=Jb.Lf.value.Ie,Mc=Jb.Zm.value.Ie;mc=Jb.jl;var Nb=Jb.Xc.getPropertyStrings(Jb.Lf.value.Kr,f.a.yFb);sc=Jb.Xc.getPropertyStrings(sc,f.a.yFb);Mc=Jb.Xc.getPropertyStrings(Mc,f.a.yFb);
Nb=this.b_a(Nb,sc,Mc);Jb.Xc.setPropertyStrings(mc,f.a.yFb,Nb);Jb.ig.add(z.a.Ya(f.a.yFb));return!0}return!1}static uh(){return new O}static get instance(){return O.Vg.value}}O.Vg=new c.a(O.uh);Object(D.a)(O,"AutoSaveParametersNodeComplexMerge",n.a,[]);class I extends n.a{constructor(){super()}get Mn(){return 44}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.ff),1);return Jb}cD(Jb,mc){const sc=Jb.fo.runtime.Qa;if(mc===z.a.Ya(w.a.ff))return v.a.instance.ya(589608865,1,3,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Jb.jl.id,Jb.jl.Ab,mc),sc.eo(216),sc.isFeatureEnabled(216)?this.VKl(Jb,mc):this.kLl(Jb,mc),!0;v.a.instance.ya(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}VKl(Jb,mc){const sc=z.a.Lla(mc),Mc=Jb.Xc;var Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,sc),Kb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,sc),Yb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,sc);Yb=I.y9k(Jb,Kb,Yb);Nb=this.b_a(Nb,
Kb,Yb);Kb=Jb.jl;0<Nb.length?Mc.setPropertyObjectIds(Kb,sc,Nb):Kb.removeProperty(sc);Jb.ig.add(mc)}static uh(){return new I}static get instance(){return I.Vg.value}static y9k(Jb,mc,sc){const Mc=new J.a,Nb=new C.a;mc.forEach(Kb=>{const Yb=Jb.fo.runtime.Lw.J(Kb);Yb&&Nb.add(Yb.ZW(f.a.Mo).toString(),Kb);return!0});sc.forEach(Kb=>{var Yb=Jb.fo.runtime.Hp.J(Kb);Yb?(Yb=Yb.ZW(f.a.Mo).toString(),Nb.La(Yb)&&Nb.get(Yb)!==Kb?v.a.instance.ya(557061773,1,3,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
Mc.add(Kb)):Mc.add(Kb);return!0});return Mc}}I.Vg=new c.a(I.uh);Object(D.a)(I,"BookmarkContainerNodeComplexMerge",n.a,[]);var K=b(1404);class Y extends n.a{constructor(){super()}get Mn(){return 41}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.gSb),1);Jb.W(z.a.Ya(f.a.Mo),1);Jb.W(z.a.Ya(f.a.LF),1);Jb.W(z.a.Ya(f.a.PW),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.gSb))return Jb.ig.add(z.a.Ya(f.a.gSb)),!0;if(mc===z.a.Ya(f.a.Mo))return Jb.ig.add(z.a.Ya(f.a.Mo)),!0;if(mc===z.a.Ya(f.a.LF)||mc===z.a.Ya(f.a.PW)){var sc=
Jb.Lf.value.Ie,Mc=Jb.Zm.value.Ie,Nb=Jb.jl;var Kb=(new Date).toString();const Yb=Jb.fo.runtime.Qa;Yb.eo(216);if(Yb.isFeatureEnabled(216))return v.a.instance.ya(556656202,1,3,"BookmarkNodeComplexMerge: Started at [timestamp: {0}]",Kb),Nb=this.r9i(Jb,sc,Mc,Nb,z.a.Ya(f.a.LF))&&this.r9i(Jb,sc,Mc,Nb,z.a.Ya(f.a.PW)),Nb||(v.a.instance.ya(557061774,1,1,"BookmarkNodeComplexMerge: Failed to merge Bookmark [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc),Jb.fo.logger.wf(Object.assign(new K.a,
{Mn:this.Mn,pyc:Jb.Lf.value.Kr.Ab,fxd:mc,psd:this.gxd.J(mc)}))),Kb=(new Date).toString(),v.a.instance.ya(556656203,1,3,"BookmarkNodeComplexMerge: Ended at [timestamp: {0}]",Kb),Nb;Kb=Jb.Xc.getPropertyString(sc,f.a.LF);mc=Jb.Xc.getPropertyString(Mc,f.a.LF);Kb=this.Wd(Kb)?mc:this.Wd(mc)?Kb:null;if(this.Wd(Kb))return!1;Jb.Xc.setPropertyString(Nb,f.a.LF,Kb);Jb.ig.add(z.a.Ya(f.a.LF));sc=Jb.Xc.getPropertyString(sc,f.a.PW);Mc=Jb.Xc.getPropertyString(Mc,f.a.PW);Mc=this.Wd(sc)?mc:this.Wd(Mc)?sc:null;if(this.Wd(Mc))return!1;
Jb.Xc.setPropertyString(Nb,f.a.PW,Mc);Jb.ig.add(z.a.Ya(f.a.PW));return!0}return!1}r9i(Jb,mc,sc,Mc,Nb){const Kb=z.a.Lla(Nb);mc=Jb.Xc.getPropertyObjectId(mc,Kb);sc=Jb.Xc.getPropertyObjectId(sc,Kb);var Yb=Jb.Lf.value.Ie.id;v.a.instance.ya(557061775,1,3,"BookmarkNodeComplexMerge: Merging [favoredBookmarkParaId: {0}] and [conflictBookmarkParaId: {1}]",mc,sc);const Bb=this.pki(Jb,mc,Yb,z.a.Ya(f.a.LF)===Nb,!0);Yb=this.pki(Jb,sc,Yb,z.a.Ya(f.a.LF)===Nb,!1);if(!Bb&&!Yb||Bb&&Yb&&!mc.equals(sc))return v.a.instance.ya(557061776,
1,1,"BookmarkNodeComplexMerge: Failed to merge BookmarkParaIds [Id: {0}] and [Id: {1}] for [Type: {3}] because either no BookmarkParagraph Start/End is found, or two BookmarkParagraph Start/End are found in different paragraphs respectively",mc,sc,z.a.Ya(f.a.LF)===Nb?"StartBookmarkParaId":"EndBookmarkParaId"),!1;Jb.Xc.setPropertyObjectId(Mc,Kb,Bb?mc:sc);Jb.ig.add(Nb);v.a.instance.ya(557061777,1,3,"BookmarkNodeComplexMerge: Successfully completed custom merge on bookmarks");return!0}pki(Jb,mc,sc,Mc,
Nb){if(!mc)return v.a.instance.ya(557061778,1,1,"BookmarkNodeComplexMerge: paragraphId is null, skip this paragraph"),!1;const Kb=Jb.fo.runtime.Jl;var Yb=Kb.get(mc),Bb=null;if(Yb&&Yb.Oi)Bb=Yb.Oi;else{Yb=Jb.fo.runtime.Lw.get(mc)||Jb.fo.runtime.pj.J(mc);if(!Yb)return v.a.instance.ya(557061779,1,3,"BookmarkNodeComplexMerge: paragraphNode or paragraph object is null, skip this paragraph"),!1;Bb=Yb}if(!Bb.hasProperty(w.a.DA))return v.a.instance.ya(557061661,1,3,"BookmarkNodeComplexMerge: Paragraph does not paragraph properties, skip this paragraph"),
!1;Yb=Jb.Xc.getPropertyObjectIds(Bb,w.a.DA);if(!Yb)return v.a.instance.ya(557061662,1,3,"BookmarkNodeComplexMerge: textRunFormattingGuids is null, skip this paragraph"),!1;Bb=!1;for(let fc=0;fc<Yb.length;fc++){const dd=Jb.fo.runtime.pj.J(Yb.J(fc));if(dd&&dd.hasProperty(f.a.pq)&&sc.equals(Jb.Xc.getPropertyObjectId(dd,f.a.irb))){Bb=!0;if(!Mc&&44===Jb.Xc.getPropertyUint32(dd,f.a.pq))return v.a.instance.ya(557061780,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookMarkStart Placeholder but we are looking for BookmarkEnd Placeholder, skip this paragraph"),
!1;if(Mc&&45===Jb.Xc.getPropertyUint32(dd,f.a.pq))return v.a.instance.ya(557061781,1,3,"BookmarkNodeComplexMerge: Paragraph contains BookmarkEnd Placeholder but we are looking for BookMarkStart Placeholder, skip this paragraph"),!1}}if(!Bb)return v.a.instance.ya(557061782,1,3,"BookmarkNodeComplexMerge: Paragraph does not contain BookMark PlaceholderKind, skip this paragraph"),!1;let Lb=null,gc=!0;(Nb?Jb.fo.runtime.Lw:Jb.fo.runtime.Hp).forEach((fc,dd)=>{393229===dd.Ab&&Jb.Xc.getPropertyObjectIds(dd,
w.a.pfa).zH().contains(mc)&&(Lb=dd,gc=!1);return gc});if(!Lb)return v.a.instance.ya(557061783,1,3,"BookmarkNodeComplexMerge: Paragraph does not map to an OE, skip this paragraph"),!1;let Gc=null;gc=!0;Kb.forEach((fc,dd)=>{393241===dd.Oi.Ab&&Jb.Xc.getPropertyObjectIds(dd.Oi,w.a.ff).zH().contains(Lb.id)&&(Gc=dd.Oi,gc=!1);return gc});return Gc?!0:(v.a.instance.ya(557061784,1,3,"BookmarkNodeComplexMerge: OE does not map to an OGN, skip this paragraph"),!1)}Wd(Jb){return Jb&&Jb.length?!1:!0}static uh(){return new Y}static get instance(){return Y.Vg.value}}
Y.Vg=new c.a(Y.uh);Object(D.a)(Y,"BookmarkNodeComplexMerge",n.a,[]);class W extends n.a{constructor(){super();this.Rie=!1}get Mn(){return 7}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.ff),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(w.a.ff)){const Nb=Jb.jl,Kb=Jb.Xc;var sc=Jb.fo.runtime.Qa;sc&&(this.Rie=sc.isFeatureEnabled(123));v.a.instance.ya(4511579,1,3,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Nb.id,Nb.Ab,mc);mc=Kb.getPropertyObjectIds(Jb.Lf.value.Kr,
w.a.ff);sc=Kb.getPropertyObjectIds(Jb.Lf.value.Ie,w.a.ff);var Mc=Kb.getPropertyObjectIds(Jb.Zm.value.Ie,w.a.ff);mc=this.cLl(mc,sc,Mc);if(this.Rie&&0<mc.length){sc=new Sys.StringBuilder;for(Mc=0;Mc<mc.length;Mc++)sc.append(mc.J(Mc).toString()+",");v.a.instance.ya(559710276,1,3,"Merge result for CommentContentNode {0}: {1}",Nb.id,sc.toString())}0<mc.length?Kb.setPropertyObjectIds(Nb,w.a.ff,mc):Nb.removeProperty(w.a.ff);Jb.ig.add(z.a.Ya(w.a.ff));return!0}v.a.instance.ya(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Jb.Lf.value.Ie.id,mc);return!1}cLl(Jb,mc,sc){const Mc=new J.a,Nb=new C.a(0);this.PEk(Jb,sc,Mc,Nb);return this.iuk(mc,Nb,Mc)}PEk(Jb,mc,sc,Mc){Jb=Jb||new J.a;mc=mc||new J.a;Jb.forEach(Nb=>{Mc.W(Nb,1);return!0});mc.forEach(Nb=>{Mc.tb(Nb).returnValue?Mc.W(Nb,2):(Mc.W(Nb,0),sc.add(Nb));return!0})}iuk(Jb,mc,sc){Jb=Jb||new J.a;const Mc=new J.a,Nb=new J.a,Kb=new J.a;Jb.forEach(Yb=>{let Bb=!0,Lb;({value:Lb}=mc.tb(Yb)).returnValue&&(Lb?1===Lb&&(Bb=!1):mc.W(Yb,2));Bb?Mc.add(Yb):this.Rie&&Nb.add(Yb);return!0});
sc.forEach(Yb=>{let Bb=!1,Lb;({value:Lb}=mc.tb(Yb)).returnValue?Lb||(Bb=!0,mc.W(Yb,2)):v.a.instance.ya(4511585,1,3,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Yb);Bb?Mc.add(Yb):this.Rie&&Kb.add(Yb);return!0});this.Wri(Nb,"Favored");this.Wri(Kb,"Unfavored");return Mc}Wri(Jb,mc){if(Jb.length){var sc=new Sys.StringBuilder;for(let Mc=0;Mc<Jb.length;Mc++)sc.append(Jb.J(Mc).toString()+",");v.a.instance.ya(561637572,
1,3,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",mc,sc.toString())}}static uh(){return new W}static get instance(){return W.Vg.value}}W.Vg=new c.a(W.uh);Object(D.a)(W,"CommentContentNodeComplexMerge",n.a,[]);class Z extends n.a{constructor(){super()}get Mn(){return 8}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.gaa),3);Jb.W(z.a.Ya(f.a.EG),3);Jb.W(z.a.Ya(f.a.Y7c),2);Jb.W(z.a.Ya(f.a.commentId),2);Jb.W(z.a.Ya(f.a.VDh),2);Jb.W(z.a.Ya(f.a.qKa),2);Jb.W(z.a.Ya(f.a.sWa),1);Jb.W(z.a.Ya(f.a.Bwb),
1);Jb.W(z.a.Ya(f.a.Hxb),1);Jb.W(z.a.Ya(f.a.ifa),1);Jb.W(z.a.Ya(f.a.TG),1);Jb.W(z.a.Ya(w.a.ff),0);Jb.W(z.a.Ya(f.a.BD),0);return Jb}cD(Jb,mc){if(mc!==z.a.Ya(f.a.sWa)&&mc!==z.a.Ya(f.a.Bwb)&&mc!==z.a.Ya(f.a.Hxb)&&mc!==z.a.Ya(f.a.TG)&&mc!==z.a.Ya(f.a.ifa))return!1;const sc=Jb.fo.runtime.Qa,Mc=Jb.Lf.value.Ie;var Nb=Jb.Zm.value.Ie;const Kb=Jb.jl;if(mc===z.a.Ya(f.a.sWa)){mc=Jb.Xc.getPropertyString(Mc,f.a.sWa);Nb=Jb.Xc.getPropertyString(Nb,f.a.sWa);Nb=this.Wd(mc)?Nb:this.Wd(Nb)?mc:null;if(this.Wd(Nb))return!1;
Jb.Xc.setPropertyString(Kb,f.a.sWa,Nb);Jb.ig.add(z.a.Ya(f.a.sWa));return!0}if(mc===z.a.Ya(f.a.Hxb))return mc=Jb.Xc.getPropertyBool(Mc,f.a.Hxb),Nb=Jb.Xc.getPropertyBool(Nb,f.a.Hxb),mc=null!=mc?mc:!1,mc=(null!=Nb?Nb:!1)||mc,Jb.Xc.setPropertyBool(Kb,f.a.Hxb,mc),Jb.ig.add(z.a.Ya(f.a.Hxb)),!0;if(mc===z.a.Ya(f.a.Bwb)){mc=Jb.Xc.getPropertyBool(Mc,f.a.Bwb);Nb=Jb.Xc.getPropertyBool(Nb,f.a.Bwb);if(mc===Nb)return!0;mc=null!=mc?mc:!1;mc=(null!=Nb?Nb:!1)||mc;Jb.Xc.setPropertyBool(Kb,f.a.Bwb,mc);return!0}if(mc===
z.a.Ya(f.a.TG)){mc=Jb.Xc.getPropertyBool(Mc,f.a.TG);Nb=Jb.Xc.getPropertyBool(Nb,f.a.TG);if(mc===Nb)return!0;mc=null!=mc?mc:!1;mc=(null!=Nb?Nb:!1)||mc;Jb.Xc.setPropertyBool(Kb,f.a.TG,mc);Jb.ig.add(z.a.Ya(f.a.TG));return!0}if(mc===z.a.Ya(f.a.ifa)){sc.eo(27);if(!sc.isFeatureEnabled(27))return!1;mc=Jb.Xc.getPropertyString(Mc,f.a.ifa);Nb=Jb.Xc.getPropertyString(Nb,f.a.ifa);if(mc===Nb)return!0;Jb.Xc.setPropertyString(Kb,f.a.ifa,Nb||mc);Jb.ig.add(z.a.Ya(f.a.ifa));return!0}return!1}Wd(Jb){return Jb&&Jb.length?
!1:!0}static uh(){return new Z}static get instance(){return Z.Vg.value}}Z.Vg=new c.a(Z.uh);Object(D.a)(Z,"CommentNodeComplexMerge",n.a,[]);var U=b(2);class X extends n.a{constructor(){super()}get Mn(){return 46}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.contentControlNode),1);Jb.W(z.a.Ya(w.a.lastModifiedTime),0);Jb.W(z.a.Ya(f.a.O8c),5);return Jb}cD(Jb,mc){var sc=Jb.fo.runtime.Qa;U.AFrameworkApplication.Dp("Word-TOCMerge;Word-TOCMergecf");if(!sc.rvb(1000005))return!1;if(mc===z.a.Ya(f.a.contentControlNode)){v.a.instance.ya(556865370,
1,3,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Jb.jl.id,Jb.jl.Ab,mc);sc=z.a.Lla(mc);const Yb=Jb.Xc;var Mc=Yb.getPropertyObjectIds(Jb.Lf.value.Kr,sc),Nb=Yb.getPropertyObjectIds(Jb.Lf.value.Ie,sc),Kb=Yb.getPropertyObjectIds(Jb.Zm.value.Ie,sc);Kb=X.k$k(Kb,Jb.fo.runtime.XEc);Mc=this.b_a(Mc,Nb,Kb);Nb=Jb.jl;0<Mc.length?Yb.setPropertyObjectIds(Nb,sc,Mc):Nb.removeProperty(sc);Jb.ig.add(mc);return!0}v.a.instance.ya(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",
Jb.Lf.value.Ie.id,mc);return!1}static uh(){return new X}static get instance(){return X.Vg.value}static k$k(Jb,mc){const sc=new J.a;Jb.forEach(Mc=>{mc.contains(Mc,(Nb,Kb)=>Nb.equals(Kb))||sc.add(Mc);return!0});return sc}}X.Vg=new c.a(X.uh);Object(D.a)(X,"ContentControlContainerNodeComplexMerge",n.a,[]);class fa extends n.a{constructor(){super()}get Mn(){return 37}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.haa),1);Jb.W(z.a.Ya(f.a.gj),1);Jb.W(z.a.Ya(f.a.Xh),1);Jb.W(z.a.Ya(f.a.Ecc),1);Jb.W(z.a.Ya(f.a.Yrf),
2);Jb.W(z.a.Ya(f.a.Xrf),2);return Jb}cD(Jb,mc){var sc=Jb.Zm.value.Ie;const Mc=Jb.jl;if(mc===z.a.Ya(f.a.haa))return mc=Jb.Xc.getPropertyBool(sc,f.a.haa),null==mc||mc||(Jb.Xc.setPropertyBool(Mc,f.a.haa,!1),Jb.ig.add(z.a.Ya(f.a.haa))),!0;var Nb=Jb.Lf.value.Ie;if(mc===z.a.Ya(f.a.Ecc)){mc=Jb.Xc.getPropertyObjectId(Nb,f.a.Ecc);var Kb=Jb.Xc.getPropertyObjectId(sc,f.a.Ecc);if(mc&&!mc.equals(Kb))return!1;if(mc=mc||Kb)Jb.Xc.setPropertyObjectId(Mc,f.a.Ecc,mc),Jb.ig.add(z.a.Ya(f.a.Ecc));return!0}if(mc===z.a.Ya(f.a.gj)||
mc===z.a.Ya(f.a.Xh)){Kb=z.a.Lla(mc);Nb=Jb.Xc.getPropertyObjectId(Nb,Kb);sc=Jb.Xc.getPropertyObjectId(sc,Kb);const Yb=this.oki(Jb,Jb.jl.id,Nb),Bb=this.oki(Jb,Jb.jl.id,sc);if(Nb&&Nb.equals(sc))return!0;if(Nb&&!Jb.fo.runtime.Jl.get(Nb)||Yb&&Bb)return!1;(Nb=Yb?Nb:Bb?sc:null)?Jb.Xc.setPropertyObjectId(Mc,Kb,Nb):Mc.removeProperty(Kb);Jb.ig.add(mc);return!0}return!1}oki(Jb,mc,sc){if(!sc)return!1;const Mc=Jb.fo.runtime.Jl;sc=Mc.get(sc);if(!sc||!sc.Oi)return!1;sc=Jb.Xc.getPropertyObjectIds(sc.Oi,w.a.DA);if(!sc)return!1;
for(let Kb=0;Kb<sc.length;Kb++){var Nb=sc.J(Kb);if((Nb=Mc.get(Nb))&&Nb.Oi&&(Nb=Jb.Xc.getPropertyObjectId(Nb.Oi,f.a.ud))&&Nb.equals(mc))return!0}return!1}static uh(){return new fa}static get instance(){return fa.Vg.value}}fa.Vg=new c.a(fa.uh);Object(D.a)(fa,"ContentControlNodeComplexMerge",n.a,[]);class ma extends n.a{constructor(){super()}get Mn(){return 10}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.customXmlPartNode),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.customXmlPartNode)){mc=Jb.jl;const Mc=Jb.Xc;
var sc=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.customXmlPartNode);const Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.customXmlPartNode),Kb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.customXmlPartNode);sc=this.dLl(sc,Nb,Kb);0<sc.length?Mc.setPropertyObjectIds(mc,f.a.customXmlPartNode,sc):mc.removeProperty(f.a.customXmlPartNode);Jb.ig.add(z.a.Ya(f.a.customXmlPartNode));return!0}return!1}dLl(Jb,mc,sc){return this.b_a(Jb,mc,sc)}static uh(){return new ma}static get instance(){return ma.Vg.value}}ma.Vg=
new c.a(ma.uh);Object(D.a)(ma,"CustomXmlPartContainerNodeComplexMerge",n.a,[]);class ka extends n.a{constructor(){super()}get Mn(){return 9}get xC(){return 0}static uh(){return new ka}static get instance(){return ka.Vg.value}}ka.Vg=new c.a(ka.uh);Object(D.a)(ka,"CustomXmlPartNodeComplexMerge",n.a,[]);class oa extends n.a{constructor(){super()}get Mn(){return 29}get xC(){return 3}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.embeddedFontNode),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.embeddedFontNode)){mc=
Jb.Xc;var sc=mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.embeddedFontNode),Mc=mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.embeddedFontNode);const Nb=mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.embeddedFontNode);sc=this.b_a(sc,Mc,Nb);Mc=Jb.jl;0<sc.length?mc.setPropertyObjectIds(Mc,f.a.embeddedFontNode,sc):Mc.removeProperty(f.a.embeddedFontNode);Jb.ig.add(z.a.Ya(f.a.embeddedFontNode));return!0}return!1}static uh(){return new oa}static get instance(){return oa.Vg.value}}oa.Vg=new c.a(oa.uh);Object(D.a)(oa,
"EmbeddedFontContainerNodeComplexMerge",n.a,[]);class za extends n.a{constructor(){super()}get Mn(){return 30}get xC(){return 3}static uh(){return new za}static get instance(){return za.Vg.value}}za.Vg=new c.a(za.uh);Object(D.a)(za,"EmbeddedFontNodeComplexMerge",n.a,[]);class Ja extends n.a{constructor(){super()}get Mn(){return 11}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.EQ),4);Jb.W(z.a.Ya(f.a.tXa),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.tXa)){const sc=Jb.jl,Mc=Jb.Xc;v.a.instance.ya(4063307,1,3,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",sc.id,sc.Ab,mc);mc=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.tXa);const Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.tXa),Kb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.tXa);mc=this.Oui(mc,Nb,Kb,(Yb,Bb)=>Yb.equals(Bb));0<mc.length?Mc.setPropertyObjectIds(sc,f.a.tXa,mc):sc.removeProperty(f.a.tXa);Jb.ig.add(z.a.Ya(f.a.tXa));return!0}v.a.instance.ya(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Jb.Lf.value.Ie.id,mc);return!1}static uh(){return new Ja}static get instance(){return Ja.Vg.value}}Ja.Vg=new c.a(Ja.uh);Object(D.a)(Ja,"FootnoteEndnoteContainerNodeComplexMerge",n.a,[]);class pa extends n.a{constructor(){super()}get Mn(){return 12}get xC(){return 3}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.r_),1);return Jb}cD(Jb,mc){const sc=Jb.jl,Mc=Jb.Xc;if(mc===z.a.Ya(f.a.r_)){let Nb=-1;v.a.instance.ya(5002527,1,3,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
sc.id,sc.Ab,mc);const Kb=Mc.getPropertyInt32(Jb.Lf.value.Ie,f.a.r_),Yb=Mc.getPropertyInt32(Jb.Zm.value.Ie,f.a.r_);null!=Kb&&-1!==Kb?Nb=Kb:null!=Yb&&(Nb=Yb);Mc.setPropertyInt32(sc,f.a.r_,Nb);Jb.ig.add(mc);return!0}v.a.instance.ya(5002528,1,3,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Kr.id,mc);return!1}static uh(){return new pa}static get instance(){v.a.instance.ya(5002526,1,3,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return pa.Vg.value}}pa.Vg=new c.a(pa.uh);Object(D.a)(pa,"FootnoteEndnoteNodeComplexMerge",n.a,[]);class Na extends n.a{constructor(){super()}get Mn(){return 13}get xC(){return 3}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.jca),4);return Jb}static uh(){return new Na}static get instance(){return Na.Vg.value}}Na.Vg=new c.a(Na.uh);Object(D.a)(Na,"HeaderFooterContainerNodeComplexMerge",n.a,[]);var Da=b(38);class Aa extends n.a{constructor(){super()}get Mn(){return 14}get xC(){return 3}uk(){const Jb=super.uk();
Jb.W(z.a.Ya(f.a.runId),3);Jb.W(z.a.Ya(f.a.yb),3);Jb.W(z.a.Ya(f.a.Xfi),3);Jb.W(z.a.Ya(f.a.N_),1);Jb.W(z.a.Ya(Da.a.zga),1);Jb.W(z.a.Ya(w.a.yga),1);Jb.W(z.a.Ya(f.a.a3),1);Jb.W(z.a.Ya(w.a.Jna),1);Jb.W(z.a.Ya(Da.a.elb),1);Jb.W(z.a.Ya(f.a.Pqb),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(w.a.yga)||mc===z.a.Ya(f.a.a3)||mc===z.a.Ya(f.a.N_)||mc===z.a.Ya(f.a.nO)||mc===z.a.Ya(w.a.Fdb)||mc===z.a.Ya(w.a.Jna)||mc===z.a.Ya(Da.a.zga)||mc===z.a.Ya(Da.a.elb)||mc===z.a.Ya(f.a.Pqb)){const Mc=Jb.jl;var sc=Jb.Xc;v.a.instance.ya(4018185,
1,3,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Mc.id,Mc.Ab,mc);const Nb=sc.getPropertyInt32(Jb.Lf.value.Ie,Da.a.zga);sc=sc.getPropertyInt32(Jb.Zm.value.Ie,Da.a.zga);if(null!=Nb&&(!Nb||2===Nb))return!0;if(null!=sc&&(!sc||2===sc))return mc=Jb.Zm.value.Ie,this.ssb(mc,Mc,w.a.yga),this.ssb(mc,Mc,f.a.a3),this.ssb(mc,Mc,f.a.nO),mc.hasProperty(f.a.N_)&&this.ssb(mc,Mc,f.a.N_),this.ssb(mc,Mc,w.a.Fdb),this.ssb(mc,Mc,w.a.Jna),this.ssb(mc,Mc,Da.a.zga),this.ssb(mc,
Mc,Da.a.elb),Jb.ig.add(z.a.Ya(w.a.yga)),Jb.ig.add(z.a.Ya(f.a.a3)),Jb.ig.add(z.a.Ya(f.a.nO)),Jb.ig.add(z.a.Ya(f.a.N_)),Jb.ig.add(z.a.Ya(w.a.Fdb)),Jb.ig.add(z.a.Ya(w.a.Jna)),Jb.ig.add(z.a.Ya(Da.a.zga)),Jb.ig.add(z.a.Ya(Da.a.elb)),Jb.ig.add(z.a.Ya(f.a.Pqb)),!0}v.a.instance.ya(4018186,1,3,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Kr.id,mc);return!1}static uh(){return new Aa}static get instance(){return Aa.Vg.value}}Aa.Vg=
new c.a(Aa.uh);Object(D.a)(Aa,"ImageNodeComplexMerge",n.a,[]);class Ma extends n.a{constructor(){super()}get Mn(){return 40}get xC(){return 0}static uh(){return new Ma}static get instance(){return Ma.Vg.value}}Ma.Vg=new c.a(Ma.uh);Object(D.a)(Ma,"IntelligenceAnnotationNodeComplexMerge",n.a,[]);class ba extends n.a{constructor(){super()}get Mn(){return 32}get xC(){return 0}static uh(){return new ba}static get instance(){return ba.Vg.value}}ba.Vg=new c.a(ba.uh);Object(D.a)(ba,"IntelligenceContentLocatorNodeComplexMerge",
n.a,[]);class L extends n.a{constructor(){super()}get Mn(){return 34}get xC(){return 0}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.deb),1);return Jb}cD(Jb,mc){const sc=Jb.jl,Mc=Jb.Xc;if(mc===z.a.Ya(f.a.deb)){mc=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.deb);const Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.deb),Kb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.deb);mc=this.b_a(mc,Nb,Kb);Mc.setPropertyObjectIds(sc,f.a.deb,mc);Jb.ig.add(z.a.Ya(f.a.deb));return!0}return!1}static uh(){return new L}static get instance(){return L.Vg.value}}
L.Vg=new c.a(L.uh);Object(D.a)(L,"IntelligenceRegionNodeComplexMerge",n.a,[]);class V extends n.a{constructor(){super()}get Mn(){return 35}get xC(){return 0}static uh(){return new V}static get instance(){return V.Vg.value}}V.Vg=new c.a(V.uh);Object(D.a)(V,"IntelligenceRejectionNodeComplexMerge",n.a,[]);class ha extends n.a{constructor(){super()}get Mn(){return 39}get xC(){return 0}static uh(){return new ha}static get instance(){return ha.Vg.value}}ha.Vg=new c.a(ha.uh);Object(D.a)(ha,"IntelligenceReviewedNodeComplexMerge",
n.a,[]);class la extends n.a{constructor(){super()}get Mn(){return 33}get xC(){return 0}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.Kuc),1);Jb.W(z.a.Ya(f.a.Yld),1);Jb.W(z.a.Ya(f.a.pie),1);Jb.W(z.a.Ya(f.a.qie),1);return Jb}cD(Jb,mc){const sc=Jb.jl,Mc=Jb.Xc;if(mc===z.a.Ya(f.a.Kuc)||mc===z.a.Ya(f.a.Yld)||mc===z.a.Ya(f.a.pie)||mc===z.a.Ya(f.a.qie)){mc=mc===z.a.Ya(f.a.Kuc)?f.a.Kuc:f.a.Yld;var Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,mc);const Kb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,mc),Yb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,
mc);Nb=this.b_a(Nb,Kb,Yb);Mc.setPropertyObjectIds(sc,mc,Nb);Jb.ig.add(z.a.Ya(mc));return!0}return!1}static uh(){return new la}static get instance(){return la.Vg.value}}la.Vg=new c.a(la.uh);Object(D.a)(la,"IntelligenceRootNodeComplexMerge",n.a,[]);class ya extends n.a{constructor(){super()}get Mn(){return 15}get xC(){return 3}static uh(){return new ya}static get instance(){return ya.Vg.value}}ya.Vg=new c.a(ya.uh);Object(D.a)(ya,"NumberListNodeComplexMerge",n.a,[]);var va=b(97);class xa extends n.a{constructor(){super()}get Mn(){return 16}get xC(){return 0}uk(){const Jb=
super.uk();Jb.W(z.a.Ya(f.a.ERb),1);Jb.W(z.a.Ya(va.a.jEh),7);Jb.W(z.a.Ya(va.a.iEh),7);return Jb}cD(Jb,mc){const sc=Jb.jl,Mc=Jb.Xc;if(mc===z.a.Ya(f.a.ERb))return this.U3f(Mc,Jb.Lf.value.Ie,Jb.Zm.value.Ie,sc,f.a.ERb),Jb.ig.add(mc),!0;v.a.instance.ya(4207940,1,3,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Kr.id,mc);return!1}static uh(){return new xa}static get instance(){return xa.Vg.value}}xa.Vg=new c.a(xa.uh);
Object(D.a)(xa,"OutlineElementNodeComplexMerge",n.a,[]);class Ia extends n.a{constructor(){super()}get Mn(){return 17}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.ERb),1);Jb.W(z.a.Ya(f.a.saa),1);Jb.W(z.a.Ya(va.a.PD),1);Jb.W(z.a.Ya(va.a.ixc),1);Jb.W(z.a.Ya(va.a.Qha),8);return Jb}cD(Jb,mc){const sc=Jb.jl,Mc=Jb.Xc;if(mc===z.a.Ya(f.a.ERb))return this.U3f(Mc,Jb.Lf.value.Ie,Jb.Zm.value.Ie,sc,f.a.ERb),Jb.ig.add(mc),!0;if(mc===z.a.Ya(f.a.saa)){var Nb=Mc.getPropertyBool(Jb.Lf.value.Ie,f.a.saa),Kb=Mc.getPropertyBool(Jb.Zm.value.Ie,
f.a.saa);Mc.setPropertyBool(sc,f.a.saa,null==Nb?!1:Nb&&null==Kb?!1:Kb);Jb.ig.add(mc);return!0}if(mc===z.a.Ya(va.a.ixc))return this.U3f(Mc,Jb.Lf.value.Ie,Jb.Zm.value.Ie,sc,va.a.ixc),Jb.ig.add(mc),!0;if(mc===z.a.Ya(va.a.PD))return Nb=Mc.getPropertyBool(Jb.Lf.value.Ie,va.a.PD),Kb=Mc.getPropertyBool(Jb.Zm.value.Ie,va.a.PD),Mc.setPropertyBool(sc,va.a.PD,null==Nb?!0:Nb||null==Kb?!0:Kb),Jb.ig.add(mc),!0;v.a.instance.ya(4057305,1,3,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Jb.Lf.value.Kr.id,mc);return!1}static uh(){return new Ia}static get instance(){return Ia.Vg.value}}Ia.Vg=new c.a(Ia.uh);Object(D.a)(Ia,"OutlineGroupNodeComplexMerge",n.a,[]);var mb=b(52),gb=b(42);class Za extends n.a{constructor(){super()}get Mn(){return 18}get xC(){return 2}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.wge),3);Jb.W(z.a.Ya(w.a.Rba),this.xC);Jb.W(z.a.Ya(f.a.lu),1);Jb.W(z.a.Ya(f.a.ZP),1);Jb.W(z.a.Ya(f.a.sM),1);Jb.W(z.a.Ya(f.a.tO),1);Jb.W(z.a.Ya(f.a.fw),1);return Jb}cD(Jb,mc){const sc=Jb.Xc;
if(Jb.fo.runtime.Qa.isFeatureEnabled(118)){if(mc===z.a.Ya(f.a.lu)||mc===z.a.Ya(f.a.sM)||mc===z.a.Ya(f.a.ZP)||mc===z.a.Ya(f.a.fw)||mc===z.a.Ya(f.a.tO))return this.OTm(sc,Jb)}else if(mc===z.a.Ya(f.a.lu)||mc===z.a.Ya(f.a.fw)){let Mc,Nb;({x8c:mc,Eeb:Mc,ueb:Nb}=this.pof(Object(gb.a)(sc,sc.getPropertyUint32s,"getPropertyUint32s"),Jb.Lf.value.Kr,Jb.Lf.value.Ie,Jb.Zm.value.Ie,f.a.lu,null));if(!Nb&&!Mc)return v.a.instance.ya(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Jb.Lf.value.Ie.id,z.a.Ya(f.a.lu)),!0;let Kb,Yb,Bb;({x8c:Kb,Eeb:Yb,ueb:Bb}=this.pof(Object(gb.a)(sc,sc.getPropertyObjectIds,"getPropertyObjectIds"),Jb.Lf.value.Kr,Jb.Lf.value.Ie,Jb.Zm.value.Ie,f.a.fw,null));if(!Yb&&!Bb)return v.a.instance.ya(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Jb.Lf.value.Ie.id,z.a.Ya(f.a.fw)),!0;const Lb=Yb&&!Bb;if((Mc&&!Nb)!==Lb)return v.a.instance.ya(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Jb.Lf.value.Ie.id,z.a.Ya(f.a.lu),z.a.Ya(f.a.fw)),!1;Lb&&(sc.setPropertyObjectIds(Jb.jl,f.a.fw,Kb),sc.setPropertyUint32s(Jb.jl,f.a.lu,mc));v.a.instance.ya(4318877,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Jb.Lf.value.Ie.id,z.a.Ya(f.a.lu),Mc,Nb,z.a.Ya(f.a.fw),Yb,Bb);Jb.ig.add(z.a.Ya(f.a.fw));Jb.ig.add(z.a.Ya(f.a.lu));
return!0}v.a.instance.ya(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}nai(Jb,mc,sc,Mc){let Nb;({x8c:mc,Eeb:Mc,ueb:Nb}=this.pof(mc,sc.Lf.value.Kr,sc.Lf.value.Ie,sc.Zm.value.Ie,Jb,Mc));return Nb||Mc?{returnValue:!0,mrf:mc,Eeb:Mc,ueb:Nb}:(v.a.instance.ya(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
sc.Lf.value.Ie.id.toString(),z.a.Ya(Jb)),{returnValue:!1,mrf:mc,Eeb:Mc,ueb:Nb})}y$h(Jb,mc,sc,Mc,Nb){let Kb;let Yb,Bb,Lb,gc;({mrf:Kb,Eeb:Gc,ueb:Yb,returnValue:Lb}=this.nai(Jb,Object(gb.a)(sc,sc.getPropertyUint32s,"getPropertyUint32s"),Mc,null));({mrf:sc,Eeb:Nb,ueb:Bb,returnValue:gc}=this.nai(mc,Object(gb.a)(sc,sc.getPropertyObjectIds,"getPropertyObjectIds"),Mc,Nb));var Gc=Gc&&!Yb;return Lb&&gc?Gc!==(Nb&&!Bb)?(v.a.instance.ya(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Mc.Lf.value.Ie.id.toString(),z.a.Ya(Jb),z.a.Ya(mc)),{returnValue:2,b6d:Kb,$5d:sc,iDe:Gc}):{returnValue:0,b6d:Kb,$5d:sc,iDe:Gc}:{returnValue:1,b6d:Kb,$5d:sc,iDe:Gc}}AZf(Jb){let mc=!0;Jb.forEach(sc=>sc!==mb.a.nil?mc=!1:!0);return mc}TTk(Jb,mc,sc){return this.AZf(Jb)&&this.AZf(mc)&&this.AZf(sc)?!0:!1}OTm(Jb,mc){let sc,Mc,Nb,Kb,Yb,Bb;var Lb=({b6d:Kb,$5d:Yb,iDe:Mc}=this.y$h(f.a.ZP,f.a.fw,Jb,mc,null)).returnValue;if(2===Lb||1===Lb)return!0;({b6d:Nb,$5d:Bb,iDe:sc,returnValue:Lb}=this.y$h(f.a.lu,f.a.sM,Jb,
mc,Object(gb.a)(this,this.TTk,"getExtendedGuidEquivalence")));if(2===Lb||1===Lb)return!0;let gc;({x8c:Lb,Eeb:Gc,ueb:gc}=this.oak(Object(gb.a)(Jb,Jb.getPropertyDictionary,"getPropertyDictionary"),mc.Lf.value.Kr,mc.Lf.value.Ie,mc.Zm.value.Ie,f.a.tO));if(!gc&&!Gc)return v.a.instance.ya(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",mc.Lf.value.Ie.id.toString(),z.a.Ya(f.a.tO)),!0;var Gc=Gc&&!gc;if(sc!==Mc||sc!==Gc)return v.a.instance.ya(592545116,
1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",mc.Lf.value.Ie.id.toString(),z.a.Ya(f.a.lu),z.a.Ya(f.a.ZP),z.a.Ya(f.a.tO),Mc,sc,Gc),!0;sc&&(Jb.setPropertyObjectIds(mc.jl,f.a.fw,Yb),Jb.setPropertyUint32s(mc.jl,f.a.ZP,Kb),Jb.setPropertyObjectIds(mc.jl,f.a.sM,Bb),Jb.setPropertyUint32s(mc.jl,
f.a.lu,Nb),Jb.setPropertyDictionary(mc.jl,f.a.tO,Lb));v.a.instance.ya(592545118,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",mc.Lf.value.Ie.id.toString(),Mc,sc,Gc);mc.ig.add(z.a.Ya(f.a.ZP));mc.ig.add(z.a.Ya(f.a.fw));mc.ig.add(z.a.Ya(f.a.lu));mc.ig.add(z.a.Ya(f.a.sM));mc.ig.add(z.a.Ya(f.a.tO));return!0}static uh(){return new Za}static get instance(){return Za.Vg.value}}Za.Vg=new c.a(Za.uh);
Object(D.a)(Za,"PageContentNodeComplexMerge",n.a,[]);class $a extends n.a{constructor(){super()}get Mn(){return 19}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.Aia),1);Jb.W(z.a.Ya(f.a.appsNode),2);Jb.W(z.a.Ya(f.a.customXmlPartContainerNode),2);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.Aia)){const Mc=Jb.Xc;var sc=Mc.getPropertyObjectIds(Jb.Lf.value.Kr,f.a.Aia);const Nb=Mc.getPropertyObjectIds(Jb.Lf.value.Ie,f.a.Aia),Kb=Mc.getPropertyObjectIds(Jb.Zm.value.Ie,f.a.Aia);sc=this.pLl(sc,Nb,Kb,Yb=>{let Bb;({value:Bb}=
Jb.fo.runtime.Hp.tb(Yb)).returnValue?Jb.fo.runtime.Jl.W(Yb,new t.a(Bb,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")});if(0<sc.length)return Mc.setPropertyObjectIds(Jb.jl,f.a.Aia,sc),Jb.ig.add(z.a.Ya(f.a.Aia)),!0}v.a.instance.ya(4018187,1,3,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}static uh(){return new $a}static get instance(){return $a.Vg.value}}
$a.Vg=new c.a($a.uh);Object(D.a)($a,"PageManifestNodeComplexMerge",n.a,[]);var cb=b(1584);class La extends n.a{constructor(){super()}get Mn(){return 43}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.Y1),0);Jb.W(z.a.Ya(f.a.iDa),0);Jb.W(z.a.Ya(f.a.wCa),0);Jb.W(z.a.Ya(f.a.tga),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(f.a.tga)){mc=Jb.Xc;var sc=Jb.Lf.value.Kr,Mc=Jb.Zm.value.Ie,Nb=Jb.Lf.value.Ie;sc=sc?mc.getPropertyObjectId(sc,f.a.tga):null;Mc=Mc?mc.getPropertyObjectId(Mc,f.a.tga):null;Nb=Nb?mc.getPropertyObjectId(Nb,
f.a.tga):null;v.a.instance.ya(589657691,1,3,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",sc?sc.toString():"NULL",Mc?Mc.toString():"NULL",Nb?Nb.toString():"NULL");if(Mc){if(Nb&&Mc.equals(Nb))return Jb.ig.add(z.a.Ya(f.a.tga)),mc.setPropertyObjectId(Jb.jl,f.a.tga,Mc),!0;if(cb.a.ege.equals(Mc))return Jb.ig.add(z.a.Ya(f.a.tga)),mc.setPropertyObjectId(Jb.jl,f.a.tga,cb.a.ege),!0}if(Nb&&cb.a.ege.equals(Nb))return Jb.ig.add(z.a.Ya(f.a.tga)),mc.setPropertyObjectId(Jb.jl,f.a.tga,
cb.a.ege),!0;v.a.instance.ya(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",sc?sc.toString():"NULL",Mc?Mc.toString():"NULL",Nb?Nb.toString():"NULL")}return!1}static uh(){return new La}static get instance(){return La.Vg.value}}La.Vg=new c.a(La.uh);Object(D.a)(La,"PageMetadataNodeComplexMerge",n.a,[]);var Ya=b(1455),Eb=b(109);class qa extends n.a{constructor(){super()}get Mn(){return 31}uk(){const Jb=super.uk();Jb.W(z.a.Ya(Eb.a.oq),1);Jb.W(z.a.Ya(f.a.listID),
1);Jb.W(z.a.Ya(f.a.ke),1);for(let mc=0;mc<qa.Dfb.length;mc++)Jb.W(qa.Dfb[mc],1);return Jb}cD(Jb,mc){const sc=Jb.Xc,Mc=Jb.jl,Nb=Jb.fo.runtime.Qa.isFeatureEnabled(114);z.a.Lla(mc);if(mc===z.a.Ya(Eb.a.oq)){const Kb=sc.getPropertyUint32(Jb.Lf.value.Ie,Eb.a.oq),Yb=sc.getPropertyUint32(Jb.Zm.value.Ie,Eb.a.oq);if(null!=Kb&&null!=Yb&&Kb===Yb)return sc.setPropertyUint32(Mc,Eb.a.oq,Kb),Jb.ig.add(mc),!0;if(null==Kb&&null==Yb)return Nb?Mc.removeProperty(Eb.a.oq):sc.setPropertyUint32(Mc,Eb.a.oq,Kb),Jb.ig.add(z.a.Ya(Eb.a.oq)),
!0;if(null!=Kb&&null==Yb)return sc.setPropertyUint32(Mc,Eb.a.oq,Kb),Jb.ig.add(mc),!0;if(null==Kb&&null!=Yb)return sc.setPropertyUint32(Mc,Eb.a.oq,Yb),Jb.ig.add(mc),!0}else if(mc===z.a.Ya(f.a.ke)){if(Nb)return this.lTm(sc,Jb)}else if(mc===z.a.Ya(f.a.listID)){if(Nb)return this.oTm(Jb,f.a.listID)}else if(Array.contains(qa.Dfb,mc)&&Nb)return this.kTm(Jb);return!1}oTm(Jb,mc){const sc=Jb.jl;var Mc=Jb.Zm.value,Nb=Jb.Lf.value;let Kb;const Yb=Mc.bia.tb(z.a.Ya(mc)).returnValue,Bb=({value:Kb}=Nb.bia.tb(z.a.Ya(mc))).returnValue;
Nb=Nb.Ie;Mc=Mc.Ie;let Lb=!1;Bb?Kb.isDeleted?(sc.removeProperty(mc),Lb=!0):Kb.iU?(sc.ooa(mc,Nb.ZW(f.a.listID)),Lb=!0):Yb&&(Mc.hasProperty(f.a.listID)?sc.ooa(mc,Mc.ZW(f.a.listID)):sc.removeProperty(mc),Lb=!0):Yb&&(Mc.hasProperty(f.a.listID)?(sc.ooa(mc,Mc.ZW(f.a.listID)),Lb=!0):v.a.instance.ya(578851419,1,1,"PersistablePropertySetComplexMerge: Merging ListId property. Not present in [base]: {0} [favored] : {1} conflict {2}.]",Jb.Lf.value.Kr.aFb(),Jb.Lf.value.Ie.aFb(),Jb.Zm.value.Ie.aFb()));return Lb?
(Jb.ig.add(z.a.Ya(mc)),!0):!1}kTm(Jb){let mc=!0,sc=!0,Mc,Nb;({Prl:mc,dql:sc,aEk:Mc,Ggk:Nb}=this.pak(Jb));v.a.instance.ya(578932993,1,3,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Jb.Lf.value.Ie.id.toString(),mc,sc);return mc&&!sc?(this.Fvi(Nb,Jb),!0):mc?!1:(this.Fvi(Mc,Jb),!0)}pak(Jb){let mc,sc,Mc,Nb;const Kb=Jb.Zm.value;let Yb;const Bb=Jb.Lf.value;let Lb;sc=mc=!0;Mc=new C.a;Nb=new C.a;for(let gc=0;gc<
qa.Dfb.length;gc++){const Gc=qa.Dfb[gc],fc=({value:Yb}=Kb.bia.tb(Gc)).returnValue;({value:Lb}=Bb.bia.tb(Gc)).returnValue&&(mc=this.f9i(Jb.Lf,Mc,Lb,Gc)&&mc);fc&&(sc=this.f9i(Jb.Zm,Nb,Yb,Gc)&&sc)}return{Prl:mc,dql:sc,aEk:Mc,Ggk:Nb}}f9i(Jb,mc,sc,Mc){const Nb=z.a.Lla(Mc);Jb=Jb.value.Ie;mc.W(Mc,Jb.hasProperty(Nb)?Jb.ZW(Nb):null);return!sc.iU}Fvi(Jb,mc){const sc=mc.jl;for(let Nb=0;Nb<qa.Dfb.length;Nb++){var Mc=qa.Dfb[Nb];const Kb=z.a.Lla(Mc);(Mc=Jb.J(Mc))?sc.ooa(Kb,Mc):sc.removeProperty(Kb)}for(Jb=0;Jb<
qa.Dfb.length;Jb++)mc.ig.add(qa.Dfb[Jb]);v.a.instance.ya(578932994,1,3,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",mc.Lf.value.Ie.id.toString())}lTm(Jb,mc){const sc=mc.jl,Mc=Jb.getPropertyInt32(mc.Lf.value.Ie,f.a.ke),Nb=Jb.getPropertyInt32(mc.Zm.value.Ie,f.a.ke);return null!=Mc&&null!=Nb&&Mc===Nb?(Jb.setPropertyInt32(sc,f.a.ke,Mc),mc.ig.add(z.a.Ya(f.a.ke)),!0):null==Mc&&null==Nb?(sc.removeProperty(f.a.ke),mc.ig.add(z.a.Ya(f.a.ke)),!0):null!=Mc&&null==Nb?(Jb.setPropertyInt32(sc,
f.a.ke,Mc),mc.ig.add(z.a.Ya(f.a.ke)),!0):null==Mc&&null!=Nb?(Jb.setPropertyInt32(sc,f.a.ke,Nb),mc.ig.add(z.a.Ya(f.a.ke)),!0):!1}static uh(){return new qa}static get instance(){return qa.Vg.value}}qa.Vg=new c.a(qa.uh);qa.Dfb=[z.a.Ya(f.a.Xk),z.a.Ya(f.a.yt),z.a.Ya(w.a.FX),z.a.Ya(f.a.g8),z.a.Ya(f.a.Yl),z.a.Ya(f.a.Ro),z.a.Ya(w.a.yX),z.a.Ya(f.a.dkf),z.a.Ya(w.a.font),z.a.Ya(va.a.Pzb)];Object(D.a)(qa,"PersistablePropertySetComplexMerge",n.a,[]);class Oa extends n.a{constructor(){super()}get Mn(){return 21}get xC(){return 0}static uh(){return new Oa}static get instance(){return Oa.Vg.value}}
Oa.Vg=new c.a(Oa.uh);Object(D.a)(Oa,"RevisionMetadataNodeComplexMerge",n.a,[]);class Ha extends n.a{constructor(){super()}get Mn(){return 22}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.languageHint),7);Jb.W(z.a.Ya(f.a.rod),2);return Jb}static uh(){return new Ha}static get instance(){return Ha.Vg.value}}Ha.Vg=new c.a(Ha.uh);Object(D.a)(Ha,"SharedPersistablePropertySetComplexMerge",n.a,[]);class ab extends n.a{constructor(){super()}get Mn(){return 38}get xC(){return 3}static uh(){return new ab}static get instance(){return ab.Vg.value}}
ab.Vg=new c.a(ab.uh);Object(D.a)(ab,"StylePropertySetComplexMerge",n.a,[]);var Ra=b(1245),Pa=b(1301);class bb extends n.a{constructor(){super()}get Mn(){return 23}get xC(){return 0}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.ff),4);Jb.W(z.a.Ya(f.a.rowSpan),1);Jb.W(z.a.Ya(f.a.colSpan),1);Jb.W(z.a.Ya(f.a.ghostCell),1);Jb.W(z.a.Ya(f.a.nxa),2);Jb.W(z.a.Ya(f.a.sRa),2);Jb.W(z.a.Ya(f.a.T0),2);Jb.W(z.a.Ya(f.a.P1a),5);return Jb}n2b(Jb){if(!Jb)return v.a.instance.ya(573957923,1,2,"Feature helper is null"),!1;
Jb.eo(184);return Jb.isFeatureEnabled(184)}cD(Jb,mc){var sc=mc===z.a.Ya(f.a.rowSpan)||mc===z.a.Ya(f.a.colSpan)||mc===z.a.Ya(f.a.ghostCell);if(!this.n2b(Jb.fo.runtime.Qa))return!sc;var Mc=Jb.Zm.value.Kr,Nb=Pa.e(Jb.fo,Mc,null);if(Nb.equals(mb.a.nil))return v.a.instance.ya(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Mc.id),Jb.fo.logger.wf(Object.assign(new Ra.a,{info:"Table node ID could not be found for table cell"})),!1;var Kb=Jb.fo.runtime.BTb.J(Nb).J(Mc.id);
if(!Kb)return!sc;Mc=Jb.jl;Nb=Jb.Xc;if(mc===z.a.Ya(f.a.ghostCell))return Nb.setPropertyBool(Mc,f.a.ghostCell,Kb.qe),Jb.ig.add(z.a.Ya(f.a.ghostCell)),!0;if(mc===z.a.Ya(f.a.rowSpan))return mc=Kb.rowSpan,Kb=Kb.colSpan,null!=mc&&null!=Kb&&(1<mc||1<Kb)?Nb.setPropertyUint32(Mc,f.a.rowSpan,mc):Mc.removeProperty(f.a.rowSpan),Jb.ig.add(z.a.Ya(f.a.rowSpan)),!0;if(mc===z.a.Ya(f.a.colSpan))return mc=Kb.rowSpan,sc=Kb.colSpan,Kb=Kb.qe,null!=mc&&null!=sc&&(1<mc||1<sc)?Nb.setPropertyUint32(Mc,f.a.colSpan,sc):Kb&&
null!=sc?Nb.setPropertyUint32(Mc,f.a.colSpan,sc):Mc.removeProperty(f.a.colSpan),Jb.ig.add(z.a.Ya(f.a.colSpan)),!0;v.a.instance.ya(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",mc);Jb.fo.logger.wf(Object.assign(new Ra.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!sc}static uh(){return new bb}static get instance(){return bb.Vg.value}}
bb.Vg=new c.a(bb.uh);Object(D.a)(bb,"TableCellNodeComplexMerge",n.a,[]);class hb extends n.a{constructor(){super()}get Mn(){return 24}n2b(Jb){if(!Jb)return v.a.instance.ya(573845782,1,2,"Feature helper is null"),!1;Jb.eo(184);return Jb.isFeatureEnabled(184)}get xC(){return 0}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.ff),1);Jb.W(z.a.Ya(w.a.$U),1);Jb.W(z.a.Ya(w.a.Eoa),1);Jb.W(z.a.Ya(f.a.QFc),1);Jb.W(z.a.Ya(f.a.UFc),1);Jb.W(z.a.Ya(f.a.nxa),2);Jb.W(z.a.Ya(f.a.sRa),2);Jb.W(z.a.Ya(f.a.T0),2);return Jb}cD(Jb,
mc){if(mc===z.a.Ya(w.a.ff)||mc===z.a.Ya(w.a.$U)||mc===z.a.Ya(f.a.QFc)||mc===z.a.Ya(f.a.UFc)||mc===z.a.Ya(w.a.Eoa)){const Nb=Jb.jl;var sc=Jb.Xc;v.a.instance.ya(4273303,1,3,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Nb.id,Nb.Ab,mc);if(this.Rwk(Jb))return!1;var Mc=sc.getPropertyObjectIds(Jb.Lf.value.Kr,w.a.ff);const Kb=sc.getPropertyObjectIds(Jb.Lf.value.Ie,w.a.ff),Yb=sc.getPropertyObjectIds(Jb.Zm.value.Ie,w.a.ff);Mc=this.Oui(Mc,Kb,Yb,(Bb,Lb)=>
Bb.equals(Lb));if(0<Mc.length)return sc.setPropertyObjectIds(Nb,w.a.ff,Mc),sc.setPropertyInt32(Nb,w.a.Eoa,Mc.length),this.n2b(Jb.fo.runtime.Qa)&&({value:mc}=Jb.Zm.value.bia.tb(z.a.Ya(w.a.$U)),{value:sc}=Jb.Lf.value.bia.tb(z.a.Ya(w.a.$U)),mc.iU?Nb.ooa(w.a.$U,mc.newValue):Nb.ooa(w.a.$U,sc.newValue)),Jb.ig.add(z.a.Ya(w.a.ff)),Jb.ig.add(z.a.Ya(w.a.$U)),Jb.ig.add(z.a.Ya(w.a.Eoa)),Jb.ig.add(z.a.Ya(f.a.QFc)),Jb.ig.add(z.a.Ya(f.a.UFc)),!0}v.a.instance.ya(4018189,1,3,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Jb.Lf.value.Ie.id,mc);return!1}Rwk(Jb){const mc=Jb.Zm.value,sc=Jb.Lf.value;let Mc,Nb;({value:Mc}=mc.bia.tb(z.a.Ya(w.a.$U)));({value:Nb}=sc.bia.tb(z.a.Ya(w.a.$U)));return Mc.iU||Nb.iU?Mc.iU&&Nb.iU?(v.a.instance.ya(4273304,1,3,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",Mc.oldValue,Nb.newValue,Mc.newValue),Jb.fo.logger.wf(Object.assign(new Ra.a,{Qh:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),
!0):hb.eNh(Jb.fo,Mc,sc,"BaseConflict")||hb.eNh(Jb.fo,Nb,mc,"BaseFavored")?!0:!1:!1}static uh(){return new hb}static get instance(){return hb.Vg.value}static eNh(Jb,mc,sc,Mc){return mc.iU&&({value:mc}=sc.bia.tb(z.a.Ya(w.a.ff)),mc.iU)?(v.a.instance.ya(4273305,1,3,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",Mc),Jb.logger.wf(Object.assign(new Ra.a,{Qh:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}hb.Vg=new c.a(hb.uh);
Object(D.a)(hb,"TableNodeComplexMerge",n.a,[]);var Pb=b(456);class wb extends n.a{constructor(){super()}get Mn(){return 25}get xC(){return 0}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.yb),3);Jb.W(z.a.Ya(w.a.ff),4);Jb.W(z.a.Ya(f.a.nxa),2);Jb.W(z.a.Ya(f.a.sRa),2);Jb.W(z.a.Ya(f.a.T0),2);Jb.W(z.a.Ya(Pb.a.BFd),2);Jb.W(z.a.Ya(Pb.a.AFd),2);Jb.W(z.a.Ya(f.a.P1a),5);return Jb}static uh(){return new wb}static get instance(){return wb.Vg.value}}wb.Vg=new c.a(wb.uh);Object(D.a)(wb,"TableRowNodeComplexMerge",n.a,
[]);class Fb extends n.a{constructor(){super()}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.uOm),2);Jb.W(z.a.Ya(w.a.ff),1);return Jb}cD(Jb,mc){if(mc===z.a.Ya(w.a.ff)){const Mc=Jb.jl,Nb=Jb.Xc;v.a.instance.ya(42754251,1,3,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Mc.id,Mc.Ab,mc);var sc=Nb.getPropertyObjectIds(Jb.Lf.value.Kr,w.a.ff);const Kb=Nb.getPropertyObjectIds(Jb.Lf.value.Ie,w.a.ff),Yb=Nb.getPropertyObjectIds(Jb.Zm.value.Ie,w.a.ff);if(sc=
this.tLl(sc,Kb,Yb))return 0<sc.length?Nb.setPropertyObjectIds(Mc,w.a.ff,sc):Mc.removeProperty(w.a.ff),Jb.ig.add(z.a.Ya(w.a.ff)),!0}v.a.instance.ya(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc);return!1}tLl(Jb,mc,sc){const Mc=new C.a(0);Jb.forEach(Kb=>{Mc.W(Kb,0);return!0});mc.forEach(Kb=>{Mc.La(Kb)?Mc.W(Kb,1):Mc.W(Kb,3);return!0});sc.forEach(Kb=>{let Yb;({value:Yb}=Mc.tb(Kb)).returnValue?1===
Yb?Mc.W(Kb,5):3===Yb?(v.a.instance.ya(42754253,1,2,"TaskNode was found added by both sides of merge"),Mc.W(Kb,3)):Mc.W(Kb,2):Mc.W(Kb,4);return!0});const Nb=new J.a;Mc.forEach((Kb,Yb)=>{Yb&&2!==Yb&&1!==Yb&&Nb.add(Kb);return!0});return Nb}static uh(){return new Fb}static get instance(){return Fb.Vg.value}}Fb.Vg=new c.a(Fb.uh);Object(D.a)(Fb,"TaskContentNodeComplexMerge",n.a,[]);class Ta{equals(Jb,mc){return Jb&&mc?Jb.UserId===mc.UserId&&Jb.Provider===mc.Provider&&Jb.DisplayName===mc.DisplayName&&Jb.Email===
mc.Email:!Jb&&!mc}xB(){return 0}}Object(D.a)(Ta,"CommentTaskPersonComparer",null,[354]);class Zb{equals(Jb,mc){return Jb&&mc?Jb.startDate?Jb.endDate?Jb.startDate.getTime()===mc.startDate.getTime()&&Jb.endDate.getTime()===mc.endDate.getTime():!mc.endDate:!mc.startDate:!Jb&&!mc}xB(){return 0}}Object(D.a)(Zb,"CommentTaskScheduleEqualityComparer",null,[354]);class Db{equals(Jb,mc){if(!Jb||!mc)return!Jb&&!mc;if(!Jb.extensions&&!mc.extensions)return!0;if(!Jb.extensions||!mc.extensions||Jb.extensions.count!==
mc.extensions.count)return!1;let sc=!0;Jb.extensions.forEach((Mc,Nb)=>{let Kb;return({value:Kb}=mc.extensions.tb(Mc)).returnValue&&Nb===Kb?!0:sc=!1});return sc}xB(){return 0}}Object(D.a)(Db,"ExtensionListEqualityComparer",null,[354]);class pb{QBk(Jb,mc){return Jb&&mc?Jb.recordId===mc.recordId&&pb.kWg.equals(Jb.user,mc.user)&&pb.kWg.equals(Jb.assignee,mc.assignee)&&Jb.type===mc.type&&Jb.title===mc.title&&Jb.priority===mc.priority&&Jb.isLossy===mc.isLossy&&Jb.completion===mc.completion&&Jb.commentId===
mc.commentId&&Jb.time===mc.time&&pb.iqj.equals(Jb.schedule,mc.schedule):!Jb&&!mc}equals(Jb,mc){return this.QBk(Jb,mc)}xB(){return 0}}pb.kWg=new Ta;pb.iqj=new Zb;new Db;Object(D.a)(pb,"HistoryRecordEqualityComparer",null,[354]);var nb=b(1670),ub=b(1192);class kb extends n.a{constructor(Jb){super();this.fVa=Jb}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.kcc),5);Jb.W(z.a.Ya(f.a.taskId),2);Jb.W(z.a.Ya(f.a.mOm),2);Jb.W(z.a.Ya(f.a.pOm),2);Jb.W(z.a.Ya(f.a.eEa),1);return Jb}MKg(Jb){if(!Jb.Zm.value.Kr&&!Jb.Lf.value.Kr){const mc=
Jb.Lf.value.Ie.gF();mc.removeProperty(f.a.eEa);const sc=Jb.Lf.value.Ie,Mc=Jb.Zm.value.Ie;Jb.Lf=new c.a(()=>new ub.a(mc,sc));Jb.Zm=new c.a(()=>new ub.a(mc,Mc))}return super.MKg(Jb)}cD(Jb,mc){if(mc!==z.a.Ya(f.a.eEa))return v.a.instance.ya(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Jb.Lf.value.Ie.id,mc),!1;const sc=Jb.jl,Mc=Jb.Xc;v.a.instance.ya(42754255,1,3,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
sc.id,sc.Ab,mc);mc=Mc.getPropertyString(Jb.Lf.value.Kr,f.a.eEa);const Nb=Mc.getPropertyString(Jb.Lf.value.Ie,f.a.eEa),Kb=Mc.getPropertyString(Jb.Zm.value.Ie,f.a.eEa);mc=this.sLl(mc,Nb,Kb);if(!mc)return!1;0<mc.length?Mc.setPropertyString(sc,f.a.eEa,mc):sc.removeProperty(f.a.eEa);Jb.ig.add(z.a.Ya(f.a.eEa));return!0}sLl(Jb,mc,sc){Jb=this.fVa.Mpc(Jb);mc=this.fVa.Mpc(mc);sc=this.fVa.Mpc(sc);if(!kb.Gki(Jb,mc))return v.a.instance.ya(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!kb.Gki(Jb,sc))return v.a.instance.ya(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;sc=kb.Nek(Jb.length,mc,sc);return this.fVa.Wxg(sc)}static uh(){const Jb=new nb.a;return new kb(Jb)}static get instance(){return kb.Vg.value}static Nek(Jb,mc,sc){const Mc=new J.a;for(let Nb=0;Nb<mc.length;Nb++)Mc.add(mc.J(Nb));for(;Jb<sc.length;Jb++)Mc.add(sc.J(Jb));return Mc}static Gki(Jb,mc){const sc=Jb.length;if(sc>mc.length)return!1;for(let Mc=0;Mc<sc;Mc++)if(!kb.Awj.equals(mc.J(Mc),
Jb.J(Mc)))return mc.J(Mc).recordId===Jb.J(Mc).recordId&&v.a.instance.ya(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}kb.Vg=new c.a(kb.uh);kb.Awj=new pb;Object(D.a)(kb,"TaskSingleNodeComplexMerge",n.a,[]);class zc extends n.a{constructor(){super()}get Mn(){return 26}uk(){const Jb=super.uk();Jb.W(z.a.Ya(w.a.ff),1);return Jb}cD(Jb,mc){const sc=w.a.ff;if(mc===z.a.Ya(sc)){mc=Jb.jl;const Nb=Jb.Xc;var Mc=Nb.getPropertyObjectIds(Jb.Lf.value.Kr,
sc);const Kb=Nb.getPropertyObjectIds(Jb.Lf.value.Ie,sc),Yb=Nb.getPropertyObjectIds(Jb.Zm.value.Ie,sc);Mc=this.xLl(Mc,Kb,Yb);Nb.setPropertyObjectIds(mc,sc,Mc);Jb.ig.add(z.a.Ya(sc));return!0}return!1}xLl(Jb,mc,sc){return this.b_a(Jb,mc,sc)}static uh(){return new zc}static get instance(){return zc.Vg.value}}zc.Vg=new c.a(zc.uh);Object(D.a)(zc,"VectorClockContainerNodeComplexMerge",n.a,[]);class Qc extends n.a{constructor(){super()}get Mn(){return 27}uk(){const Jb=super.uk();Jb.W(z.a.Ya(f.a.y4),1);return Jb}cD(Jb,
mc){const sc=f.a.y4;if(mc===z.a.Ya(sc)){mc=Jb.jl;const Mc=Jb.Xc,Nb=Mc.getPropertyUint32(Jb.Lf.value.Ie,sc)||0,Kb=Mc.getPropertyUint32(Jb.Zm.value.Ie,sc)||0;Mc.setPropertyUint32(mc,sc,this.fZk(Nb,Kb));Jb.ig.add(z.a.Ya(sc));return!0}return!1}fZk(Jb,mc){return Jb>mc?Jb:mc}static uh(){return new Qc}static get instance(){return Qc.Vg.value}}Qc.Vg=new c.a(Qc.uh);Object(D.a)(Qc,"VectorClockNodeComplexMerge",n.a,[]);class md extends n.a{constructor(){super()}get Mn(){return 28}get xC(){return 0}uk(){const Jb=
super.uk();Jb.W(z.a.Ya(f.a.wNh),3);Jb.W(z.a.Ya(f.a.yb),3);Jb.W(z.a.Ya(f.a.wxk),5);Jb.W(z.a.Ya(f.a.bvi),5);Jb.W(z.a.Ya(f.a.jca),5);return Jb}static uh(){return new md}static get instance(){return md.Vg.value}}md.Vg=new c.a(md.uh);Object(D.a)(md,"WordSectionNodeComplexMerge",n.a,[]);b.d(P,"a",function(){return vd});class vd{bIh(Jb){switch(Jb.Ab){case 131073:return Jb.hasProperty(f.a.A7)?Aa.instance:qa.instance;case 1074135140:return m.instance;case 1074135137:return A.instance;case 1074135139:return B.instance;
case 1074135138:return S.instance;case 1074135136:return R.instance;case 1074135157:return O.instance;case 1074135152:return I.instance;case 1074135153:return Y.instance;case 1074135126:return W.instance;case 1074135127:return Z.instance;case 1074135145:return fa.instance;case 1074135144:return X.instance;case 1074135142:return ma.instance;case 1074135143:return ka.instance;case 1074135163:return oa.instance;case 1074135164:return za.instance;case 1074135124:return Ja.instance;case 1074135125:return pa.instance;
case 1074135122:return Na.instance;case 393233:return Aa.instance;case 1074135170:return Ma.instance;case 1074135168:return ba.instance;case 1074135166:return L.instance;case 1074135167:return V.instance;case 1074135169:return ha.instance;case 1074135165:return la.instance;case 393234:return ya.instance;case 393229:return xa.instance;case 393241:return Ia.instance;case 393227:return Za.instance;case 131120:return La.instance;case 393271:return $a.instance;case 393230:return Ya.a.instance;case 131140:return Oa.instance;
case 1179649:return Ha.instance;case 1073872969:return ab.instance;case 393252:return bb.instance;case 393250:return hb.instance;case 393251:return wb.instance;case 1074135154:return zc.instance;case 1074135161:return Fb.instance;case 1074135162:return kb.instance;case 1074135155:return Qc.instance;case 1073872968:return md.instance}return n.a.instance}}Object(D.a)(vd,"GraphNodeComplexMergeFactory",null,[1316])},1584:function(D,P,b){D=b(0);var f=b(456),c=b(5),n=b(18),m=b(126),w=b(77),z=b(127),v=b(184),
t=b(531),A=b(52),B=b(381),S=b(1072);class C{constructor(oa,za=0){this.muf=null;this.$se=0;this.LK=oa;this.Sui=za}}Object(D.a)(C,"GraphMergerResponse",null,[]);var H=b(42),J=b(1),M=b(602),G=b(1176),R=b(1242);class O extends R.a{constructor(){super();this.g3i=null;this.Cej=!1}get pta(){return"Crash"}sYb(){this.detail.W("Type",this.pta);this.detail.W("Trace",this.oSm(this.g3i));this.detail.W("Continue",this.Cej);return this.detail}oSm(oa){oa=oa.split("\n");const za=4<oa.length?4:oa.length,Ja=new Sys.StringBuilder;
for(let pa=0;pa<za;pa++)pa===za-1?Ja.append(String.format("{0}...",oa[pa])):Ja.append(String.format("{0}\n",oa[pa]));return Ja.toString()}}Object(D.a)(O,"CrashMergeFailureDetail",R.a,[]);var I=b(1586),K=b(1192),Y=b(1310),W=b(1177),Z=b(1403);class U{constructor(){this.Dwh=new B.a;this.WDh=new B.a;this.KFh=new B.a}}Object(D.a)(U,"RangeMarkers",null,[]);class X{constructor(){this.colSpan=this.rowSpan=null;this.qe=!1;this.eTe=new v.a;this.i1e=new v.a;this.F1e=new v.a}get mRf(){return this.eTe.d9()}set mRf(oa){oa||
(this.eTe=new v.a);this.eTe=oa.d9()}get ucg(){return this.i1e.d9()}set ucg(oa){oa||(this.i1e=new v.a);this.i1e=oa.d9()}get Ape(){return this.F1e.d9()}set Ape(oa){oa||(this.F1e=new v.a);this.F1e=oa.d9()}}Object(D.a)(X,"TableCellStructureInfo",null,[]);var fa=b(1245),ma=b(1301);b.d(P,"a",function(){return ka});class ka{constructor(){this.fge=0;this.w1g=this.snb=this.Lic=this.qg=this.wfh=this.L7a=null;this.b9g=0;this.C_g=this.uVg=null}get ARi(){return this.L7a}get lpm(){return this.wfh}get Xc(){return this.qg}get iAb(){return this.Lic}get i9h(){return this.snb}get Xal(){return this.w1g}get Qxc(){return this.b9g}get ABh(){return this.uVg}get kdd(){return this.C_g}a_a(oa,
za,Ja,pa,Na,Da,Aa){Ja=this.enk(oa,za,pa,Na,Da,Aa,this.kdd);pa=0;const Ma=Ja.runtime.HAe;let ba=null;try{this.nGl(Ma,Ja,Aa,oa,za,Na,Da);for(oa=1;pa<this.iAb.length;pa++)if(!(0,this.iAb[pa])(Ja)){oa=2;Ja.logger.Ume("GraphMerger.GetMergeFunctions()",pa);break}return ba=new C(Ja.output.LK,oa)}catch(L){const V=!Ja.output.timeout;Ja.output.crash=V;const ha=this.Xce(L),la=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",V?"Crashed":"Timed Out",Ja.input.O3b,!!Ja.output.LK,
ha);V?(m.a.instance.ya(4051608,1,1,"MergeChanges Crash. [Error: {0}]",la),Ja.logger.wf(Object.assign(new O,{g3i:ha,Cej:!!Ja.output.LK}))):m.a.instance.ya(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",la);if(Ja.output.LK)return ba=new C(Ja.output.LK,2);throw L;}finally{Ja.output.succeeded?this.kGl(Ma,Ja,pa):Ja.output.timeout?this.mGl(Ja,pa):Ja.output.crash?Ja.output.LK?this.lGl(Ja,pa):this.jGl(Ja,pa):this.iGl(Ja,pa);Ja.logger.hGl();m.a.instance.Joa(42350232,1,Ja.output.succeeded?3:2,"MergeLogger",
Ja.logger.mZk());Ja.logger.XZa.P$h()&&m.a.instance.Joa(559015903,1,2,"MarkerInfo",Ja.logger.XZa.toString());if(Ja.runtime.Qa&&Ja.runtime.Qa.isFeatureEnabled(122))try{this.LEl(Ja)}catch(L){m.a.instance.ya(571619421,1,3,"Error logging references: {0}",L.toString())}!Ja.output.succeeded&&Ja.runtime.Qa&&(Ja.runtime.Qa.xRf(1000007),Ja.runtime.Qa.rvb(1000007)&&w.Health.instance.recordQosError("BrowserMergeFailure",["MergeFailure"],!0,!0,!1,!1,null));ba.$se|=(Ja.output.succeeded?2:1)<<2*(Aa-1);if(ba)try{ba.muf=
this.N5l(Ja)}catch(L){m.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",L)}}}LEl(oa){const za=Na=>{const Da=this.OLa()-oa.input.YDa>this.Qxc;if(0<this.Qxc&&Da)throw m.a.instance.ya(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Na),z.a.invalidOperation(Na);};let Ja=oa.runtime.Lw.keys,pa=Na=>oa.runtime.Lw.J(Na);this.R5f(oa,za,Ja,pa,"Favored");Ja=oa.runtime.Hp.keys;pa=Na=>oa.runtime.Hp.J(Na);this.R5f(oa,za,Ja,pa,"Unfavored");Ja=oa.runtime.Jl.keys;
pa=Na=>{const Da=oa.runtime.Jl.J(Na);return Da?Da.Oi:oa.runtime.Lw.J(Na)};this.R5f(oa,za,Ja,pa,"Merged")}R5f(oa,za,Ja,pa,Na){var Da=new v.a;const Aa=new v.a;for(let Ma=0;Ma<Ja.length;Ma++){za("LogAddedAndDeletedNodes");const ba=pa(Ja.J(Ma));if(4325465===ba.Ab)continue;const L=oa.runtime.pj.J(ba.id);L&&this.MEl(Da,Aa,ba,L)}this.Lri(Aa,Ma=>oa.runtime.pj.J(Ma),za);this.Lri(Da,pa,za);za=new Sys.StringBuilder;for(Ja=0;Ja<Da.length;Ja++)za.append(Da.J(Ja).toString()+",");Da=new Sys.StringBuilder;for(Ja=
0;Ja<Aa.length;Ja++)Da.append(Aa.J(Ja).toString()+",");m.a.instance.Joa(571619423,1,3,Na+" revision: Added references",za.toString());m.a.instance.Joa(571619424,1,3,Na+" revision: Deleted references",Da.toString())}MEl(oa,za,Ja,pa){const Na=Ja.Hl();for(let Aa=0;Aa<Na.length;Aa++){const Ma=Na[Aa];if(this.hgi(Ma)){var Da=this.Xc.getPropertyObjectIds(Ja,Ma);this.zFl(oa,za,pa,Ma,Da)}else this.Vji(Ma)&&(Da=this.Xc.getPropertyObjectId(Ja,Ma),this.yFl(oa,za,pa,Ma,Da))}}Lri(oa,za,Ja){Ja("LogNestedReferences");
Ja=new v.a;const pa=new t.a;for(let Na=0;Na<oa.length;Na++){const Da=oa.J(Na);this.p7f(Da,Ja,pa,za)}for(za=0;za<Ja.length;za++)oa.add(Ja.J(za))}p7f(oa,za,Ja,pa){const Na=pa(oa);if(Na){const Aa=Na.Hl();for(let Ma=0;Ma<Aa.length;Ma++){var Da=Aa[Ma];if(this.hgi(Da)){Da=this.Xc.getPropertyObjectIds(Na,Da);for(let ba=0;ba<Da.length;ba++)Ja.contains(Da.J(ba))||(za.add(Da.J(ba)),Ja.add(Da.J(ba)),this.p7f(Da.J(ba),za,Ja,pa))}else this.Vji(Da)&&(Da=this.Xc.getPropertyObjectId(Na,Da),Ja.contains(Da)||(za.add(Da),
Ja.add(Da),this.p7f(oa,za,Ja,pa)))}}}zFl(oa,za,Ja,pa,Na){if(this.Xc.hasProperty(Ja,pa)){Ja=this.Xc.getPropertyObjectIds(Ja,pa);const Da=Ja.zH();pa=Na.zH();for(let Aa=0;Aa<Na.length;Aa++)Da.contains(Na.J(Aa))||oa.add(Na.J(Aa));for(oa=0;oa<Ja.length;oa++)pa.contains(Ja.J(oa))||za.add(Ja.J(oa))}else for(za=0;za<Na.length;za++)oa.add(Na.J(za))}yFl(oa,za,Ja,pa,Na){Na&&(this.Xc.hasProperty(Ja,pa)?(Ja=this.Xc.getPropertyObjectId(Ja,pa),Na.equals(Ja)||(oa.add(Na),za.add(Ja))):oa.add(Na))}gGl(oa){m.a.instance.ya(4535064,
1,3,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",oa.input.O3b,oa.output.crash,oa.output.timeout)}nGl(oa,za,Ja,pa,Na,Da,Aa){if(oa){oa=pa.length?pa.Ye(pa.length-1):null;var Ma=Na.length?Na.Ye(Na.length-1):null;Ja=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",za.input.O3b,pa.length,oa?
oa.id:A.a.nil,oa?oa.wG?oa.wG.id:A.a.nil:A.a.nil,Na.length,Ma?Ma.id:A.a.nil,Ma?Ma.wG?Ma.wG.id:A.a.nil:A.a.nil,Da,Aa,this.Qxc,Ja);switch(za.input.source){case 5:m.a.instance.ya(51663493,1,3,Ja);break;default:m.a.instance.ya(4051606,1,3,Ja)}}}kGl(oa,za,Ja){if(oa)switch(oa=this.agd(za,Ja,"Succeeded"),za.input.source){case 5:m.a.instance.ya(51663494,1,3,oa);break;default:m.a.instance.ya(4059162,1,3,oa)}}mGl(oa,za){za=this.agd(oa,za,"Timeout");switch(oa.input.source){case 5:m.a.instance.ya(51663495,1,3,
za);break;default:m.a.instance.ya(4059163,1,2,za)}}iGl(oa,za){za=this.agd(oa,za,"Rejection");switch(oa.input.source){case 5:m.a.instance.ya(51663496,1,3,za);break;default:m.a.instance.ya(4059164,1,2,za)}}lGl(oa,za){za=this.agd(oa,za,"Crash - Rejection");switch(oa.input.source){case 5:m.a.instance.ya(51663497,1,3,za);break;default:m.a.instance.ya(4059165,1,2,za)}}jGl(oa,za){za=this.agd(oa,za,"Crash - Failed");switch(oa.input.source){case 5:m.a.instance.ya(51663498,1,3,za);break;default:m.a.instance.ya(4059166,
1,2,za)}}agd(oa,za,Ja){const pa=oa.output.LK,Na=pa&&pa.length?pa.Ye(pa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",oa.input.O3b,Ja,this.OLa()-oa.input.YDa,za,pa?pa.length:0,Na?Na.id:A.a.nil,Na?Na.wG?Na.wG.id:A.a.nil:A.a.nil,oa.input.source)}enk(oa,za,Ja,pa,Na,Da,Aa){const Ma=new I.a,ba=Ma.input;ba.s9=oa;ba.KEa=za;ba.Kg=Ja;ba.s3=pa;ba.Ytc=Na;ba.source=
Da;ba.kdd=Aa;ba.YDa=this.OLa();Ma.logger.zAm(ba.YDa);oa=Ma.runtime;oa.LDd=m.a.instance.O0(1,4);oa.HAe=m.a.instance.O0(1,3);let L="";oa.NF=V=>{if(this.Qxc){var ha=this.OLa()-ba.YDa,la=ha>this.Qxc;L+=String.format(" ({0}: {1})",V,ha);la&&(Ma.output.timeout=!0,V=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ba.O3b,this.Qxc,V,ha,L),this.IPm(V))}};return Ma}ohd(){return[Object(H.a)(this,this.W_l,"otherAuthorsHaveChangesToMerge"),
Object(H.a)(this,this.utl,"isInputValid"),Object(H.a)(this,this.Pkl,"initializeOutputMergeState"),Object(H.a)(this,this.t0b,"initializeRuntimeMergeState"),Y.a.E5l,Object(H.a)(this,this.D5l,"preProcessTableStructure"),Object(H.a)(this.ABh,this.ABh.aLl,"mergeChildNodeLists"),Object(H.a)(this,this.sTm,"tryObjectMerge"),Y.a.m5l,Object(H.a)(this,this.gFk,"finalizeObjectMerge"),Object(H.a)(this,this.q1m,"validateMarkers"),Object(H.a)(this,this.lRj,"addMergeResultsToOutput")]}W_l(oa){const za=oa.input.s9;
oa=oa.output;return za?za.length?!0:(m.a.instance.ya(4051610,1,4,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),oa.LK=za,oa.succeeded=!0,!1):(m.a.instance.ya(4051609,1,4,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),oa.LK=za,oa.succeeded=!0,!1)}utl(oa){var za=oa.input;const Ja=za.s9,pa=za.KEa,Na=za.Kg,Da=za.s3;za=za.Ytc;oa=oa.output;if(!pa||!pa.length)return m.a.instance.ya(42350233,1,4,"IsInputValid: No local changes to merge."),oa.LK=Ja,
oa.succeeded=!0,!1;let Aa=!0;if(2!==Da&&1!==Da)return oa.LK=Ja,!1;Na&&Na!==A.a.nil||(Aa=!1);Ja.length<(za?2:1)&&(m.a.instance.ya(4051614,1,4,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",za),Aa=!1);Aa||(oa.LK=2===Da?Ja:pa);return Aa}t0b(oa){var za=oa.input,Ja=za.s9,pa=za.KEa,Na=za.s3,Da;let Aa;({rPm:Da,M3m:Aa,sKa:za}=this.YXk(oa,Ja,pa,za.Ytc));if(!za)return m.a.instance.ya(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
Da.id,Aa.id),oa.logger.wf(Object.assign(new G.a,{Qh:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.Zri(Da,Ja.length,"TheirChanges"),this.Zri(Aa,pa.length,"YourChanges"),oa.output.LK=2===Na?Ja:pa,!1;oa.runtime.sKa=za;({AUm:Ja,YDk:pa}=this.suk(Na,Da,Aa));({BUm:za,ZDk:Na,K1j:Da}=this.CZk(oa,Ja,pa,za));oa.runtime.pj=Da;oa.runtime.Hp=za;oa.runtime.Lw=Na;oa.runtime.Jl=new B.a;oa.runtime.$$d=pa.id;oa.runtime.REe=Ja.id;oa.runtime.IAb=new B.a;oa.runtime.hWa=
new t.a;oa.runtime.Gxf=new B.a;oa.runtime.BTb=new B.a;oa.runtime.DHg=new B.a;oa.runtime.N8b=new U;oa.runtime.Fig=new t.a;oa.runtime.XEc=new v.a;oa.runtime.Qa=oa.input.kdd(oa);oa.runtime.Qa.a1d(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.UOm);oa.runtime.Qa.a1d(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.yQm);oa.runtime.Qa.a1d(1000007,"Microsoft.Office.WordOnline.MergeQosError","WoMer140;WoMer140cf",f.a.qLl);return oa.runtime.Ndi=
!0}Zri(oa,za,Ja){const pa=new v.a;for(;oa;)pa.add(oa),oa=oa.wG;const Na=new Sys.StringBuilder;Na.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ja,za,pa.length));let Da=pa.length,Aa=0;pa.forEach(Ma=>({Wbi:Da,qsi:Aa}=this.FSj(Na,Ma,pa,Da,Aa)).returnValue);m.a.instance.ya(4273302,1,3,Na.toString())}FSj(oa,za,Ja,pa,Na){oa.append(String.format(" [{0} {1} {2}]",pa,za.tX?"S":"B",za.id));pa--;Na++;return 50<Na&&Ja.length!==Na?(oa.append(" ...Truncated."),{returnValue:!1,Wbi:pa,
qsi:Na}):{returnValue:!0,Wbi:pa,qsi:Na}}YXk(oa,za,Ja,pa){za=za.Ye(za.length-1-(pa?1:0));Ja=Ja.Ye(Ja.length-1);pa=za.Eta(Ja);oa.runtime.NF("GetCommonBase");oa.logger.gna("GetCommonBase");return{rPm:za,M3m:Ja,sKa:pa}}CZk(oa,za,Ja,pa){let Na,Da;({result:Na}=za.yOa(pa));oa.runtime.NF("GetUnfavoredChanges");oa.logger.gna("GetUnfavoredChanges");({result:Da}=Ja.yOa(pa));5===oa.input.source&&(oa.runtime.bEk=M.a.COf(Ja),oa.runtime.uLg=M.a.COf(za));oa.runtime.NF("GetFavoredChanges");oa.logger.gna("GetFavoredChanges");
za=new S.a(Object(H.a)(pa,pa.Saa,"getMergeableObject"));oa.runtime.NF("GetModifiedObjects");oa.logger.gna("GetModifiedObjects");return{BUm:Na,ZDk:Da,K1j:za}}suk(oa,za,Ja){2===oa?(oa=za,za=Ja):oa=Ja;return{AUm:za,YDk:oa}}Pkl(oa){const za=oa.input,Ja=za.s9,pa=za.KEa;oa.output.LK=(2===za.s3?Ja:pa).d9();oa.runtime.NF("InitializeOutputMergeState");oa.logger.gna("InitializeOutputMergeState");return!0}lRj(oa){var za=oa.input.Kg;const Ja=oa.runtime.Jl,pa=oa.output.LK;za=this.fnk(oa,pa.Ye(pa.length-1),za,
A.a.create());this.SEk(oa,za,Ja);pa.add(za);return oa.output.succeeded=!0}fnk(oa,za,Ja,pa){oa.runtime.HAe&&m.a.instance.ya(4051616,1,3,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ja,pa);oa=this.lpm(pa);oa.Yvh(za,Ja);return oa}SEk(oa,za,Ja){oa.runtime.HAe&&m.a.instance.ya(4059167,1,3,"FillRevision: Adding {0} objects to merged revision.",Ja.count);Ja.forEach((pa,Na)=>{za.hph(Na.Oi);return!0})}n2b(oa){if(!oa)return m.a.instance.ya(573957952,1,2,"Feature helper is null"),
!1;oa.eo(184);return oa.isFeatureEnabled(184)}D5l(oa){if(!this.n2b(oa.runtime.Qa))return!0;const za=oa.runtime.Lw,Ja=oa.runtime.Hp,pa=oa.runtime.pj;let Na=!0;za.forEach((Da,Aa)=>{393252===Aa.Ab&&(Na=this.jHi(oa,Da,Aa,pa,za));return Na});if(!Na)return!1;Ja.forEach((Da,Aa)=>{393252===Aa.Ab&&(Na=this.jHi(oa,Da,Aa,pa,Ja));return Na});oa.logger.gna("PreProcessTableStructure");return Na}jHi(oa,za,Ja,pa,Na){const Da=null==this.Xc.getPropertyBool(Ja,c.a.ghostCell)?!1:this.Xc.getPropertyBool(Ja,c.a.ghostCell),
Aa=null==this.Xc.getPropertyUint32(Ja,c.a.rowSpan)?1:this.Xc.getPropertyUint32(Ja,c.a.rowSpan),Ma=null==this.Xc.getPropertyUint32(Ja,c.a.colSpan)?1:this.Xc.getPropertyUint32(Ja,c.a.colSpan);if(Da)return!0;var ba=pa.J(za);if(ba){pa=null==this.Xc.getPropertyBool(ba,c.a.ghostCell)?!1:this.Xc.getPropertyBool(ba,c.a.ghostCell);var L=null==this.Xc.getPropertyUint32(ba,c.a.rowSpan)?1:this.Xc.getPropertyUint32(ba,c.a.rowSpan);var V=null==this.Xc.getPropertyUint32(ba,c.a.colSpan)?1:this.Xc.getPropertyUint32(ba,
c.a.colSpan);pa=pa!==Da;L=L!==Aa;V=V!==Ma}else V=L=pa=!0;const ha=ma.e(oa,Ja,Na);if(ha.equals(A.a.nil))return m.a.instance.ya(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",za),oa.logger.wf(Object.assign(new fa.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let la=oa.runtime.BTb.J(ha);la||(oa.runtime.BTb.W(ha,new B.a),la=oa.runtime.BTb.J(ha));let ya=la.J(za),va=new v.a;const xa=new v.a,Ia=new v.a;pa&&(ya||(va=this.Xc.getPropertyObjectIds(Ja,
n.a.ff)));if(L||V)if(ya){if(ya.qe)return m.a.instance.ya(573957961,1,3,"Table cell has conflicting ghostcell properties we are not handling"),oa.logger.wf(Object.assign(new fa.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=ya.rowSpan&&Aa!==ya.rowSpan||null!=ya.colSpan&&Ma!==ya.colSpan)return m.a.instance.ya(573957962,1,3,"Same table cell has different rowSpan/colSpan in conflicting revisions"),oa.logger.wf(Object.assign(new fa.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),
!1}else{var mb;({rowIndex:Ja,aoc:mb}=ma.b(oa,Na,Ja));if(-1===Ja||-1===mb)return m.a.instance.ya(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",za),oa.logger.wf(Object.assign(new fa.a,{info:"Table cell location could not be found"})),!1;for(var gb=Ja;gb<Ja+Aa;gb++)for(var Za=mb;Za<mb+Ma;Za++){var $a=ma.c(oa,ha,gb,Za);if($a.equals(A.a.nil))return m.a.instance.ya(573957955,1,3,"Other revision deleted the table cells this revision is trying to merge"),oa.logger.wf(Object.assign(new fa.a,
{info:"Ghost cell not found in the table bounds"})),!1;var cb=Na.uz($a,oa.runtime.pj.J($a));if(!cb)return m.a.instance.ya(573957956,1,3,"Other revision has inserted cells in between the cells this revision is trying to merge"),oa.logger.wf(Object.assign(new fa.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!$a.equals(za)){if(null==this.Xc.getPropertyBool(cb,c.a.ghostCell)||!this.Xc.getPropertyBool(cb,c.a.ghostCell))return m.a.instance.ya(573957957,
1,3,"Other revision deleted some of the cells this revision is trying to merge"),oa.logger.wf(Object.assign(new fa.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var La=la.J($a);if(La)return m.a.instance.ya(573957958,1,3,"The ghost cell is already merged with some other cells in the other revision"),oa.logger.wf(Object.assign(new fa.a,{info:"Ghost cell is already merged with some other cell"})),!1;xa.add($a);La=new X;La.qe=!0;cb=this.Xc.getPropertyUint32(cb,c.a.colSpan);null!=
cb&&(La.colSpan=cb);la.W($a,La)}}if(ba&&(null==this.Xc.getPropertyBool(ba,c.a.ghostCell)||!this.Xc.getPropertyBool(ba,c.a.ghostCell))&&(Na=null==this.Xc.getPropertyUint32(ba,c.a.rowSpan)?1:this.Xc.getPropertyUint32(ba,c.a.rowSpan),Ja=null==this.Xc.getPropertyUint32(ba,c.a.colSpan)?1:this.Xc.getPropertyUint32(ba,c.a.colSpan),Na>Aa||Ja>Ma)){gb=mb=-1;({rowIndex:mb,aoc:gb}=ma.a(oa,null,ba,mb,gb));if(-1===mb||-1===gb)return m.a.instance.ya(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",
za),oa.logger.wf(Object.assign(new fa.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ba=xa.zH();for(Za=mb;Za<mb+Na;Za++)for($a=gb;$a<gb+Ja;$a++){La=ma.d(oa,null,ha,Za,$a);if(!La)return m.a.instance.ya(573957960,1,2,"Table cell could not be found within table bounds"),oa.logger.wf(Object.assign(new fa.a,{info:"Ghost cell not found in the table bounds"})),!1;La.id.equals(za)||ba.contains(La.id)||Ia.add(La.id)}}}!ya&&(pa||L||V)&&(m.a.instance.ya(573957963,
1,3,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",za),ya=new X,ya.rowSpan=Aa,ya.colSpan=Ma,ya.qe=Da,ya.Ape=va,ya.mRf=xa,ya.ucg=Ia,la.add(za,ya));return!0}sTm(oa){return this.u9i(oa,!1)}gFk(oa){return this.u9i(oa,!0)}u9i(oa,za){const Ja=oa.runtime,pa=Ja.pj,Na=Ja.Lw,Da=za?Ja.Gxf:Ja.Hp,Aa=Ja.Jl;let Ma=!0;const ba=oa.runtime.LDd;let L=0,V=0,ha=0;Da.forEach((la,ya)=>{ba&&m.a.instance.ya(4051617,1,4,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
la,ya.Ab,za);V++;50===V&&(L++,oa.runtime.NF(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",L,ha,za)),V=0);if(oa.runtime.Qa&&oa.runtime.Qa.rvb(1000005)&&oa.runtime.XEc.contains(ya.id,(Ia,mb)=>Ia.equals(mb))||this.GIm(ya.Ab))return!0;if(!za&&this.hsk(ya.Ab,oa.runtime.Qa))return Ja.Gxf.W(la,ya),!0;var va=Na.get(la);if(!va)return Aa.La(la)?Aa.J(la).Yui(ya):Aa.W(la,new W.a(ya,!1)),!0;if(!pa.J(la)&&!this.ALl(va.Ab)){var xa=!!oa.input.s9&&!!oa.input.s9.last()&&oa.input.s9.last().ew(la);
const Ia=!!oa.input.KEa&&!!oa.input.KEa.last()&&oa.input.KEa.last().ew(la),mb=new K.a(va,ya);if(!mb.iU)return Aa.W(la,new W.a(va,!1)),!0;m.a.instance.ya(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",la,ya.Ab,za,xa,Ia,!mb.iU,oa.input.source);oa.logger.wf(Object.assign(new G.a,{Qh:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));
return Ma=!1}xa=Aa.uz(la,new W.a(pa.J(la)));({jl:va,returnValue:Ma}=this.Xal.merge(oa,this.i9h,this.Xc,xa,va,ya));ha++;Ma&&(oa.runtime.NF(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",la,ya.Ab,ha,L,za)),va&&(Aa.La(va.Oi.id)?Aa.J(va.Oi.id).Yui(va.Oi):Aa.W(va.Oi.id,va)));return Ma});oa.logger.gna("ObjectMerge");Ma&&5===oa.input.source&&oa.runtime.uLg.length&&Na.forEach((la,ya)=>393230===ya.Ab&&oa.runtime.uLg.contains(la,(va,xa)=>va.equals(xa))&&
(Ma=pa.J(la)?!(new Z.a(n.a.Zk,this.Xc.getPropertyString(pa.J(la),n.a.Zk),this.Xc.getPropertyString(ya,n.a.Zk))).iU:!1,!Ma)?(m.a.instance.ya(16869081,1,2,"Failed to Merge Object {0} which was changed in the favored and removed in the unfavored, finalize: {1}",la,za),oa.logger.wf(Object.assign(new G.a,{Qh:"GraphMerger.TryObjectMerge",eventId:"baw1z"})),!1):!0);ba&&m.a.instance.ya(4059168,1,4,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Da.count,ha,za);return Ma}q1m(oa){try{oa.runtime.N8b.KFh.forEach(za=>
{var Ja=oa.runtime.Jl.J(za);if(Ja){var pa=this.Xc.getPropertyObjectId(Ja.Oi,c.a.Xh);Ja=this.Xc.getPropertyObjectId(Ja.Oi,c.a.gj);if(!pa||!Ja){let Na;(Na=oa.logger.XZa).Quc=Na.Quc+1;return!0}pa=this.Yvc(oa,pa,za,c.a.ud,Na=>38===Na||40===Na);za=this.Yvc(oa,Ja,za,c.a.ud,Na=>39===Na||41===Na);if(!pa||!za){let Na;(Na=oa.logger.XZa).Quc=Na.Quc+1}}else m.a.instance.ya(559535576,1,2,"ValidateMerge: Couldn't find merged node to verify");oa.runtime.NF("Validate markers taking too long");return!0}),oa.runtime.N8b.Dwh.forEach(za=>
{var Ja=oa.runtime.Jl.J(za);if(Ja){var pa=this.Xc.getPropertyObjectId(Ja.Oi,c.a.LF);Ja=this.Xc.getPropertyObjectId(Ja.Oi,c.a.PW);if(!pa||!Ja){let Na;(Na=oa.logger.XZa).Ouc=Na.Ouc+1;return!0}pa=this.Yvc(oa,pa,za,c.a.irb,Na=>44===Na);za=this.Yvc(oa,Ja,za,c.a.irb,Na=>45===Na);if(!pa||!za){let Na;(Na=oa.logger.XZa).Ouc=Na.Ouc+1}}else m.a.instance.ya(559535577,1,2,"ValidateMerge: Couldn't find merged node to verify");oa.runtime.NF("Validate markers taking too long");return!0}),oa.runtime.N8b.WDh.forEach(za=>
{var Ja=oa.runtime.Jl.J(za);if(Ja){var pa=this.Xc.getPropertyObjectId(Ja.Oi,c.a.VB);Ja=this.Xc.getPropertyObjectId(Ja.Oi,c.a.ry);if(!pa||!Ja){let Na;(Na=oa.logger.XZa).Puc=Na.Puc+1;return!0}pa=this.Yvc(oa,pa,za,c.a.Yj,Na=>33===Na);za=this.Yvc(oa,Ja,za,c.a.Yj,Na=>34===Na);if(!pa||!za){let Na;(Na=oa.logger.XZa).Puc=Na.Puc+1}}else m.a.instance.ya(559535578,1,2,"ValidateMerge: Couldn't find merged node to verify");oa.runtime.NF("Validate markers taking too long");return!0})}catch(za){m.a.instance.ya(559535579,
1,2,"ValidateMerge threw an exception: {0}",za)}return oa.logger.XZa.P$h()?!1:!0}Yvc(oa,za,Ja,pa,Na){if(oa.runtime.Fig.contains(za))return!1;if(za=this.O_h(oa,za)){za=this.Xc.getPropertyObjectIds(za,n.a.DA);for(let Ma=0;Ma<za.length;Ma++){var Da=this.O_h(oa,za.Ye(Ma));if(Da){var Aa=this.Xc.getPropertyBool(Da,n.a.n4);if(Aa&&Aa&&(Aa=this.Xc.getPropertyUint32(Da,c.a.pq),Da=this.Xc.getPropertyObjectId(Da,pa),Na(Aa)&&Da.equals(Ja)))return!0}}}return!1}O_h(oa,za){const Ja=oa.runtime.Jl.J(za);return Ja?
Ja.Oi:oa.runtime.pj.J(za)}GIm(oa){switch(oa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}hsk(oa,za){let Ja=!1;if(1074135145===oa)return!0;za&&za.eo(216);za&&za.isFeatureEnabled(216)&&1074135153===oa&&(Ja=!0);return Ja}ALl(oa){switch(oa){case 1074135162:return!0}return!1}Iok(oa,za){const Ja=new v.a,pa=new v.a,Na=new v.a;var Da=oa.runtime.sKa;const Aa=Da?Da.id:A.a.nil;this.u5f(Da).forEach(Ma=>{Ja.add(za(Ma));return!0});Da=oa.input.s9.Ye(oa.input.s9.length-
1);this.u5f(Da,Aa).forEach(Ma=>{pa.add(za(Ma));return!0});oa=oa.input.KEa.Ye(oa.input.KEa.length-1);this.u5f(oa,Aa).forEach(Ma=>{Na.add(za(Ma));return!0});return{I1j:Ja,sPm:pa,N3m:Na}}u5f(oa,za=null){const Ja=new v.a;za||(za=A.a.nil);for(;oa&&!za.equals(oa.id);)Ja.add(oa),oa=oa.wG;Ja.reverse();return Ja}TMm(oa){const za=3===this.fge;let Ja=!1;!oa.output.succeeded&&(2===this.fge||oa.output.crash&&1===this.fge)&&(Ja=!0);let pa=!1;oa.input.s9&&0<oa.input.s9.length&&(za||Ja)&&oa.runtime.Lw&&oa.runtime.pj&&
oa.runtime.Qa&&(pa=oa.runtime.Qa.isFeatureEnabled(83));return pa}hgi(oa){return 9===J.a.jvb(J.a.qbe(oa))}Vji(oa){return 8===J.a.jvb(J.a.qbe(oa))}static sVk(oa){return oa.output.crash?2:oa.output.succeeded?3:1}}ka.ege=A.a.Ad("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(D.a)(ka,"GraphMergerBase",null,[1094])},1586:function(D,P,b){D=b(0);var f=b(1454),c=b(52);class n{constructor(){this.source=0;this.Kg=this.KEa=this.s9=null;this.s3=0;this.Ytc=!1;this.mode=this.YDa=0;this.kdd=null;this.O3b=c.a.create()}}
Object(D.a)(n,"InputState",null,[]);class m{constructor(){this.timeout=this.succeeded=this.crash=!1;this.LK=null}}Object(D.a)(m,"OutputState",null,[]);class w{constructor(){this.Ndi=this.HAe=this.LDd=!1;this.Qa=this.Fig=this.N8b=this.DHg=this.BTb=this.hWa=this.NF=this.IAb=this.XEc=this.uLg=this.bEk=this.Jl=this.Gxf=this.Hp=this.Lw=this.pj=this.REe=this.$$d=this.sKa=null}}Object(D.a)(w,"RuntimeState",null,[]);b.d(P,"a",function(){return z});class z{constructor(){this.input=new n;this.runtime=new w;
this.output=new m;this.logger=new f.a(this)}}Object(D.a)(z,"MergeState",null,[])},1587:function(D,P,b){b.r(P);D=b(0);var f=b(531),c=b(184),n=b(126),m=b(212),w=b(1299),z=b(1412),v=b(1433),t=b(5),A=b(1580);class B{constructor(R,O){this.start=R;this.end=O}}Object(D.a)(B,"MergeDiffIdx",null,[]);class S{constructor(R,O,I,K=!1,Y=null,W=null,Z=!0){this.ANd=this.zNd=this.AYg=this.jWc=0;this.Llc=this.wKe=null;this.snb=Y||new A.a;this.qg=I;this.Xxa=R.d9();this.iNj=O.d9();this.ZR=new B(0,0);this.lW=new B(0,
0);this.JUe=K;this.ASc=Z;this.CQc=W;this.J7j();this.wym()}get QL(){return this.Xxa}get gL(){return this.iNj}get Cz(){return this.jWc}get qv(){return this.AYg}get sla(){return this.zNd}get Bfa(){return this.ANd}get $uk(){const R=new c.a;for(let O=this.wKe.start;O<this.wKe.end;O++)R.add(this.QL.Ye(O));return R}get Ryf(){const R=new c.a;for(let O=this.Llc.start;O<this.Llc.end;O++)R.add(this.gL.Ye(O));return R}Wzf(R){if(this.qv<R.qv){if(this.qv+this.sla>R.qv)return!0}else if(this.qv>R.qv){if(R.qv+R.sla>
this.qv)return!0}else if(2===this.Cz&&3===R.Cz||3===this.Cz&&2===R.Cz||2===this.Cz&&2===R.Cz||3===this.Cz&&3===R.Cz)return!0;return!1}tPi(R,O,I,K){R.hA(O);R.aw(O,I);return K+=I.length-1}S2i(R,O,I,K,Y){let W=this.QL.Ye(R),Z=this.gL.Ye(O);if(!W||!Z||!W.$jb&&!Z.$jb)return{returnValue:!1,MJa:K,GRa:Y};let U=new c.a,X=new c.a;W.$jb&&(U=W.wEd(),W=U.Ye(I?0:U.length-1));Z.$jb&&(X=Z.wEd(),Z=X.Ye(I?0:X.length-1));if(!W.zz(Z,this.snb,this.CQc,this.JUe,this.ASc))return{returnValue:!1,MJa:K,GRa:Y};U.length&&(K=
this.tPi(this.QL,R,U,K));X.length&&(Y=this.tPi(this.gL,O,X,Y));return{returnValue:!0,MJa:K,GRa:Y}}FFk(R,O,I,K,Y,W){for(;Y<=I&&W<=K;){const Z=R.Ye(Y),U=O.Ye(W);if(!Z.zz(U,this.snb,this.CQc,this.JUe,this.ASc))break;this.ZR.start+=Z.length;this.lW.start+=U.length;Y++;W++}return{bkf:Y,iMg:W}}DFk(R,O,I,K,Y,W){for(;Y>=I&&W>=K;){const Z=R.Ye(Y),U=O.Ye(W);if(!Z.zz(U,this.snb,this.CQc,this.JUe,this.ASc))return{returnValue:!0,MJa:Y,GRa:W};Y--;W--}return{returnValue:!1,MJa:Y,GRa:W}}EFk(R,O,I,K){let Y=!1;do({bkf:R,
iMg:O}=this.FFk(this.QL,this.gL,I,K,R,O)),{MJa:I,GRa:K,returnValue:Y}=this.S2i(R,O,!0,I,K);while(Y);return{bkf:R,iMg:O,MJa:I,GRa:K}}CFk(R,O,I,K){let Y=!1;do{if(!({MJa:I,GRa:K}=this.DFk(this.QL,this.gL,R,O,I,K)).returnValue)break;({MJa:I,GRa:K,returnValue:Y}=this.S2i(I,K,!1,I,K))}while(Y);return{MJa:I,GRa:K}}J7j(){var R=0,O=0,I=this.QL.length-1,K=this.gL.length-1;0<=I&&this.QL.Ye(I);0<=K&&this.gL.Ye(K);({bkf:R,iMg:O,MJa:I,GRa:K}=this.EFk(R,O,I,K));if(R<I||O<K)({MJa:I,GRa:K}=this.CFk(R,O,I,K));I++;
K++;this.wKe=new B(R,I);this.Llc=new B(O,K);this.ZR.end=this.ZR.start;this.lW.end=this.lW.start;for(var Y=R;Y<I;Y++){var W=this.QL.Ye(Y);this.ZR.end+=W.length}for(Y=O;Y<K;Y++)W=this.gL.Ye(Y),this.lW.end+=W.length;n.a.instance.ya(3993809,1,3,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",R,I,O,K);n.a.instance.ya(3993810,1,3,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.ZR.start,this.ZR.end,this.lW.start,this.lW.end);this.ZR.start<=this.ZR.end&&this.lW.start<=this.lW.end&&(R=this.QL.Ye(R),O=this.gL.Ye(O),Y=this.QL.Ye(I),W=this.gL.Ye(K),I=this.QL.Ye(I-1),K=this.gL.Ye(K-1),n.a.instance.ya(3993811,1,3,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",R,Y,O,W,I,K))}wym(){this.AYg=this.ZR.start;this.zNd=this.ANd=0;this.ZR.start===this.ZR.end&&this.lW.start===
this.lW.end?this.jWc=0:this.ZR.start===this.ZR.end&&this.lW.start<this.lW.end?(this.jWc=1,this.ANd=this.lW.end-this.lW.start):this.lW.start===this.lW.end&&this.ZR.start<this.ZR.end?(this.jWc=2,this.zNd=this.ZR.end-this.ZR.start):(this.jWc=3,this.zNd=this.ZR.end-this.ZR.start,this.ANd=this.lW.end-this.lW.start);n.a.instance.ya(3993814,1,3,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Cz,this.qv,this.sla,this.Bfa)}tul(R,O){return R.X7()&&
O.X7()?R.runId===O.runId&&R.We===O.We:!1}lyl(R){if(!R.X7()||"\ufffc"!==R.text)return!1;R=R.uXb;return R?R.hasProperty(t.a.Yj)||R.hasProperty(t.a.irb)||R.hasProperty(t.a.xAf)||R.hasProperty(t.a.EQ)||R.hasProperty(t.a.A7)||R.hasProperty(t.a.Uma)||R.hasProperty(t.a.ifb)||R.hasProperty(t.a.pq)&&(R=this.qg.getPropertyInt32(R,t.a.pq))&&(36===R||35===R||24===R||23===R||33===R||34===R||44===R||45===R||42===R||43===R)?!0:!1:!1}Vnd(R){return R.X7()&&!this.lyl(R)}U8j(){if(2===this.Cz)return!1;var R=this.Llc.start;
if(!R)return!1;let O=null;for(var I=this.Llc.start;I<this.Llc.end;I++){const K=this.gL.Ye(I);if(this.Vnd(K)){O=K;break}}if(!O)return!1;--R;for(I=this.gL.Ye(R);I&&!this.Vnd(I);)R--,I=this.gL.Ye(R);return I&&this.tul(I,O)?!0:!1}S_h(R){const O=new c.a;for(let I=0;I<R.length;I++)R.J(I).$jb?O.aw(O.length,R.J(I).wEd()):O.insert(O.length,R.J(I));return O}vul(){if(3!==this.Cz||this.sla!==this.Bfa)return!1;const R=this.S_h(this.$uk),O=this.S_h(this.Ryf);if(R.length!==O.length)return!1;for(let I=0;I<R.length;I++)if(!R.J(I).zz(O.J(I),
this.snb,this.CQc,!0,this.ASc))return!1;return!0}uul(){if(this.Cz&&3!==this.Cz||this.QL.length!==this.gL.length)return!1;let R=!1;for(let O=0;O<this.QL.length;O++){if(!this.QL.J(O).zz(this.gL.J(O),this.snb,this.CQc,!0,this.ASc))return!1;if(3===this.QL.J(O).type||1===this.QL.J(O).type){const I=this.QL.J(O),K=this.gL.J(O);R=I.runId!==K.runId||I.We!==K.We||R}}return R}}Object(D.a)(S,"MergeBlockDiff",null,[]);var C=b(1243);class H{constructor(R,O){this.id=R;this.index=O}}Object(D.a)(H,"ParagraphStartIndex",
null,[]);var J=b(1310),M=b(1217);b.d(P,"ParagraphMerge",function(){return G});class G{constructor(R,O,I,K,Y,W){this.mkc=this.vNb=this.Fm=this.Lt=null;this.oe=!1;this.Ykh=this.z_g=this.RTg=this.Pza=this.jTa=this.Xxa=null;this.Tc=R;this.fD=O;this.Oza=K;this.uya=I;this.IV=Y;this.hWd=this.IV(111);this.qg=W}J4h(R){const O=new f.a;R.QL.forEach(I=>{2===I.type&&O.add(I.ij);return!0});R.gL.forEach(I=>{2===I.type&&O.remove(I.ij);return!0});return O}T1h(R){const O=new c.a;R.gL.forEach(I=>{2===I.type&&O.add(I.ij);
return!0});return O}LEh(R){const O=new c.a;let I=0,K=0;R.gL.forEach(Y=>{2===Y.type&&(O.add(new H(Y.ij,I<R.qv?I:I<R.qv+R.Bfa?R.qv:I-R.Bfa+R.sla)),I=K);K+=Y.length;return!0});return O}qgk(R,O){var I=this.LEh(R);const K=this.LEh(O);R=this.J4h(R);const Y=this.J4h(O);O=new c.a;const W=new f.a;let Z=0;for(let U=0;U<I.length;U++){const X=I.J(U);if(Z<K.length){let fa=K.J(Z);for(;Z<K.length&&fa.index<=X.index;){if(fa.id.equals(X.id)){Z++;break}R.contains(fa.id)||W.contains(fa.id)||(O.add(fa.id),W.add(fa.id));
Z++;fa=K.J(Z)}}Y.contains(X.id)||(O.add(X.id),W.add(X.id))}for(;Z<K.length;)I=K.J(Z),R.contains(I.id)||W.contains(I.id)||(O.add(I.id),W.add(I.id)),Z++;return O}initialize(){if(this.oe){const R=!!this.Lt&&!!this.Fm;this.Tc.logger.wf(Object.assign(new C.a,{Qh:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return R}this.oe=!0;if(!({QL:this.Xxa,idd:this.jTa,jHd:this.Pza,X2d:this.RTg,aae:this.z_g,SEe:this.Ykh}=M.a.tIh(this.Tc,this.qg,this.fD,this.uya,this.Oza,this.IV,!1,!1)).returnValue)return!1;
this.Lt=new S(this.Xxa,this.jTa,this.qg,void 0,void 0,this.IV);this.Fm=new S(this.Xxa,this.Pza,this.qg,void 0,void 0,this.IV);n.a.instance.ya(593272919,1,3,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Lt.sla,this.Lt.Bfa,this.Fm.sla,this.Fm.Bfa));return!0}m2a(){n.a.instance.ya(593826836,1,3,"Attempting to merge with LCS");let R=!1;const O=this.Tc.runtime.Qa.isFeatureEnabled(111),I=new v.a(this.qg,this.Tc);var K=null;let Y=
null;var W=null;const Z=X=>this.Tc.runtime.pj.J(X);K=X=>this.Tc.runtime.Lw.J(X)||this.Tc.runtime.pj.J(X);const U=X=>this.Tc.runtime.Hp.J(X)||this.Tc.runtime.pj.J(X);O?(this.Lt=new S(this.Xxa,this.jTa,this.qg,void 0,void 0,this.IV,!1),this.Fm=new S(this.Xxa,this.Pza,this.qg,void 0,void 0,this.IV,!1),({updateHints:K}=I.qJh(this.fD,Z,this.uya,K,this.Lt.qv,this.Lt.qv+this.Lt.sla,this.Lt.qv+this.Lt.Bfa)).returnValue&&({updateHints:Y}=I.qJh(this.fD,Z,this.Oza,U,this.Fm.qv,this.Fm.qv+this.Fm.sla,this.Fm.qv+
this.Fm.Bfa)).returnValue&&(R=!0)):({updateHints:K}=I.pJh(this.fD,Z,this.uya,K,this.Lt.qv,this.Lt.qv+this.Lt.sla,this.Lt.qv+this.Lt.Bfa)).returnValue&&({updateHints:Y}=I.pJh(this.fD,Z,this.Oza,U,this.Fm.qv,this.Fm.qv+this.Fm.sla,this.Fm.qv+this.Fm.Bfa)).returnValue&&(R=!0);R||(n.a.instance.ya(593826835,1,2,"Failed to create update hints with LCS"),R=!1);R&&(W=new J.a(this.Tc,this.fD,this.uya,this.Oza,X=>this.Tc.runtime.Qa?this.Tc.runtime.Qa.isFeatureEnabled(X):!1,this.qg,null,K,Y),({Jl:W}=W.VGc()).returnValue||
(n.a.instance.ya(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.Tc.logger.wf(Object.assign(new C.a,{Qh:"TryLCSMerge",eventId:"9zrqs"})),R=!1));n.a.instance.ya(593826833,1,R?3:2,"TryLCSMerge: [Success: {0}]",R);return{returnValue:R,Jl:W}}VGc(){let R;R=null;if(!this.initialize())return this.Tc.logger.nM("ParagraphMerge Initialize"),this.Vzb(),{returnValue:!1,Jl:R};this.Tc.logger.nM("ParagraphMerge Initialize");this.Tc.runtime.Qa.eo(111);let O;this.Tc.logger.Dze(2);let I=({m2a:O}=
this.cxk()).returnValue;this.hWd&&(I=I&&({Jl:R,m2a:O}=this.phd(this.Tc,this.qg,this.IV,this.mkc,this.vNb)).returnValue);this.Tc.logger.Szg();if(!I){this.Tc.logger.nM("ParagraphMerge DoMergeInteral");if(O){this.Tc.logger.Dze(3);({Jl:R,returnValue:I}=this.m2a());this.Tc.logger.Szg();if(I)return{returnValue:!0,Jl:R};this.Vzb();return{returnValue:!1,Jl:R}}this.Vzb();return{returnValue:!1,Jl:R}}if(!this.hWd)return this.phd(this.Tc,this.qg,this.IV,this.mkc,this.vNb);this.Tc.logger.nM("ParagraphMerge DoMergeInteral");
return{returnValue:!0,Jl:R}}phd(){let R;if(!({ate:R}=M.a.phd(this.Tc,this.qg,this.IV,this.mkc,this.vNb)).returnValue)return this.Tc.logger.nM("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.Vzb(),{returnValue:!1,Jl:R,m2a:!0};this.Tc.logger.nM("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Jl:R,m2a:!1}}Vzb(R=!1){n.a.instance.Joa(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+R+"] BaseRevisionMergeBlocksList: {0}",this.RTg);n.a.instance.Joa(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.z_g);n.a.instance.Joa(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.Ykh);R=new c.a;M.a.Bxc(this.qg,"BaseObjects_",this.fD,R);M.a.Bxc(this.qg,"FavoredObjects_",this.uya,R);M.a.Bxc(this.qg,"ConflictObjects_",this.Oza,R);M.a.lFl(this.Tc,R)}azh(R){let O,I;I=O=0;if(!this.Lt.Cz)O=this.Fm.qv;else if(1===this.Lt.Cz)O=this.Fm.qv<this.Lt.qv?this.Fm.qv:this.Fm.qv===this.Lt.qv?R||1!==this.Fm.Cz?this.Fm.qv+this.Lt.Bfa:this.Fm.qv:this.Fm.qv+this.Lt.Bfa;else if(2===this.Lt.Cz||3===this.Lt.Cz)O=this.Fm.qv<=
this.Lt.qv?this.Fm.qv:this.Fm.qv+(this.Lt.Bfa-this.Lt.sla);if(2===this.Fm.Cz||3===this.Fm.Cz)I=O+this.Fm.sla;return{e9h:O,Ral:I}}$Sh(R,O){let I;I=0;if(!O)return{returnValue:!0,ntd:I};let K=0,Y=0;for(;K<R.length;){let W;for(let Z=K;Z<R.length;Z++){K=Z;W=R.J(Z);const U=W.length;Y+=U;if(!(Y<O)){if(Y>O)if(W.$jb)R.hA(K),R.aw(K,W.wEd()),Y-=U;else return n.a.instance.ya(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
O),this.Tc.logger.wf(Object.assign(new C.a,{Qh:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,ntd:I};break}}if(Y===O)return K++,I=K,{returnValue:!0,ntd:I}}n.a.instance.ya(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",O);this.Tc.logger.wf(Object.assign(new C.a,{Qh:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,ntd:I}}m_j(R,O,I){let K=0;var Y=0,W=!1;const Z=this.Fm.Ryf.d9();
if(this.Fm.U8j())for(--O;0<=O;O--){let U=R.J(O);if(this.Fm.Vnd(U)){Y=R.J(O);K=Y.runId;Y=Y.We;W=!0;break}}W||((Y=R.J(I))&&this.Fm.Vnd(Y)?(K=Y.runId,Y=Y.We):Y=K=0);for(R=0;R<Z.length;R++)I=Z.J(R),I.X7()&&(W=I,this.Fm.Vnd(I)?(W.runId=K,W.We=Y):(W.runId=0,W.We=0));return Z}bki(R){if(2===R.length){const O=1===R.J(0).type?R.J(0):null;R=2===R.J(1).type;if(O&&R&&""===O.text)return!0}return!1}cxk(){const R=this.Lt.uul();if(!R&&!this.Lt.Cz)return this.mkc=this.Fm.gL.d9(),this.vNb=this.T1h(this.Fm),{returnValue:!0,
m2a:!1};if(!this.Fm.Cz)return this.mkc=this.Lt.gL.d9(),this.vNb=this.T1h(this.Lt),{returnValue:!0,m2a:!1};(this.bki(this.Lt.gL)||this.bki(this.Fm.gL))&&this.Tc.logger.eri(Object.assign(new C.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!R){var O=this.Lt.Wzf(this.Fm);O&&this.IV(92)&&(n.a.instance.ya(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Lt=new S(this.Xxa,this.jTa,this.qg,!0,void 0,this.IV),this.Fm=
new S(this.Xxa,this.Pza,this.qg,!0,void 0,this.IV),O=this.Lt.Wzf(this.Fm));if(O)return n.a.instance.ya(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Tc.logger.wf(Object.assign(new z.a,{Qh:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,m2a:!0}}var I;O=0;this.vNb=this.qgk(this.Lt,this.Fm);({e9h:I,Ral:Y}=this.azh(!1));const K=this.Lt.gL.d9();if(!({ntd:I}=this.$Sh(K,I)).returnValue||(2===this.Fm.Cz||3===this.Fm.Cz)&&!({ntd:O}=
this.$Sh(K,Y)).returnValue)return{returnValue:!1,m2a:!1};if(2===this.Fm.Cz||3===this.Fm.Cz){this.zDc(K,O);this.zDc(K,I-1);var Y=null;for(var W=O-1;W>=I;W--)2===K.J(W).type&&(Y=K.J(W)),K.hA(W);0<K.length&&(W=K.J(K.length-1),2!==W.type&&4!==W.type&&Y&&(this.Tc.runtime.Qa.eo(127),this.Tc.runtime.Qa.isFeatureEnabled(127)&&(K.add(Y),this.vNb.add(Y.ij))));n.a.instance.ya(4019726,1,3,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",O-I-1,I)}if(1===this.Fm.Cz||3===this.Fm.Cz)Y=this.Fm.Ryf,
R&&(Y=this.m_j(K,I,O)),this.zDc(K,I-1),this.zDc(K,I),this.zDc(Y,0),this.zDc(Y,Y.length-1),K.aw(I,Y),n.a.instance.ya(4019727,1,3,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",I,R,Y.So());this.mkc=K;return{returnValue:!0,m2a:!1}}zDc(R,O){0>O||O>=R.length||(R=R.J(O),Object(m.a)(w.a,R)&&(R.fZa=!0))}CHd(R,O){let I;I=O;if(!this.initialize())return{returnValue:!1,rib:R,pwa:I};if(this.Fm.Wzf(this.Lt))return this.Vzb(!0),this.Tc.logger.wf(Object.assign(new z.a,
{Qh:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,rib:R,pwa:I};if(!this.Fm.Cz||3===this.Fm.Cz&&this.Fm.vul())return{returnValue:!0,rib:R,pwa:O};let K;({e9h:K}=this.azh(!0));O<K||O===K&&(1!==this.Fm.Cz||1===this.Fm.Cz&&1===this.Lt.Cz&&O===this.Lt.qv+this.Lt.Bfa)?I=O:(I=O+this.Fm.Bfa-this.Fm.sla,I<K&&(I=K));return{returnValue:!0,rib:R,pwa:I}}}Object(D.a)(G,"ParagraphMerge",null,[1314])},1588:function(D,P,b){b.r(P);D=b(0);var f=b(1319),c=b(1211),n=b(1193),m=b(1419),w=b(1210);class z{constructor(H=
"",J="",M="",G=-99999,R=-1,O=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=H?H:"";this.Description=J?J:"";this.Type=M?M:"";this.Score=G;this.Age=R;this.Count=O}}Object(D.a)(z,"Suggestion",null,[]);class v{constructor(H,J){this.GroupType=this.Suggestions=null;this.Suggestions=H;this.GroupType=J}}Object(D.a)(v,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.rum="servicecommands";Object(D.a)(t,"SuggestionGroupType",
null,[]);var A=b(1126),B=b(2),S=b(30);b.d(P,"InteractionLogger",function(){return C});class C{constructor(H,J,M){this.dQe=0;this.daf=this.QUc=null;this.Pb=H;this.v9e=this.qNe=this.cVe=!1;this.Xqj=J;this.Re=B.AFrameworkApplication.je;this.sc=M;this.cNd=this.L3e=0}get pDa(){return this.Pb.pDa}Rze(H){this.Pb.Rze(H)}Xri(){if(this.QUc){var H=0;for(const J of this.QUc)this.Pb.HGl(J,H++);this.QUc=null}}beginQuery(H,J,M){this.Pb.BGl(H,J,M)}$Ab(H,J){this.Pb.V1j(H,J);this.cVe=!0;this.v9e=!1}ZCa(){this.cVe=
!1;this.qNe||(this.Xri(),this.Pb.APh(this.dQe))}CGl(H,J){this.Pb.DGl(H,J)}wSl(H,J,M,G,R){for(const O of this.Xqj)if(H.startsWith(O)){this.v9e=!0;break}this.Pb.WEl(H,J,M,G,R)}VSl(H){this.qNe=!1;this.dQe=H;this.cVe||this.v9e||(this.Xri(),this.Pb.APh(this.dQe,!1))}USl(H,J){this.Pb.ZEl(H,J);this.qNe=!0}HVh(H,J){if(!H.count)return"";let M="";const G=Date.now();for(let R of H)H=(G-R.timeStamp)/1E3,H=A.a.gKg(H),0<M.length&&(M+=";"),M+=J?R.commandId:R.controlId,M+=":",M+=H.toString();return M}Egb(){var H=
this.HVh(f.a.instance.Afd(),!1);0<H.length&&this.Pb.VEl(H);H=this.HVh(f.a.instance.Grc(),!0);0<H.length&&this.Pb.JEl(H)}QGl(H){this.Pb.PEl(H)}Mba(H,J,M,G,R,O,I,K=null){this.Pb.YFl(H,J,M,G,R,O,I,K)}$G(H,J,M=null){this.Pb.grd(H,J,M)}onError(H,J,M=null){this.Pb.Kfb(H,J,M)}Zxm(H){this.QUc=H}f7k(H,J=!1){const M=[];if(!H)return M;for(let G=0;G<H.length;G++){const R=n.a[H[G].groupType].toLowerCase(),O=[],I=H[G].results;if(I){for(let K=0;K<I.length;K++)"findindocument"!==R||""===this.sc.dPf&&!J?Array.add(O,
new z(I[K].label,I[K].description,R,I[K].score,I[K].H1d,I[K].count)):Array.add(O,new z("","",R,I[K].score,I[K].H1d,I[K].count));"answer"===R||"definition"===R||"wolframanswer"===R||"entity"===R?Array.add(M,new v(O,t.answer)):"classifier"===R||"appsforoffice"===R?Array.add(M,new v(O,t.commands)):"serviceclassifier"===R?Array.add(M,new v(O,t.rum)):"assistance"===R?Array.add(M,new v(O,t.help)):("document"===R||"people"===R||"findindocument"===R||"notes"===R||"image"===R)&&Array.add(M,new v(O,R))}}return M}i6h(H,
J,M=!1){const G={};G.Query=J;G.SuggestionGroups=S.c(this.f7k(H,M));return S.c(G)}Z6h(H){const J={"Content-Type":"application/json",Accept:"application/json"};J["X-Office-Version"]=B.AFrameworkApplication.buildVersion;J["X-Office-Application"]=B.AFrameworkApplication.K.Oa("Application");J["X-Office-Platform"]="WAC";J["X-TellMe-SqmUserId"]=B.AFrameworkApplication.K.Oa("LoggableUserId")||"";J["X-TellMe-SessionId"]=this.Pb.pDa.Ema;J["X-TellMe-SuggestionTypes"]="Ranker";J["X-TellMe-Culture"]=B.AFrameworkApplication.uiCulture;
J["X-TellMe-ProcessSessionId"]=B.AFrameworkApplication.userSessionId;J["X-TellMe-Flights"]=H;J["X-TellMe-PartialQueryIndex"]=this.L3e;return J}d7b(H,J,M){this.Mba(J.length,"RankerLogging",H.data.mf.toString(),Math.round(window.performance.now()-M),w.a.$5i,!0,c.a.rYa)}M6b(H,J,M){this.Mba(J.length,"RankerLogging",H.data.mf.toString(),Math.round(window.performance.now()-M),w.a.$5i,!1,c.a.rYa)}$6h(){this.daf||(this.daf=new m.a(this.sc,null,6E3));return this.daf.O9}j8f(H){const J=this.i6h(this.QUc,H,!0),
M=this.Z6h("RankerLogging"),G=window.performance.now();this.Re.Ki(this.$6h(),2,J,M,!1,0,R=>{this.d7b(R,H,G)},R=>{this.M6b(R,H,G)},null,null,!1,4E3,6E3);this.L3e++}Gnm(){this.L3e=0}Iyg(H){this.cNd=H}}Object(D.a)(C,"InteractionLogger",null,[])},1591:function(D,P,b){b.r(P);D=b(0);var f=b(18),c=b(5),n=b(126),m=b(184),w=b(52),z=b(1402),v=b(1298),t=b(1241),A=b(1217);class B{constructor(J,M,G=null){this.author=J;this.rsd=M;this.plg=G||w.a.nil}zz(J){return J?this.author===J.author&&this.rsd===J.rsd&&this.plg===
J.plg:!1}}Object(D.a)(B,"RunMergeBlockTrackedChangeAttribute",null,[]);class S{constructor(J,M,G){this.insertion=J||S.ZAf;this.deletion=M||S.ZAf;this.yPa=G||S.ZAf}get Rel(){return 0<this.insertion.author.length}get Bel(){return 0<this.deletion.author.length}get hfl(){return 0<this.yPa.author.length}zz(J){return J?this.insertion.zz(J.insertion)&&this.deletion.zz(J.deletion)&&this.yPa.zz(J.yPa):!1}}S.ZAf=new B("",0);Object(D.a)(S,"RunMergeBlockTrackedChangeInfo",null,[]);var C=b(1453);b.d(P,"ParagraphMergeBlockCreator",
function(){return H});class H extends v.a{constructor(J,M,G,R,O,I,K){super();this.maxValue=Number.MAX_VALUE;this.YA=new z.a;this.afc=null;this.OP=0;this.J4g=!1;this.iWc="";this.xJe=J;this.$r=M;this.kv=G;this.iKj=R;this.$Od=O;this.e4g=I;this.qg=K;if(this.qg.hasProperty(this.$r,f.a.Zk))if(this.qg.hasProperty(this.$r,c.a.yb))if(this.qg.hasProperty(this.$r,c.a.zm))if(this.qg.hasProperty(this.$r,c.a.Ao))if(this.qg.hasProperty(this.$r,f.a.DA))if(this.M5=this.qg.getPropertyString(this.$r,f.a.Zk),this.mC=
this.qg.getPropertyUint32(this.$r,c.a.yb),this.zr=this.qg.getPropertyUint32s(this.$r,c.a.zm),this.JUd=this.qg.getPropertyUint32s(this.$r,c.a.Ao),this.lSe=this.qg.getPropertyObjectIds(this.$r,f.a.DA),this.M5||""===this.M5)if(this.M5.length||1!==this.lSe.length||(this.zr.length||(this.zr.add(0),n.a.instance.ya(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.JUd.length||(this.JUd.add(0),n.a.instance.ya(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.wCj=this.Vbe(this.$r,c.a.ccg,this.zr.length),this.CYc=this.Vbe(this.$r,f.a.pR,this.zr.length),this.nra=this.Vbe(this.$r,f.a.XDa,this.zr.length),this.bqa=this.Vbe(this.$r,c.a.ZT,this.zr.length),this.Vqa=this.t9k(this.$r,c.a.xR,this.zr.length),this.Bjl(),J=this.qg.hasProperty(this.$r,f.a.WB)?this.qg.getPropertyUint32s(this.$r,f.a.WB):new m.a,this.eXd=A.a.XXi(J,this.M5.length),this.zr.length!==this.JUd.length)n.a.instance.ya(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
M.id);else if(this.zr.length!==this.lSe.length)n.a.instance.ya(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",M.id);else{this.e4g&&(this.qg.hasProperty(this.$r,c.a.gs)?this.afc=this.qg.getPropertyObjectIds(this.$r,c.a.gs):(n.a.instance.ya(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",M.id),this.afc=this.u2(this.zr.length,w.a.nil)),this.zr.length!==this.afc.length&&(n.a.instance.ya(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
M.id,this.zr.length,this.afc.length),this.afc=this.u2(this.zr.length,w.a.nil)));if(this.zr.length!==this.CYc.length||this.zr.length!==this.nra.length||this.zr.length!==this.bqa.length||this.zr.length!==this.Vqa.length)this.zr.length===this.CYc.length||this.$Od||n.a.instance.ya(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",M.id,this.zr.length,this.CYc.length),this.zr.length===this.nra.length||
this.$Od||n.a.instance.ya(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",M.id,this.zr.length,this.nra.length),this.zr.length===this.bqa.length||this.$Od||n.a.instance.ya(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",M.id,this.zr.length,this.bqa.length),this.zr.length===this.Vqa.length||
this.$Od||n.a.instance.ya(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",M.id,this.zr.length,this.Vqa.length),J=this.qg.getPropertyBool(this.$r,f.a.Orf),n.a.instance.ya(17877020,1,3,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",M.id,O,null==J?!1:J),this.CYc=this.u2(this.zr.length,!0),this.nra=this.u2(this.zr.length,!1),this.bqa=this.u2(this.zr.length,
!1),this.Vqa=this.u2(this.zr.length,0),this.qg.setPropertyBool(this.$r,f.a.Orf,!1);this.YA.w1m(this.zr.length)?(this.eXd.length!==this.zr.length+1&&n.a.instance.ya(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",M.id,this.zr.length,this.eXd.length),this.Hzj=!0):n.a.instance.ya(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",M.id)}else n.a.instance.ya(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",M.id);else n.a.instance.ya(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",M.id);else n.a.instance.ya(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",M.id);else n.a.instance.ya(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",M.id);else n.a.instance.ya(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",M.id);else n.a.instance.ya(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",M.id)}Bjl(){this.qg.hasProperty(this.$r,c.a.HYa)?this.YA.lxb=this.qg.getPropertyBools(this.$r,c.a.HYa):this.YA.lxb=this.u2(this.zr.length,!1);this.qg.hasProperty(this.$r,c.a.KAa)?this.YA.Ssb=this.qg.getPropertyBools(this.$r,c.a.KAa):this.YA.Ssb=this.u2(this.zr.length,!1);this.qg.hasProperty(this.$r,c.a.IYa)?this.YA.kxb=this.qg.getPropertyStrings(this.$r,c.a.IYa):this.YA.kxb=this.u2(this.zr.length,"");this.qg.hasProperty(this.$r,
c.a.LWa)?this.YA.Psb=this.qg.getPropertyStrings(this.$r,c.a.LWa):this.YA.Psb=this.u2(this.zr.length,"");this.qg.hasProperty(this.$r,c.a.JYa)?this.YA.mxb=this.qg.getPropertyListOfMilliseconds(this.$r,c.a.JYa):this.YA.mxb=this.u2(this.zr.length,0);this.qg.hasProperty(this.$r,c.a.MWa)?this.YA.Jab=this.qg.getPropertyListOfMilliseconds(this.$r,c.a.MWa):this.YA.Jab=this.u2(this.zr.length,0);this.qg.hasProperty(this.$r,c.a.N_a)?this.YA.uhb=this.qg.getPropertyBools(this.$r,c.a.N_a):this.YA.uhb=this.u2(this.zr.length,
!1);this.qg.hasProperty(this.$r,c.a.j2a)?this.YA.QBb=this.qg.getPropertyStrings(this.$r,c.a.j2a):this.YA.QBb=this.u2(this.zr.length,"");this.qg.hasProperty(this.$r,c.a.k2a)?this.YA.SBb=this.qg.getPropertyListOfMilliseconds(this.$r,c.a.k2a):this.YA.SBb=this.u2(this.zr.length,0);this.qg.hasProperty(this.$r,c.a.rRa)?this.YA.RBb=this.qg.getPropertyObjectIds(this.$r,c.a.rRa):this.YA.RBb=this.u2(this.zr.length,w.a.nil)}Vbe(J,M,G){return this.qg.hasProperty(J,M)?this.qg.getPropertyBools(J,M):this.u2(G,!1)}t9k(J,
M,G){return this.qg.hasProperty(J,M)?this.qg.getPropertyUint32s(J,M):this.u2(G,0)}u2(J,M){const G=new m.a;for(let R=0;R<J;R++)G.add(M);return G}k8k(J){const M=this.eXd.Ye(J);J=this.eXd.Ye(J+1);return this.M5.substring(M,J)}a2h(){if(this.J4g)return null;var J=this.OP<this.zr.length?this.zr.Ye(this.OP):this.maxValue;if(J===this.maxValue||this.iKj&&!this.M5.length)return this.J4g=!0,J=new t.a(this.kv,this.$r.id,this.mC),this.iWc=this.Qhf(this.iWc,J.toString()),J;const M=this.JUd.Ye(this.OP),G=this.lSe.Ye(this.OP),
R=this.wCj.Ye(this.OP),O=this.CYc.Ye(this.OP),I=this.nra.Ye(this.OP),K=this.bqa.Ye(this.OP),Y=this.Vqa.Ye(this.OP),W=this.e4g?this.afc.Ye(this.OP):null;var Z=null;this.YA.lxb.Ye(this.OP)&&(Z=new B(this.YA.kxb.Ye(this.OP)||"",this.YA.mxb.Ye(this.OP)));var U=null;this.YA.Ssb.Ye(this.OP)&&(U=new B(this.YA.Psb.Ye(this.OP)||"",this.YA.Jab.Ye(this.OP)));var X=null;this.YA.uhb.Ye(this.OP)&&(X=new B(this.YA.QBb.Ye(this.OP)||"",this.YA.SBb.Ye(this.OP),this.YA.RBb.Ye(this.OP)));Z=new S(Z,U,X);U=this.k8k(this.OP);
this.OP++;X=U.startsWith("\ufddfHYPERLINK ");J=new C.a(this.xJe,this.kv,this.$r.id,M,J,G,U,R,!X,O,I,K,Y,Z,W);this.iWc=this.Qhf(this.iWc,J.toString());return J}R1h(){let J;J=null;var M="";if(!this.Hzj)return{hag:J,bgb:M};if(M=this.a2h())J=new m.a,J.add(M);for(;M=this.a2h();)J.add(M);M=this.iWc;return{hag:J,bgb:M}}}Object(D.a)(H,"ParagraphMergeBlockCreator",v.a,[])},1595:function(D,P,b){b.r(P);D=b(0);var f=b(184),c=b(1298),n=b(1240);class m extends n.a{constructor(z,v){super(4,z,v)}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.ij)}Mrc(){return"Table"}clone(){return new m(this.source,this.ij)}zz(z,v,t,A=!1){return super.zz(z,v,t,A)?this.ij.equals(z.ij):!1}get length(){return 1}}Object(D.a)(m,"TableMergeBlock",n.a,[]);b.d(P,"TableMergeBlockCreator",function(){return w});class w extends c.a{constructor(z,v){super();this.UTg=new m(v,z.id)}R1h(){let z;z=new f.a;z.add(this.UTg);return{hag:z,bgb:this.Qhf("",this.UTg.toString())}}}Object(D.a)(w,"TableMergeBlockCreator",c.a,[])},1664:function(D,P,b){b.r(P);
var f=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},c=b(0),n=b(42),m=b(59);class w extends Sys.EventArgs{constructor(Q,sa){super();this.DDe=Q;this.actualValue=sa}}Object(c.a)(w,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,
[]);var z=b(31);class v{constructor(){this.vfc=[];this.VWg=this.HNe=0;this.Sd=null;this.la=new m.a}init(Q,sa,db){this.Sd=Q;this.HNe=sa;this.VWg=db;this.Sd.i1d(Object(n.a)(this,this.H6b,"onCpuMeterFrameAvailable"));this.xUj(Object(n.a)(this,this.yjk,"cpuPercentThresholdExceeded"))}H6b(Q,sa){sa.ctd&&(Array.enqueue(this.vfc,sa.ctd.CP),this.vfc.length>this.VWg&&(Array.dequeue(this.vfc),this.dak()))}dak(){var Q=this.vfc.length;let sa=0;for(let db=0;db<Q;db++){const Gb=Array.dequeue(this.vfc);sa+=Gb;Array.enqueue(this.vfc,
Gb)}Q=sa/Q;Q>this.HNe&&this.la.raiseEvent("CPTTE",new w(this.HNe,Q))}yjk(Q,sa){z.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.f7d(sa.DDe,sa.actualValue))}xUj(Q){this.la.addHandler("CPTTE",Q)}f7d(Q,sa){const db={};db.ThresholdValue=Q;db.ActualValue=sa;return db}}Object(c.a)(v,"CpuMeterMonitor",null,[1125]);var t=b(364);class A{constructor(){this.S=this.T=this.M=this.C=0}}Object(c.a)(A,"ProfileInformation",null,[]);var B=b(7),S=b(22),C=b(169),H=b(65);class J{constructor(Q=
0,sa=0){this.zKb=!1;this.FJb={};this.USd=Q;this.jTd=sa;this.Rbf=0;S.a.addHandler(window.self,B.a.Drh,()=>{this.zKb=!0});S.a.addHandler(window.self,B.a.Erh,()=>{this.zKb=!1})}Grh(Q,sa,db){const Gb=J.generateKey(sa,db);Gb in this.FJb?sa=this.FJb[Gb]:(sa=new A,sa.S=db?1:0,this.FJb[Gb]=sa,this.Rbf++);sa.C++;sa.M=Q>sa.M?Q:sa.M;sa.T+=Q}Sra(Q,sa){this.Grh(Q,sa,!1);this.zKb&&this.Grh(Q,sa,!0)}getData(){if(0<this.jTd&&this.Rbf>this.jTd)return this.GRk();const Q=0<this.USd,sa={},db=this.FJb;for(let Xb in db){var Gb=
Xb;const Xc=db[Xb];this.cSi(Xc);Q&&Xc.T>=this.USd&&(sa[Gb]=Xc)}return Q?H.a.Wd(sa)?null:sa:this.FJb}GRk(){var Q=0<this.USd,sa=[];const db=this.FJb;for(let Gb in db){const Xb={key:Gb,value:db[Gb]};let Xc=Xb.value;(!Q||Xc.T>=this.USd)&&Array.add(sa,Xb)}if(sa.length>this.jTd)sa.sort((Gb,Xb)=>Xb.value.T-Gb.value.T),sa=sa.slice(0,this.jTd);else if(!sa.length)return null;Q={};for(const Gb of sa)sa=Gb.value,this.cSi(sa),Q[Gb.key]=sa;return Q}cSi(Q){Q.M=C.a.DR(Q.M,0);Q.T=C.a.DR(Q.T,0)}reset(){this.FJb={};
this.Rbf=0}static generateKey(Q,sa){return sa?Q+" [it]":Q}}Object(c.a)(J,"FunctionCallAggregator",null,[984]);var M=b(2),G=b(981);class R{}Object(c.a)(R,"CpuMeterFrame",null,[]);class O extends Sys.EventArgs{constructor(Q){super();this.ctd=Q}}Object(c.a)(O,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class I{}Object(c.a)(I,"MiniTaskItemInfo",null,[]);class K{}Object(c.a)(K,"TaskItemInfo",null,[]);var Y=b(1026),W=b(1051),Z=b(195);class U{constructor(Q,sa,db,Gb,Xb){this.gPb=0;this.N5=null;this.gXd=
this.yih=0;this.agh=!1;this.Igc=0;this.HTc=!1;this.Wda=null;this.HQd=0;this.S1e=new m.a;this.iZd=[];this.Xx=Q;this.P_e=sa;this.qSe=db;this.J8g=Gb;M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Hyb();this.Itj=Xb;this.rSe=new J(100);this.iBj=Y.a.kA(1,5,new W.a)}i1d(Q){this.S1e.addHandler("OnCpuMeterFrameAvailable",Q)}jsg(Q){this.S1e.removeHandler("OnCpuMeterFrameAvailable",Q)}R_a(Q,sa,db,Gb=null){db=Gb?Gb.priority:7;const Xb=this.Xx();this.start(sa,
db);try{Q()}finally{this.stop(sa,Gb),Q=this.Xx()-Xb,this.J8g.track(Q,sa)}}Cd(Q,sa){const db=this.Xx();try{Q()}finally{Q=this.Xx()-db,this.qSe.Sra(Q,sa),0<this.gPb&&this.rSe.Sra(Q,sa),this.J8g.track(Q,sa)}}Sgg(Q){const sa=new K;sa.TN=Q.m9f;sa.TP=Q.priority;this.uKi(1,sa)}Lxc(Q){this.HQd|=Q}start(Q,sa){if(!this.gPb){this.rSe.reset();const db=this.Cmi(Q);db&&this.Gne(1);this.N5=new K;this.N5.TN=Q;this.N5.TP=sa;this.N5.ST=(new Date).toISOString();this.N5.STS=C.a.DR(this.Xx(),2);db?this.N5.UI=1:this.Aul(Q)?
this.N5.UI=2:this.N5.UI=0}this.gPb++}Gne(Q){this.Igc|=Q}T4d(Q=!0,sa=0){this.Igc=Q?0:this.Igc&~sa}stop(Q,sa=null){let db;this.gPb--;0>=this.gPb&&this.N5&&(db=this.Xx()-this.N5.STS,this.gXd+=db,this.P_e.Sra(db,Q),this.Cmi(Q)&&this.T4d(!1,1),this.N5.TRT=C.a.DR(db,2),sa&&(this.N5.TQT=C.a.DR(sa.Y$l,2),this.N5.TDT=C.a.DR(sa.Cni,2)),this.Itj&&(this.uKi(0,this.N5),this.Dmm()),this.gPb=0);0<=Q.indexOf(G.a.YTm)&&this.Lxc(2);0<=Q.indexOf(G.a.zPi)&&this.Lxc(4);1===(this.Igc&1)&&this.Lxc(1);2===(this.Igc&2)&&
this.Lxc(8)}Dmm(){var Q=this.N5.TRT;if(750<Q){let db=this.rSe.getData();if(db){const Gb={};for(let Xb in db){var sa=db[Xb];const Xc=Xb;Xc.startsWith("SiOp_")||(Gb[Xc]=C.a.DR(100*sa.T/Q,2))}db=Gb}Q=Object.assign(new I,{T:Q,S:db});this.iBj.track(Q,this.N5.TN)}}eJm(){var Q=this.Xx()-this.yih,sa=C.a.DR(this.gXd/Q*100,2);Q=new R;Q.CP=sa;Q.II=this.HQd;sa=this.P_e.getData();H.a.count(sa)&&(Q.LRT=sa);sa=this.qSe.getData();H.a.count(sa)&&(Q.FP=sa);this.S1e.raiseEvent("OnCpuMeterFrameAvailable",new O(Q));this.m3i()}m3i(){this.P_e.reset();
this.qSe.reset();this.gXd=this.gPb=0;this.yih=this.Xx();this.HQd=0;this.N5=null}run(){this.agh?this.eJm():(this.m3i(),this.agh=!0);this.Wda?this.Wda(Object(n.a)(this,this.run,"run"),1E3):window.setTimeout(Object(n.a)(this,this.run,"run"),1E3)}A0d(Q,sa,db){const Gb=Array(2);Gb[0]=sa;Gb[1]=db;this.iZd[Q]||(this.iZd[Q]=[]);this.iZd[Q].push(Gb)}uKi(Q,sa){Q=this.iZd[Q];if(!Z.a.Wd(Q))for(let Gb=0;Gb<Q.length;Gb++){var db=Q[Gb];const Xb=db[0];db=db[1];Xb&&!Xb(sa)||db(sa)}}Hyb(){if(!this.HTc){const Q=window.setTimeout;
this.Wda=(sa,db)=>Q(sa,db);this.HTc=!0}}Cmi(Q){return Q.startsWith("key")||Q.startsWith("input")}Aul(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(c.a)(U,"CpuMeter",null,[143]);class X{constructor(Q){this.jOc=null;this.wq=new t.a;this.Xx=Q}initialize(Q,sa,db,Gb=!1){this.jOc||(this.jOc=new U(this.Xx,Q,sa,db,Gb),this.wq.Ue(this.jOc));return this.jOc}}Object(c.a)(X,"CpuMeterProvider",null,[1120]);var fa=b(145),ma=b(133);class ka{constructor(Q=1){this.Vv=[];this.vNd=
[];this.gh=Q}NFk(){let Q=0;for(let sa=0;sa<this.Vv.length;sa++)this.Vv[sa]<this.Vv[Q]&&(Q=sa);return Q}Sra(Q,sa){Q=C.a.DR(Q,2);if(this.Vv.length<this.gh)Array.add(this.Vv,Q),Array.add(this.vNd,sa);else{var db=this.NFk();Q>this.Vv[db]&&(this.Vv[db]=Q,this.vNd[db]=sa)}}getData(){return this.Vv.length?{["Vals"]:this.Vv,["Desc"]:this.vNd}:null}reset(){this.Vv=[];this.vNd=[]}}Object(c.a)(ka,"MaxDataAggregator",null,[984]);var oa=b(33),za=b(21);class Ja{get name(){return"Common.App.CpuMeter"}Mb(Q){Q.register(X,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").fa().hd(()=>new X(oa.a.Ze));Q.register(v,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").fa().hd(()=>new v)}init(){const Q=M.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const sa=za.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ma.a.instance.U1d.continueWith(()=>{Ja.$jl(Q,sa)})}}dispose(){}static $jl(Q,sa){const db=Y.a.kA(10,5,new J(Q.vb("TaskManagerLoggingThreshold",0),Q.vb("CpuMeterMaximumEntriesToLog",
0)));sa=sa.initialize(new ka(5),new J,db,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));sa.run();Q.$("CpuMeterMonitorIsEnabled")&&za.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(sa,Q.uI("CpuMeterAverageCpuPercentThreshold",80),Q.vb("CpuMeterRollingAverageFramesCount",15));z.b(16827671,306,50,"Initializing CpuMeter")}static main(){fa.a.instance.kc(new Ja)}}Object(c.a)(Ja,"CpuMeterPackage",null,[1,2]);var pa=b(10),Na=b(77),Da=b(1287),Aa=b(1027),Ma=b(15),ba=b(980);class L{constructor(){this.fza=
this.gza=this.ILc=null;this.tQb=!0;this.YTc=!1}Mb(Q){M.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1070,"Common.IEventTimingMeter").fa().hd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Aa.a(M.AFrameworkApplication.K.vb("EventTimingMeterEventSamplingPercent",0)/100);Q=new Da.a(Object(n.a)(Q,Q.SDa,"shouldBeInSample"));const sa=Y.a.kA(16,1,Q);this.gza=new ba.a("TypingDuration-SlowPercentileAtValue","Percentile",M.AFrameworkApplication.K.uI("AshaVetoForTypingThresholdInMS",
150),M.AFrameworkApplication.K.uI("AshaVetoForTypingThresholdPercentile",95),this.tQb);this.fza=new ba.a("TypingDuration-BrokenSlowPercentileAtValue","Percentile",M.AFrameworkApplication.K.uI("AshaVetoForTypingBrokenThresholdInMS",200),M.AFrameworkApplication.K.uI("AshaVetoForTypingThresholdPercentile",95),this.tQb);(this.YTc=!Ma.a.QNa)&&M.AFrameworkApplication.cL(()=>{this.zof()});this.ILc=db=>{db=db.rawEvent.detail;for(const Gb of db)sa.track(Gb,"EventTimingData"),"false"===Gb.metadata.altPressed.toString()&&
"false"===Gb.metadata.ctrlPressed.toString()&&"false"===Gb.metadata.repeat.toString()&&this.YTc&&(this.gza.Ona(Gb.timeToRequestAnimationFrameMs),this.fza.Ona(Gb.timeToRequestAnimationFrameMs))};S.a.addHandler(window.self,B.a.Crh,this.ILc)}dispose(){this.ILc&&(S.a.removeHandler(window.self,B.a.Crh,this.ILc),this.ILc=null)}zof(){this.gza.rDa();this.gza.vse&&(pa.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Na.Health.instance.recordQosError("SlowTypingSession",
["SlowTypingSession"],!1,!0,!0,!1,null));this.fza.rDa();this.fza.vse&&(pa.ULS.sendTraceTag(588649308,209,15,"Report SlowTypingSession Veto with BrokenSlowTypingSession error"),Na.Health.instance.recordQosError("BrokenSlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){fa.a.instance.kc(new L)}}Object(c.a)(L,"EventTimingMeterPackage",null,[1,2]);var V=b(74),ha=b(56),la=b(30);class ya{constructor(Q,sa,db,Gb=null,Xb=null){this.GP=Q;this.p1g=sa;this.b1g=db;this.odh=Gb;this.mdh=Xb}zCk(Q){const sa=
new Sys.StringBuilder(this.GP.URi);sa.append("RoamingServiceHandler.ashx?action=");sa.append("getFirstRunExperienceSettings");sa.append("&");sa.append(this.y3k(Q));sa.append("&");sa.append(M.AFrameworkApplication.zk);M.AFrameworkApplication.je.Ki(sa.toString(),1,null,null,!0,2,Object(n.a)(this,this.DOf,"getRequestSuccessCallback"),Object(n.a)(this,this.Oee,"getRequestFailureCallback"),null)}CCk(Q){var sa=new Sys.StringBuilder(this.GP.URi);sa.append("RoamingServiceHandler.ashx?action=");sa.append("saveFirstRunExperienceSettings");
sa.append("&");sa.append(M.AFrameworkApplication.zk);sa=sa.toString();Q=la.c(Q);M.AFrameworkApplication.je.Ki(sa,2,Q,null,!0,4,Object(n.a)(this,this.o5l,"postRequestSuccessCallback"),Object(n.a)(this,this.Gkg,"postRequestFailureCallback"),null)}DOf(Q){let sa=!1,db=null;try{if(0<Q.data.wd.length){const Gb=Object(ha.a)(Object,la.a(Q.data.wd)),Xb=Gb?Gb[this.GP.Hhf]:null;Xb&&(db=Object(ha.a)(Object,la.a(Xb.toString())))}sa=!0}catch(Gb){this.Oee(null)}sa&&this.p1g&&this.p1g(Q.data,db)}Oee(Q){this.b1g&&
this.b1g(Q?Q.data:null)}o5l(Q){this.odh&&this.odh(Q?Q.data:null)}Gkg(Q){this.mdh&&this.mdh(Q?Q.data:null)}y3k(Q){const sa=new Sys.StringBuilder("requestedsettings=");for(let db=0;db<Q.count;db++)sa.append(Q.J(db)),db<Q.count-1&&sa.append(";");return sa.toString()}}Object(c.a)(ya,"FirstRunExperienceRequestHandler",null,[]);class va{constructor(){this.WQc=this.JRe=this.GP=null}yGm(Q){Q?(this.GP=Q,this.wul()&&(pa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
Q=new V.a,Q.add(this.GP.Hhf),this.JRe=new ya(this.GP,Object(n.a)(this,this.DOf,"getRequestSuccessCallback"),Object(n.a)(this,this.Oee,"getRequestFailureCallback"),null,Object(n.a)(this,this.Gkg,"postRequestFailureCallback")),this.JRe.zCk(Q)),this.GP.lmi&&this.GDg()):pa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}wul(){try{if(this.GP.lmi)return!0;if(!M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||M.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;
if(this.GP.Qql||this.GP.Nwc||M.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=M.AFrameworkApplication.K.Oa("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){pa.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}OSi(Q){const sa={},db={};db.FREDisplayedDate=(new Date).toUTCString();db.VersionDisplayed=Q;db.RemindMeLater=!1;sa[this.GP.Hhf]=la.c(db);pa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.JRe.CCk(sa)}DOf(Q,sa){Q=Q?+Q.lT-+Q.PG:-1;Q>this.GP.VRi?pa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.GP.VRi):sa?this.CFm(sa)?(pa.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.GP.rvi),this.GDg()):pa.ULS.sendTraceTag(51675537,
306,100,"Current user has already seen this version of the FRE. No further action required."):(pa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.GDg())}Oee(Q){pa.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.mf:-1)}Gkg(Q){pa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.mf:-1)}GDg(){this.zGm()}zGm(){const Q=
za.a.instance.sa("Common.ISystemInitiatedFeedback");if(Q){var sa=this.GP.UHk;sa&&(M.AFrameworkApplication.Uf(sa),M.AFrameworkApplication.Qn(sa));pa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",sa);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.WQc=Object(n.a)(this,this.$Tl,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.WQc,!0),window.addEventListener("FRELaunchedEvent",this.WQc,
!0)):(pa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.OSi(this.GP.currentVersion))}else pa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback")}$Tl(Q){if(Q){var sa=Q.detail;Q=Q.type;var db=this.GP&&this.GP.xzh?this.GP.xzh.split("-")[0]:null;if("FRELaunchedEvent"===Q||db&&sa&&sa.id&&-1!==sa.id.indexOf(db))sa.success&&(pa.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.OSi(this.GP.currentVersion)),
window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.WQc,!0),window.removeEventListener("FRELaunchedEvent",this.WQc,!0))}}CFm(Q){return"RemindMeLater"in Q&&"FREDisplayedDate"in Q&&"true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.GP.rvi?!0:!1}}Object(c.a)(va,"FirstRunExperienceLauncher",null,[1067]);class xa{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Mb(Q){this.Z=Q;this.Z.register(1067,
"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").fa().hd(()=>new va)}init(){}dispose(){}static main(){fa.a.instance.kc(new xa)}}Object(c.a)(xa,"FirstRunExperienceLauncherPackage",null,[1,2]);class Ia{constructor(){this.y=this.x=0}}Object(c.a)(Ia,"HammerPoint",null,[]);var mb=b(13);class gb{constructor(Q,sa,db,Gb,Xb){this.w7g=this.q5a=this.vQd=1;this.l_d=this.m2c=this.L8a=0;this.a1e=this.C3a=null;this.zGb=this.tRe=this.LVd=!1;this.kf=Q;this.QUa=sa;this.zOb=db;this.ea=Gb;Xb&&(this.LVd=
Xb.$("PromoteLayerPinchToZoomIsEnabled"),this.tRe=Xb.$("FinalizeWithInitialPinchScaleIsEnabled"),this.zGb=Xb.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get yM(){return this.QUa}Hsl(){return!!this.kf.instance}tUl(Q){this.ea&&this.ea.processAction(mb.a.u3i,2);const sa=this.kf.instance;this.LVd&&sa.gKi();this.q5a=sa.Eh;this.vQd=Q.Med.scale;this.w7g=1;this.a1e=this.ezh();this.C3a=this.QUa.getBounds();if(!this.C3a)return pa.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.Q3h(Q);
this.zGb?this.uXi(this.QUa.scrollWidth,this.C3a.width,Q,this.q5a,sa):this.L8a=this.QUa.scrollWidth>this.C3a.width?this.d6c(this.zOb.scrollLeft,Q.x,this.q5a):null;this.l_d=this.QUa.scrollHeight>this.C3a.height?this.d6c(this.zOb.scrollTop,Q.y,this.q5a):null;return!0}lug(){this.L8a=null;this.m2c=0}uXi(Q,sa,db,Gb,Xb){Q>sa?this.L8a?(Q=Xb.$4f,Q!==this.m2c&&(this.L8a-=this.m2c-Q,this.m2c=Q)):(this.L8a=this.d6c(this.zOb.scrollLeft,db.x,Gb),this.m2c=Xb.$4f):this.lug()}sUl(Q){const sa=this.Q3h(Q);if(!sa)return pa.ULS.sendTraceTag(42821147,
353,15,"Unexpected null pinch center"),!1;Q=this.Lwm(Q.Med.scale/this.vQd)*this.q5a;this.KZm(sa,Q);this.LZm(sa,Q);return!0}KZm(Q,sa){const db=this.QUa.scrollWidth,Gb=this.C3a.width;this.zGb?this.uXi(db,Gb,Q,sa,this.kf.instance):!this.L8a&&db>Gb&&(this.L8a=this.d6c(this.zOb.scrollLeft,Q.x,sa));if(Q=this.lzh(Q.x,this.L8a,db,Gb,sa))this.zOb.scrollLeft=Q}LZm(Q,sa){const db=this.QUa.scrollHeight,Gb=this.C3a.height;!this.l_d&&db>Gb&&(this.l_d=this.d6c(this.zOb.scrollTop,Q.y,sa));if(Q=this.lzh(Q.y,this.l_d,
db,Gb,sa))this.zOb.scrollTop=Q}lzh(Q,sa,db,Gb,Xb){return db<=Gb||!sa||!Gb?null:Math.max(0,Math.min(sa*Xb-Q,db-Gb))}d6c(Q,sa,db){return(Q+sa)/db}rUl(Q){Q=Q.Med.scale;this.tRe&&(Q/=this.vQd);this.ISh(Q);this.LVd&&this.kf.instance.kog();this.ea&&this.ea.processAction(mb.a.qBf,2);this.zGb&&this.lug()}qUl(Q){Q=Q.Med.scale;this.tRe&&(Q/=this.vQd);this.ISh(Q,!0);this.LVd&&this.kf.instance.kog();this.ea&&this.ea.processAction(mb.a.qBf,2);this.zGb&&this.lug()}Lwm(Q){const sa=this.kf.instance,db=new Date>=
this.a1e;db&&(this.a1e=this.ezh());Math.abs(Q-this.w7g)>=.01*Q&&sa.zBm(Q*this.q5a,db);return sa.Eh/this.q5a}ISh(Q,sa=!1){Q*=this.q5a;this.kf.instance.kAe(Q,!1);const db={};db.initialScale=this.q5a;db.finalScale=Q;db.cancelled=sa;pa.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",db)}Q3h(Q){return(Q=Q.Med.center)?Object.assign(new Ia,{x:Q.x-this.C3a.x,y:Q.y-this.C3a.y}):null}ezh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(c.a)(gb,"PinchZoomAdapter",null,[1148]);class Za{constructor(Q){this._element=
Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(c.a)(Za,"ScrollContainerElement",null,[1147]);class $a{constructor(Q,sa,db,Gb,Xb,Xc){this.f$e=this.qnb=null;this.Z=Q;this.Jc=sa;this.ARd=db;this.B5g=Gb;this.gzj=Xb;this.ihc=Xc;this.qMd=new V.a}register(Q,sa){this.ARd&&this.Z.Da("Common.IGestureInputManager").execute(db=>{this.iLm();this.qnb=db;this.qMd.add(Q);if(this.B5g){if(this.gzj&&
db.pVk()){this.N3i();return}var Gb=this.Z.Da("Common.IZoomManager");this.Z.resolve("Common.IAppSettingsManager");const Xb=new Za(Q);Gb=new gb(Gb,Xb,sa,M.AFrameworkApplication.pa,M.AFrameworkApplication.K);db.$fm(Q,Gb)}this.N3i()})}unregister(){if(this.qnb&&this.qMd){if(this.B5g){for(let Q of this.qMd)this.qnb.eVm(Q);this.qMd.clear()}this.qnb=null}}iLm(){this.ihc&&(this.Jc?this.f$e=this.Jc.le("Task","Register"):pa.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}N3i(){this.ihc&&(this.f$e?
this.f$e.stop():pa.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(c.a)($a,"GestureInputRegistrar",null,[1068]);class cb{constructor(){this.Z=null;this.oe=!1}get name(){return"Common.App.GestureInput"}init(){this.oe||(this.Z.resolve("Common.IGestureInputRegistrar"),this.oe=!0)}dispose(){}Mb(Q){this.Z=Q;Q.register(1068,"Common.IGestureInputRegistrar").fa().hd(()=>new $a(Q,M.AFrameworkApplication.oa.$o,M.AFrameworkApplication.Ynd(),M.AFrameworkApplication.Bki(),!!M.AFrameworkApplication.K&&
M.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){fa.a.instance.kc(new cb)}}Object(c.a)(cb,"GestureInputPackage",null,[1,2]);var La=b(286),Ya=b(58);class Eb{constructor(){this.qCb=this.aWh=null}}Object(c.a)(Eb,"GestureAdapterInfo",null,[]);var qa=b(313),Oa=b(193);class Ha{constructor(){this.zIb=null}z5f(){if(!this.zIb){var Q=M.AFrameworkApplication.Tp(String.format("{0}",
Ha.xbl),5);Q=Oa.a.create(Q,null,null);qa.a.qF(Q);this.zIb=Q.LZa}return this.zIb}static get instance(){Ha.ra||(Ha.ra=new Ha);return Ha.ra}}Ha.xbl="hammer.min.js";Ha.ra=null;Object(c.a)(Ha,"HammerJsDependencyLoader",null,[1149]);const ab=(Q,sa,db=null)=>{if(void 0===sa||null===sa)throw pa.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Gb=null;switch(Q){case B.a.pinch:Gb=new Hammer.Pinch(db);break;case B.a.pan:Gb=new Hammer.Pan(db)}Gb&&(Gb.manager=
sa);return Gb};var Ra;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(Ra||(Ra={}));Object(c.b)("GestureEvent",Ra);var Pa=b(45);class bb extends Pa.a{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){super(Q,db,Gb,Xc);this.pNc=sa;this.$7a=zd;this.fya=ve;this.avj=Xb}get shiftKey(){return this.$7a}get ctrlKey(){return this.fya}get clientPoint(){return this.pNc}get Med(){return this.avj}static create(Q,sa,db,Gb,Xb,Xc){if(db.rawEvent)if(Xc){var zd=db.rawEvent;zd=new Sys.UI.Point(zd.clientX,
zd.clientY)}else zd=Pa.a.ece(db);else zd=new Sys.UI.Point(db.clientX,db.clientY);return new bb(Q,zd,sa,db,Gb,Xb,db.shiftKey,db.ctrlKey,Xc)}}Object(c.a)(bb,"GestureEventArgs",Pa.a,[]);class hb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=
this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(c.a)(hb,"GestureManagerData",null,[]);class Pb{}Pb.okj=2;Pb.pkj=4;Pb.qkj=8;Pb.rkj=8;Object(c.a)(Pb,"HammerConstants",null,[]);var wb=b(63),Fb=b(100),Ta=b(16),Zb=b(78);class Db extends S.a{constructor(Q,sa){super();this.MTa=La.a.KLk;this.p4e=!!window.PointerEvent;this.wkh=window.hasOwnProperty("ontouchstart");this.KJb=this.pXc=null;this.BTa=!1;this.Sqa=new Ya.a;this.LYc=new Ya.a;this.W0g=new V.a;this.umb=null;
this.Wec=this.ihc=this.jVg=this.MLe=this.x_e=this.cfh=this.wVg=this.B2c=!1;this.YVc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.g$e=null;this.Df=wb.EventHandlerManager.instance;this.p4e?(pa.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.pXc=Object(n.a)(this,this.hre,"onPointerEvent"),this.KJb=B.a.MLk):this.wkh?(pa.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.pXc=Object(n.a)(this,this.nBb,"onTouchEvent"),this.KJb=B.a.touchEvents):(pa.ULS.sendTraceTag(593893139,
310,50,"Using mouse events"),this.pXc=Object(n.a)(this,this.Xqe,"onMouseEvent"),this.KJb=B.a.LLk);this.Jc=sa;this.MA=Q;M.AFrameworkApplication.K&&(this.B2c=M.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.wVg=M.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.cfh=M.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.x_e=M.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),this.MLe=M.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.jVg=M.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.ihc=M.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.Wec=this.B2c&&M.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&M.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}pVk(){return this.p4e?0:this.wkh?1:2}Nu(Q){super.Nu(Q);this.Df.XMa(this.KJb,Q,0,this.pXc)}Hu(Q){super.Hu(Q);this.Df.Iab(Q,this.KJb)}$fm(Q,sa){M.AFrameworkApplication.Ynd()?Ha.instance.z5f().continueWith(db=>
{this.hLm();if(db.Dg||db.Rm)pa.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",db.status);else{pa.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",db.status);if(this.jVg){db=window.Hammer;if("undefined"===typeof db){pa.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.sCe();return}if("undefined"===typeof db.inputHandler){pa.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.sCe();return}}if(!Q)throw this.sCe(),Error.argumentNull("source element can not be null");
db=Fb.a.Ua(Q,this.MTa);if(void 0===db||null===db)db=new Ya.a,Fb.a.tj(Q,this.MTa,db),this.agm(Q);if(!db.La(Ra[0])){var Gb=Object.assign(new Eb,{qCb:ab(Ra[0],this,null),aWh:sa});db.add(Ra[0],Gb)}}this.sCe()}):pa.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}hLm(){this.ihc&&(this.Jc?this.g$e=this.Jc.le("Task","RegisterGestureAdapterAfterLoad"):pa.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}sCe(){this.ihc&&(this.g$e?this.g$e.stop():
pa.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}eVm(Q){pa.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const sa=Fb.a.Ua(Q,this.MTa);void 0!==sa&&null!==sa&&(sa.remove(Ra[0]),sa.count||(Fb.a.WC(Q,this.MTa),this.curRecognizer=null,this.fVm(Q)))}agm(Q){this.W0g.add(Q);this.Df.XMa(this.KJb,Q,0,this.pXc)}fVm(Q){this.W0g.remove(Q);this.Df.Iab(Q,this.KJb)}recognize(Q){var sa=Array(Q.pointers.length);for(var db=0;db<Q.pointers.length;db++)sa[db]=
Q.pointers[db].target;db=null;for(this.umb=this.VYk(sa);void 0!==this.umb&&null!==this.umb&&(db=Fb.a.Ua(this.umb,this.MTa),void 0===db||null===db);this.umb=this.umb.parentNode);if(void 0!==db&&null!==db){this.curRecognizer&&this.curRecognizer.state===Pb.rkj&&(this.curRecognizer=null);sa=db.keys;for(let Gb of sa){sa=db.J(Gb);void 0!==sa&&null!==sa&&void 0!==sa.qCb&&null!==sa.qCb&&(void 0===this.curRecognizer||null===this.curRecognizer||sa.qCb===this.curRecognizer||sa.qCb.canRecognizeWith(this.curRecognizer))&&
sa.qCb.recognize(Q);const Xb=sa.qCb.state;this.curRecognizer||Pb.okj!==Xb&&Pb.pkj!==Xb&&Pb.qkj!==Xb||(this.curRecognizer=sa.qCb)}}}emit(Q,sa){if("hammer.input"!==Q){this.BTa=!1;sa=bb.create(Q,this.umb,sa.srcEvent,sa,3,this.p4e);var db=Fb.a.Ua(this.umb,this.MTa);if(this.Vvl(Q))var Gb=0;else if(this.xvl(Q))Gb=1;else if(this.syl(Q))Gb=2;else{pa.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:db}=db.tb(Ra[Gb]));void 0!==db&&null!==db&&((db=db.aWh,db.Hsl())?
Q.endsWith("start")?this.BTa=db.tUl(sa):Q.endsWith("end")?(db.rUl(sa),this.BTa=!0):Q.endsWith("cancel")?(db.qUl(sa),this.BTa=!0):Q.endsWith("move")&&(this.BTa=db.sUl(sa)):pa.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(ha.a)(Hammer.Recognizer,Q)}VYk(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];var sa=Q[0],db=!0;for(let Gb=1;Gb<Q.length;Gb++){if(!Q[Gb])return null;if(sa!==Q[Gb]){db=!1;break}}if(db)return sa;sa=this.zWh(Q[0]);db=
0;for(const Gb of Q){Q=this.zWh(Gb);if(sa.J(sa.count-1)!==Q.J(Q.count-1))return null;for(let Xb=sa.count-2,Xc=Q.count-2;Xb>=db&&0<=Xc;Xb--,Xc--)if(sa.J(Xb)!==Q.J(Xc)){db=Xb+1;break}}return sa.J(db)}zWh(Q){const sa=new V.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)sa.add(Q);return sa}N0h(Q){switch(Q){case B.a.QR:case B.a.CSb:return 1;case B.a.NR:case B.a.mlf:return 2;case B.a.dL:case B.a.u3d:return 4;case B.a.VDe:case B.a.llf:return 8}return 0}nBb(Q,sa,db){Q=this.N0h(Q);sa=this.fXk(db);Hammer.inputHandler(this,
Q,sa);this.BTa&&db.preventDefault();return this.BTa}s$h(){return 1<this.Sqa.count}e4d(){pa.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.B2c)for(let Q of this.Sqa)this.$Ni(Q.key);else this.Sqa=new Ya.a;this.session=null}ARj(Q,sa,db){pa.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.LYc.La(Q)){try{sa.setPointerCapture(Q)}catch(Gb){pa.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Gb)}this.LYc.add(Q,sa)}this.Sqa.W(Q,db);this.Wec&&
1<this.Sqa.count&&this.MA&&!this.MA.v6c&&(this.MA.v6c=!0)}$Ni(Q){pa.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.LYc.La(Q)){try{this.LYc.J(Q).releasePointerCapture(Q)}catch(sa){pa.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",sa)}this.LYc.remove(Q)}else pa.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Sqa.remove(Q);this.Wec&&1>=this.Sqa.count&&this.MA&&this.MA.v6c&&(this.MA.v6c=!1)}hre(Q,sa,db){var Gb=
db.rawEvent.pointerType.toString();const Xb=db.rawEvent.pointerId.toString();if("touch"!==Gb)return!1;Q=this.N0h(Q);if(1!==Q&&!this.Sqa.La(Xb))return!1;this.wVg&&1===Q&&db.rawEvent.isPrimary&&this.Sqa.count&&(pa.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.e4d());this.B2c?this.ARj(Xb,sa,db):this.Sqa.W(Xb,db);this.x_e&&2===Q&&(!this.MLe||this.MLe&&"function"===typeof db.rawEvent.getCoalescedEvents)&&(sa=db.rawEvent.getCoalescedEvents())&&this.s$h()&&(this.YVc=Math.max(this.YVc,
sa.length));this.cfh&&(this.BTa=!1);Gb=this.eXk(this.Sqa,db,Gb);Hammer.inputHandler(this,Q,Gb);if(4===Q||8===Q)this.B2c?this.$Ni(Xb):this.Sqa.remove(Xb),this.Sqa.count||(this.session=null,this.x_e&&-1!==this.YVc&&(pa.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.YVc),this.YVc=-1));this.BTa&&db.preventDefault();return this.BTa}Xqe(){return!1}fXk(Q){const sa=new hb;var db=Q.rawEvent;const Gb=db.touches;db=db.changedTouches;sa.pointers=Array.clone(Gb);sa.pointers=Array.clone(0<
Gb.length?Gb:db);sa.changedPointers=Array.clone(db);sa.srcEvent=Q;sa.pointerType="touch";return sa}eXk(Q,sa,db){const Gb=new hb;Gb.pointers=Zb.toArray(Q.values);Gb.changedPointers=[sa];Gb.pointerType=db;Gb.srcEvent=sa;return Gb}Vvl(Q){return Ta.a.startsWith(Q,B.a.pinch)}xvl(Q){return Ta.a.startsWith(Q,B.a.pan)}syl(Q){return Ta.a.startsWith(Q,B.a.swipe)}}Object(c.a)(Db,"GestureInputManager",S.a,[1118,1119]);var pb=b(208);class nb{constructor(){this.Z=null;this.oe=!1}get name(){return"Common.App.GestureInputManager"}Mb(Q){Q.register(Db,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").fa().hd(()=>new Db(pb.a.instance,M.AFrameworkApplication.oa.$o));this.Z=Q}init(){this.oe||(this.Z.resolve("Common.App.GestureManager.GestureInputManager"),this.oe=!0)}dispose(){}static main(){fa.a.instance.kc(new nb)}}Object(c.a)(nb,"GestureInputManagerPackage",null,[1,2]);var ub=b(203);class kb{}Object(c.a)(kb,"ShellRenderData",null,[]);var zc=b(1401),Qc=b(44),md=b(1198);class vd{constructor(Q,sa,db){this.fah=this.gah=
!1;this.Dza=this.d0c=this.c0c=null;this.Jkc=new t.a;this.Re=Q;this.$Wc=db;this.I$=sa.appSettings[vd.D2m]||""}get FCm(){return this.Jkc.task}get cla(){return this.Re.value}$mm(){this.Dza=document.getElementById(vd.Q4i);const Q={};Q[vd.kel]=M.AFrameworkApplication.zk;Q["Content-Type"]="application/json; charset=utf-8";pa.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const sa=Qc.a.vp(this.I$+vd.GCm,vd.CQl,M.AFrameworkApplication.oa.mb.np.toString());
this.cla.Ki(sa,1,"",Q,!0,2,Object(n.a)(this,this.Tgb,"onSuccessCallback"),Object(n.a)(this,this.Agb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}qGl(Q){try{const sa={};sa.FlightName=Q.FlightName;sa.SessionID=Q.SessionID;pa.ULS.sendTraceTag(594883776,215,50,la.c(sa))}catch(sa){pa.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}Tgb(Q){if((Q=Q.data.wd)&&Q.length)try{const sa=la.a(Q);M.AFrameworkApplication.oa.mb.uA?(this.c0c=sa.NavBarDataJson,pa.ULS.sendTraceTag(41551899,
215,50,"Skipping call to TryLoadResources for React Shared Header.")):this.iTm(sa)&&(this.c0c=sa.NavBarDataJson);this.c0c?({pz:this.d0c}=la.d(sa.NavBarDataJson)).returnValue?(this.qGl(this.d0c),this.Jkc.Ue(this.d0c)):(pa.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:md.a.MGd(this.c0c)}),this.Jkc.ria()):(pa.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Jkc.ria())}catch(sa){this.UDa(),pa.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),
this.Jkc.ria()}else this.UDa(),pa.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}Agb(){this.Dza&&this.UDa();this.Jkc.ria();pa.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}iTm(Q){if(!Q.JsUrl||!Q.JsUrl.length)return this.UDa(),pa.ULS.sendTraceTag(6387854,215,10,"Empty or null JS URL."),!1;const sa=Oa.a.create(Q.JsUrl);sa.KJ(Object(n.a)(this,this.oQl,"o365ShellJs_LoadFinished"));qa.a.qF(sa);if(!Q.CssUrl||!Q.CssUrl.length)return this.UDa(),
pa.ULS.sendTraceTag(6387855,215,10,"Empty or null CSS URL."),!1;Q=new zc.a(Q.CssUrl);Q.KJ(Object(n.a)(this,this.nQl,"o365ShellCss_LoadFinished"));qa.a.qF(Q);return!0}nQl(Q,sa){sa.succeeded?(this.fah=!0,this.cPi()):(pa.ULS.sendTraceTag(7608092,215,10,"CSS failed to load"),this.UDa())}oQl(Q,sa){sa.succeeded?(this.gah=!0,this.cPi()):(pa.ULS.sendTraceTag(7608093,215,10,"JS failed to load"),this.UDa())}cPi(){if(this.fah&&this.gah)if(this.Dza){Sys.UI.DomElement.removeCssClass(this.Dza,vd.wxc);var Q=document.createElement("div");
Q.id=vd.WZi;this.Dza.appendChild(Q);this.ilm()}else pa.ULS.shipAssertTag(7608280,215,!1)}ilm(){const Q=window.self.O365Shell;if(Q)if(Q.SetData)if(this.c0c)if(this.d0c){Q.SetData(this.d0c);var sa=Object.assign(new kb,{launcher:vd.WZi,switcher:vd.Q4i});Q.RenderAsync?Q.RenderAsync(sa,Object(n.a)(this,this.UYl,"onSwitcherRendered")):(this.UDa(),pa.ULS.shipAssertTag(6613131,215,!1))}else this.UDa();else this.UDa(),pa.ULS.shipAssertTag(6613130,215,!1);else this.UDa(),pa.ULS.shipAssertTag(6613129,215,!1);
else this.UDa(),pa.ULS.shipAssertTag(6613128,215,!1)}UYl(){if(this.Dza){const Q=this.Dza.getElementsByTagName("a");Q&&0<Q.length&&Q[0]&&"none"!==this.Dza.style.display&&Q[0].focus();M.AFrameworkApplication.pa.processAction(mb.a.pQl,2);pa.ULS.sendTraceTag(6612807,215,50,"O365 switcher tiles added to the DOM.")}else pa.ULS.sendTraceTag(41551900,215,15,"Switcher DOM element is null. Cannot append shell container.")}UDa(){this.Dza&&!Sys.UI.DomElement.containsCssClass(this.Dza,vd.FQh)&&(Sys.UI.DomElement.removeCssClass(this.Dza,
vd.wxc),Sys.UI.DomElement.addCssClass(this.Dza,vd.FQh),pa.ULS.sendTraceTag(7129104,215,10,"Failed to display O365 Shell Switcher."))}static get instance(){return vd.ra||(vd.ra=vd.dcb())}static dcb(){return new vd(new ub.a(()=>M.AFrameworkApplication.je),M.AFrameworkApplication.K,M.AFrameworkApplication.oa.mb.np)}}vd.kel="X-qs";vd.CQl="at";vd.GCm="O365ShellServiceProxy.ashx";vd.ra=null;vd.Q4i="sw_bar";vd.wxc="SwitcherLoading";vd.FQh="SwitcherError";vd.WZi="ShellContainer";vd.D2m="ShellWebServiceBase";
Object(c.a)(vd,"O365ShellActor",null,[1115]);class Jb{constructor(){this.Z=null}get name(){return"Common.App.O365Shell"}Mb(Q){this.Z=Q;this.Z.register(vd,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").fa().hd(()=>new vd(new ub.a(()=>M.AFrameworkApplication.je),M.AFrameworkApplication.K,M.AFrameworkApplication.oa.mb.np))}init(){M.AFrameworkApplication.K.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){M.AFrameworkApplication.kOg&&(!M.AFrameworkApplication.K.$("AppSwitcherMitigationIsEnabled")||
M.AFrameworkApplication.oa.mb.uA)&&this.Z.resolve("Common.App.O365Shell.O365ShellActor").$mm()}dispose(){}static main(){fa.a.instance.kc(new Jb)}}Object(c.a)(Jb,"PackageManager",null,[1,2]);class mc{Hfb(){}init(){}dispose(){}}Object(c.a)(mc,"NoOpOfflineLogger",null,[1176,12]);var sc=b(532);class Mc{}Mc.S1d=0;Object(c.a)(Mc,"OfflineLoggerConstants",null,[]);var Nb=b(75),Kb=b(167),Yb=b(320);class Bb{constructor(Q,sa,db,Gb,Xb){this.H5a=!1;this.q$=null;this.xOc=this.oic=this.hIb=0;this.zL=this.oob=this.aW=
null;this.Fi=!1;this.tHa=db;this.XIa=Gb;this.xea=Xb;this.Re=sa;this.Za=Q}init(){this.zBg();this.iEl();this.H5a=!1;this.Re.fRb(this);this.aW=new Nb.a(3,2,2500,Object(n.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Za.Cb(this.aW)}M5c(Q){return"OfflineLog|"+Q}iEl(){const Q=this.tHa.getItem("OfflineLoggerManifest");void 0!==Q&&null!==Q&&0<Q.length&&(this.q$=Bb.bHc(Q));this.q$||(this.q$={});if(void 0===this.q$.end||null===this.q$.end)this.q$.end=0;if(void 0===this.q$.offset||null===this.q$.offset)this.q$.offset=
0;this.hIb=this.q$.offset;isFinite(this.hIb)||(this.hIb=0);this.oic=this.q$.end;isFinite(this.oic)||(this.oic=0);this.xOc=this.oic}zBg(){this.oob=new Yb.a;this.zL=new Kb.a;this.XIa.hqh(Object(n.a)(this,this.ehg,"onUlsReadyToBeSent"));this.XIa.Kqh(Object(n.a)(this,this.ghg,"onUlsSentSuccessfully"));this.XIa.Jqh(Object(n.a)(this,this.fhg,"onUlsSentFailed"));this.XIa.Yph(Object(n.a)(this,this.ydg,"onAfterUlsHostDisposed"))}ehg(Q,sa){if(void 0!==sa&&null!==sa&&void 0!==sa.args&&null!==sa.args){Q=!1;if(!this.oob.La(sa.args.tag)){if(!this.oob.La(Mc.S1d))return;
Q=!0}this.oob.remove(Q?Mc.S1d:sa.args.tag);this.zL.La(sa.fP)||this.zL.W(sa.fP,new V.a);this.zL.J(sa.fP).add(sa.args)}}ghg(Q,sa){this.zL.remove(sa.fP)}fhg(Q,sa){if(void 0!==sa&&null!==sa&&this.zL.La(sa.fP)){Q=this.zL.J(sa.fP);for(let db=0,Gb=Q.count;db<Gb;++db)sa=Bb.serialize(Q.J(db),this.xea),this.ZGd(this.M5c(this.xOc++),sa)}}ydg(){this.dispose()}ZGd(Q,sa){try{return this.tHa.setItem(Q,sa),!0}catch(db){return pa.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",
db.message),!1}}sendOfflineLogs(){if(!this.H5a){for(var Q=this.hIb,sa=new V.a,db=null;Q<this.oic&&5>=sa.count;++Q){var Gb=this.M5c(Q);const Xb=this.tHa.getItem(Gb);this.tHa.removeItem(Gb);if(void 0===Xb||null===Xb)continue;const Xc=({sessionId:Gb}=Bb.deserialize(Xb)).returnValue;if(Xc){if(!db)db=Gb;else if(Gb!==db)break;sa.add(Xc)}else pa.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Xb)}0<sa.count&&this.XIa.rQi(this,Zb.toArray(sa),db);this.hIb=Q;Q>=this.oic&&(this.Za.Oe(this.aW),
this.aW=null)}}Hfb(Q,sa,db){!this.Fi&&pa.ULS.O0(sa,db)&&this.oob.W(Q,!0)}dispose(){if(!this.Fi){this.aW&&this.Za.Oe(this.aW);var Q=Zb.toArray(this.zL.keys);Q.sort();for(const sa of Q){Q=this.zL.J(sa);for(let db=0,Gb=Q.count;db<Gb;++db){const Xb=Bb.serialize(Q.J(db),this.xea);this.ZGd(this.M5c(this.xOc++),Xb)}}this.hIb<this.xOc?(this.q$.end=this.xOc,this.q$.offset=this.hIb,this.ZGd("OfflineLoggerManifest",JSON.stringify(this.q$))):this.tHa.removeItem("OfflineLoggerManifest")}this.Fi=!0}PCa(){this.H5a=
!0}g_a(){this.H5a=!1}static serialize(Q,sa){const db={};db.t=Q.tag;db.c=Q.category;db.l=Q.level;db.m=Q.message;db.lt=Q.logType;db.s=sa;db.ts=Q.timestamp;db.o=Q.isMinified;db.a=Q.args;return JSON.stringify(db)}static deserialize(Q){return(Q=Bb.bHc(Q))?{returnValue:new sc.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static bHc(Q){try{return JSON.parse(Q)}catch(sa){pa.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",sa.message)}return null}}
Object(c.a)(Bb,"OfflineLoggerImpl",null,[1176,12,179]);class Lb{constructor(Q,sa,db,Gb){this.sessionId=Q;this.version=sa;this.L2d=db;this.Phg=Gb;this.mR=new V.a}}Object(c.a)(Lb,"CachedLogUpload",null,[]);class gc{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(c.a)(gc,"LoggingExceptionArgsLocalStorage",null,[]);class Gc{constructor(Q){this.t=Q.tag;this.c=Q.category;
this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new gc(Q.exceptionArgs))}}Object(c.a)(Gc,"LoggingArgsLocalStorage",null,[]);var fc=b(327);class dd{constructor(Q,sa,db,Gb,Xb,Xc){this.t=Q;this.m=sa;this.s=db;this.v=Gb;this.i=Xb;this.a=Xc;this.op="Log"}}Object(c.a)(dd,"LoggingKeyLocalStorage",null,[]);var Td=b(129);const Bd=(Q,sa,db)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===
Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===sa&&isFinite(Q.t)&&Td.a.Gc(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===db);class ce{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg){this.H5a=this.z8g=this.s8g=this.t8g=!1;this.zL=this.oob=this.q$=this.aW=null;this.Fi=!1;this.zLb=[];this.hic=[];this.tHa=db;this.XIa=Gb;this.xea=Xb;this.Re=sa;this.Za=Q;this.$Wc=Xc;this.G1e=zd;this.nfh=ve;this.i6a=yf;this.UAj=cf;this.SXe=eg}get manifest(){return this.q$}get Hqd(){return this.oob}get OZa(){return this.zL}init(){this.zBg();
this.H5a=!1;this.Re.fRb(this);this.aW=new Nb.a(3,1,2500,Object(n.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Za.Cb(this.aW)}determineLogsToSendAtBoot(){this.PLh(!0)}determineLogsToSendOnReconnect(){this.PLh(!1)}PLh(Q){this.r$d();this.zLb=[];Q&&(this.hic=[]);for(var sa=0;sa<this.tHa.length;sa++){const db=this.tHa.key(sa),Gb=ce.bHc(db,!1);Bd(Gb,this.$Wc,this.G1e)&&(Gb.s===this.xea?Array.add(this.zLb,db):Q&&Array.add(this.hic,db))}if(this.zLb.length||Q&&this.hic.length)if(sa=
this.SXe?Object(n.a)(this,this.gJm,"sortDescendKeysToUpload"):Object(n.a)(this,this.jJm,"sortKeysToUpload"),this.zLb.sort(sa),Q&&this.hic.sort(sa),0<this.zLb.length||0<this.hic.length)this.aW=new Nb.a(3,2,2500,Object(n.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Za.Cb(this.aW)}jJm(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}gJm(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}M5c(Q,sa,db,Gb){return JSON.stringify(new dd(this.$Wc,this.G1e,sa,db,Q,Gb))}zBg(){this.oob=new Yb.a;
this.zL=new Kb.a;this.XIa.hqh(Object(n.a)(this,this.ehg,"onUlsReadyToBeSent"));this.XIa.Kqh(Object(n.a)(this,this.ghg,"onUlsSentSuccessfully"));this.XIa.Jqh(Object(n.a)(this,this.fhg,"onUlsSentFailed"));this.XIa.Yph(Object(n.a)(this,this.ydg,"onAfterUlsHostDisposed"))}ehg(Q,sa){if(void 0!==sa&&null!==sa&&void 0!==sa.args&&null!==sa.args){if(this.Hqd.La(sa.args.tag))this.Hqd.remove(sa.args.tag);else if(this.Hqd.La(Mc.S1d))this.Hqd.remove(Mc.S1d);else if(!(this.UAj&&50>sa.args.level))return;({value:Q}=
this.OZa.tb(sa.fP)).returnValue||(Q=new Lb(sa.sessionId,sa.version,sa.L2d,sa.Phg),this.OZa.W(sa.fP,Q));this.OZa.J(sa.fP).mR.add(sa.args)}}ghg(Q,sa){this.OZa.remove(sa.fP)}fhg(Q,sa){void 0!==sa&&null!==sa&&this.OZa.La(sa.fP)&&this.Pvi(sa.fP)&&!this.z8g&&(this.z8g=!0,pa.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}Pvi(Q){let sa=!1;if(({value:Gb}=this.OZa.tb(Q)).returnValue&&Gb&&0<Gb.mR.count){if(Gb.L2d>=this.i6a)return!1;var db=Gb.mR;const Xb=Array(db.count);for(let Xc=0,zd=db.count;Xc<
zd;++Xc)Xb[Xc]=new Gc(db.J(Xc));db=ce.serialize(Xb);var Gb=this.M5c(Gb.Phg,Gb.sessionId,Gb.version,Gb.L2d);this.ZGd(Gb,db)&&(this.OZa.remove(Q),sa=!0)}return sa}ydg(){this.dispose()}ZGd(Q,sa){try{return this.tHa.setItem(Q,sa),!0}catch(db){return pa.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",db.message),!1}}sendOfflineLogs(){if(!this.H5a){var Q=0<this.zLb.length?this.zLb:this.hic,sa=Q.length;if(sa)for(;0<sa;){M.AFrameworkApplication.Uf("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");
sa--;var db=this.SXe?Q.pop():Q[0];this.SXe||Array.removeAt(Q,0);const Xc=ce.bHc(db,!0);if(Bd(Xc,this.$Wc,this.G1e)){var Gb=this.tHa.getItem(db);this.tHa.removeItem(db);if(void 0!==Gb&&null!==Gb)if(Xc.a>this.i6a)pa.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Xc.a,this.i6a);else if(db=ce.bHc(Gb,!0),void 0!==db&&null!==db&&isFinite(db.length))if(db.length){Gb=db[db.length-1];var Xb=(new Date).getTime()-Gb.ts;if(Xb<-ce.F6i)pa.ULS.sendTraceTag(37290078,222,50,
"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Gb.ts);else if(Xb>this.nfh*ce.F6i)pa.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.nfh,Gb.ts);else{Xc.s===this.xea?this.t8g||(this.t8g=!0,pa.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.s8g||(this.s8g=!0,pa.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Xc.s));
sa=Array(db.length);for(Gb=0;Gb<db.length;Gb++){Q=Gb;a:{Xb=db[Gb];if(void 0===Xb||null===Xb){Xb=null;break a}let zd=null;Xb.e&&(zd=new fc.a(null),zd.name=Xb.e.n,zd.stack=Xb.e.s,zd.message=Xb.e.m,zd.file=Xb.e.f,zd.line=Xb.e.l,zd.column=Xb.e.c);Xb=new sc.a(Xb.ts,Xb.c,Xb.t,Xb.l,Xb.m,Xb.lt,Xb.o,Xb.a,zd)}sa[Q]=Xb}this.XIa.rQi(this,sa,Xc.s,Xc.v,Xc.a+1,Xc.i);break}}else pa.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Gb);else pa.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
Gb)}}else this.r$d()}}Hfb(Q,sa,db){!this.Fi&&pa.ULS.O0(sa,db)&&this.Hqd.W(Q,!0)}dispose(){if(!this.Fi){this.aW&&this.Za.Oe(this.aW);var Q=Zb.toArray(this.OZa.keys);for(const sa of Q)this.Pvi(sa)}this.Fi=!0}PCa(){this.H5a=!0;this.r$d()}g_a(){this.H5a=!1;this.r$d();this.aW&&this.Za.Oe(this.aW);this.aW=new Nb.a(3,1,2500,Object(n.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Za.Cb(this.aW)}r$d(){this.aW&&(this.Za.Oe(this.aW),this.aW=null)}static serialize(Q){return JSON.stringify(Q)}static bHc(Q,
sa){try{return JSON.parse(Q)}catch(db){sa&&pa.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",db.message)}return null}}ce.F6i=864E5;Object(c.a)(ce,"OfflineLoggerImplV2",null,[1176,12,179]);class Ec{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(sa){return this.handleError("Key",sa),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(sa){return this.handleError("GetItem",
sa),null}}setItem(Q,sa){try{return localStorage.setItem(Q,sa)}catch(db){return this.handleError("SetItem",db),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(sa){this.handleError("RemoveItem",sa)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,sa){pa.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,sa.message)}}Object(c.a)(Ec,"OfflineStorage",null,[1175]);class kc{create(Q){let sa=null;try{void 0!==localStorage&&
null!==localStorage&&(sa=new Ec)}catch(db){pa.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",db.message)}Object.getType(pa.ULS.host).implementsInterface(1144)&&sa||(pa.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",sa?"supported":"not supported",Object.getType(pa.ULS.host).implementsInterface(1144)?"supported":"not supported"),Q=0);Q=1===Q?new Bb(M.AFrameworkApplication.Sb,M.AFrameworkApplication.je,sa,
pa.ULS.host,M.AFrameworkApplication.userSessionId):2===Q?new ce(M.AFrameworkApplication.Sb,M.AFrameworkApplication.je,sa,pa.ULS.host,M.AFrameworkApplication.userSessionId,M.AFrameworkApplication.oa.mb.np,M.AFrameworkApplication.oa.mb.TCa,M.AFrameworkApplication.K.vb("OfflineLoggerRetentionInDays",30),M.AFrameworkApplication.K.vb("OfflineLoggerMaxAttempts",5),M.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),M.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):
new mc;Q.init();return Q}}Object(c.a)(kc,"OfflineLoggerFactory",null,[]);class hc{Mb(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=M.AFrameworkApplication.K;let sa=0;Q.$("OneNoteOfflineLoggerIsEnabled")?sa=1:Q.$("OfflineLoggerV2IsEnabled")&&(sa=2);sa&&(M.AFrameworkApplication.KIg=(new kc).create(sa))}dispose(){}}Object(c.a)(hc,"OfflineLoggerPackage",null,[1,2]);const Gd=Q=>{try{return la.a(Q)}catch(sa){}return null};class nc{constructor(Q,sa,db,Gb,Xb,Xc){this.n1=!1;this.Np=null;this.c4e=
!1;this.ea=Q;this.Re=sa;this.Se=db;this.L7g=Gb;this.qa=Xb;this.vAj=Xc}init(Q,sa){sa&&Q.Da("Common.Interface.IRtcBasicProvider").execute(Object(n.a)(this,this.Zjf,"awaitRtc"))}Zjf(Q){const sa=Q.Ugd();sa.continueWith(()=>{this.Np=sa.result;this.c4e&&(this.Np.GR(2,null,!0),this.c4e=!1);this.Np.n6((db,Gb)=>{2===Gb.type&&this.Mc.processAction(mb.a.fileNameUpdate,2)});this.Np.Zza((db,Gb)=>{2===Gb.newState&&this.Mc.processAction(mb.a.fileNameUpdate,2)});2===this.Np.connectionState&&this.Mc.processAction(mb.a.fileNameUpdate,
2)})}fXa(Q){this.wRh(Q,!0)}wRh(Q,sa){const db=this.E5j(Q.n2i),Gb={};Gb[nc.XFh]=nc.YFh;this.hQi.Ki(db,2,"",Gb,!1,2,Object(n.a)(this,this.dzc,"onRefreshFilenameSuccess"),sa?Object(n.a)(this,this.nXl,"onRefreshFilenameFailureRetry"):Object(n.a)(this,this.gCi,"onRefreshFilenameFailureNoRetry"),Q)}dzc(Q){this.n1=!1;const sa=Gd(Q.data.wd);Q.data.state.onSuccess(sa,this.L7g.value)}nXl(Q){5!==Q.data.status||this.n1?this.gCi(Q):(this.n1=!0,this.wRh(Q.data.state,!1))}gCi(Q){Q.data.state.onFailure(-1)}yWb(Q){this.xRh(Q,
!0)}xRh(Q,sa){const db=this.F5j(),Gb={};Gb[nc.XFh]=nc.YFh;Gb[nc.iel]=Ta.a.mj(Q.mQi);Gb[nc.gel]=this.vAj.value.Xdk;this.hQi.Ki(db,2,"",Gb,!1,2,Object(n.a)(this,this.Hud,"onRenameFileSuccess"),sa?Object(n.a)(this,this.rXl,"onRenameFileFailureRetry"):Object(n.a)(this,this.jCi,"onRenameFileFailureNoRetry"),Q)}F5j(){return this.$xh()}E5j(Q){let sa=this.$xh();return sa=Qc.a.vp(sa,nc.mel,Q?"2":"1")}$xh(){let Q=(this.qa.value.appSettings.RenameWebServiceBase||"")+nc.hel;Q=Qc.a.vp(Q,nc.jel,Ta.a.mj(M.AFrameworkApplication.zk));
this.Uq&&this.Uq.Aje&&(Q=Qc.a.vp(Q,nc.lel,"1"));return Q}Hud(Q){this.n1=!1;const sa=Gd(Q.data.wd);Q.data.state.onSuccess(sa,this.L7g.value);this.Qxi()}Qxi(){this.Np?this.Np.GR(2,null,!0):this.c4e=!0}rXl(Q){5!==Q.data.status||this.n1?this.jCi(Q):(this.n1=!0,this.xRh(Q.data.state,!1))}jCi(Q){Q.data.state.onFailure(-1)}get Mc(){return this.ea.value}get hQi(){return this.Re.value}get Uq(){return this.Se.value}static get instance(){return nc.ra||(nc.ra=nc.dcb())}static dcb(){return new nc(new ub.a(()=>
M.AFrameworkApplication.pa),new ub.a(()=>M.AFrameworkApplication.je),new ub.a(()=>M.AFrameworkApplication.Uq),new ub.a(()=>za.a.instance.resolve("Postmessage.IHostPostmessenger")),new ub.a(()=>M.AFrameworkApplication.K),new ub.a(()=>za.a.instance.resolve("Common.IRenameProps")))}}nc.XFh="Content-Type";nc.YFh="application/json; charset=utf-8";nc.hel="renamehandler.ashx";nc.jel="qs";nc.iel="n";nc.lel="sl";nc.gel="X-CoauthLockId";nc.mel="u";nc.ra=null;Object(c.a)(nc,"ExecuteRenameFileHandler",null,[]);
class uc{constructor(){this.onFailure=this.onSuccess=null;this.n2i=!1}}Object(c.a)(uc,"ExecuteRefreshFilenameData",null,[]);class yc{constructor(){this.onFailure=this.onSuccess=this.mQi=null}}Object(c.a)(yc,"ExecuteRenameFileData",null,[]);class ke{constructor(){this.Z=null;this.QQe=nc.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Mb(Q){this.Z=Q}init(){M.AFrameworkApplication.K.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){M.AFrameworkApplication.twc()&&(nc.instance.init(this.Z,
M.AFrameworkApplication.lCc),M.AFrameworkApplication.yWb=Object(n.a)(this,this.yWb,"executeRenameFile"),M.AFrameworkApplication.fXa=Object(n.a)(this,this.fXa,"executeRefreshFilename"),M.AFrameworkApplication.ABd=Object(n.a)(this,this.ABd,"sendFileNameAndLocationUpdateNotification"))}yWb(Q,sa,db){const Gb=new yc;Gb.mQi=Q;Gb.onSuccess=sa;Gb.onFailure=db;this.QQe.yWb(Gb)}fXa(Q,sa,db){const Gb=new uc;Gb.onSuccess=Q;Gb.onFailure=sa;Gb.n2i=db;this.QQe.fXa(Gb)}ABd(){this.QQe.Qxi()}dispose(){}}Object(c.a)(ke,
"PackageManager",null,[1,2]);var Qe=b(116);class Gg{constructor(Q,sa,db){this.QDg=this.RDg=this.SDg=!1;this.eEg=!Q&&!sa;this.fEg=!Q&&!db;this.eEg||this.fEg||(this.SDg=!Q,this.RDg=!sa,this.QDg=!db)}}Object(c.a)(Gg,"RenameDisabledDialogInfo",null,[]);class Kg extends Qe.StandardDialog{constructor(Q,sa,db,Gb,Xb){super();this.uIg=[];this.Mja=new Gg(Q,sa,db);this.vqb=Gb;this.Wnb=Xb;this.xf="RenameDisabledDialog";this.Dc=0;this.Xd(1,CommonUIStrings.l_DialogClose);this.VAm();this.plm()}VAm(){this.Mja.eEg?
this.aEd(this.vqb?this.Wnb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Mja.fEg?this.aEd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.hRj();this.s0d(this.uIg)}aEd(Q){Array.add(this.uIg,Q)}hRj(){const Q=[];this.Mja.SDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Mja.RDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.Mja.QDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.uIg,Q)}}Object(c.a)(Kg,"ReactRenameDisabledDialogBase",Qe.StandardDialog,[]);class mf extends Kg{constructor(Q,sa,db,Gb,Xb){super(Q,sa,db,Gb,Xb)}plm(){this.jAb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(c.a)(mf,"ReactRenameDisabledDialog",Kg,[]);var Kf=b(134);class yb{static get Bf(){return Kf.a.ty(yb.Al,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}yb.Al="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(c.a)(yb,"RenameDisabledDialogHtml",null,[]);class Ob extends Kf.a{constructor(Q,sa,db,Gb,Xb){super();this.Mja=new Gg(Q,sa,db);this.vqb=Gb;this.Wnb=Xb;this.xf="RenameDisabledDialog";this.Dc=0;this.Xd(1,CommonUIStrings.l_DialogClose);this.Bf=yb.Bf;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.U3("RenameRow")}BU(){if(this.Mja.eEg){let Q;Q=this.vqb?this.Wnb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Ob.aEd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.Mja.fEg?Ob.aEd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.pgl()}pgl(){this.Mja.SDg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Mja.RDg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Mja.QDg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static aEd(Q,sa,db){Q.style.display="none";sa.innerText=db}}Object(c.a)(Ob,"RenameDisabledDialog",Kf.a,[]);var Lc=b(72);class nd{constructor(Q,sa){this.tMb=0;this.ea=Q;this.VSa=sa}initialize(Q){if(!this.ea||!this.VSa)return!1;this.tMb=Q;this.pb();return!0}pb(){this.ea.ma(mb.a.Iqf,Lc.a.frame,Object(n.a)(this,this.Iqf,"commitNewDocumentTitle"))}Iqf(Q,sa,db,Gb,Xb){if(1===db)return this.ea.processAction(mb.a.renameFile,
1);Q=Ta.a.jK(this.VSa.eA);Xb=(0,Xb.getNewDocumentTitle)();Xb.length>this.tMb&&(Xb=Xb.substr(0,this.tMb));if(32!==this.ea.zb(mb.a.renameFile,2,Xb))return this.AHc(Q),8;this.AHc(Xb);return 32}AHc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Fh(){return new nd(M.AFrameworkApplication.pa,M.AFrameworkApplication.$q)}}Object(c.a)(nd,"ReactRenameUIHandler",null,[1182]);var Rd=b(1134),Yf=b(1272),Pd=b(516),Mf=b(83),Me=b(174),Xd=b(54);class Fe{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,
yf,cf,eg,Xh){this._initialized=!1;this._element=null;this.tMb=0;this.g8e=this.MUe=!1;this.ea=Q;this.lpa=sa;this.qd=db;this.yr=Gb;this.VSa=Xb;this.egh=Xc;this.wXd=zd;this.iMe=ve;this.xnb=yf;this.u5g=cf;this.ai=eg;this.uWe=Xh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,sa,db){if(!(this.ea&&this.VSa&&this.egh&&this.wXd&&this.iMe&&sa)||0>=Q)return!1;this._element=sa;this._element.title=db;this._element.setAttribute(Xd.a.lg,Xd.a.a2);this._element.setAttribute("Unselectable",
"on");this.tMb=Q;this.lH();return this._initialized=!0}lH(){this.lpa&&(this.lpa.Ma(B.a.blur,this._element,Object(n.a)(this,this.onBlur,"onBlur")),this.lpa.Ma(B.a.paste,this._element,Object(n.a)(this,this.Cud,"onPaste")));this.qd.Ma(B.a.vh,this._element,Object(n.a)(this,this.onKeyDown,"onKeyDown"));this.yr.Ma(B.a.pointerDown,this._element,Object(n.a)(this,this.LI,"onPointerDown"));this.yr.Ma(B.a.FO,this._element,Object(n.a)(this,this.v_a,"onPointerUp"))}onBlur(){this.isActive&&!this.MUe&&(this.u5g||
this.iMe(this._element),this.mEh(),this.exf(!1));return this.MUe=!1}Cud(){pa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.pVl(Q):this.qVl(Q)}pVl(Q){let sa=!1;switch(Q.$a.keyCode){case Sys.UI.Key.enter:this.mEh();this.exf(this.ai||this.uWe);sa=!0;break;case Sys.UI.Key.tab:this.u5g&&this.iMe(this._element);break;case Sys.UI.Key.esc:this.Jug(),this.exf(this.ai||this.uWe),sa=!0}return sa}qVl(Q){let sa=!1;switch(Q.$a.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.J8i(this.uWe),
this.isActive&&this.wXd(this._element),sa=!0}return sa}LI(){this.isActive||(this.J8i(!1),this.isActive&&(this._element.focus(),this.wXd(this._element),this.g8e=!0));return!1}v_a(){return this.g8e?(this.wXd(this._element),this.g8e=!1,!0):!1}rwc(){return 32===this.ea.processAction(mb.a.renameFile,1)}mEh(){const Q=Ta.a.jK(this.VSa.eA);let sa=this._element.innerText.trim();sa.length>this.tMb&&(sa=sa.substr(0,this.tMb));sa!==Q&&""!==sa?32!==this.ea.zb(mb.a.renameFile,2,sa)?this.Jug():this.AHc(sa):this.Jug()}Jug(){this.AHc(Ta.a.jK(this.VSa.eA))}AHc(Q){this._initialized&&
(this._element.innerText=Q,this.egh())}J8i(Q){this.rwc()?this.isActive||(Q&&(this.MUe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Xd.a.lg,Xd.a.uuh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Rd.CuiHelper.tOh),this.xnb&&this.xnb.execute(sa=>{sa.jKi(!0)}),Q&&this._element.focus(),pa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ea.processAction(mb.a.REc,
2)}exf(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Xd.a.lg,Xd.a.a2);Sys.UI.DomElement.removeCssClass(this._element,Rd.CuiHelper.tOh);this.xnb&&this.xnb.execute(sa=>{sa.jKi(!1)});Q&&(this._element.blur(),this._element.focus())}static twa(){Yf.a.twa(M.AFrameworkApplication.isRtl)}static Fh(){return new Fe(M.AFrameworkApplication.pa,Pd.a.instance,Mf.KeyInputManager.instance,Me.a.instance,M.AFrameworkApplication.$q,Fe.twa,
oa.a.bsm,oa.a.wCh,za.a.instance.Da("Common.App.Header.HeaderEventSource"),Ma.a.Ix,Ma.a.Ih,Ma.a.lh)}}Object(c.a)(Fe,"RenameUIHandler",null,[1182]);class re{static get instance(){return M.AFrameworkApplication.oa.mb.uA?re.ra||(re.ra=nd.Fh()):re.ra||(re.ra=Fe.Fh())}}re.ra=null;Object(c.a)(re,"RenameUIHandlerFactory",null,[]);class Ad{constructor(){this.dtd=this.cOl=this.vqk=null}}Object(c.a)(Ad,"RenameMruEntryProperties",null,[]);var zf=b(171),Id=b(93),Ac=b(1197),ah;(function(Q){Q[Q.unknown=-1]="unknown";
Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(ah||(ah={}));Object(c.b)("CommonOperationResult",ah);class cg{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh){this.M5g=Q;this.ea=sa;this.Se=db;this.SM=
Gb;this.QLb=Xb;this.tNj=Xc;this.vqb=zd;this.rlh=ve;this.iHj=yf;this.Wnb=cf;this.qa=eg;this.hHj=Xh}pb(){M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.uA||this.Mc.ma(mb.a.ruc,Lc.a.frame,Object(n.a)(this,this.ruc,"initializeRenameUIHandler"));this.Mc.ma(mb.a.REc,Lc.a.frame,Object(n.a)(this,this.REc,"showRenameDisabledDialog"));this.Mc.ma(mb.a.renameFile,Lc.a.frame,Object(n.a)(this,this.renameFile,"renameFile"));this.Mc.Ia(mb.a.fileNameUpdate,Lc.a.frame,Object(n.a)(this,this.Eem,"refreshFilename"),
64);this.Mc.Ia(mb.a.zoe,Lc.a.frame,Object(n.a)(this,this.zoe,"moveToFolderCompleteByHost"),64);this.Mc.ma(mb.a.Y3b,Lc.a.frame,Object(n.a)(this,this.Y3b,"moveToFolder"));M.AFrameworkApplication.oa&&(M.AFrameworkApplication.K.$("PostMessageEmbedded")||M.AFrameworkApplication.K.$("IsJsApi"))&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&M.AFrameworkApplication.NQ().execute(Q=>{Q.Xv(Id.a.dwi);Q.VC(Id.a.dwi,cg.kcm);Q.Xv(Id.a.SDf);Q.VC(Id.a.SDf,
cg.icm)})}rwc(){return this.hHj.K4h()?8:32}p0m(){return this.Uq?this.vqb?this.Uq.Xzf:this.Uq.BXa:!0}ruc(){return re.instance.initialize(M.AFrameworkApplication.hae,M.AFrameworkApplication.JNh,M.AFrameworkApplication.OOi||CommonUIStrings.l_RenameFileTooltip)?32:8}REc(){const Q=this.p0m(),sa=this.tNj();pa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.QLb,sa,Q,this.vqb);M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.tA&&M.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new mf(this.QLb,!sa,!Q,this.vqb,this.Wnb()):new Ob(this.QLb,!sa,!Q,this.vqb,this.Wnb());return 32}renameFile(Q,sa,db,Gb,Xb){if(1===db)return this.rwc();if(!M.AFrameworkApplication.yWb)return 8;if(8===this.rwc())return this.Mc.processAction(mb.a.REc,2),8;pa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");M.AFrameworkApplication.yWb(Xb,Object(n.a)(this,
this.Hud,"onRenameFileSuccess"),Object(n.a)(this,this.qXl,"onRenameFileFailure"));return 32}Hud(Q,sa){Q?Q.OperationResult?this.I9h(Q.OperationResult):(this.utm(sa,Q.NewName),this.jWm(Q,Object(n.a)(M.AFrameworkApplication.oa.mb,M.AFrameworkApplication.oa.mb.hNg,"updateOpenInClientDocumentUrl")),M.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&M.AFrameworkApplication.oa.updateCommandUI(),this.iHj.V$i()):this.I9h(5)}utm(Q,sa){const db={};db[zf.a.GEk]=sa;Q.xh(Id.a.SDf,db)}jWm(Q,sa){this.rWm(Q);
M.AFrameworkApplication.R8d=Q.DirectInvokeDavUrl;sa=sa(Q.EditDocInClientUrl);const db=new Ad;db.dtd=this.SM.eA;db.vqk=sa;db.cOl=Q.EditDocInClientUrl;this.Mc.zb(mb.a.POi,2,db)}I9h(Q){switch(Q){case 1:Q=new Qe.StandardDialog,Q.Dc=0,Q.AM(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.cRi()}}rWm(Q){this.SM.eA=cg.DYj(this.SM.eA,Q.NewName);Q.BreadcrumbFolderName&&(this.SM.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&(this.SM.breadcrumbFolderUrl=
Q.BreadcrumbFolderUrl);this.rlh(Q.NewName)}qXl(Q){const sa=new Qe.StandardDialog;sa.Dc=0;switch(Q){case 1:pa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");sa.uoa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:pa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");sa.uoa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:pa.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),sa.uoa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}M.AFrameworkApplication.NQ().execute(db=>{db.xh(Id.a.FEk,{["FailureMessage"]:ah[Q]})});this.cRi()}Eem(Q,sa,db){if(1===db)return this.rwc();if(!M.AFrameworkApplication.fXa)return 8;M.AFrameworkApplication.fXa(Object(n.a)(this,this.dzc,"onRefreshFilenameSuccess"),Object(n.a)(this,this.nre,"onRefreshFilenameFailure"),!1);return 32}Y3b(Q,sa,db,Gb,Xb){if(1===
db)return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DTTMoveButton",!1)&&M.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===db){const Xc={};Q=M.AFrameworkApplication.syb;sa=M.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&sa)&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Xc[zf.a.HMm]=Q;Xb&&Xb.MoveButtonClickedTime&&(Xc[zf.a.NMl]=Xb.MoveButtonClickedTime.getTime());M.AFrameworkApplication.NQ().execute(zd=>
{zd.xh(Id.a.Y3b,Xc)});if(Xb&&Xb.MoveButtonClickedTime){if(Q=this.lI())Xb=(new Date).getTime()-Xb.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",Xb.toString());Na.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}zoe(Q,sa,db,Gb,Xb){if(1===db)return M.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.rwc():8;if(2===db){if(!M.AFrameworkApplication.ABd)return Na.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",
!1,!1,null),8;if(!Xb)return Na.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Xb[zf.a.Bql])if(Xb[zf.a.Kcj])if(Q=Xb[zf.a.Kcj].toLowerCase(),sa=M.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),db=M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),sa&&M.AFrameworkApplication.syb&&db){const Xc={};Xc[zf.a.KBc]="1";Xc[zf.a.documentUrl]=Q;Xc[zf.a.reason]=Ac.a.iwg;Na.Health.instance.recordKpiSuccess("MoveToFolder",
null);M.AFrameworkApplication.NQ().execute(zd=>{zd.xh(Id.a.JVb,Xc)})}else if(!M.AFrameworkApplication.syb&&db)Na.Health.instance.recordKpiSuccess("MoveToFolder",null),oa.a.En(Q,oa.a.FEa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Na.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Na.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else M.AFrameworkApplication.fXa(Object(n.a)(this,this.dzc,"onRefreshFilenameSuccess"),
Object(n.a)(this,this.nre,"onRefreshFilenameFailure"),!1),M.AFrameworkApplication.ABd(),Na.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}jFm(Q,sa){return Q&&sa?Q!==this.SM.breadcrumbFolderName||sa!==this.SM.breadcrumbFolderUrl:!1}dzc(Q,sa){Q&&(Q.NewName!==Ta.a.jK(this.SM.eA)||this.jFm(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.Hud(Q,sa)}nre(){}cRi(){this.rlh(Ta.a.jK(this.SM.eA))}get Mc(){return this.ea.value}get Uq(){return this.Se.value}lI(){try{return new Map}catch(Q){return null}}static get instance(){return cg.ra||
(cg.ra=cg.dcb())}static dcb(){return new cg(M.AFrameworkApplication.twc,new ub.a(()=>M.AFrameworkApplication.pa),new ub.a(()=>M.AFrameworkApplication.Uq),M.AFrameworkApplication.$q,M.AFrameworkApplication.ECa,()=>M.AFrameworkApplication.wOg,M.AFrameworkApplication.lCc,Object(n.a)(re.instance,re.instance.AHc,"updateTitle"),za.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>M.AFrameworkApplication.kr,M.AFrameworkApplication.K,za.a.instance.resolve("Common.IRenameProps"))}static DYj(Q,
sa){Q=Ta.a.PXa(Q);return sa+Q}static kcm(Q){const sa=Q.Values[zf.a.Cul];pa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",sa);sa?M.AFrameworkApplication.pa.zb(mb.a.zoe,2,Q.Values):Na.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static icm(Q){M.AFrameworkApplication.pa.zb(mb.a.renameFile,2,Q.Values.NewName)}}cg.ra=null;Object(c.a)(cg,"RenameActor",null,[]);var Zi=b(128),uh=b(1033),Jk=b(507),uj=b(387);class Uf{constructor(Q,
sa){this.ea=Q;this.Fmb=sa}pb(){this.ea.ma(mb.a.z1i,Lc.a.frame,Object(n.a)(this,this.FHm,"showRenameDialogAction"))}FHm(Q,sa,db){Q=32;if(1===db)return uj.SessionStatusManager.instance.Hj?8:32;2===db&&(32!==this.ea.processAction(mb.a.renameFile,1)?(this.ea.processAction(mb.a.REc,2),Zi.a.instance.qb(uh.a.Gla,{["Reason"]:Jk.a.Vkm}),Q=8):32===this.ea.processAction(mb.a.rBe,1)?this.ea.processAction(mb.a.rBe,2):this.Fmb.value.create().s1a());return Q}}Object(c.a)(Uf,"RenameDialogActor",null,[1153]);class bf{constructor(Q,
sa,db){this.dialog=null;this.ea=Q;this.SM=sa;this.hnb=db}S3k(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:bf.fqc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ta.a.jK(this.SM.eA),["maxLength"]:this.hnb};return Q}s1a(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.S3k()};this.dialog=new Kf.a(!1,!1,!0);this.dialog.Dc=1;this.dialog.xf="RenameDialog";this.dialog.Hh(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.Asg,"renameDialogHandler"),Q)}Asg(Q,sa){if(sa&&
1===Q){if(sa[bf.fqc]&&(Q=Ta.a.jK(this.SM.eA),sa=(sa[bf.fqc]||"").trim(),sa!==Q&&""!==sa)){this.ea.zb(mb.a.renameFile,2,sa);return}Zi.a.instance.qb(uh.a.GVb,{["Reason"]:Jk.a.ASh})}}}bf.fqc="txtDocumentName";Object(c.a)(bf,"ReactRenameDialog",null,[1183]);class Il{static get Bf(){return Kf.a.ty(Il.Al,CommonUIStrings.l_RenameDialogLabel)}}Il.Al="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(Il,"RenameDialogHtml",null,[]);class vj extends Kf.a{constructor(Q,sa,db){super();this.ea=Q;this.SM=sa;this.hnb=db;this.xf="RenameDialog";this.Bf=Il.Bf}s1a(){var Q={["txtDocumentName"]:Ta.a.jK(this.SM.eA)};this.Hh(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.Asg,"renameDialogHandler"),Q);Q=document.getElementById(vj.fqc);0<this.hnb&&(Q.maxLength=this.hnb);Q.focus()}Asg(Q,sa){if(1===Q&&(Q=Ta.a.jK(this.SM.eA),sa=(sa[vj.fqc]||"").trim(),sa!==Q&&""!==sa)){this.ea.zb(mb.a.renameFile,
2,sa);return}Zi.a.instance.qb(uh.a.GVb,{["Reason"]:Jk.a.ASh})}}vj.fqc="txtDocumentName";Object(c.a)(vj,"RenameDialog",Kf.a,[1183]);class Ie{constructor(Q){this.VSa=null;this.hnb=0;this.ea=Q;this._initialized=!1}initialize(Q,sa){this.VSa=Q;this.hnb=sa;this._initialized=!0}create(){return this._initialized?M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.tA&&M.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new bf(this.ea,this.VSa,this.hnb):new vj(this.ea,this.VSa,this.hnb):null}}Object(c.a)(Ie,
"RenameDialogFactory",null,[1151]);var Rf=b(213);class Bj{constructor(Q){this.ea=Q}pb(){this.ea.ma(mb.a.rBe,Lc.a.frame,Object(n.a)(this,this.GHm,"showRenameFlyoutAction"))}t9j(){return Rf.appChromeContainsAction("setDocumentTitleFlyoutOpened")&&M.AFrameworkApplication.oa.mb.uA}GHm(Q,sa,db){if(1===db)return this.t9j()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}}Object(c.a)(Bj,"RenameFlyoutActor",null,[1152]);class Jl{constructor(Q,sa,db,Gb,Xb){this.Xdk=
null;this.Se=Xb;this.N5g=db;this.M5g=Gb;this.vNj=Q;this.Wnb=sa}get Uq(){return this.Se.value}K4h(){if(!this.M5g())return 5;if(this.Wnb())return 1;if(this.Uq){if(this.N5g&&!this.Uq.Xzf)return 3;if(!this.N5g&&!this.Uq.BXa)return 4}return this.vNj()?0:2}}Object(c.a)(Jl,"RenameProps",null,[1150]);class $i{constructor(Q,sa,db,Gb,Xb,Xc){this.Fk=!1;this.sZe=new Ya.a;this.igc=sa;this.Xx=db;this.o3a=Gb;this.qa=Xb;this.X5=Xc}enable(){this.Fk||(this.V$i(),this.aGg(),this.Fk=!0)}generateKey(Q,sa,db){return String.format("{0}/{1}/{2}",
db,Q,sa)}BXk(){const Q=Ta.a.jK(this.igc().eA);return this.generateKey(this.igc().breadcrumbFolderName,this.igc().breadcrumbFolderUrl,Q)}CXk(Q,sa,db){return Q&&sa?this.generateKey(Q,sa,db):db}Zuk(Q,sa,db){return Q&&Q!==this.igc().breadcrumbFolderName||sa&&sa!==this.igc().breadcrumbFolderUrl?!0:db!==Ta.a.jK(this.igc().eA)}V$i(){const Q=this.BXk();this.sZe.W(Q,new Date)}Ojg(Q){this.fEm(Q)&&this.$mh(Q)}fEm(Q){const sa=this.o3a();return sa?this.X5&&this.X5.rj||!sa.Aje||!M.AFrameworkApplication.fXa?(this.O3i(Q),
this.Fk=!1):!0:!1}XCi(Q,sa,db,Gb){const Xb=this.Zuk(Q,sa,db);Q=this.CXk(Q,sa,db);sa=this.sZe.tb(Q).returnValue;Xb&&!sa&&(this.K9h(Gb),pa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.n7f));Xb||this.sZe.W(Q,this.Xx())}}Object(c.a)($i,"ARenamedFileChecker",null,[1114]);class Cg extends $i{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){super(Q,sa,db,Gb,Xb,Xc);this.Qt=Xb;this.gHj=zd;this.jUe=ve}get n7f(){return"RenamedFileCheckerUsingSettingsRefresh"}aGg(){this.Qt.rmc(Object(n.a)(this,this.d$h,
"handleSettingsRefresh"))}d$h(Q,sa){sa&&sa.CAb&&sa.Syi&&(sa.Uua("BreadcrumbDocName")||sa.Uua("BreadcrumbFolderName")||sa.Uua("BreadcrumbFolderUrl")||sa.Uua("DirectInvokeDAVUrl")||sa.Uua("EditDocInClientUrl"))&&(pa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.n7f),this.Ojg(sa))}O3i(){this.Qt.EOi(Object(n.a)(this,this.d$h,"handleSettingsRefresh"))}$mh(Q){if(Q&&Q.CAb){const sa=Q.CAb;this.XCi(sa.Oa("BreadcrumbFolderName"),sa.Oa("BreadcrumbFolderUrl"),sa.Oa("BreadcrumbDocName"),
Q)}}K9h(Q){const sa={OperationResult:0,classId:1};Q=Q.CAb;sa.BreadcrumbFolderName=Q.Oa("BreadcrumbFolderName");sa.BreadcrumbFolderUrl=Q.Oa("BreadcrumbFolderUrl");sa.DirectInvokeDavUrl=Q.Oa("DirectInvokeDAVUrl");sa.EditDocInClientUrl=Q.Oa("EditDocInClientUrl");Q=Q.Oa("BreadcrumbDocName");sa.NewName=M.AFrameworkApplication.eqc?Q:Ta.a.jK(Q);this.jUe.execute(db=>{this.tol(sa,db)})}tol(Q,sa){this.gHj().Hud(Q,sa)}}Object(c.a)(Cg,"RenamedFileCheckerUsingSettingsRefresh",$i,[]);class qk extends $i{constructor(Q,
sa,db,Gb,Xb,Xc,zd,ve,yf,cf){super(Q,db,Gb,Xb,Xc,yf);this.wZc=this.K1=null;this.JFj=sa;this.ea=zd;this.Za=ve;cf&&cf.execute(eg=>{this.whm(eg)})}get n7f(){return"RenamedFileCheckerUsingTask"}whm(Q){this.K1=Q;this.K1.smc(Object(n.a)(this,this.gma,"handleVisibilityChange"))}gma(Q,sa){!this.Fk||sa.newState&&1!==sa.newState||this.wZc||(this.aGg(),this.Ojg(this.wZc))}aGg(){this.wZc=new Nb.a(3,2,this.JFj(),Object(n.a)(this,this.Ojg,"performRenameFileCheckTick"),89);this.Za.Cb(this.wZc)}O3i(Q){this.Za.Oe(Q)}$mh(Q){this.K1&&
2===this.K1.S$?this.Sim(Q):M.AFrameworkApplication.fXa(Object(n.a)(this,this.dzc,"onRefreshFilenameSuccess"),Object(n.a)(this,this.nre,"onRefreshFilenameFailure"),!0)}Sim(Q){this.Za.Oe(Q);this.wZc=null}dzc(Q){Q&&this.XCi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}K9h(){this.ea.processAction(mb.a.fileNameUpdate,2)}nre(){}}Object(c.a)(qk,"RenamedFileCheckerUsingTask",$i,[]);class fj{constructor(){this.qa=this.Z=null}get name(){return"Common.App.RenameFile"}Mb(Q){this.Z=Q;this.qa=M.AFrameworkApplication.K;
this.Z.register(Uf,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").hd(()=>new Uf(M.AFrameworkApplication.pa,this.Z.Rd("Common.App.Rename.IRenameDialogFactory"))).fa();this.Z.register(Ie,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").hd(()=>new Ie(M.AFrameworkApplication.pa)).fa();this.Z.register(1114,"Common.App.Rename.IRenamedFileChecker").hd(()=>this.pok()).fa();this.Z.register(Bj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").hd(()=>
new Bj(M.AFrameworkApplication.pa)).fa()}pok(){if(this.qa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.Z.sa("Common.IRefreshableAppSettings");if(Q&&Q.ali)return new Cg(()=>Q.vb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>M.AFrameworkApplication.$q,()=>new Date,()=>M.AFrameworkApplication.Uq,Q,this.Z.sa("Common.ISessionStatus"),()=>cg.instance,this.Z.Da("Postmessage.IHostPostmessenger"))}return new qk(()=>this.qa.vb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.qa.vb("RenamedFileCheckerPingIntervalInMs",
12E4),()=>M.AFrameworkApplication.$q,()=>new Date,()=>M.AFrameworkApplication.Uq,M.AFrameworkApplication.K,M.AFrameworkApplication.pa,M.AFrameworkApplication.Sb,this.Z.sa("Common.ISessionStatus"),this.Z.Da("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.qa.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){const Q=M.AFrameworkApplication.oa.mb.uA;M.AFrameworkApplication.twc()&&re.instance.initialize(M.AFrameworkApplication.hae,Q?null:M.AFrameworkApplication.JNh,Q?null:
M.AFrameworkApplication.OOi||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(Jl,"Common.App.Rename.RenameProps").as("Common.IRenameProps").hd(()=>new Jl(()=>M.AFrameworkApplication.wOg,()=>M.AFrameworkApplication.kr,M.AFrameworkApplication.lCc,M.AFrameworkApplication.twc,new ub.a(()=>M.AFrameworkApplication.Uq))).fa(),cg.instance.pb(),this.qa.$("RenameDialogIsEnabled")&&(this.Z.resolve("Common.App.Rename.RenameDialogFactory").initialize(M.AFrameworkApplication.$q,M.AFrameworkApplication.hae),
this.Z.resolve("Common.App.Rename.IRenameDialogActor").pb()),this.Z.resolve("Common.App.Rename.IRenameFlyoutActor").pb(),M.AFrameworkApplication.lCc&&this.Z.resolve("Common.App.Rename.IRenamedFileChecker").enable())}dispose(){}}Object(c.a)(fj,"PackageManager",null,[1,2]);class dj{static get Bf(){return Kf.a.ty(dj.Al,CommonUIStrings.l_SaveACopyFileName)}}dj.Al="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(dj,"FileNameDialogHtml",null,[]);class wi extends Kf.a{constructor(Q,sa,db,Gb){super();this.VOd=this.rTa=null;this.ea=Q;this.Pxa=sa;this.w2c=db;this.Xd(1,CommonUIStrings.l_SaveButtonLabel);this.Bf=dj.Bf;this.xf="FileNameDialog-SaveACopy";this.Gk=Gb}$Ka(Q,sa,db){this.VOd=Q;this.rTa=db;Q={["txtFileName"]:Ta.a.jK(M.AFrameworkApplication.$q.eA),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,sa)};this.Hh(CommonUIStrings.l_SaveToOneDrive,Object(n.a)(this,this.gae,"fileNameDialogHandler"),
Q);pa.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}gae(Q,sa){1!==Q?pa.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=sa.txtFileName.trim(),pa.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),sa=Ta.a.PXa(M.AFrameworkApplication.fileName),Q&&""!==Q&&""!==sa&&(Q+=sa),this.w2c.QQa(this.VOd,this.rTa,Q,this.Gk))}}Object(c.a)(wi,"FileNameDialog",
Kf.a,[1270]);class ef{constructor(Q,sa,db){this.ea=Q;this.Pxa=sa;this.w2c=db}create(Q){return new wi(this.ea,this.Pxa,this.w2c,Q)}}Object(c.a)(ef,"FileNameDialogFactory",null,[1222]);class he extends Qe.StandardDialog{constructor(Q){super();this.Dc=1;this.Xd(1,CommonUIStrings.l_RetryButtonLabel);this.Xd(0,CommonUIStrings.l_DialogClose);this.ea=Q}rQ(Q){pa.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.pw(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(n.a)(this,this.gvg,"retryDialogHandler"))}gvg(Q){1===Q?(pa.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ea.processAction(mb.a.ZCc,2)):pa.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(c.a)(he,"RetryDialog",Qe.StandardDialog,[1221]);var We=b(191);class nh{constructor(Q,sa,db,Gb){this.LWd=null;this.kIj=Q;this.qa=db;this.rbh=sa;this.g8g=new t.a;this.Jc=Gb}Nwc(){return this.qa.$("SaveToCloudStorageUIIsEnabled")}lub(){return mb.a.twg}R3d(){qa.a.Hyd(Object(n.a)(this,
this.aTi,"saveToCloudActionDispatcher"));qa.a.qcd([new We.a(mb.a.twg,Lc.a.frame,0)],this.rbh.Jsc())}pb(){const Q=this.rbh.Jsc();Q?(Q.KJ(()=>{this.g8g.Ue(!0)}),this.R3d()):pa.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}wLi(){pa.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}aTi(Q,sa,db,Gb,Xb){return sa.contextId!==Lc.a.frame||Q!==this.lub()?2:this.Nwc()?1===db?uj.SessionStatusManager.instance.Hj?8:32:2===db?
(this.wLi(),Xb&&Xb.FileDownloadUrl&&pa.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Jc&&(this.LWd=this.Jc.le("DialogShown","SaveToOneDriveReponseTime")),this.g8g.task.continueWith(()=>{this.LWd&&(this.LWd.stop(),this.LWd=null);this.kIj.start(Xb)}),32):8:8}}Object(c.a)(nh,"SaveToCloudStorageActor",null,[1146]);class Qj extends nh{constructor(Q,sa,db,Gb){super(Q,sa,db,Gb);this.oEj=sa}Nwc(){return this.qa.$("SaveACopyBrsIsEnabled")}lub(){return mb.a.ZCc}R3d(){qa.a.Hyd(Object(n.a)(this,
this.aTi,"saveToCloudActionDispatcher"));qa.a.qcd([new We.a(mb.a.ZCc,Lc.a.frame,0)],this.oEj.Jsc())}wLi(){pa.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(c.a)(Qj,"SaveACopyActor",nh,[]);class Fh{}Fh.default=0;Object(c.a)(Fh,"SaveToCloudErrorCodes",null,[]);class wf{constructor(Q,sa,db,Gb,Xb,Xc){this.Gk=null;this.$Jj=Q;this.wza=sa;this.w2c=db;this.qa=Gb;this.XKd=Xb;this.OH=Xc}start(Q){this.Gk=Q;this.wza.avc?(pa.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.u8j()):(pa.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.MHm())}MHm(){this.$Jj.create().$Ka()}vl(){this.OH().rQ(Fh.default)}u8j(){try{pa.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.qa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.XKd||2===this.XKd)Q={["client_id"]:this.qa.appSettings.UploadToSkyDriveClientId};WL.init(Q);pa.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.onFailure,"onFailure"))}catch(Q){pa.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.vl()}}onSuccess(Q){pa.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.w2c.QQa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Gk)}onFailure(Q){if(Q&&
Q.error){if("user_canceled"===Q.error.code){pa.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}pa.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else pa.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vl()}}Object(c.a)(wf,"SaveToCloudManager",null,[1145]);class Cj extends wf{constructor(Q,sa,db,Gb,Xb,Xc,zd){super(sa,db,Gb,Xb,Xc,zd);this.buj=Q}onSuccess(Q){Q&&
Q.data&&Q.data.folders?(pa.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.buj.create(this.Gk).$Ka(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(pa.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vl())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&pa.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}vl(){pa.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.vl()}}Object(c.a)(Cj,"SaveACopyManager",wf,[]);var yd=b(152);class te{constructor(Q,sa,db,Gb,Xb){this.rTa=this.Ti=this.RMc=null;this.n1=!1;this.Gk=this.P8a=null;this.ncf=Q;this.RHa=sa;this.OH=db;this.Lh=Gb;this.Jc=Xb}Mjb(){this.Lh&&1===this.Lh.state||(this.Ti=this.RHa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Dc=5,this.Ti.hr=!1,this.Ti.rE(CommonUIStrings.l_DefaultDialogTitle,null,null))}dta(){this.Ti&&(this.Ti.close(),this.Ti=
null)}f9(){1!==M.AFrameworkApplication.oa.state&&this.OH().rQ(Fh.default)}Y8b(){pa.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");oa.a.En(this.rTa,oa.a.FEa(3),void 0,"UploadToCloudManager.RedirectToFolder")}X8b(Q){let sa=!1,db=!1;M.AFrameworkApplication.K&&(sa=M.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),db=M.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));pa.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);
if(sa&&db){pa.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Gb={};Gb[zf.a.KBc]="1";Gb[zf.a.documentUrl]=Q;M.AFrameworkApplication.NQ().execute(Xb=>{Xb.xh(Id.a.JVb,Gb)})}else oa.a.En(Q,oa.a.FEa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}QQa(Q,sa,db=null,Gb=null){pa.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Jc&&(this.P8a=this.Jc.le("DialogShown","SaveToOneDriveUploadTime"));this.Mjb();this.rTa=
sa;this.RMc=this.ncf.create(Q,db,Gb);this.Gk=Gb;this.Fla()}Fla(){pa.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.RMc.execute(Object(n.a)(this,this.$Xl,"onSaveToCloudUploadFinished"),Object(n.a)(this,this.ZXl,"onSaveToCloudUploadFailed"))}$Xl(Q){this.dta();this.n1=!1;if(Q&&Q.data&&Q.data.wd){var sa;if(({pz:sa}=la.d(Q.data.wd)).returnValue)if(Q=sa,Q.StatusCode!==yd.a.Yw&&Q.StatusCode!==yd.a.u$c)pa.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),
this.f9();else{pa.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.X8b(Q.NewDocumentUrl):this.Y8b()}catch(db){pa.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",db.toString())}this.Uvd()}else pa.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:md.a.MGd(Q.data.wd)}),this.f9()}else pa.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.f9()}ZXl(Q){5!==Q.data.status&&12!==Q.data.status||this.n1?(pa.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.dta(),this.f9(),this.Uvd()):(pa.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.n1=!0,this.Fla())}Uvd(){this.P8a&&(this.P8a.stop(),this.P8a=null)}}Object(c.a)(te,"UploadToCloudManager",null,[1109]);class me extends te{constructor(Q,sa,db,Gb,Xb,Xc){super(sa,db,Gb,Xb,Xc);this.ea=Q}i2f(){return!!this.Gk&&
!!this.Gk.SaveEntryPoint&&"VersionHistory"===this.Gk.SaveEntryPoint.toString()}f9(){pa.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.i2f()&&this.ea.zb(mb.a.Ywe,2,{["FailureReason"]:"Unknown"});super.f9()}Y8b(){pa.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.i2f()&&this.ea.processAction(mb.a.fAd,2);super.Y8b()}X8b(Q){pa.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.i2f()&&this.ea.processAction(mb.a.fAd,
2);super.X8b(Q)}Fla(){this.Gk&&"true"===this.Gk.SkipSaveToHost?super.Fla():32!==this.ea.processAction(mb.a.Cib,1)?(pa.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.Fla()):this.ea.zb(mb.a.Cib,2,[()=>{pa.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");te.prototype.Fla.call(this)},()=>{pa.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.f9()}])}}Object(c.a)(me,"SaveACopyUploadToCloudManager",te,[]);var pk=b(635),Bi=b(936);class td{constructor(){this.Z=null}get name(){return"Common.App.SaveACopy"}init(){M.AFrameworkApplication.K.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){M.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.Z.resolve("Common.App.SaveACopy.SaveACopyActor").pb()}dispose(){}Mb(Q){this.Z=Q;this.Z.register(me,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").hd(()=>new me(M.AFrameworkApplication.pa,
Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Bi.a).create(),()=>new he(M.AFrameworkApplication.pa),M.AFrameworkApplication.oa,M.AFrameworkApplication.oa.$o)).fa();this.Z.register(ef,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").hd(()=>new ef(M.AFrameworkApplication.pa,M.AFrameworkApplication.oa.mb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).fa();this.Z.register(Qj,"Common.App.SaveACopy.SaveACopyActor").hd(()=>
new Qj(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),M.AFrameworkApplication.K,M.AFrameworkApplication.oa.$o)).fa();this.Z.register(Cj,"Common.App.SaveACopy.SaveACopyManager").hd(()=>new Cj(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),pk.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),M.AFrameworkApplication.K,M.AFrameworkApplication.vaa,
()=>new he(M.AFrameworkApplication.pa))).fa()}static main(){fa.a.instance.kc(new td)}}Object(c.a)(td,"PackageManager",null,[1,2]);var ci=b(34);class Dg extends Qe.StandardDialog{constructor(Q,sa){super();this.ljc=!1;this.tP=null;this.ea=Q;this.sQc=sa;this.Qwa=!1}rQ(Q,sa,db){this.tP=sa;this.ljc=db;pa.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,db);(Q=this.jof(Q))?(this.Dc=0,this.Xd(1,CommonUIStrings.l_DialogClose)):(this.Dc=6,this.Xd(0,CommonUIStrings.l_DialogClose));
Q||pa.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.pw(ci.a.Eqm,this.HSk(Q),this.GSk(Q,sa),Object(n.a)(this,this.gvg,"retryDialogHandler"),!0)}gvg(Q){1===Q?(pa.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.tP?this.ea.zb(mb.a.bBd,2,[this.tP,this.ljc]):this.ea.processAction(mb.a.bBd,2)):pa.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}jof(Q){return 0>Q||6<Q?(pa.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",
Q),0):Q}GSk(Q,sa){Q=this.jof(Q);return this.sQc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,sa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,sa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}HSk(Q){Q=this.jof(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(c.a)(Dg,"ErrorRetryDialog",Qe.StandardDialog,[1143]);class Qi{constructor(Q,sa){this.qa=
Q;this.ea=sa;this.sQc=this.qa.$("SaveToHostWithExtraCharsInFileName")}create(){return new Dg(this.ea,this.sQc)}}Object(c.a)(Qi,"ErrorRetryDialogFactory",null,[1113]);class ti extends Kf.a{constructor(Q,sa,db,Gb,Xb,Xc,zd=null){super();this.e$=null;this.ea=sa;this.Pxa=Gb;this.Q8a=Xc;this.qa=Q;this.OH=Xb;this.Lh=db;this.sQc=this.qa.$("SaveToHostWithExtraCharsInFileName");this.Gk=zd;this.Xd(1,CommonUIStrings.l_SaveButtonLabel)}get oa(){return this.Lh}uMh(Q,sa){this.hoa(1,!!Q&&Q!==sa);this.e$=document.getElementById(ti.zSh);
S.a.addHandler(this.e$,"change",Object(n.a)(this,this.rqe,"onFileNameChange"));S.a.addHandler(this.e$,"input",Object(n.a)(this,this.rqe,"onFileNameChange"));this.e$.focus()}ySh(Q){return this.sQc?(new RegExp("["+this.PQh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.PQh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}PQh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}$Rf(){const Q=Ta.a.jK(M.AFrameworkApplication.$q.eA);this.hoa(1,!!this.e$&&""!==this.e$.value&&this.e$.value!==Q)}rqe(){this.e$&&
window.setTimeout(()=>{this.$Rf()},0)}gae(Q,sa){if(1!==Q)pa.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=sa[ti.zSh];sa=ti.wEi in sa?sa[ti.wEi]:!1;pa.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Ta.a.WLi(Q),sa);const db=Ta.a.PXa(M.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==db||1===this.oa.state?this.ySh(Q)?this.OH.create().rQ(1,Q,sa):this.Q8a.QQa(Q+
db,sa,this.Gk):this.OH.create().rQ(2,Q,sa)}}dispose(){this.e$&&(S.a.removeHandler(this.e$,"change",Object(n.a)(this,this.rqe,"onFileNameChange")),S.a.removeHandler(this.e$,"input",Object(n.a)(this,this.rqe,"onFileNameChange")),this.e$=null);super.dispose()}}ti.zSh="txtFileName";ti.wEi="chkOverwrite";Object(c.a)(ti,"FileNameDialogBase",Kf.a,[]);class Ke{static get Bf(){return Kf.a.ty(Ke.Al,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Ke.Al="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(c.a)(Ke,"FileNameDialogHtml",null,[]);class gi extends ti{constructor(Q,sa,db,Gb,Xb,Xc){super(Q,sa,db,Gb,Xb,Xc);this.Bf=Ke.Bf;this.xf="FileNameDialog-SaveAsToHost"}$Ka(Q,sa){const db=Ta.a.jK(M.AFrameworkApplication.$q.eA);sa={["txtFileName"]:Q||db,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:sa};this.Hh(CommonUIStrings.L_SaveAs,Object(n.a)(this,this.gae,"fileNameDialogHandler"),sa);this.uMh(Q,db)}}Object(c.a)(gi,"FileNameDialog",ti,[1142]);class nf{constructor(Q,sa,
db,Gb,Xb,Xc){this.ea=sa;this.qa=Q;this.Pxa=Gb;this.Q8a=Xc;this.OH=Xb;this.Lh=db}create(){return new gi(this.qa,this.ea,this.Lh,this.Pxa,this.OH,this.Q8a)}}Object(c.a)(nf,"FileNameDialogFactory",null,[1112]);class Dh{constructor(Q,sa,db){this.Q8a=db;this.pRe=sa;this.qa=Q}pb(){2===M.AFrameworkApplication.oa.mb.np?M.AFrameworkApplication.pa.Ia(mb.a.bBd,Lc.a.frame,Object(n.a)(this,this.JSi,"saveAsToHostActionDispatcher"),4):M.AFrameworkApplication.pa.ma(mb.a.bBd,Lc.a.frame,Object(n.a)(this,this.JSi,"saveAsToHostActionDispatcher"))}JSi(Q,
sa,db,Gb,Xb){return sa.contextId!==Lc.a.frame||Q!==mb.a.bBd?2:this.qa.$("SaveAsToHostBrsIsEnabled")?1===db?uj.SessionStatusManager.instance.Hj?8:32:2===db?(pa.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.pRe.create(),Xb&&Object.getType(Xb)===Array&&2===Xb.length?Q.$Ka(Xb[0],!!Xb[1]):Q.$Ka(null,!1),32):8:8}}Object(c.a)(Dh,"SaveAsToHostActor",null,[]);class Rj{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){this.Ti=null;this.ljc=this.n1=!1;this.P8a=this.Gk=this.tP=
null;this.qa=sa;this.I$=this.qa.appSettings.SaveAsToHostWebServiceBase;this.Z3g=Gb;this.RHa=Xb;this.Re=db;this.OH=Xc;this.Jc=ve;this.Lh=zd;this.ea=Q;this.b5a=sa.Oa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Mjb(){1!==this.Lh.state&&(this.Ti=this.RHa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Dc=5,this.Ti.hr=!1,this.Ti.rE(CommonUIStrings.l_DefaultDialogTitle,null,null))}f9(Q=0){1!==this.Lh.state&&this.OH.create().rQ(Q,Ta.a.jK(this.tP),this.ljc)}Y8b(){const Q=this.qa.appSettings.BreadcrumbFolderUrl;
pa.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");oa.a.En(Q,oa.a.FEa(3),void 0,"UploadToHostManager.RedirectToFolder")}X8b(Q){let sa=!1,db=!1;this.qa&&(sa=this.qa.$("SaveACopyIsEnabledForUiHost"),db=this.qa.$("UiHostSupportsDocRebootFeatures"));pa.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);if(sa&&db){pa.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Gb=
{};Gb[zf.a.KBc]="1";Gb[zf.a.documentUrl]=Q;Gb[zf.a.reason]=Ac.a.iwg;M.AFrameworkApplication.NQ().execute(Xb=>{Xb.xh(Id.a.JVb,Gb)})}else oa.a.En(Q,oa.a.FEa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}QQa(Q,sa,db=null){pa.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Z3g&&!this.Z3g()&&this.Re&&(this.Jc&&(this.P8a=this.Jc.le("DialogShown","SaveAsToHostUploadTime")),this.Mjb(),this.ljc=sa,this.tP=Q,(this.Gk=db)&&"true"===this.Gk.SkipSaveToHost?this.E$d():this.Fla())}Fla(){32!==
this.ea.processAction(mb.a.Cib,1)?(pa.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.E$d()):this.ea.zb(mb.a.Cib,2,[()=>{pa.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.E$d()},(Q,sa)=>{pa.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.f9(sa)}])}TZl(Q){this.dta();this.n1=!1;if(Q&&Q.data&&Q.data.wd)if(({pz:sa}=la.d(Q.data.wd)).returnValue)if(Q=
sa,Q.StatusCode!==yd.a.Yw&&Q.StatusCode!==yd.a.u$c){pa.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var sa={};sa.FailureReason=Q.StatusCode.toString();sa.ExtraInfo=Q.ExtraInfo;this.E0a(sa);this.f9(parseInt(Q.ExtraInfo))}else{pa.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.Mtg();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.X8b(Q.NewDocumentUrl):this.Y8b()}catch(db){pa.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
db.toString())}this.Uvd()}else pa.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:md.a.MGd(Q.data.wd)}),this.E0a({["FailureReason"]:"Failed to deserialize response"}),this.f9();else pa.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.E0a({["FailureReason"]:"null response"}),this.f9()}SZl(Q){5!==Q.data.status&&12!==Q.data.status||this.n1?(pa.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,
["HttpStatus"]:Q.data.mf}),this.E0a({["FailureReason"]:Q.data.mf.toString()}),this.dta(),this.f9(),this.Uvd()):(pa.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.n1=!0,this.Gk&&"true"===this.Gk.SkipSaveToHost?this.E$d():this.Fla())}dta(){this.Ti&&(this.Ti.close(),this.Ti=null)}Uvd(){this.P8a&&(this.P8a.stop(),this.P8a=null)}Mtg(){this.Gk&&"VersionHistory"===this.Gk.SaveEntryPoint&&this.ea.processAction(mb.a.fAd,2)}E0a(Q){this.Gk&&"VersionHistory"===this.Gk.SaveEntryPoint&&
this.ea.zb(mb.a.Ywe,2,Q)}E$d(){let Q=this.I$+this.b5a;Q=Qc.a.vp(Q,"qs",Ta.a.mj(M.AFrameworkApplication.zk));Q=Qc.a.vp(Q,"n",Ta.a.mj((new Date).getTime().toString()));Q=Qc.a.vp(Q,"ov",Ta.a.mj(this.ljc.toString()));Q=Qc.a.vp(Q,"fn",Ta.a.mj(this.tP));this.Gk&&this.Gk.FileDownloadUrl&&(Q=Qc.a.vp(Q,"furl",Ta.a.mj(this.Gk.FileDownloadUrl)));this.Re.Ki(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(n.a)(this,this.TZl,"onUploadFinished"),Object(n.a)(this,this.SZl,"onUploadFailed"),
null,void 0,void 0,void 0,void 0,"1")}}Object(c.a)(Rj,"UploadToHostManager",null,[1111]);class se{constructor(){this.Z=null}get name(){return"Common.App.SaveAsToHost"}init(){M.AFrameworkApplication.K.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){M.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&this.Z.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").pb()}Mb(Q){this.Z=Q;this.Z.register(Qi,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").hd(()=>
new Qi(M.AFrameworkApplication.K,M.AFrameworkApplication.pa)).fa();this.Z.register(Rj,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").hd(()=>new Rj(M.AFrameworkApplication.pa,M.AFrameworkApplication.K,M.AFrameworkApplication.je,()=>M.AFrameworkApplication.gi,()=>(new Bi.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),M.AFrameworkApplication.oa,M.AFrameworkApplication.oa.$o)).fa();this.Z.register(nf,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").hd(()=>
new nf(M.AFrameworkApplication.K,M.AFrameworkApplication.pa,M.AFrameworkApplication.oa,M.AFrameworkApplication.oa.mb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).fa();this.Z.register(Dh,"Common.App.SaveAsToHost.SaveAsToHostActor").hd(()=>new Dh(M.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).fa()}dispose(){}static main(){fa.a.instance.kc(new se)}}
Object(c.a)(se,"SaveAsToHostPackage",null,[1,2]);class qf extends Qe.StandardDialog{constructor(){super();this.Dc=0;this.Xd(1,CommonUIStrings.l_DialogClose)}rQ(Q){this.pw(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(c.a)(qf,"ErrorDialog",Qe.StandardDialog,[1221]);var rk=b(182);class Ue extends Qe.StandardDialog{constructor(Q,sa,db){super();this.ea=Q;this.wza=sa;this.Pxa=db;this.Ija=!1;this.Dc=1;this.E0(1);this.Xd(1,CommonUIStrings.l_SignIn);this.Xd(0,
CommonUIStrings.l_SignInToSaveDialogCancelButton)}$Ka(){this.wza.Nph(Object(n.a)(this,this.UCi,"onSignIn"));this.Av(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(n.a)(this,this.Gll,"inputHandler"))}Gll(Q){Q?this.pte():(pa.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())}X$j(){let Q="2";if(this.Pxa)switch(this.Pxa.np){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.wza.bkm(Object(n.a)(this,this.UCi,
"onSignIn"));super.hide()}pte(){const Q=new rk.QueryStringBuilder("Signin.aspx");Q.ue("prompt","1");Q.ue("cbcxt",this.X$j());M.AFrameworkApplication.Jra(Q);oa.a.En(Q.toString(),"LoginWindow",void 0,"SignInDialog")}UCi(){this.uCa&&this.hide();pa.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ea.processAction(mb.a.twg,2)}}Object(c.a)(Ue,"SignInDialog",Qe.StandardDialog,[1271]);class Tc{constructor(Q,sa,db){this.ea=Q;this.wza=sa;this.Pxa=
db}create(){return new Ue(this.ea,this.wza,this.Pxa)}}Object(c.a)(Tc,"SignInDialogFactory",null,[1224]);class Kj{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.I$=Q;this.tP=sa;this.Lgc=db;this.VOd=Gb;this.m5e=Xb;this.b5a=Xc;this.Gk=zd}execute(Q,sa){if(!M.AFrameworkApplication.gi&&M.AFrameworkApplication.je){var db=this.I$+this.b5a;db=Qc.a.vp(db,"fo",Ta.a.mj(this.VOd));db=Qc.a.vp(db,"fn",Ta.a.mj(this.tP));db=Qc.a.vp(db,"qs",Ta.a.mj(this.m5e));db=Qc.a.vp(db,"n",Ta.a.mj((new Date).getTime().toString()));this.Gk&&
this.Gk.FileDownloadUrl&&(db=Qc.a.vp(db,"furl",Ta.a.mj(this.Gk.FileDownloadUrl)));this.Lgc&&(db=Qc.a.vp(db,"fnn",Ta.a.mj(this.Lgc)));M.AFrameworkApplication.je.Ki(db,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,sa,null)}}}Object(c.a)(Kj,"SkyDriveUploadCaller",null,[1141]);class di{constructor(Q){this.qa=Q;this.uQb=Q.appSettings.SkyDriveUploadWebServiceBase;this.tP=Q.appSettings.FileName;this.b5a=Q.Oa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,sa,db){return new Kj(this.uQb,
this.tP,sa,Q,M.AFrameworkApplication.zk,this.b5a,db)}}Object(c.a)(di,"SkydriveUploadCallerFactory",null,[1110]);class rj{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){M.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").pb()}dispose(){}Mb(Q){this.Z=Q;this.Z.register(Tc,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").hd(()=>
new Tc(M.AFrameworkApplication.pa,pk.a.instance,M.AFrameworkApplication.oa.mb)).fa();this.Z.register(di,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").hd(()=>new di(M.AFrameworkApplication.K)).fa();this.Z.register(nh,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").hd(()=>new nh(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
M.AFrameworkApplication.K,M.AFrameworkApplication.oa.$o)).fa();this.Z.register(te,"Common.App.SaveToCloudStorage.UploadToCloudManager").hd(()=>new te(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Bi.a).create(),()=>new qf,M.AFrameworkApplication.oa,M.AFrameworkApplication.oa.$o)).fa();this.Z.register(wf,"Common.App.SaveToCloudStorage.SaveToCloudManager").hd(()=>new wf(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),pk.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
M.AFrameworkApplication.K,M.AFrameworkApplication.vaa,()=>new qf)).fa()}static main(){fa.a.instance.kc(new rj)}}Object(c.a)(rj,"PackageManager",null,[1,2]);class Ag extends Qe.StandardDialog{constructor(){super();this.Dc=0;this.Xd(1,CommonUIStrings.l_DialogClose)}rQ(Q,sa){this.TMh(Q,sa,ci.a.Gqm)}TMh(Q,sa,db){pa.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",db);this.pw(db,Q,sa,null)}rzf(Q,sa){pa.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.pw(ci.a.Iqm,Q,sa,null,!0)}}Object(c.a)(Ag,"ErrorDialog",Qe.StandardDialog,[1049]);class Sj{static get Bf(){return Kf.a.ty(Sj.Al,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Sj.Al="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(c.a)(Sj,"FileNameDialogHtml",null,[]);var fg=b(70);class Bl extends ti{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){super(Q,sa,db,Gb,Xb,Xc,ve);this.Inb=this.M7e=this.BS=null;this.S6j=CommonUIStrings.l_SaveToAnotherFolder;this.Bf=Sj.Bf;this.xf="FileNameDialog-SaveToSharePoint";this.x_c=zd;this.AEj=ve}$Ka(Q){const sa=Ta.a.jK(M.AFrameworkApplication.$q.eA),db=M.AFrameworkApplication.breadcrumbFolderName,Gb=M.AFrameworkApplication.breadcrumbBrandName,Xb={["txtFileName"]:Q||sa};let Xc=CommonUIStrings.L_SaveAs;
2===M.AFrameworkApplication.oa.mb.np&&(Xc=CommonUIStrings.L_SaveACopy);this.Hh(Xc,Object(n.a)(this,this.gae,"fileNameDialogHandler"),Xb);this.uMh(Q,sa);this.yyf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");M.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.BS=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.M7e=Xd.a.e2d(Q,this.BS,"anotherFolderDescribedBy",""),
this.BS.className="WACButton WACDialogButtonNormal",Q=!1,db&&db.length?(this.Nnh(this.BS,this.M7e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Gb,db)),Q=this.LPj(Gb,db)):this.Nnh(this.BS,this.M7e,CommonUIStrings.l_CurrentOnlineFolder),this.YQj(this.BS),this.NPj(this.BS),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.BS,"SaveToAnotherLocationTwo"),pa.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.BS,"SaveToAnotherLocationOne"),S.a.addHandler(this.BS,B.a.click,Object(n.a)(this,this.Cgg,"onSaveToAnotherLocationClick")),S.a.addHandler(this.BS,B.a.vh,Object(n.a)(this,this.DCi,"onSaveToAnotherLocationKeyDown")))}LPj(Q,sa){let db;db=!1;const Gb=document.getElementById("currentLocation");Gb.innerText="";const Xb=this.Y1h(Gb,Q),Xc=this.Y1h(Gb,sa);let zd=255,ve=255;255<Xb+Xc&&(zd=Math.max(238,408-Xb),ve=Math.max(170,408-Xc),db=!0);this.GSj(Gb,Q,ve,sa,zd);return db}Y1h(Q,
sa){const db=document.createElement("div");db.innerText=sa;db.style.visibility="hidden";Q.appendChild(db);sa=db.clientWidth;Q.removeChild(db);return sa}GSj(Q,sa,db,Gb,Xb){sa&&(this.Mnh(Q,sa,db),this.BSj(Q));Gb&&this.Mnh(Q,Gb,Xb)}Mnh(Q,sa,db){const Gb=document.createElement("div");Gb.innerText=sa;Gb.title=sa;Gb.className="SaveToAnotherFolderBreadcrumb";Gb.style.maxWidth=db.toString()+"px";Q.appendChild(Gb)}BSj(Q){const sa=document.createElement("span");sa.id="FolderSeparator";const db=document.createElementNS("http://www.w3.org/2000/svg",
"svg");db.setAttribute("class","SeparatorCaret");const Gb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Gb.setAttribute("points","1 4 1 11 5 7.5");db.appendChild(Gb);sa.appendChild(db);Q.appendChild(sa)}Nnh(Q,sa,db){db=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,db);sa&&(sa.innerText=db);Q.tabIndex=0;Q.setAttribute(Xd.a.lg,Xd.a.a2)}NPj(Q){const sa=document.createElement("span");sa.id="anotherFolderText";sa.innerText=this.S6j;sa.className="AnotherFolderTextSpan";
Q.appendChild(sa)}YQj(Q){const sa=document.createElement("span");sa.className="cui-img-cont-float cui-img-16by16 ";this.Inb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Inb.setAttribute("class","FolderIconSVG");const db=document.createElementNS("http://www.w3.org/2000/svg","path");db.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Inb.appendChild(db);sa.appendChild(this.Inb);Q.appendChild(sa)}DCi(Q){!Q||
Q.keyCode!==fg.a.tq&&Q.keyCode!==fg.a.QId||this.Cgg(Q)}Cgg(){if(this.e$){const Q=Ta.a.PXa(M.AFrameworkApplication.fileName);let sa=this.e$.value;this.hide();sa&&""!==sa&&""!==Q||1===this.oa.state?(""!==Q&&(sa+=Q),this.ySh(sa)?this.OH.create().rQ(1,sa,!1):this.x_c.start(sa,this.AEj)):this.OH.create().rQ(2,sa,!1)}}I$j(Q){this.BS&&this.Inb&&(Q?(this.BS.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.BS,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Inb,"DisabledFolderIconSVG")):(this.BS.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.BS,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Inb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.BS,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Inb,"DisabledFolderIconSVG"))))}$Rf(){super.$Rf();this.I$j(!!this.e$&&""!==this.e$.value)}dispose(){this.BS&&(S.a.removeHandler(this.BS,B.a.click,Object(n.a)(this,this.Cgg,"onSaveToAnotherLocationClick")),S.a.removeHandler(this.BS,B.a.vh,Object(n.a)(this,this.DCi,
"onSaveToAnotherLocationKeyDown")),this.BS=null);super.dispose()}}Object(c.a)(Bl,"FileNameDialog",ti,[1079]);var fe=b(410),ac=b(340),bh=b(1196),Ae=b(1338);class Bk{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(c.a)(Bk,"SaveAsDialogInput",null,[]);class ze{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(c.a)(ze,"SaveLocation",null,[]);var Nh=b(188);class Eg{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf){this.MZe=
null;this.tP="";this.x_c=Q;this.OH=sa;this.Gk=yf;this.Q8a=db;this.Lh=Xb;this.SM=Gb;this.cQb=zd;this.Ikc=ve;Xc&&(this.MZe=new ub.a(()=>new bh.a(Xc.value,null)))}PRk(){const Q=new fe.a(ac.a.lf());Q.W("type","currentHost");return Object.assign(new ze,{folderName:this.SM.breadcrumbFolderName,friendlyPath:this.SM.breadcrumbBrandName,properties:Q})}Ixl(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}f6k(){if(!this.MZe||
!this.cQb)return null;var Q=this.MZe.value.Ve("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.mwi)return null;Q=Q.mwi;const sa=new V.a;let db=0,Gb=0;for(var Xb=0;Xb<Q.length;Xb++){var Xc=Q[Xb];if(!this.Ixl(Xc))continue;db++;if(!Xc.sharepoint_info)continue;const zd=Xc.url,ve=Xc.sharepoint_info.site_url,yf=Xc.title;Xc=Ae.b(Xc,M.AFrameworkApplication.isRtl);if(!(zd&&ve&&yf&&Xc))continue;Gb++;const cf=new fe.a(ac.a.lf());cf.W("type","SharePoint");cf.W("siteUrl",ve);cf.W("folderUrl",zd);Gb++;sa.add(Object.assign(new ze,
{folderName:yf,friendlyPath:Xc,properties:cf}))}Xb=new Map;Xb.set("NumPlaces",Q.length.toString());Xb.set("NumSharepointPlaces",db.toString());Xb.set("placesWithMetadata",Gb.toString());Na.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Xb);0<db&&(Gb?.5>1*Gb/db&&Na.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Na.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return sa}FSk(){const Q=
new V.a;Q.add(this.PRk());const sa=this.f6k();sa&&Q.addRange(sa);return Object.assign(new Bk,{enableMoreLocations:!M.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.tP,extension:Ta.a.PXa(this.SM.eA),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}ESk(){const Q=Object(n.a)(this,this.FSk,"getDialogInput"),sa={};sa.inputPropsCallback=Q;return sa}$Ka(Q){this.tP=Q;this.tP||(this.tP=String.format(CommonUIStrings.l_SaveACopy_Filename,Ta.a.jK(this.SM.eA)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.ESk()};let sa=CommonUIStrings.L_SaveAs;2===this.Lh.mb.np&&(sa=CommonUIStrings.L_SaveACopy);const db=new Kf.a(!1,!1,!0);db.Dc=1;db.xf="SaveAsDialog";db.Xd(1,CommonUIStrings.l_SaveButtonLabel);db.Hh(sa,Object(n.a)(this,this.Cqm,"saveAsDialogHandler"),Q)}hHm(Q,sa){Q&&""!==Q&&""!==sa||1===this.Lh.state?this.Hxl()?this.rEl(Q,sa):(""!==sa&&(Q+=sa),this.x_c.start(Q,this.Gk)):(pa.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.OH.create().rQ(2,
Q,!1))}rEl(Q,sa){Na.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);this.Ikc.e_h(this.Ikc.XHh(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2)).then(db=>{if(db&&0<db.length){const Gb=db[0][zf.a.D3l];db=db[0][zf.a.F3l];if(""!==Gb&&""!==db)this.cQb.QQa(db,Q+sa,Gb,this.Gk),Na.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.OH.create().rQ(0,Q,!1);const Xb=this.lI();Xb&&(Xb.set("SiteUrlAvailable",""===Gb?"false":
"true"),Xb.set("FolderUrlAvailable",""===db?"false":"true"));Na.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Nh.a,{extendedProperties:Xb}))}}else this.OH.create().rQ(0,Q,!1),Na.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(db=>{"Canceled"===db?((db=this.lI())&&db.set("IsCanceled","true"),Na.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Nh.a,{extendedProperties:db}))):
Na.Health.instance.recordKpiFailure("SaveACopySFP",db,!1,!1,null)})}Hxl(){return this.Ikc?this.Ikc.Dli()&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1):(pa.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}lI(){try{return new Map}catch(Q){return null}}Cqm(Q,sa){if(sa&&1===Q){Q=sa.fileName;var db=Ta.a.PXa(this.SM.eA);sa.moreLocationsSelected&&this.hHm(Q,db);if(sa.locationCallback){var Gb=sa.locationCallback();Gb?Gb.properties&&
"currentHost"===Gb.properties.J("type")?this.Q8a.QQa(Q+db,!1,this.Gk):Gb.properties&&"SharePoint"===Gb.properties.J("type")?(sa=Gb.properties.J("siteUrl"),Gb=Gb.properties.J("folderUrl"),this.cQb.QQa(Gb,Q+db,sa,this.Gk)):pa.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):pa.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else pa.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(c.a)(Eg,"ReactSaveAsDialog",null,[1079]);class Oh{constructor(Q,
sa,db,Gb,Xb,Xc,zd,ve=null,yf=null,cf=null){this.ea=sa;this.qa=Q;this.Pxa=Gb;this.Q8a=Xc;this.OH=Xb;this.Lh=db;this.cgh=zd;this.sAj=ve;this.cQb=yf;this.Ikc=cf}create(Q){return this.Lh&&this.Lh.mb.tA?new Eg(this.cgh,this.OH,this.Q8a,M.AFrameworkApplication.$q,this.Lh,this.sAj,this.cQb,this.Ikc,Q):new Bl(this.qa,this.ea,this.Lh,this.Pxa,this.OH,this.Q8a,this.cgh,Q)}}Object(c.a)(Oh,"FileNameDialogFactory",null,[1053]);class Dd{constructor(Q,sa,db,Gb){this.vr=this.wHa=null;this.G4a=Q;this.Lh=db;this.IFj=
Gb;this.mGa=new ub.a(()=>new bh.a(sa.value,Object(n.a)(this,this.Ncb,"getMoreInfoEventReceived")))}get Vre(){this.wHa||(this.mGa.value.Ve("Save As",!0),this.vr&&this.vr.Xha&&this.vr.Xha.length&&(this.wHa=this.mNf(this.vr.Xha)));return this.wHa}start(Q){if(!this.Vre)if(M.AFrameworkApplication.breadcrumbFolderUrl&&M.AFrameworkApplication.breadcrumbFolderUrl.length)this.wHa=M.AFrameworkApplication.breadcrumbFolderUrl;else return pa.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.vr),!1;const sa=this.IFj();sa.XDg();const db=sa.XNf();if(!db)return pa.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.G4a.start((Gb,Xb)=>{sa.hide();Q(Gb,Xb)},()=>{this.ygb(sa)},db,this.wHa);return!0}ygb(Q){Q.hide();pa.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}mNf(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const sa=Q.indexOf("/documents/");return-1!==sa?Q.substring(0,sa+1)+"_layouts/15/onedrive.aspx":""}Ncb(Q){this.vr||
3!==Q.state||(this.vr=Q)}}Object(c.a)(Dd,"OneDriveFilePickerHelper",null,[1052]);class sg extends Kf.a{constructor(){super()}XDg(){this.mIb="FilePickerDialog";this.Bf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.xf="PickerDialog-MsoSp";this.showDialog("",null)}XNf(){return document.getElementById("FilePickerDiv")}VO(){}Yba(){}}Object(c.a)(sg,"PickerDialog",Kf.a,[1051]);class hk{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.qa=Q;this.pRe=db;this.ea=sa;this.x_c=Gb;this.G4a=Xb;this.CXc=Xc;this.mpj=
zd}pb(){const Q=this.G4a.Jsc();Q?Ma.a.Qu||this.qa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ea.Ia(mb.a.$Cc,Lc.a.frame,Object(n.a)(this,this.cTi,"saveToSharePointActionDispatcher"),64):(Q.LZa.continueWith(sa=>{sa.Dg&&this.G4a.nfg(sa)}),this.R3d()):pa.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}R3d(){qa.a.Hyd(Object(n.a)(this,this.cTi,"saveToSharePointActionDispatcher"));qa.a.qcd([new We.a(mb.a.$Cc,Lc.a.frame,0)],this.G4a.Jsc())}get Nwc(){return this.qa.$("SaveToAnotherFolderBrsIsEnabled")}get Pzh(){return this.qa.$("UserCanWriteRelative")}cTi(Q,
sa,db,Gb,Xb){return sa.contextId!==Lc.a.frame||Q!==mb.a.$Cc?2:this.Nwc&&(this.CXc.Vre||this.Pzh)?1===db?uj.SessionStatusManager.instance.Hj?8:this.mpj()?32:8:2===db?(pa.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Xb&&Xb.SaveEntryPoint&&"VersionHistory"===Xb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Pzh?(pa.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.pRe.create(Xb).$Ka(null)):(pa.ULS.sendTraceTag(24524225,216,50,
"No permission save to current folder, show Picker to save to another folder."),this.x_c.start(null,Xb)),32):8:8}}Object(c.a)(hk,"SaveToSharePointActor",null,[]);class Af{constructor(Q,sa,db,Gb){this.Gk=this.s$g=null;this.cQb=Q;this.OH=sa;this.CXc=db;this.Lh=Gb}start(Q,sa){pa.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.s$g=Q;this.Gk=sa;this.CXc.start((db,Gb)=>{this.Twd(db,Gb)})||this.YDg()}Twd(Q,sa){if(Q)this.onSuccess(sa);else this.onFailure(sa)}YDg(){1!==this.Lh.state&&this.OH().rzf(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){pa.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const sa=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let db=null;if(sa&&(db=Q?this.q6k(Q):this.p6k(sa))){this.cQb.QQa(sa,this.s$g,db,this.Gk);return}pa.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!sa,!db)}pa.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.YDg()}p6k(Q){Q.endsWith("/")||(Q+="/");let sa=0;for(let db=0;db<Q.length;db++)if("/"===Q.charAt(db)&&5===++sa)return Q.substr(0,db);return null}q6k(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const sa=Q.lastIndexOf("/");return-1!==sa?Q.substring(0,sa):null}onFailure(Q){pa.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?pa.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
Q.error.errorCode,Q.error.message):pa.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.YDg()}}Object(c.a)(Af,"SaveToSharePointManager",null,[1227]);class le{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){this.I$=Q;this.tP=sa;this.Lgc=Gb;this.m5e=Xc;this.rTa=db;this.hKj=Xb;this.b5a=zd;this.Gk=ve}execute(Q,sa){if(!M.AFrameworkApplication.gi&&M.AFrameworkApplication.je){var db=this.I$+this.b5a;db=Qc.a.vp(db,"fu",Ta.a.mj(this.rTa));db=Qc.a.vp(db,"su",Ta.a.mj(this.hKj));db=Qc.a.vp(db,"fn",
Ta.a.mj(this.tP));db=Qc.a.vp(db,"n",Ta.a.mj((new Date).getTime().toString()));this.Gk&&this.Gk.FileDownloadUrl&&(db=Qc.a.vp(db,"furl",Ta.a.mj(this.Gk.FileDownloadUrl)));db=db+"&"+this.m5e;this.Lgc&&this.Lgc.length?db=Qc.a.vp(db,"fnn",Ta.a.mj(this.Lgc)):pa.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");pa.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");M.AFrameworkApplication.je.Ki(db,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,Q,sa,null,void 0,void 0,void 0,void 0,"9")}}}Object(c.a)(le,"SharePointSaveAsCaller",null,[1275]);class Cl{constructor(Q){this.uQb=Q.appSettings.SaveAsToHostWebServiceBase;this.tP=Q.appSettings.FileName;this.b5a=Q.Oa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,sa,db,Gb){return new le(this.uQb,this.tP,Q,sa,db,M.AFrameworkApplication.zk,this.b5a,Gb)}}Object(c.a)(Cl,"SharePointUploadCallerFactory",null,[1226]);var Ph=b(1225);class mn{constructor(Q,sa,db,Gb,Xb){this.Ti=this.RMc=
null;this.DJe=!1;this.G7e=this.rTa=null;this.ncf=sa;this.RHa=db;this.OH=Gb;this.Lh=Xb;this.ea=Q}QQa(Q,sa,db,Gb){this.DJe=!1;pa.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Mjb();this.rTa=Q;Gb&&Gb.SaveEntryPoint&&(this.G7e=Gb.SaveEntryPoint);this.RMc=this.ncf.create(Q,sa,db,Gb);Gb&&"true"===Gb.SkipSaveToHost?this.Fla():this.pJk()}pJk(){const Q=()=>{pa.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.Fla()};32!==this.ea.zb(mb.a.Cib,2,[()=>{pa.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Fla()},Q])&&Q()}Fla(){pa.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.RMc.execute(Object(n.a)(this,this.bYl,"onSaveToSharePointUploadFinished"),Object(n.a)(this,this.aYl,"onSaveToSharePointUploadFailed"))}bYl(Q){if(Q&&Q.data&&Q.data.wd){var sa;if(({pz:sa}=la.d(Q.data.wd)).returnValue)if(sa.StatusCode!==yd.a.Yw&&sa.StatusCode!==
yd.a.u$c)pa.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,sa.StatusCode),sa.StatusCode!==yd.a.$we&&this.uNh(Q.data.status)||(this.E0a(sa.StatusCode.toString()),this.sGm(sa.StatusCode));else{pa.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.Mtg();try{sa.NewDocumentUrl?this.X8b(sa.NewDocumentUrl):this.Y8b()}catch(db){pa.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
db.toString())}}else pa.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:md.a.MGd(Q.data.wd)}),this.g9d()||(this.E0a("Failed to deserialize response"),this.fEd())}else pa.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.g9d()||(this.E0a("Unknown"),this.fEd())}aYl(Q){Q&&Q.data?this.uNh(Q.data.status)||(pa.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.E0a(Ph.a[Q.data.status]),this.fEd()):(pa.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.g9d()||(this.E0a("Unknown"),this.fEd()))}g9d(){if(!this.DJe)return pa.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.DJe=!0,this.Fla(),!0;pa.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}uNh(Q){pa.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.g9d()}Y8b(){pa.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");oa.a.En(this.rTa,oa.a.FEa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}X8b(Q){let sa=
!1,db=!1;M.AFrameworkApplication.K&&(sa=M.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),db=M.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));pa.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,sa);if(sa&&db){pa.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Gb={};Gb[zf.a.KBc]="1";Gb[zf.a.documentUrl]=Q;Gb[zf.a.reason]=Ac.a.iwg;M.AFrameworkApplication.NQ().execute(Xb=>
{Xb.xh(Id.a.JVb,Gb)})}else oa.a.En(Q,oa.a.FEa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Mjb(){this.Lh&&1===this.Lh.state||(this.Ti=this.RHa(),this.Ti.message=CommonUIStrings.l_CommentProgressTooltip,this.Ti.Dc=5,this.Ti.hr=!1,this.Ti.rE(CommonUIStrings.l_DefaultDialogTitle,null,null))}dta(){this.Ti&&(this.Ti.close(),this.Ti=null)}fEd(){this.vl(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}iHm(){this.vl(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}wGm(){const Q=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vl(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,ci.a.Dqm)}vl(Q,sa,db=ci.a.Hqm){pa.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,sa);this.dta();1!==this.Lh.state&&this.OH().TMh(Q,sa,db)}sGm(Q){pa.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case yd.a.eHc:this.iHm();break;case yd.a.$we:this.wGm();break;default:this.fEd()}}Mtg(){"VersionHistory"===this.G7e&&this.ea.processAction(mb.a.fAd,
2)}E0a(Q){"VersionHistory"===this.G7e&&this.ea.zb(mb.a.Ywe,2,{["FailureReason"]:Q})}}Object(c.a)(mn,"UploadToSharePointManager",null,[1104]);var Fi=b(462),Kk=b(105);class Lj{constructor(){this.a0c=this.CTd=this.xTd=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Mb(Q){this.Z=Q;this.xTd=Fi.a.Wp(Q.Da("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.CTd=Fi.a.Wp(Q.Da("Common.IEventEmitter<Common.IMruResult>"));M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)?(this.a0c=Fi.a.Wp(Q.Da("Common.App.SharedFilePicker.ISharedFilePicker")),Kk.Task.WAA.call(null,this.xTd,this.CTd,this.a0c).continueWith(()=>{this.mMi()})):(this.a0c=null,Kk.Task.WAA.call(null,this.xTd,this.CTd).continueWith(()=>{this.mMi()}))}mMi(){this.Z.register(Cl,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").hd(()=>new Cl(M.AFrameworkApplication.K)).fa();this.Z.register(mn,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").hd(()=>
new mn(M.AFrameworkApplication.pa,this.Z.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Bi.a).create(),()=>new Ag,M.AFrameworkApplication.oa)).fa();this.Z.register(Af,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").hd(()=>new Af(this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ag,this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),M.AFrameworkApplication.oa)).fa();
this.Z.register(Dd,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").hd(()=>new Dd(this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new ub.a(()=>this.xTd.result),M.AFrameworkApplication.oa,()=>new sg)).fa();this.Z.register(Oh,"Common.App.SaveToSharePoint.FileNameDialogFactory").hd(()=>new Oh(M.AFrameworkApplication.K,M.AFrameworkApplication.pa,M.AFrameworkApplication.oa,M.AFrameworkApplication.oa.mb,
this.Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Z.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new ub.a(()=>this.CTd.result),this.Z.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.a0c?this.a0c.result:null)).fa();this.Z.register(hk,"Common.App.SaveToSharePoint.SaveToSharePointActor").hd(()=>new hk(M.AFrameworkApplication.K,M.AFrameworkApplication.pa,this.Z.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.Z.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Z.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>M.AFrameworkApplication.oa.A9j)).fa();M.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").pb()}static main(){fa.a.instance.kc(new Lj)}}Object(c.a)(Lj,"PackageManager",null,[1,2]);class il{}Object(c.a)(il,
"StringDifference",null,[1225]);class xd{constructor(Q,sa){this.charCode=Q;this.description=sa}}Object(c.a)(xd,"UBTableEntry",null,[]);class lg{}new xd(8,"C0 Controls 1");new xd(9,"Horizontal tab (HT)");new xd(10,"Line feed (LF)");new xd(12,"C0 Controls 2");new xd(13,"Carriage return (CR)");new xd(31,"C0 Controls 3");new xd(32,"Space");new xd(47,"ASCII Punctuation and Symbols 1");new xd(57,"ASCII Digits");new xd(64,"ASCII Punctuation and Symbols 2");new xd(90,"Uppercase Latin Alphabet");new xd(96,
"ASCII Punctuation and Symbols 3");new xd(122,"Lowercase Latin Alphabet");new xd(127,"U+0000..U+007F Basic Latin");new xd(159,"C1 Controls");new xd(160,"NB Space");new xd(191,"Latin-1 Punctuation and Symbols");new xd(255,"U+0080..U+00FF Latin-1 Supplement");new xd(383,"U+0100..U+017F Latin Extended-A");new xd(591,"U+0180..U+024F Latin Extended-B");new xd(687,"U+0250..U+02AF IPA Extensions");new xd(767,"U+02B0..U+02FF Spacing Modifier Letters");new xd(879,"U+0300..U+036F Combining Diacritical Marks");
new xd(1023,"U+0370..U+03FF Greek and Coptic");new xd(1279,"U+0400..U+04FF Cyrillic");new xd(1327,"U+0500..U+052F Cyrillic Supplement");new xd(1423,"U+0530..U+058F Armenian");new xd(1535,"U+0590..U+05FF Hebrew");new xd(1791,"U+0600..U+06FF Arabic");new xd(1871,"U+0700..U+074F Syriac");new xd(1919,"U+0750..U+077F Arabic Supplement");new xd(1983,"U+0780..U+07BF Thaana");new xd(2047,"U+07C0..U+07FF NKo");new xd(2111,"U+0800..U+083F Samaritan");new xd(2143,"U+0840..U+085F Mandaic");new xd(2303,"U+08A0..U+08FF Arabic Extended-A");
new xd(2431,"U+0900..U+097F Devanagari");new xd(2559,"U+0980..U+09FF Bengali");new xd(2687,"U+0A00..U+0A7F Gurmukhi");new xd(2815,"U+0A80..U+0AFF Gujarati");new xd(2943,"U+0B00..U+0B7F Oriya");new xd(3071,"U+0B80..U+0BFF Tamil");new xd(3199,"U+0C00..U+0C7F Telugu");new xd(3327,"U+0C80..U+0CFF Kannada");new xd(3455,"U+0D00..U+0D7F Malayalam");new xd(3583,"U+0D80..U+0DFF Sinhala");new xd(3711,"U+0E00..U+0E7F Thai");new xd(3839,"U+0E80..U+0EFF Lao");new xd(4095,"U+0F00..U+0FFF Tibetan");new xd(4255,
"U+1000..U+109F Myanmar");new xd(4351,"U+10A0..U+10FF Georgian");new xd(4607,"U+1100..U+11FF Hangul Jamo");new xd(4991,"U+1200..U+137F Ethiopic");new xd(5023,"U+1380..U+139F Ethiopic Supplement");new xd(5119,"U+13A0..U+13FF Cherokee");new xd(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new xd(5791,"U+1680..U+169F Ogham");new xd(5887,"U+16A0..U+16FF Runic");new xd(5919,"U+1700..U+171F Tagalog");new xd(5951,"U+1720..U+173F Hanunoo");new xd(5983,"U+1740..U+175F Buhid");new xd(6015,"U+1760..U+177F Tagbanwa");
new xd(6143,"U+1780..U+17FF Khmer");new xd(6319,"U+1800..U+18AF Mongolian");new xd(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new xd(6479,"U+1900..U+194F Limbu");new xd(6527,"U+1950..U+197F Tai Le");new xd(6623,"U+1980..U+19DF New Tai Lue");new xd(6655,"U+19E0..U+19FF Khmer Symbols");new xd(6687,"U+1A00..U+1A1F Buginese");new xd(6831,"U+1A20..U+1AAF Tai Tham");new xd(7039,"U+1B00..U+1B7F Balinese");new xd(7103,"U+1B80..U+1BBF Sundanese");new xd(7167,"U+1BC0..U+1BFF Batak");
new xd(7247,"U+1C00..U+1C4F Lepcha");new xd(7295,"U+1C50..U+1C7F Ol Chiki");new xd(7375,"U+1CC0..U+1CCF Sundanese Supplement");new xd(7423,"U+1CD0..U+1CFF Vedic Extensions");new xd(7551,"U+1D00..U+1D7F Phonetic Extensions");new xd(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new xd(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new xd(7935,"U+1E00..U+1EFF Latin Extended Additional");new xd(8191,"U+1F00..U+1FFF Greek Extended");new xd(8303,"U+2000..U+206F General Punctuation");
new xd(8351,"U+2070..U+209F Superscripts and Subscripts");new xd(8399,"U+20A0..U+20CF Currency Symbols");new xd(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new xd(8527,"U+2100..U+214F Letterlike Symbols");new xd(8591,"U+2150..U+218F Number Forms");new xd(8703,"U+2190..U+21FF Arrows");new xd(8959,"U+2200..U+22FF Mathematical Operators");new xd(9215,"U+2300..U+23FF Miscellaneous Technical");new xd(9279,"U+2400..U+243F Control Pictures");new xd(9311,"U+2440..U+245F Optical Character Recognition");
new xd(9471,"U+2460..U+24FF Enclosed Alphanumerics");new xd(9599,"U+2500..U+257F Box Drawing");new xd(9631,"U+2580..U+259F Block Elements");new xd(9727,"U+25A0..U+25FF Geometric Shapes");new xd(9983,"U+2600..U+26FF Miscellaneous Symbols");new xd(10175,"U+2700..U+27BF Dingbats");new xd(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new xd(10239,"U+27F0..U+27FF Supplemental Arrows-A");new xd(10495,"U+2800..U+28FF Braille Patterns");new xd(10623,"U+2900..U+297F Supplemental Arrows-B");
new xd(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new xd(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new xd(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new xd(11359,"U+2C00..U+2C5F Glagolitic");new xd(11391,"U+2C60..U+2C7F Latin Extended-C");new xd(11519,"U+2C80..U+2CFF Coptic");new xd(11567,"U+2D00..U+2D2F Georgian Supplement");new xd(11647,"U+2D30..U+2D7F Tifinagh");new xd(11743,"U+2D80..U+2DDF Ethiopic Extended");new xd(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new xd(11903,"U+2E00..U+2E7F Supplemental Punctuation");new xd(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new xd(12255,"U+2F00..U+2FDF Kangxi Radicals");new xd(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new xd(12351,"U+3000..U+303F CJK Symbols and Punctuation");new xd(12447,"U+3040..U+309F Hiragana");new xd(12543,"U+30A0..U+30FF Katakana");new xd(12591,"U+3100..U+312F Bopomofo");new xd(12687,"U+3130..U+318F Hangul Compatibility Jamo");new xd(12703,"U+3190..U+319F Kanbun");new xd(12735,
"U+31A0..U+31BF Bopomofo Extended");new xd(12783,"U+31C0..U+31EF CJK Strokes");new xd(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new xd(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new xd(13311,"U+3300..U+33FF CJK Compatibility");new xd(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new xd(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new xd(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new xd(42127,"U+A000..U+A48F Yi Syllables");new xd(42191,"U+A490..U+A4CF Yi Radicals");
new xd(42239,"U+A4D0..U+A4FF Lisu");new xd(42559,"U+A500..U+A63F Vai");new xd(42655,"U+A640..U+A69F Cyrillic Extended-B");new xd(42751,"U+A6A0..U+A6FF Bamum");new xd(42783,"U+A700..U+A71F Modifier Tone Letters");new xd(43007,"U+A720..U+A7FF Latin Extended-D");new xd(43055,"U+A800..U+A82F Syloti Nagri");new xd(43071,"U+A830..U+A83F Common Indic Number Forms");new xd(43135,"U+A840..U+A87F Phags-pa");new xd(43231,"U+A880..U+A8DF Saurashtra");new xd(43263,"U+A8E0..U+A8FF Devanagari Extended");new xd(43311,
"U+A900..U+A92F Kayah Li");new xd(43359,"U+A930..U+A95F Rejang");new xd(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new xd(43487,"U+A980..U+A9DF Javanese");new xd(43615,"U+AA00..U+AA5F Cham");new xd(43647,"U+AA60..U+AA7F Myanmar Extended-A");new xd(43743,"U+AA80..U+AADF Tai Viet");new xd(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new xd(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new xd(44031,"U+ABC0..U+ABFF Meetei Mayek");new xd(55215,"U+AC00..U+D7AF Hangul Syllables");new xd(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new xd(56191,"U+D800..U+DB7F High Surrogates");new xd(56319,"U+DB80..U+DBFF High Private Use Surrogates");new xd(57343,"U+DC00..U+DFFF Low Surrogates");new xd(63743,"U+E000..U+F8FF Private Use Area");new xd(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new xd(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new xd(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new xd(65039,"U+FE00..U+FE0F Variation Selectors");new xd(65055,"U+FE10..U+FE1F Vertical Forms");new xd(65071,"U+FE20..U+FE2F Combining Half Marks");
new xd(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new xd(65135,"U+FE50..U+FE6F Small Form Variants");new xd(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new xd(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new xd(65535,"U+FFF0..U+FFFF Specials");new xd(65663,"U+10000..U+1007F Linear B Syllabary");new xd(65791,"U+10080..U+100FF Linear B Ideograms");new xd(65855,"U+10100..U+1013F Aegean Numbers");new xd(65935,"U+10140..U+1018F Ancient Greek Numbers");new xd(65999,"U+10190..U+101CF Ancient Symbols");
new xd(66047,"U+101D0..U+101FF Phaistos Disc");new xd(66207,"U+10280..U+1029F Lycian");new xd(66271,"U+102A0..U+102DF Carian");new xd(66351,"U+10300..U+1032F Old Italic");new xd(66383,"U+10330..U+1034F Gothic");new xd(66463,"U+10380..U+1039F Ugaritic");new xd(66527,"U+103A0..U+103DF Old Persian");new xd(66639,"U+10400..U+1044F Deseret");new xd(66687,"U+10450..U+1047F Shavian");new xd(66735,"U+10480..U+104AF Osmanya");new xd(67647,"U+10800..U+1083F Cypriot Syllabary");new xd(67679,"U+10840..U+1085F Imperial Aramaic");
new xd(67871,"U+10900..U+1091F Phoenician");new xd(67903,"U+10920..U+1093F Lydian");new xd(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new xd(68095,"U+109A0..U+109FF Meoritic Cursive");new xd(68191,"U+10A00..U+10A5F Kharoshthi");new xd(68223,"U+10A60..U+10A7F Old South Arabian");new xd(68415,"U+10B00..U+10B3F Avestan");new xd(68447,"U+10B40..U+10B5F Inscriptional Parthian");new xd(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new xd(68687,"U+10C00..U+10C4F Old Turkic");new xd(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new xd(69759,"U+11000..U+1107F Brahmi");new xd(69839,"U+11080..U+110CF Kaithi");new xd(69887,"U+110D0..U+110FF Sora Sompeng");new xd(69967,"U+11100..U+1114F Chakma");new xd(70111,"U+11180..U+111DF Sharada");new xd(71375,"U+11680..U+116CF Takri");new xd(74751,"U+12000..U+123FF Cuneiform");new xd(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new xd(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new xd(92735,"U+16800..U+16A3F Bamum Supplement");new xd(94111,"U+16F00..U+16F9F Miao");new xd(110847,
"U+1B000..U+1B0FF Kana Supplement");new xd(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new xd(119295,"U+1D100..U+1D1FF Musical Symbols");new xd(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new xd(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new xd(119679,"U+1D360..U+1D37F Counting Rod Numerals");new xd(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new xd(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new xd(127023,"U+1F000..U+1F02F Mahjong Tiles");
new xd(127135,"U+1F030..U+1F09F Domino Tiles");new xd(127231,"U+1F0A0..U+1F0FF Playing Cards");new xd(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new xd(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new xd(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new xd(128591,"U+1F600..U+1F64F Emoticons");new xd(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new xd(128895,"U+1F700..U+1F77F Alchemical Symbols");new xd(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new xd(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new xd(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new xd(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new xd(917631,"U+E0000..U+E007F Tags");new xd(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new xd(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new xd(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(c.a)(lg,"UnicodeBlocks",null,[1108]);class cd{constructor(){this.Z=
null}Mb(Q){this.Z=Q;this.Z.register(il,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").fa();this.Z.register(lg,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").fa()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve("Common.App.SensitiveLogging.IStringDifference");this.Z.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){fa.a.instance.kc(new cd)}}Object(c.a)(cd,
"SensitiveLoggingPackage",null,[1,2]);var Pf;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder"})(Pf||(Pf={}));Object(c.b)("SharedFilePickerLandingLocation",Pf);class sk{constructor(Q){this.J_b=this.zAc=null;this._initialized=!1;this.eUf=Q}UBf(Q){this._initialized||(Q.Xv(Id.a.cLi),Q.VC(Id.a.cLi,Object(n.a)(this,this.kXl,"onReceivedPickerResponse")),this._initialized=!0)}e_h(Q){return this.J_b=new Promise((sa,db)=>{const Gb={};Gb[zf.a.B3l]=Q;this.zAc=
(Xb,Xc)=>{""===Xc?(pa.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),sa(Xb)):("Canceled"===Xc?pa.ULS.sendTraceTag(572548164,306,50,Xc):pa.ULS.sendTraceTag(556901065,306,10,Xc),db(Xc))};this.eUf.execute(Xb=>{this.UBf(Xb);Xb.xh(Id.a.L_l,Gb)})})}kXl(Q){this.zAc(Q.Values[zf.a.wsm],void 0===Q.Values[zf.a.Sjg]||null===Q.Values[zf.a.Sjg]?"":Q.Values[zf.a.Sjg])}Dli(){return M.AFrameworkApplication.K.$("UiHostCommonFilePicker")}XHh(Q,sa,db,Gb,Xb,Xc,zd,ve,yf=null){const cf={};cf[zf.a.csm]=
Q;cf[zf.a.titleText]=sa;cf[zf.a.mXj]=db;cf[zf.a.nXj]=Gb;cf[zf.a.oXj]=Xb;cf[zf.a.qwk]=!0;cf[zf.a.LEk]=Xc;cf[zf.a.H3l]=zd;cf[zf.a.G3l]=Pf[ve];yf&&(null!=yf.O1d&&(cf[zf.a.O1d]=yf.O1d),null!=yf.mld&&(cf[zf.a.mld]=yf.mld));return cf}}Object(c.a)(sk,"SharedFilePickerManager",null,[1107]);class jl{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}Mb(Q){this.Z=Q;Q.register(sk,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").fa().hd(()=>
new sk(Q.Da("Postmessage.IHostPostmessenger")))}init(){M.AFrameworkApplication.K.Qo(()=>{this.m0b()})}m0b(){this.Z.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){fa.a.instance.kc(new jl)}}Object(c.a)(jl,"SharedFilePickerPackage",null,[1,2]);class Sb extends Sys.EventArgs{constructor(Q){super();this.pOl=Q}}Object(c.a)(Sb,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class Th{}Object(c.a)(Th,"TypingSpeedMeterWindow",null,[]);class Gi{constructor(Q,sa,db,Gb,
Xb){this.Sag=null;this.qXg=this.EZd=this.zaf=this.yyc=0;this.Dbf=new m.a;this.Xx=Q;this.Sd=sa;this.Sd.i1d(Object(n.a)(this,this.H6b,"onCpuMeterFrameAvailable"));this.QMj=db;this.CBj=Xb;this.nMj=Gb}oVj(Q){this.Dbf.addHandler("TypingSpeedWindowAvailable",Q)}Ikm(Q){this.Dbf.removeHandler("TypingSpeedWindowAvailable",Q)}H6b(Q,sa){this.Sag=sa.ctd}mni(){var Q=this.Xx();Q-this.EZd>this.nMj&&this.LQi();this.yyc||(this.zaf=Q);this.EZd=Q;this.yyc++;this.yyc>=this.CBj&&(this.Dbf.raiseEvent("TypingSpeedWindowAvailable",
new Sb(this.ozh())),Q=new Th,Q.TS=this.ozh(),this.Sag&&(Q.CP=this.Sag.CP),Q.EC=this.qXg,this.QMj.track(Q),this.LQi())}LQi(){this.EZd=this.zaf=this.yyc=0}ozh(){return 2>this.yyc?0:Math.round(6E4*(this.yyc-1)/(this.EZd-this.zaf))}ZYm(Q){this.qXg=Q}dispose(){this.Sd.jsg(Object(n.a)(this,this.H6b,"onCpuMeterFrameAvailable"))}}Object(c.a)(Gi,"TypingSpeedMeter",null,[1139]);class Lk{constructor(Q){this.UPb=null;this.wq=new t.a;this.Xx=Q}initialize(Q,sa,db,Gb){this.UPb||(this.UPb=new Gi(this.Xx,Q,sa,db,
Gb),this.wq.Ue(this.UPb));return this.UPb}}Object(c.a)(Lk,"TypingSpeedMeterProvider",null,[1106]);class Dj{constructor(){this.Cbf=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(M.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=za.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),sa=Fi.a.Wp(za.a.instance.Da("Common.ICpuMeterProvider"));sa.continueWith(()=>{const db=sa.result.wq.task;var Gb=new Aa.a(M.AFrameworkApplication.K.vb("TypingSpeedMeterWindowSamplingPercent",
0)/100);Gb=new Da.a(Object(n.a)(Gb,Gb.SDa,"shouldBeInSample"));const Xb=Y.a.kA(12,1,Gb),Xc=M.AFrameworkApplication.K.vb("TypingSpeedMeterWindowTimeoutMs",5E3),zd=M.AFrameworkApplication.K.vb("TypingSpeedMeterMaxKeystrokesPerWindow",5);db.CWR(()=>this.Cbf=Q.initialize(db.result,Xb,Xc,zd))})}}dispose(){this.Cbf&&this.Cbf.dispose()}Mb(Q){Q.register(Lk,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").fa().hd(()=>new Lk(oa.a.Ze))}static main(){fa.a.instance.kc(new Dj)}}
Object(c.a)(Dj,"TypingSpeedMeterPackage",null,[1,2]);class bl{create(Q){return new Aa.a(Q)}}Object(c.a)(bl,"RandomSamplerFactory",null,[994]);var If=b(11),eo=b(1052);class ql{constructor(Q,sa,db,Gb,Xb){Q.zqh(()=>{Gb.Wzd()});Q.Gqh((Xc,zd)=>{Gb.Tzd(zd.revisionId,zd.FOa)});Q.n1d((Xc,zd)=>{Gb.sil(zd.CRi,zd.FOa,zd.GDe)});Q.yqh(()=>{Gb.qtg()});sa.kVj((Xc,zd)=>{Gb.VPm(zd.BPi,zd.DDe,zd.actualValue)});sa.jUj((Xc,zd)=>{Gb.UPm(zd.BPi,zd.DDe,zd.actualValue)});Xb.X3c(()=>{Gb.fHd()});db.n6((Xc,zd)=>{6===zd.type&&
Gb.VCc(zd.z9)})}}Object(c.a)(ql,"EventForwarder",null,[]);class Mk{constructor(Q,sa,db){this.MCj=Q;this.xV=db;this.slc=sa}create(Q,sa){return new ql(this.MCj,this.slc,Q,sa,this.xV)}}Object(c.a)(Mk,"EventForwarderFactory",null,[]);var Gh=b(319);class Ck{}Ck.$Tm="TypingToOutboundReplicationStart";Ck.f0l="OutboundReplicationStartToOutboundReplicationEnd";Ck.nSi="RtcNotificationToInboundReplicationEnd";Ck.c$i="TypingToInboundReplicationEnd";Object(c.a)(Ck,"PerfTrackerPhases",null,[]);class Um{constructor(Q,
sa,db,Gb,Xb,Xc,zd,ve,yf=null){this.B_e=this.r8g=!1;this.z1e=5;this.E9g=50;this.a0e=20;this.vZe=this.O_e=this.UEa=null;this.sOc=this.fOc=0;this.V9e=this.Z$e=!1;this.hZd=Array(7);this.iLc=null;this.T1g=!1;this.PLe=null;this.CFj={};this.pQd=Q;this.Z3a=sa;this.tBj=db;this.k3g=Gb.create(Ck.nSi,Xb,Xc,20,!1);this.e_d=Gb.create(Ck.c$i,zd,ve,20,!0);if(this.qa=M.AFrameworkApplication.K)this.r8g=this.qa.$("LogSteppedInboundFrameIsEnabled"),this.B_e=this.qa.$("LogTasksDetailsFromCPUMeterIsEnabled"),this.a0e=
this.qa.vb("InboundFrameMaxNumberOfLongRunningTasks",20),this.E9g=this.qa.vb("InboundFrameMinLengthForLongRunningTasksInMs",50),this.z1e=this.qa.vb("InboundFrameNumberOfLastShortTasks",5);this.LHb=yf}get Lak(){null==this.PLe&&(this.PLe=!!this.qa&&this.qa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.PLe}get Hna(){return this.CFj}initialize(Q){this.UEa=Q}pmm(Q,sa,db=null){this.OBh();pa.ULS.shipAssertTag(8229761,324,0<Q.length);let Gb=!1;for(const Xc of Q){const zd=Xc.toString();
if(zd in this.Hna){var Xb=this.Hna[zd];if(!Xb.uDc){Xb.pVi(Q,sa,db);if(this.B_e&&!Gb){const ve=this.IDk(),yf=this.GLk(this.iLc);Gb=!0;this.esi(Xc.toString(),Xb,ve,this.vZe,this.hZd,yf)}else this.esi(Xc.toString(),Xb,null,null,this.hZd,null);delete this.Hna[zd]}}else Xb=this.pQd.create(this.k3g,this.e_d),Xb.pVi(Q,sa),this.Hna[zd]=Xb}this.V9e=!1}VCc(Q){pa.ULS.shipAssertTag(8257930,304,Q.Imi,"Expected data not sent on the wire");if(Q.Imi){if(Q.Bxe in this.Hna){var sa=this.Hna[Q.Bxe];sa.Rxe||(sa.VCc(Q.revisionId,
Q.fEi,Q.c0i,Q.FOa),delete this.Hna[Q.Bxe])}else sa=this.pQd.create(this.k3g,this.e_d),sa.VCc(Q.revisionId,Q.fEi,Q.c0i,Q.FOa),this.Hna[Q.Bxe]=sa;this.OBh()}}xjl(){this.Z$e||(this.O_e=Array(this.a0e),this.vZe=Array(this.z1e),this.sOc=this.fOc=0,this.hZd=[0,0,0,0,0,0,0,0],this.iLc=Array(3),this.iLc[1]=[0,0],this.iLc[2]=[0,0],this.Z$e=!0)}yEm(Q){return!Q.TP&&Q.TN===G.a.zPi&&(Q=Gh.a(this.Hna))&&Q[0]?!0:!1}$Sl(Q){this.Z$e=!1;const sa=Gh.a(this.Hna);sa&&sa[0]&&(Q.TRT>=this.E9g&&this.fOc<this.a0e?this.O_e[this.fOc++]=
Q:(this.vZe[this.sOc]=Q,this.sOc=this.sOc<this.z1e-1?this.sOc+1:0),this.YGl(Q),this.hHl(Q))}ZSl(){this.B_e&&(this.xjl(),this.V9e=!0)}YGl(Q){this.hZd[Q.TP]++}hHl(Q){if(Q&&Q.UI){const sa=this.iLc[Q.UI];sa[0]+=1;sa[1]+=Q.TRT}}GLk(Q){const sa={};Q&&(Q[1]&&(sa.Typing=Q[1]),Q[2]&&(sa.Clicking=Q[2]));return sa}IDk(){return this.fOc?this.O_e.slice(0,this.fOc-1):null}OBh(){var Q=Gh.a(this.Hna);if(Q&&(this.T1g||this.rHl(Q),Q.length>this.tBj))for(const sa of Q){Q=this.Hna[sa];const db=Q.createdTime,Gb=this.Z3a();
6E4<Gb-db&&(z.b(8438528,304,50,"{0}",{["Not Received"]:Q.uDc?"RtcNotification":"ServerRevision",["Duration"]:Gb-db}),Q.uDc||z.b(42075798,304,15,"{0}",{["RevisionId"]:sa,["Duration"]:Gb-db}),delete this.Hna[sa])}}rHl(Q){if(this.Lak&&this.LHb)for(const sa of Q)if(Q=this.Hna[sa],Q.Rxe&&!Q.uDc&&(Q=Q.createdTime,2E3<this.Z3a()-Q)){let db=null;If.App.na&&If.App.na.Aa&&If.App.na.Aa.Nb&&(db=If.App.na.Aa.Nb.contentReplicator);this.LHb.execute(Gb=>{Gb.flush(db,1)});this.T1g=!0}}esi(Q,sa,db,Gb,Xb,Xc){this.r8g&&
(sa=sa.qLk())&&(sa.RevisionId=Q,sa.LRTWR=db,sa.LSTWR=Gb,sa.TSD=Xb,sa.UIWR=Xc,this.UEa&&this.UEa.track(sa))}}Object(c.a)(Um,"InboundMonitor",null,[1285]);class Ej{constructor(Q,sa,db,Gb){this.Aw=sa;this.pQd=db;this.lMj=Gb}create(Q,sa,db,Gb,Xb=null){return new Um(this.pQd,this.Aw,50,this.lMj,Q,sa,db,Gb,Xb)}}Object(c.a)(Ej,"InboundMonitorFactory",null,[1231]);var Xi=b(246);class Hi{}Hi.TFe="UserCount";Hi.kpm="RevisionChainLength";Object(c.a)(Hi,"PerfTrackerPivotNames",null,[]);class ib{}Object(c.a)(ib,
"PerfTrackingContext",null,[]);const Ab=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Tb{}Object(c.a)(Tb,"SteppedInboundFrame",null,[]);class lc{constructor(Q,sa,db,Gb,Xb){this.Uob=this.rQd=null;this.g3g=500;this.qQd=this.w5=this.AKb=this.whc=this.sKd=-1;this.VRg=null;this.Sgh=this.Sfh=!1;this.yfh=null;this.Pbh=this.Xja=0;this.Ijc=Q;this.MNe=sa();this.YXd=!1;this.T2e=0;this.TMb=db;this.kxj=Gb;this.e_d=Xb;M.AFrameworkApplication.K&&
(this.g3g=M.AFrameworkApplication.K.vb("InboundFrameSamplingMinimalTotalTimeMs",500))}get Rxe(){return this.Sfh}get uDc(){return this.Sgh}get DRi(){return this.yfh}get createdTime(){return this.MNe}get FOa(){return this.Xja}get e0l(){return this.Pbh}get bWb(){return this.TMb()}VCc(Q,sa,db,Gb){this.Rxe||(this.YXd=db,this.T2e=sa,this.sKd=C.a.DR(oa.a.Ze(),2),this.VRg=(new Date).toISOString(),this.Uob=Q,this.Pbh=Gb,this.Sfh=!0,this.uDc?this.NPh():(this.C3i(),ma.a.instance.gq(Q.toString()+"Start"),Xi.a.instance.Gne(2)))}pVi(Q,
sa,db=null){this.uDc||(this.Xja=sa,this.Sgh=!0,this.yfh=Q,this.qQd=C.a.DR(oa.a.Ze(),2),this.Rxe&&(ma.a.instance.gq(this.Uob.toString()+"End"),db&&(this.whc=db.pQi,this.AKb=db.O8,this.w5=db.APi),Xi.a.instance.T4d(),this.NPh()))}qLk(){if(!(0<this.sKd&&0<this.whc&&0<this.AKb&&0<this.w5&&0<this.qQd))return null;const Q=new Tb;Q.TT=C.a.DR(this.qQd-this.sKd,2);if(Q.TT<this.g3g)return null;Q.ST=this.VRg;Q.UC=this.bWb;Q.RS=C.a.DR(this.whc-this.sKd,2);Q.SR=C.a.DR(this.AKb-this.whc,2);Q.RRS=C.a.DR(this.w5-
this.AKb,2);Q.RP=C.a.DR(this.qQd-this.w5,2);Q.ResponseLanded=C.a.DR(this.AKb,2);0<Q.RS?(ma.a.instance.yO("RTCToRequestSent",this.Uob.toString()+"Start","RequestInvoked"+this.whc),ma.a.instance.yO("RequestSentToResponseReceived","RequestInvoked"+this.whc,"RequestCompleted"+this.AKb),ma.a.instance.yO("ResponseReceivedToReplicationStart","RequestCompleted"+this.AKb,"ReplicationStart"+this.w5)):ma.a.instance.yO("RTCToReplicationStart",this.Uob.toString()+"Start","ReplicationStart"+this.w5);ma.a.instance.yO("Replication",
"ReplicationStart"+this.w5,this.Uob.toString()+"End");return Q}C3i(){this.rQd=this.Ijc.create();this.rQd.start(Ck.nSi,Ck.c$i)}NPh(){this.rQd||this.C3i();const Q=this.rQd.end(this.YXd,this.Vnk());this.kxj.Xwe(Q);this.e_d.Xwe(Q+this.T2e)}Vnk(){const Q={};Q[Hi.TFe]=Ab(this.bWb);var sa=this.DRi.length;Q[Hi.kpm]=9>=sa?sa.toString():"10AndAbove";return Object.assign(new ib,{P:Q,FC:this.FOa,CFC:this.e0l+this.FOa,ID:this.Uob.toString(),CD:this.T2e,UC:this.bWb,RCL:this.DRi.length})}}Object(c.a)(lc,"InboundOperation",
null,[1284]);class Hc{constructor(Q,sa,db){this.Xpa=Q;this.Z3a=sa;this.TMb=db}create(Q,sa){return new lc(this.Xpa,this.Z3a,this.TMb,Q,sa)}}Object(c.a)(Hc,"InboundOperationFactory",null,[1230]);class hd{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf){this.ZXd=!0;this.Sch=this.dVd=null;this.Q2e=Q;this.ltj=sa;this.GFj=db;this.Ai=Gb;this.Ebf=Xb.create("TypingToOutboundReplicationStart",Xc,zd,20,!1);this.i6e=Xb.create("OutboundReplicationStartToOutboundReplicationEnd",ve,yf,20,!1)}get vjg(){return this.dVd}get kte(){return this.Sch}fHd(){!this.vjg&&
this.ZXd&&(this.ZXd=this.ltj())&&(this.dVd=this.Q2e.create(Object(n.a)(this,this.GR,"sendUpdateNotification"),this.GFj(),this.Ebf,this.i6e),this.vjg.fHd())}Wzd(){this.ZXd=!0;this.Sch=this.vjg;this.kte&&(this.dVd=null,this.kte.Wzd())}qtg(){this.dVd=null}Tzd(Q,sa){this.kte&&this.kte.Tzd(Q,sa)}GR(Q){this.Ai.GR(6,Q)}}Object(c.a)(hd,"OutboundMonitor",null,[]);class ta{constructor(Q,sa){this.Q2e=Q;this.EEj=sa}create(Q,sa,db,Gb,Xb,Xc,zd){return new hd(this.Q2e,Q,sa,db,this.EEj,Gb,Xb,Xc,zd)}}Object(c.a)(ta,
"OutboundMonitorFactory",null,[]);var jb=b(52);class Mb{constructor(Q){this.jpb=Q}get rbm(){return this.jpb}La(Q){return!!this.jpb&&Q in this.jpb}get Imi(){return this.La(Mb.y9d)&&this.La(Mb.h$b)&&this.La(Mb.RCg)}get revisionId(){if(this.La(Mb.h$b))return jb.a.Ad(this.jpb[Mb.h$b]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get Bxe(){if(this.La(Mb.h$b))return this.jpb[Mb.h$b];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");
}get fEi(){if(this.La(Mb.y9d))return Number.parseInvariant(this.jpb[Mb.y9d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get c0i(){if(this.La(Mb.h$b))return Boolean.parse(this.jpb[Mb.RCg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get FOa(){if(this.La(Mb.Xcg))return Number.parseInvariant(this.jpb[Mb.Xcg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static Plk(Q){return new Mb(Q)}static Ulk(Q,
sa,db,Gb){const Xb={};Xb[Mb.y9d]=Q.toString();Xb[Mb.h$b]=sa.toString();Xb[Mb.RCg]=db.toString();Xb[Mb.Xcg]=Gb.toString();return new Mb(Xb)}}Mb.h$b="RevisionID";Mb.y9d="Duration";Mb.RCg="ShouldSample";Mb.Xcg="NumSequentialFailures";Object(c.a)(Mb,"ReplicationNotificationMessage",null,[1276]);class xb{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.Jm=this.If=0;this.kNb=this.d2c=null;this.eJe=[];this.Mdh=null;this.tOd={};this.Xja=0;this.Ijc=Q;this.DIj=sa;this.Z3a=db;this.TMb=Gb;this.Dhh=Xb;this.Uob=null;this.tOd.TypingStartStage=
null;this.tOd.ReplicationStartStage="TypingStartStage";this.tOd.ReplicationEndStage="ReplicationStartStage";this.Flh=1<this.bWb;this.Ebf=Xc;this.i6e=zd}get bWb(){return this.TMb()}fHd(){this.fof("TypingStartStage")&&(this.spg("TypingStartStage"),pa.ULS.shipAssertTag(8257931,324,!this.kNb&&!this.Jm,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.If=this.Z3a(),this.d2c=this.Ijc.create(),this.t3i(this.d2c,Ck.$Tm))}Wzd(){if(this.fof("ReplicationStartStage")){this.spg("ReplicationStartStage");
pa.ULS.shipAssertTag(8257932,324,!!this.d2c,"TypingStart not called");if(this.d2c){const Q=this.IPh(this.d2c,this.Uob);this.Ebf.Xwe(Q)}this.kNb=this.Ijc.create();this.t3i(this.kNb,Ck.f0l)}}Tzd(Q,sa){this.fof("ReplicationEndStage")&&(this.spg("ReplicationEndStage"),this.Jm=this.Z3a(),this.Xja=sa,pa.ULS.shipAssertTag(8257933,324,!!this.kNb,"ReplicationStart not called"),this.kNb&&(pa.ULS.shipAssertTag(8193425,324,!!this.kNb,"ReplicationStart not called"),sa=this.IPh(this.kNb,Q),this.i6e.Xwe(sa)),pa.ULS.shipAssertTag(8257934,
324,!!this.If,"StartTime not set. No message sent to other editors."),this.If&&(Q=Mb.Ulk(this.Jm-this.If,Q,this.Dhh,this.Xja),this.DIj(Q.rbm)))}fof(Q){if(this.tOd[Q]===this.Mdh)return!0;pa.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.nPj()});return!1}nPj(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let sa=0;sa<this.eJe.length;sa++)Q.append(" "+this.eJe[sa]);return Q.toString()}spg(Q){this.eJe.push(Q);this.Mdh=Q}t3i(Q,sa){this.Flh&&Q.start(sa)}IPh(Q,sa){if(!this.Flh)return-1;
const db={};db[Hi.TFe]=Ab(this.bWb);sa=Object.assign(new ib,{P:db,FC:this.Xja,CFC:0,ID:sa?sa.toString():"",CD:0,UC:this.bWb,RCL:0});return Q.end(this.Dhh,sa)}}Object(c.a)(xb,"OutboundOperation",null,[1283]);class Nc{constructor(Q,sa,db){this.Ijc=Q;this.Z3a=sa;this.TMb=db}create(Q,sa,db,Gb){return new xb(this.Ijc,Q,this.Z3a,this.TMb,sa,db,Gb)}}Object(c.a)(Nc,"OutboundOperationFactory",null,[1229]);class rc{constructor(Q,sa){this.tWg=this._name=this.ZE=null;this.Jc=Q;this.UEa=sa}start(Q,sa=null){this.ZE=
this.Jc.le("UserAction",Q);this._name=Q;this.tWg=sa}end(Q,sa){let db=-1;Q&&(db=this.ZE.Wf,sa.D=db,sa.CN=this.tWg,sa.CD+=db,this.UEa.track(sa,this._name));return db}}Object(c.a)(rc,"PerfTracker",null,[1277]);class wd{constructor(Q,sa){this.Jc=Q;this.UEa=sa}create(){return new rc(this.Jc,this.UEa)}}Object(c.a)(wd,"PerfTrackerFactory",null,[1228]);class Fc{constructor(Q,sa,db){this.QXc=null;this.DEj=Q;this.j3g=sa;this.akc=db}init(Q,sa,db,Gb,Xb,Xc,zd){sa=this.akc.create(sa/100);db=this.akc.create(db/
100);this.QXc=this.DEj.create(Object(n.a)(sa,sa.SDa,"shouldBeInSample"),Object(n.a)(db,db.SDa,"shouldBeInSample"),Q,Gb,Xb,Xc,zd)}fHd(){this.QXc.fHd()}Wzd(){this.QXc.Wzd()}qtg(){this.QXc.qtg()}Tzd(Q,sa){this.QXc.Tzd(Q,sa)}sil(Q,sa,db=null){this.j3g.pmm(Q,sa,db)}VCc(Q){Q=Mb.Plk(Q);this.j3g.VCc(Q);ma.a.instance.gq(Q.revisionId+"Start")}VPm(Q,sa,db){z.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.f7d(Q,sa,db))}UPm(Q,sa,db){z.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",
this.f7d(Q,sa,db))}f7d(Q,sa,db){const Gb={};Gb.PhaseName=Q;Gb.ThresholdValue=sa;Gb.ActualValue=db;return Gb}}Object(c.a)(Fc,"ReplicationTelemetryManager",null,[]);var qe=b(555);class Nf extends qe.a{constructor(Q,sa){super(Q,sa);this.gh=this.HYd=0}Ona(Q){this.HYd+=Q;this.gh++}getValue(){return this.gh?this.HYd/this.gh:0}G0a(){this.gh=this.HYd=0}}Object(c.a)(Nf,"AverageMetric",qe.a,[]);class mg extends qe.a{constructor(Q,sa){super(Q,sa);this.jHa=0}Ona(Q){Q>this.jHa&&(this.jHa=Q)}getValue(){return this.jHa}G0a(){this.jHa=
0}}Object(c.a)(mg,"MaxMetric",qe.a,[]);var mi=b(1555);class Fg extends qe.a{constructor(Q,sa,db=100){super(Q,sa);this.eTd=this.Xic=this.flc=0;this.WWd=db;this.l7e=new mi.a(this.WWd)}Ona(Q){if(this.Xic===this.WWd){const sa=this.l7e.dequeue();this.flc-=sa;this.Xic--}this.l7e.enqueue(Q);this.flc+=Q;this.Xic++;Q=this.flc/this.Xic;Q>this.eTd&&this.Xic===this.WWd&&(this.eTd=Q)}getValue(){return this.eTd}G0a(){this.eTd=0;this.l7e=new mi.a(this.WWd);this.Xic=this.flc=0}}Object(c.a)(Fg,"MaxRollingAverageMetric",
qe.a,[]);class Tj extends qe.a{constructor(Q,sa){super(Q,sa);this.gh=0}Ona(){this.gh++}getValue(){return this.gh}G0a(){this.gh=0}}Object(c.a)(Tj,"CounterMetric",qe.a,[]);class lj{constructor(Q,sa){this.tQb=sa;this.mKe=new Nf(Q+"-AverageValue","Milliseconds");this.$_e=new mg(Q+"-MaxValue","Milliseconds");this.f0e=new Fg(Q+"-MaxRollingAverageValue","Milliseconds");this.FNe=new Tj(Q+"-NumberOfEvents","Count");this.gza=new ba.a(Q+"-SlowPercentileAtValue","Percentile",M.AFrameworkApplication.K.uI("CoAuthLatencySlowTargetValue",
3E3),M.AFrameworkApplication.K.uI("CoAuthLatencySlowThresholdPercentile",95),this.tQb);this.fza=new ba.a(Q+"-BrokenSlowPercentileAtValue","Percentile",M.AFrameworkApplication.K.uI("CoAuthLatencyBrokenSlowTargetValue",5E3),M.AFrameworkApplication.K.uI("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.tQb)}I3(Q){this.mKe.Ona(Q);this.$_e.Ona(Q);this.f0e.Ona(Q);this.FNe.Ona(Q);this.gza.Ona(Q);this.fza.Ona(Q)}Dve(){this.mKe.rDa();this.$_e.rDa();this.f0e.rDa();this.FNe.rDa();this.gza.rDa();this.fza.rDa();
this.mKe.G0a();this.$_e.G0a();this.f0e.G0a();this.FNe.G0a();this.gza.G0a();this.fza.G0a()}}Object(c.a)(lj,"ReplicationLatencyMetrics",null,[]);class mj{constructor(){this.GZe=new Ya.a}NLi(Q,sa,db){if(!(0>sa)){if(!({value:Gb}=this.GZe.tb(Q,Gb)).returnValue){var Gb=new lj(Q,db);this.GZe.W(Q,Gb)}Gb.I3(sa)}}Dve(){for(const Q of this.GZe.values)Q.Dve()}}Object(c.a)(mj,"ReplicationTelemetryMetricsManager",null,[1103]);class bn{NLi(){}Dve(){}}Object(c.a)(bn,"ReplicationTelemetryMetricsManagerStub",null,
[1103]);class Ln{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.A8a=this.SZd=0;this.RBj=Q;this.j4e=db;this.Yjh=Gb;this.OTg=Xb;this.slc=sa;this.SBj=Xc;this.tQb=zd}Xwe(Q){this.RBj.NLi(this.j4e,Q,this.tQb);Q>this.Yjh&&this.slc.FPm(this.j4e,this.Yjh,Q);this.SZd+=Q;this.A8a++;this.SZd/this.A8a>this.OTg&&this.A8a>this.SBj&&this.slc.t1j(this.j4e,this.OTg,this.SZd/this.A8a)}}Object(c.a)(Ln,"TimeSpanVerifier",null,[1136]);class Jm{constructor(Q,sa){this.AHj=Q;this.slc=sa}create(Q,sa,db,Gb,Xb){return new Ln(this.AHj,
this.slc,Q,sa,db,Gb,Xb)}}Object(c.a)(Jm,"TimeSpanVerifierFactory",null,[1102]);class Re extends Sys.EventArgs{constructor(Q,sa,db){super();this.BPi=Q;this.DDe=sa;this.actualValue=db}}Object(c.a)(Re,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class tk{constructor(){this.la=new m.a}FPm(Q,sa,db){this.la.raiseEvent("TSVTE",new Re(Q,sa,db))}t1j(Q,sa,db){this.la.raiseEvent("TSVATE",new Re(Q,sa,db))}kVj(Q){this.la.addHandler("TSVTE",Q)}jUj(Q){this.la.addHandler("TSVATE",Q)}}Object(c.a)(tk,"TimeSpanVerifierNotifier",
null,[1101]);class Cn{constructor(){this.Z=this.qa=null}get name(){return"Box4.ReplicationTelemetry"}Mb(Q){this.qa=Q.resolve("Common.IAppSettingsManager");this.Z=Q;if(this.qa.$("Box4ReplicationTelemetryIsEnabled")){Q.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new wd(If.App.na.$o,Y.a.kA(20,1,new W.a))).fa();Q.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new tk).fa();this.qa.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new mj).fa():Q.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new bn).fa();Q.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Jm(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).fa();Q.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new Nc(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Cn.QZh)).fa();Q.ia("ReplicationTelemetry.OutboundMonitorFactory",
()=>new ta(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).fa();Q.ia("ReplicationTelemetry.InboundOperationFactory",()=>new Hc(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Cn.QZh)).fa();var sa=new Ej(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),
db=this.qa.$("ComponentStateLoggingPackageIsEnabled")?this.Z.Da("Common.IComponentStateLogManager"):null;Q.ia("ReplicationTelemetry.IInboundMonitor",()=>sa.create(this.qa.vb("Box4ReplicationTelemetryInboundOperationThreshold",0),this.qa.vb("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.qa.vb("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.qa.vb("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),db)).fa();Q.ia("Common.IRandomSamplerFactory",()=>new bl).fa();
Q.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Fc(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).fa();Q.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Mk(eo.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.qa.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.qa.vb("Box4ReplicationTelemetrySamplePercent",
0),sa=this.qa.vb("Box4ReplicationTelemetryPhaseSamplePercent",0),db=this.qa.vb("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Gb=this.qa.vb("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Xb=this.qa.vb("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),Xc=this.qa.vb("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),zd=this;this.Z.Da("Box4.Presence.IRtcProxyProvider").execute(yf=>{yf.mK().continueWith(()=>{const cf=
yf.mK().result,eg=zd.Z.resolve("ReplicationTelemetry.ReplicationTelemetryManager");eg.init(cf,Q,sa,db,Gb,Xb,Xc);zd.Z.resolve("ReplicationTelemetry.EventForwarderFactory").create(cf,eg);if(zd.qa.$("LogSteppedInboundFrameIsEnabled")){const Xh=Fi.a.Wp(zd.Z.Da("Common.ICpuMeterProvider"));Xh.continueWith(()=>{const Nj=zd.Z.resolve("ReplicationTelemetry.IInboundMonitor");var dh=new Da.a(()=>!0);dh=Y.a.kA(19,1,dh);Nj.initialize(dh);const dl=Xh.result.wq.task;dl.continueWith(()=>{dl.result.A0d(0,()=>Nj.V9e,
un=>{Nj.$Sl(un)});dl.result.A0d(1,un=>Nj.yEm(un),()=>{Nj.ZSl()})})})}pa.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var ve=this;M.AFrameworkApplication.cL(()=>{ve.Z.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Dve()})}}dispose(){}static QZh(){const Q=If.App.Lb;return Q?Q.OAf:0}}Object(c.a)(Cn,"ReplicationTelemetryPackage",null,[1,2]);var rl=b(1031),pc=b(50),qh=b(14),Jf=b(138),kg=b(3),sj=b(240),Kl=b(180),tf=b(269),xe=b(19),Hg=b(24),uk=b(9),ng=b(1657);class zh{static get Bf(){return Kf.a.ty(zh.Al,
Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}zh.Al="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(c.a)(zh,"InsertSymbolsDialogHtml",null,[]);class Pe extends ng.a{constructor(Q,sa,db){super();this.lic=this.eVa=
this.dqb=null;this.yVe=0;this.ea=Q;this.kb=sa;this.eqb=db;this.Xd(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Xd(0,CommonUIStrings.l_DialogClose);this.Ija=!1;this.Bf=zh.Bf;this.xf="InsertSymbolsDialog"}dispose(){0<Pe.Zaf&&pa.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.yVe,Pe.Zaf);Pe.eYg++;pa.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Pe.eYg);this.ea=this.eqb=null;super.dispose()}s1a(){this.Hh(Box4Intl.Box4Strings.L_SymbolSingle,
Object(n.a)(this,this.fnl,"insertSymbolsDialogHandler"),null);this.yVe=0;Pe.kYg++;pa.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Pe.kYg);const Q=this.BPf("symbol_d_"+Pe.HUc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let sa=0;sa<Q.length;sa++)S.a.removeHandler(Q[sa],B.a.focus,Object(n.a)(this,this.S4i,"symbolFocusHandler"));super.hide()}fnl(Q){1===Q?(this.hfg("symbol_d_"+Pe.HUc),this.kb.wM(this.tI,
!0),this.kb.$j().Bi.tw(this.ZF),this.ZF.focus()):this.hide()}get Kyb(){return Pe.PUc}set Kyb(Q){Pe.PUc=Q}get Iyb(){return Pe.zUc}set Iyb(Q){Pe.zUc=Q}BU(){super.BU();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.eqb.D4j(),Q=Q.getElementsByTagName("a")))for(let sa=0;sa<Q.length;sa++)S.a.addHandler(Q[sa],B.a.focus,Object(n.a)(this,this.S4i,"symbolFocusHandler"))}Wea(){const Q=document.getElementById("symbolsContainer");Q&&(this.dqb||(this.dqb=Object(n.a)(this,this.lNm,"symbolClickHandler"),
this.Ho.Ma(B.a.click,Q,this.dqb),this.Ho.Ma(B.a.nF,Q,this.dqb)),this.eVa||(this.eVa=Object(n.a)(this,this.nNm,"symbolKeyHandler"),this.qd.Ma(B.a.vh,Q,this.eVa),this.qd.Ma(B.a.Ns,Q,this.eVa),this.qd.Ma(B.a.wh,Q,this.eVa)));super.Wea()}Vsb(){const Q=document.getElementById("symbolsContainer");Q&&(this.dqb&&(this.Ho.Gb(B.a.click,Q,this.dqb),this.Ho.Gb(B.a.nF,Q,this.dqb),this.dqb=null),this.eVa&&(this.qd.Gb(B.a.vh,Q,this.eVa),this.qd.Gb(B.a.Ns,Q,this.eVa),this.qd.Gb(B.a.wh,Q,this.eVa),this.eVa=null));
super.Vsb()}nYl(Q){this.rYi("symbol_d_"+Pe.HUc,!1);Pe.HUc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.rYi(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const sa=this.gtc(Pe.HUc);Q.innerText=sa.altText}}gtc(Q){const sa=this.eqb.NCe.lHg.value,db=Gh.a(sa);return sa[db[Q]]}S4i(Q){if(Q.target!==this.lic){const sa=this.kb.$j();sa&&sa.Bi&&(sa.Bi.tw(Q.target),this.lic=Q.target)}this.nYl(Q.target.id)}lNm(Q){const sa=Q.me;if("a"!==sa.tagName.toLowerCase())return!1;Q.eventName===B.a.nF&&this.hfg(sa.id);
this.kb.wM(this.tI,!0);this.kb.$j().Bi.tw(sa);sa.focus();return!0}nNm(Q){var sa=Q.me;if("a"!==sa.tagName.toLowerCase())return!1;const db=parseInt(sa.id.substr(sa.id.lastIndexOf("_")+1));if(Q.$a.ctrlKey||Q.$a.altKey||Q.$a.keyCode>=fg.a.XKc&&Q.$a.keyCode<=fg.a.hec)return!1;if(Q.eventName===B.a.vh){Q=Q.$a.keyCode;let Gb=-1;Q===Sys.UI.Key.enter?(this.hfg(sa.id),this.kb.wM(this.tI,!0),this.kb.$j().Bi.tw(sa),sa.focus()):Q===Sys.UI.Key.up?Gb=db-15:Q===Sys.UI.Key.down?Gb=db+15:Q===Sys.UI.Key.left?Gb=M.AFrameworkApplication.isRtl?
db+1:db-1:Q===Sys.UI.Key.right&&(Gb=M.AFrameworkApplication.isRtl?db-1:db+1);0<=Gb&&(sa=this.BPf("symbol_d_"+Gb))&&sa.focus()}return!0}hfg(Q){this.yVe++;Pe.Zaf++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const sa=this.gtc(Q),db={};db.SourceControlId="symbol_"+Q+"_"+sa.MCe;this.ea.zb(kg.a.insertSymbol,2,db);pa.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}BPf(Q){const sa=document.getElementById("symbolsContainer");return sa?sa.querySelector("#"+Q):null}rYi(Q,sa){(Q=
this.BPf(Q))&&(sa?Q.setAttribute("selected","true"):Q.removeAttribute("selected"))}}Pe.HUc=0;Pe.PUc=null;Pe.zUc=null;Pe.kYg=0;Pe.eYg=0;Pe.Zaf=0;Object(c.a)(Pe,"InsertSymbolsDialog",ng.a,[]);class Pg{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){this.ea=Q;this.Tb=sa;this.cLj=new ub.a(Object(n.a)(this,this.n7k,"getSymbolsDropDownMenuProps"));this.Ub=db;this.eqb=Gb;this.yl=Xb;this.sY=Xc;this.Ea=zd;this.nl=ve}n7k(){return this.eqb.D5j()}pb(){this.ea.Ia(kg.a.Cng,qh.a.application,Object(n.a)(this,this.Cng,"queryInsertSymbols"),
96);this.ea.ma(kg.a.MBb,qh.a.view,Object(n.a)(this,this.MBb,"populateSymbolsDropDown"));this.ea.ma(kg.a.lFd,qh.a.view,Object(n.a)(this,this.U4i,"symbolsDropDownOpenHandler"));this.ea.ma(kg.a.Nue,qh.a.view,Object(n.a)(this,this.FJi,"querySymbolPositionHandler"));this.ea.ma(kg.a.insertSymbol,qh.a.view,Object(n.a)(this,this.GYa,"insertSymbolViewHandler"));this.ea.ma(kg.a.MBb,qh.a.xc,Object(n.a)(this,this.MBb,"populateSymbolsDropDown"));this.ea.ma(kg.a.lFd,qh.a.xc,Object(n.a)(this,this.U4i,"symbolsDropDownOpenHandler"));
this.ea.ma(kg.a.Nue,qh.a.xc,Object(n.a)(this,this.FJi,"querySymbolPositionHandler"));this.ea.ma(kg.a.insertSymbol,qh.a.xc,Object(n.a)(this,this.enl,"insertSymbolHandler"));this.ea.qc(kg.a.MBb,1124);this.ea.qc(kg.a.lFd,1036);this.ea.qc(kg.a.Nue,1124);this.ea.qc(kg.a.insertSymbol,1036);M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ea.ma(kg.a.Cuc,qh.a.view,Object(n.a)(this,this.d1i,"showInsertMoreSymbolsDialogHandler")),this.ea.ma(kg.a.Cuc,qh.a.xc,Object(n.a)(this,
this.d1i,"showInsertMoreSymbolsDialogHandler")),this.ea.qc(kg.a.Cuc,1124))}FJi(Q,sa,db,Gb,Xb){if(1===db)return 32;Q=this.eqb.HFi(Xb);Q=String.format(this.eqb.mNm,Q.character);Xb[rl.a.InnerHTML]=Q;Xb[rl.a.On]=!1;return 32}GYa(Q,sa,db,Gb,Xb){let Xc;if(({fe:Xc,selected:zd,GYa:ve}=this.had(sa,db,Xc,zd,ve)).returnValue)return ve;var zd=xe.SelectionEditor.He(zd);var ve=!0;Q=8;db=this.Ub.tc(15);db.Va(Xc.Oc);zd||(Q=this.ea.Qe(sa,kg.a.Zsa,2,!0,Gb,null),sa=32===Q,pa.ULS.shipAssertTag(6407387,348,sa,"DeleteForReplace did not succeed. Response is {0}",
Q),ve=sa);ve&&(sa=Xc.Xa.Lg,zd=xe.SelectionEditor.He(sa),pa.ULS.shipAssertTag(6407388,348,zd,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",sa.contextId),Q=8,zd&&(Q=this.ea.Qe(sa,kg.a.insertSymbol,2,!1,Gb,Xb),pa.ULS.shipAssertTag(6407389,348,32===Q,"Insertion at IP context did not succeed. Response is {0}",Q),32===Q&&pc.FocusManager.instance().uf(Xc.sI)));db.dispose();return Q}had(Q,sa,db,Gb,Xb){db=null;Q.view.Qc&&(db=Q.view);Gb=null;if(!db||!db.Xa)return z.b(16851359,
315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,fe:db,selected:Gb,GYa:8};Gb=db.Xa.Lg;if(!Gb)return{returnValue:!0,fe:db,selected:Gb,GYa:2};if(this.sY.J(14)&&this.yl.jla(Gb))return{returnValue:!0,fe:db,selected:Gb,GYa:8};if(db.Xa.Fa.CK||this.nl&&this.nl.instance&&this.nl.instance.ZQ(Gb)||xe.SelectionEditor.peb(Q.Um))return{returnValue:!0,fe:db,selected:Gb,GYa:2};if(Pg.Bg.RRa(uk.ParagraphReader.e3,
Gb))return Xb=8,Pg.fc.qb(sj.a.Je,{["Reason"]:Kl.a.lQ}),{returnValue:!0,fe:db,selected:Gb,GYa:Xb};Xb=32;return 1===sa?{returnValue:!0,fe:db,selected:Gb,GYa:Xb}:{returnValue:!1,fe:db,selected:Gb,GYa:Xb}}enl(Q,sa,db,Gb,Xb){if(1===db)return 32;if(xe.SelectionEditor.peb(sa))return 2;Q=this.eqb.HFi(Xb);Gb.Er=Q.index;Gb=this.Tb.Ff(sa.node);db=Gb.Na(11);pa.ULS.shipAssertTag(6379466,324,db,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Jf.a[sa.node.type]);db=this.Ub.tc(15);db.sr(Gb);
Pg.characterPropertiesEditor.replaceTextRange(sa,Q.character,!0,!1);sa=Hg.SelectionFactory.ae(Gb.currentNode,sa.cpBegin+1);this.Ea.setSelection(sa);db.dispose();return 32}MBb(Q,sa,db,Gb,Xb){if(1===db)return 32;Xb.MenuItems=this.cLj.value;return 32}U4i(Q,sa,db){let Gb,Xb,Xc;({fe:Gb,selected:Xb,GYa:Xc}=this.had(sa,db,Gb,Xb,Xc));return Xc}d1i(Q,sa,db){2===db&&(new Pe(this.ea,pc.FocusManager.instance(),za.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).s1a();return 32}Cng(){return 32}static get characterPropertiesEditor(){return Pg.Wb||
(Pg.Wb=za.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){Pg.Wb=Q}static get Bg(){return tf.ContextSetEditor.instance}static get fc(){return Zi.a.instance}}Pg.Wb=null;Object(c.a)(Pg,"SymbolsActor",null,[1064]);class Ve{constructor(Q,sa){this.MCe=Q;this.altText=sa}}Object(c.a)(Ve,"Symbol",null,[]);class dg{constructor(){this.G$e=null;this.ijh=new ub.a(dg.m$c)}get lHg(){return this.ijh}i1h(Q){this.G$e||(this.G$e=Gh.a(this.ijh.value));return Array.indexOf(this.G$e,
Q)}static m$c(){const Q={};Q["\u2022"]=new Ve("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Ve("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Ve("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Ve("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Ve("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Ve("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Ve("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Ve("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);
Q["\u2260"]=new Ve("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Ve("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Ve("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Ve("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Ve("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Ve("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Ve("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Ve("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);
Q["\u03b2"]=new Ve("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new Ve("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Ve("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Ve("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Ve("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Ve("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Ve("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Ve("\u2665",
Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Ve("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new Ve("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Ve("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Ve("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Ve("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Ve("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Ve("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);
Q["\u00c2"]=new Ve("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new Ve("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Ve("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Ve("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Ve("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Ve("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=
new Ve("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Ve("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Ve("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Ve("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Ve("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Ve("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Ve("\u00ce",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Ve("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new Ve("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Ve("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Ve("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Ve("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Ve("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);
Q["\u00d6"]=new Ve("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new Ve("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Ve("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Ve("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Ve("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Ve("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=
new Ve("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Ve("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Ve("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Ve("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Ve("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Ve("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Ve("\u00e6",
Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Ve("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new Ve("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Ve("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Ve("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Ve("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Ve("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);
Q["\u00ed"]=new Ve("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Ve("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Ve("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Ve("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Ve("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Ve("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Ve("\u00f4",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Ve("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new Ve("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Ve("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Ve("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Ve("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Ve("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);
Q["\u00ff"]=new Ve("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new Ve("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Ve("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Ve("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Ve("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Ve("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Ve("\u0153",
Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Ve("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new Ve("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Ve("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(c.a)(dg,"SymbolsLoader",null,[1063]);var Ii=b(394),Vl=b(323),Dk=b(215),Fj=b(580),od=b(1089),Cd=b(304),dm=b(92);class no{constructor(Q){this.dLj=Q}get NCe(){return this.dLj}get mNm(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}HFi(Q){Q=
Q.SourceControlId.split("_");const sa={};2===Q.length?(sa.character=Q[1],sa.index=this.NCe.i1h(sa.character)):(sa.character=Q[2],sa.index=parseInt(Q[1]));return sa}D5j(){return this.n6h()}build(){return this.o7k()}D4j(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const sa=this.NCe.lHg.value,db=Gh.a(sa);let Gb=0;for(;Gb<db.length;){Gb%15||Q.append('<tr role="presentation">');const Xb=sa[db[Gb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Gb,Ta.a.Y2(Xb.MCe),Ta.a.Y2(Xb.altText)));Gb++;Gb%15&&Gb!==db.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}o7k(){const Q=this.n6h();return Cd.t(Q)}n6h(){const Q=Object.assign(new Ii.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.PSj());M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.oRj());return Q}oRj(){const Q=Object.assign(new Vl.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),sa=Object.assign(new Dk.a,{Id:"btnMoreSymbols",Command:kg.a.Cuc.toString(),LabelText:Ta.a.we(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Ta.a.we(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:M.AFrameworkApplication.Sp,Image16by16Class:dm.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(sa);return Q}PSj(){const Q=Object.assign(new Vl.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
sa=Object.assign(new Fj.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),db=this.NCe.lHg.value,Gb=Gh.a(db),Xb=Math.min(25,Gb.length);for(let zd=0;zd<Xb;zd++){var Xc=db[Gb[zd]];Xc=Object.assign(new od.a,{Id:String.format("{0}{1}_{2}","symbol_",zd,Xc.MCe),Character:Xc.MCe,Command:kg.a.insertSymbol.toString(),QueryCommand:kg.a.Nue.toString(),Alt:Ta.a.we(Xc.altText)});sa.GalleryItems.push(Xc)}Q.ControlList.push(sa);
return Q}}Object(c.a)(no,"SymbolsUiBuilder",null,[1062]);var Km=b(46),$b=b(218),wj=b(17),Vm=b(606),ip=b(352);class Ze{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){M.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.Z.resolve("Box4.Symbols.ISymbolsActor").pb()}dispose(){}Mb(Q){this.Z=Q;this.Z.register(dg,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").fa();this.Z.ia("Box4.Symbols.SymbolsUiBuilder",()=>new no(this.Z.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").fa();
this.Z.ia("Box4.Symbols.SymbolsActor",()=>new Pg(M.AFrameworkApplication.pa,new Vm.a,new ip.a,this.Z.resolve("Box4.Symbols.ISymbolsUIBuilder"),$b.a.instance,wj.a.instance,Km.a.instance,this.Z.Da("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").fa()}static main(){fa.a.instance.kc(new Ze)}}Object(c.a)(Ze,"Box4SymbolsPackage",null,[1,2]);var Ji=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},gd=b(1297),id=b(1240),Kd=b(1217),vh=b(1580),Mn=b(234),tg=b(272);class Lm{constructor(){this.container=this.lSa=null}Mb(Q){this.container=Q}init(){this.lSa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.lSa&&this.lSa.dispose()}}Object(c.a)(Lm,"ALiveBooksAccessibilityCheckPackageManager",
null,[1,2]);class dk{get Fhk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Ghk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Hhk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get b0l(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get uBb(){return CommonUIStrings.l_AccCheckerPaneTitle}get D2l(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(c.a)(dk,"AccessibilityCheckStringsProvider",null,
[164]);class Oo{constructor(){this.tSi=this.contentId=null}}Object(c.a)(Oo,"ResultIds",null,[]);class Uj{constructor(Q,sa){this._element=null;this.Yd=sa;this.qd=Q}get element(){this._element||(this._element=this.Xtf(),this.Iz());return this._element}mBg(Q){this._element=Q}dispose(){this.element&&(this.t4(),this.mBg(null))}Iz(){this.Yd&&this.qd?(this.Yd.Ma(B.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.qd.Ma(B.a.vh,this.element,Object(n.a)(this,this.rM,"onKeyPress"))):pa.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}t4(){this.Yd&&this.qd&&(this.Yd.Gb(B.a.click,this.element,Object(n.a)(this,this.onClick,"onClick")),this.qd.Gb(B.a.vh,this.element,Object(n.a)(this,this.rM,"onKeyPress")))}onClick(){this.Hqe();return!0}rM(Q){return this.Xtl(Q.$a.keyCode)?(this.Hqe(),!0):!1}Xtl(Q){return Q===fg.a.QId||Q===fg.a.tq}}Object(c.a)(Uj,"AInteractivePaneElement",null,[157,12]);var Dl=b(464),
Uh=b(51);class Vj extends Uj{constructor(Q,sa,db){super(Q,sa);this.U1e=db}hide(){this.element.removeAttribute(Xd.a.lg);Xd.a.Jq(this.element,Xd.a.vx,Xd.a.Rl);this.element.style.display="none"}show(){Xd.a.Jq(this.element,Xd.a.vx,Xd.a.NL);Xd.a.Jq(this.element,Xd.a.lg,Xd.a.y2d);this.element.style.display="block"}Xtf(){const Q=Dl.b("div",this.Mxi,"AccCheckerNotification");Xd.a.Jq(Q,Xd.a.qjf,Xd.a.Rl);Xd.a.Jq(Q,Xd.a.Vea,this.Bcg);Q.tabIndex=0;const sa=Dl.b("span",this.Lxi,"AccCheckerNotificationIcon");var db=
dm.createClusteredImage(16,16,"Info_16x16x32","",!0,"");sa.appendChild(db);db=Dl.b("span",this.Bcg,"AccCheckerNotificationText");Uh.a.Nr(db,this.Nxi);Q.appendChild(sa);Q.appendChild(db);return Q}Hqe(){this.U1e()}}Object(c.a)(Vj,"APopupNotification",Uj,[156,157,12]);class Vn extends Vj{constructor(Q,sa,db,Gb){super(Q,sa,db);this.Aza=Gb}get Mxi(){return"AccCheckerOutOfSyncNotificationId"}get Lxi(){return"AccCheckerOutOfSyncNotificationIconId"}get Bcg(){return"AccCheckerOutOfSyncNotificationTextId"}get Nxi(){return this.Aza.b0l}}
Object(c.a)(Vn,"OutOfSyncNotification",Vj,[]);class Mm extends Vj{constructor(Q,sa,db,Gb){super(Q,sa,db);this.Aza=Gb}get Mxi(){return"AccCheckerPartialResultNotificationId"}get Lxi(){return"AccCheckerPartialResultNotificationIconId"}get Bcg(){return"AccCheckerPartialResultNotificationTextId"}get Nxi(){return this.Aza.D2l}}Object(c.a)(Mm,"PartialResultNotification",Vj,[]);var Hh=b(118),Xe=b(110),ob=b(39),xi=b(222);class El{constructor(Q,sa,db,Gb=null,Xb=null,Xc=null,zd=null){this.kfh=this.hN=this.qd=
this.lSa=null;this.eOa=Gb;this.Yd=Q;this.kb=sa;this.Wm=db;this.Aza=zd||new dk;this.O2e=Xb||new Vn(this.eOa,this.Yd,Object(n.a)(this,this.jvk,"dimissOutOfSyncNotification"),this.Aza);this.N3e=Xc||new Mm(this.eOa,this.Yd,Object(n.a)(this,this.kvk,"dimissPartialResultNotification"),this.Aza)}show(){}hide(){}get eOa(){return this.qd||(this.qd=M.AFrameworkApplication.oa.bV)}set eOa(Q){this.qd=Q}GHh(){}LBa(){}dispose(){}DRa(){}aze(){}rol(Q){var sa=this.kfh[Q];Q=sa.contentId;if((sa=sa.tSi+"")&&sa.length){const db=
[];Array.add(db,Object.assign(new ob.a,{name:"RuleID",string:sa}));Xe.a.sendTelemetryEvent(Object.assign(new xi.a,{name:String.format("{0}.{1}",El.eIg,"ViolationSelected"),dataFields:db}))}this.LNl(Q)}LNl(Q){Q&&this.lSa.Qwm(Q)||(this.kb.wM(Hh.AFrame.Ddf,!1),this.XFm())}jvk(){this.WDd(!1);this.aze()}kvk(){this.V0i(!1);this.aze()}XFm(){const Q=Object.assign(new Qe.StandardDialog(!0),{hr:M.AFrameworkApplication.Hga,Dc:1,Qwa:!1});Q.E0(1);Q.Xd(1,this.Aza.Fhk);Q.Xd(0,CommonUIStrings.l_DialogCancel);Q.AM(this.Aza.Hhk,
this.Aza.Ghk,sa=>{1===sa&&this.QXf()})}J5j(Q){let sa=null;if(Q.Results&&0<Q.Results.length){sa={};let db=0;for(const Gb of Q.Results)Gb.ResultId=El.zOj+ ++db,Q=new Oo,Q.contentId=Gb.ContentId,Q.tSi=Gb.RuleId,sa[Gb.ResultId]=Q}return sa}TGl(){Xe.a.addNamespaceMapping(El.eIg,El.GOm);Xe.a.sendTelemetryEvent(Object.assign(new xi.a,{name:String.format("{0}.{1}",El.eIg,"ShowTaskpane")}))}}El.zOj="AccCheckResult";El.eIg="Office.UX.AccChecker";El.GOm="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(c.a)(El,"BaseAccessibilityCheckPane",null,[98,12]);class Wl{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(c.a)(Wl,"AccCheckerTaskPaneProps",null,[]);var oo=b(1413),Qg=b(1518),Zc=b(1233),Ci=b(157);class Ek extends El{constructor(Q,sa,db,Gb,Xb=null,Xc=null,zd,ve=null,
yf=null){super(sa,db,Gb,Xc,void 0,void 0,ve);this.fSg=null;this.b6g=this.ieh=this.M3e=this.wUd=this.iXd=this.OWd=!1;this.fcf=null;this.baf=!!M.AFrameworkApplication.oa&&!!M.AFrameworkApplication.oa.mb&&M.AFrameworkApplication.oa.mb.lle;this.GRe=this.I9=null;this.XTe=0;this.m2g=null;this.oV=Xb;yf&&(this.I9=yf.Q5m,this.GRe=yf.j8m,this.XTe=yf.d9m);this.jC=new Qg.a;za.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dC.loadScript("accessibility-checker-pane-strings").then(()=>{this.b6g=!0}).catch(cf=>
pa.ULS.sendTraceTag(41302158,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",cf))}get isVisible(){return this.ieh}n1a(Q){this.ieh=Q}get dyl(){return this.b6g}qzf(Q){Q&&(this.fSg=Q,Q.IsSuccess&&(this.kfh=this.J5j(Q),Q.IsPartialResult&&this.V0i(!0)),this.OWd=!0,this.iXd=!1,this.Xu())}WDd(Q){this.isVisible&&Q!==this.wUd&&(this.wUd=Q,this.Xu())}V0i(Q){this.M3e=Q;this.Xu()}WU(){this.iXd||Ci.UISurfaces.eu().then(Q=>{ma.a.instance.gq(Ek.lGb+":PaneOpen:Start");Q.showTaskPane(Ek.lGb,
this.wC());this.QXf();return null});this.isVisible?Ci.UISurfaces.eu().then(Q=>{Q.setSelectedTaskPane(Ek.lGb);return null}):this.TGl()}Xu(){Ci.UISurfaces.eu().then(Q=>{Q.updateTaskPane(Ek.lGb,this.wC());return null})}wC(){var Q=new Wl;this.jC.Nze(Q);Q=Object.assign(new Zc.a,{title:this.Aza.uBb,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.Z8();this.n1a(!0);M.AFrameworkApplication.oa.updateCommandUI()},onClose:()=>{this.tia();this.n1a(!1);this.iXd=this.OWd=!1;this.Xu();M.AFrameworkApplication.oa.updateCommandUI()},
isModernPane:!0});this.baf&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const sa=this.kb.gd(Ek.lGb);sa.parent=Hh.AFrame.zo;sa.iR=!0;this.lSa=Q;this.qPj()}dispose(){this.DRa();this.O2e&&(this.O2e.dispose(),this.O2e=null);this.N3e&&(this.N3e.dispose(),this.N3e=null);super.dispose()}qPj(){this.jC.IO(this.onRecheckExecute());this.jC.IO(this.QLk());this.jC.IO(this.e4k());this.jC.IO(this.onInvokeNavigateExecute());this.jC.IO(this.bWk());this.jC.IO(this.B0k());this.jC.IO(this.Y1k());
this.jC.IO(this.updateLastScanTime());this.jC.IO(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.QXf()}}}QLk(){return Q=>{Q.accessibilityCheckResultCollection=this.fSg}}e4k(){return Q=>{Q.resultsReady=this.OWd}}onInvokeNavigateExecute(){return Q=>{Q.onInvokeNavigateExecute=sa=>{this.rol(sa)}}}bWk(){return Q=>{Q.helpLink=this.vDk}}B0k(){return Q=>{Q.outOfSync=this.wUd}}Y1k(){return Q=>{Q.partialResult=this.M3e}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=sa=>
{this.fcf=sa}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{if(this.oV&&this.oV.value){const db=this.oV.value;if(db){var sa={};sa.query=Ek.JGj+Ek.twj;sa=Object.assign(new oo.a,{DX:sa});db.qca(Ek.UTe,sa)}}else this.m2g?this.m2g():this.I9.value&&this.GRe&&this.XTe&&this.I9.value.zb(this.XTe,2,this.GRe)}}}QXf(){this.M3e=this.wUd=this.OWd=!1;this.fcf&&this.fcf();this.Xu();this.iXd=!0;this.lSa.gSl()}Z8(){this.kb.uf(Ek.lGb)}tia(){this.lfb()&&this.kb.uf(this.kb.IW)}lfb(){return!!this.kb.Ef&&this.kb.Ef.name===
Ek.lGb}}Ek.lGb="AccessibilityCheckerPane";Ek.twj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Ek.UTe="FA000000012";Ek.JGj="AssetID=";Object(c.a)(Ek,"ReactAccessibilityCheckPane",El,[]);class km extends Ek{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf=null){super(Q,sa,db,Gb,Xb,Xc,void 0,yf);this.Ltj=ve;this.HJ=zd}dispose(){super.dispose()}get vDk(){return this.Ltj}WU(){this.HJ.GWa();super.WU()}}Object(c.a)(km,"ReactLiveBooksAccessibilityCheckPane",Ek,[]);var hj=b(1432),Di=b(107),ll=b(161),bg=b(69),Xl=b(164),xm=
b(460),on;(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(on||(on={}));Object(c.b)("AccessibilityRuleCategory",on);class Bf{constructor(Q,sa,db=null){this.zIe=null;this.l4g=!1;this.tVa=Q;this.yKd=sa;this.ea=db;this.Mc.ma(mb.a.Kdk,Lc.a.frame,Object(n.a)(this,this.closePane,"closePane"))}get Mc(){return this.ea||(this.ea=M.AFrameworkApplication.pa)}set Mc(Q){this.ea=Q}EAk(){this.l4g||(this.tVa.initialize(this),this.yKd.initialize(this),
this.l4g=!0)}gSl(){z.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.yKd.Wpm()}WU(Q,sa,db){if(1===db)return uj.SessionStatusManager.instance.Hj?8:32;if(this.tVa.dyl)return this.tVa.isVisible||this.EAk(),this.tVa.WU(),32;pa.ULS.sendTraceTag(542729371,334,15,"String resources were not loaded in time for ShowPane");return 8}closePane(Q,sa,db){1!==db&&this.tVa.LBa();return 32}pgg(){this.tVa.WDd(!0)}qzf(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const db=Q.AccessibilityRules;
for(let Gb in db){var sa=Gb;const Xb=db[Gb].RuleId+"";sa!==Xb&&z.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",sa,Xb)}this.zIe=db}else!this.zIe&&Q.Results&&0<Q.Results.length?(z.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.zIe;Q.IsSuccess||z.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.bjm(Q);this.MGl(Q);this.tVa.qzf(Q)}}bjm(Q){const sa=Q.AccessibilityRules;if(Q=Q.Results)for(let db=Q.length-
1;0<=db;db--){const Gb=Q[db];let Xb="";const Xc=Gb.RuleId;Gb.ContentName||(Xb+="Result does not have content name. ");Xc in sa||(Xb+=String.format("No accessibility check rule exists for ID {0}.",Xc));0<Xb.length&&(z.b(36214999,200,15,"Omitting invalid accessibility check result: "+Xb),Array.removeAt(Q,db))}}MGl(Q){var sa={};const db={};var Gb=Q.Results,Xb=[];Array.add(Xb,Object.assign(new ob.a,{name:"FinalViolationCount",int64:0}));Array.add(Xb,Object.assign(new ob.a,{name:"FinalErrorCount",string:"0"}));
Array.add(Xb,Object.assign(new ob.a,{name:"FinalWarningCount",string:"0"}));Array.add(Xb,Object.assign(new ob.a,{name:"FinalTipCount",string:"0"}));Array.add(Xb,Object.assign(new ob.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Gb){for(const ve of Gb)if(Q.AccessibilityRules){var Xc=Q.AccessibilityRules[ve.RuleId];if(Xc){if(sa[on[Xc.Category]]){let yf=sa[on[Xc.Category]];sa[on[Xc.Category]]=++yf}else sa[on[Xc.Category]]=1;db[ve.RuleId]?(Xc=db[ve.RuleId],db[ve.RuleId]=++Xc):db[ve.RuleId]=
1}}Xb[0].int64=Gb.length;for(var zd in sa)switch(Q=sa[zd],Gb=zd,Gb="Final"+Gb.charAt(0).toUpperCase()+Gb.substring(1,Gb.length)+"Count",Gb){case "FinalErrorCount":Xb[1].string=Q.toString();break;case "FinalWarningCount":Xb[2].string=Q.toString();break;case "FinalTipCount":Xb[3].string=Q.toString();break;case "FinalIntelligentServiceCount":Xb[4].string=Q.toString()}}Xe.a.sendTelemetryEvent(Object.assign(new xi.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),
dataFields:Xb}));for(let ve in db)sa=ve,Xb=db[ve],zd=[],Array.add(zd,Object.assign(new ob.a,{name:"RuleID",string:sa})),Array.add(zd,Object.assign(new ob.a,{name:"FinalViolationCount",string:Xb.toString()})),Xe.a.sendTelemetryEvent(Object.assign(new xi.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:zd}))}dispose(){this.tVa&&this.tVa.dispose();this.yKd&&this.yKd.dispose()}}Object(c.a)(Bf,"AAccessibilityCheckManager",null,[66,12]);var Gj=b(1023);
class Ub extends Bf{constructor(Q,sa,db){super(sa,db,Q);this.graph=null}Nng(Q,sa,db,Gb,Xb){if(1===db)return 32;Xb[Gj.a.On]=this.tVa.isVisible;return 32}Ngm(){for(const Q of this.yxi){const sa=this.graph.Nd(Q);sa.ro(Object(n.a)(this,this.Qd,"onPropertyChanged"));sa.wp(Object(n.a)(this,this.kw,"onConnected"));sa.Iw(Object(n.a)(this,this.hud,"onDisconnected"))}}nVm(){for(const Q of this.yxi){const sa=this.graph.Nd(Q);sa.iwa(Object(n.a)(this,this.Qd,"onPropertyChanged"));sa.LO(Object(n.a)(this,this.kw,
"onConnected"));sa.C0a(Object(n.a)(this,this.hud,"onDisconnected"))}}dispose(){super.dispose();this.nVm()}Qd(){this.pgg()}kw(){this.pgg()}hud(){this.pgg()}}Object(c.a)(Ub,"ALiveBooksAccessibilityCheckManager",Bf,[]);class Qh extends Ub{constructor(Q,sa,db,Gb,Xb,Xc){super(Q,sa,db);this.Mc.ma(mb.a.uDg,Lc.a.frame,Object(n.a)(this,this.WU,"showPane"));this.Mc.Ia(mb.a.F$l,Lc.a.frame,Object(n.a)(this,this.Nng,"queryToggleAccCheckerPane"),96);this.graph=Xb;this.hCj=Gb;this.$yj=Xc;this.Ngm()}get yxi(){return[12,
14,22,19,30,43,44]}Qwm(Q){if(this.$yj)return pa.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;pa.ULS.shipAssertTag(20272215,334,!!Q);return this.hCj.HNl(Q)}}Object(c.a)(Qh,"WordAccessibilityCheckManager",Ub,[]);var gh=b(81),lm=b(25),oe=b(101),da=b(20),Ea=b(156),fb=b(5),vb=b(27),cc=b(428);class ic{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.yg=null;this.HUb=0;this.Tb=sa;this.ey=db;this.Ea=Gb;this.ea=Xb;this.jc=Xc;this.Cr=Q;this.Bc=zd}get ap(){if(!this.yg){const Q=this.Tb.Ff(this.Cr.Nb);
this.ey.OKg(Q);if(Q.Na(7)||Q.Cc(7))this.yg=gh.a.Yn(Q,Q.origin)}return this.yg}HNl(Q){if(!Q||!Q.We||0>=Q.We.length)return pa.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var sa=Array(Q.We.length);let db=7,Gb=null;for(let Xc=0;Xc<Q.We.length;Xc++)if(Gb=this.XFk(Q.We[Xc])){if(7===db)db=this.HUb;else if(db!==this.HUb)return pa.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var Xb=this.Bc.oPa(Gb.characterData,Gb.ka);
const zd=Q.cpBegin?this.Bc.usb(Xb,Q.cpBegin):-1;Xb=Q.cpEnd?this.Bc.usb(Xb,Q.cpEnd):-1;if(-1>zd||-1>Xb)return pa.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;sa[Xc]=lm.a.nQ(zd,Xb,!1,Gb);switch(Q.contentType){case 5:if(!oe.HyperlinkReader.VSf(sa[Xc],!1))return!1;break;case 6:if(!da.ImageReader.jba(sa[Xc]))return!1;break;case 7:sa[Xc]=lm.a.nQ(-1,-1,!1,Gb)}}else return!1;sa=new Ea.Selection(sa,!1);return this.pAm(Gb,sa,Q.contentType)}XFk(Q){if(this.ap)for(this.ap.reset(),
this.HUb=7;this.ap.moveNext();){var sa=this.ap.currentNode.type;if(38===sa||36===sa||23===sa)this.HUb=sa;else if(12===sa){sa=this.ap.currentNode;const db=sa.ha(fb.a.yb,0);if(Q===db)return sa}}return null}jHg(Q){this.ea.processAction(vb.a.DT,2);this.ea.processAction(vb.a.T6,2);let sa=2;switch(this.HUb){case 23:sa=32;break;case 38:sa=this.ea.zb(vb.a.cPa,2,new cc.a(Q));break;case 36:sa=this.ea.zb(vb.a.FZa,2,new cc.a(Q));break;default:pa.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",
this.HUb)}if(32===sa)return!0;pa.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.HUb);return!1}pAm(Q,sa,db){if(this.jHg(Q)){Q=this.Cr.tx;const Gb=this.Ea.Fa.Pa;Gb&&Gb.equals(sa)&&this.jc.RDa(Q,null);this.jc.RDa(Q,sa);switch(db){case 0:case 1:this.ea.processAction(kg.a.kDb,2);break;case 2:this.ea.processAction(kg.a.fDc,2);break;case 3:this.ea.processAction(kg.a.xwa,2)}return!0}return!1}}Object(c.a)(ic,"WordAccessibilityCheckNavigateManager",null,[1105]);class Yc{constructor(){this.AccessibilityRules=
null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const sa=Q.AccessibilityRules,db={};if(sa)for(let Gb=0;Gb<sa.length;++Gb){const Xb=sa[Gb];db[Xb.Key]=Xb.Value}Q.AccessibilityRules=db;return Q}}Object(c.a)(Yc,"AccessibilityCheckResultCollection",null,[]);class ud{constructor(Q){this.lSa=null;this.c1g=Q}get fileId(){return this.c1g?this.c1g():null}initialize(Q){this.lSa=Q}Czi(Q){this.lSa.qzf(Q)}}Object(c.a)(ud,
"AAccessibilityCheckService",null,[810,12]);class Pc extends ud{constructor(Q){super(Q)}onFailure(Q,sa){pa.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",sa);Q=Object.assign(new Yc,{IsSuccess:!1});this.Czi(Q)}onSuccess(Q){Q=Pc.c4k(Q);let sa=null;if(Q)try{sa=this.Jtk(Q)}catch(db){pa.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",db.message),sa=Object.assign(new Yc,{IsSuccess:!1})}else pa.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),
sa=Object.assign(new Yc,{IsSuccess:!1});this.Czi(sa)}dispose(){}static c4k(Q){let sa=null;Q&&Q.og&&(sa=Q.og[0]);return sa?sa.Body:null}}Object(c.a)(Pc,"ALiveBooksAccessibilityCheckService",ud,[]);var Sd=b(921),uf=b(214);class lf extends uf.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}pi(){return 56}static construct(Q,sa){const db=new lf;db.FileId=Q;db.IsCoauthorable=sa;return db}}Object(c.a)(lf,"WordAccessibilityCheckRequest",uf.a,[]);class rf{}Object(c.a)(rf,"AccessibilityCheckRule",
null,[]);var Ef=b(127);class ff{static parse(Q){switch(Ta.a.Cf(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),Ef.a.argument(Q);}}}Object(c.a)(ff,"AccessibilityRuleCategoryParser",null,[]);class Se{constructor(){this.Category=this.Text=this.Id=null}static mQm(Q){const sa=new rf;sa.RuleId=Q.Id;sa.RuleName=Q.Text;sa.Category=ff.parse(Q.Category);return sa}}Object(c.a)(Se,
"WordAccessibilityCheckRule",null,[]);class xj{}Object(c.a)(xj,"AccessibilityCheckResult",null,[]);class hi{constructor(){this.cpEnd=this.cpBegin=this.We=null;this.contentType=0}}Object(c.a)(hi,"WordAccessibilityCheckContentId",null,[]);const Hj=Q=>{switch(Ta.a.Cf(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};
var mm=b(1251);class Wj{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static kQm(Q){const sa=new xj;sa.RuleId=Q.RuleId;sa.ContentName=Q.Label;const db=new hi;db.We=Q.ParaId;db.cpBegin=mm.b(Q.OS);db.cpEnd=mm.b(Q.OE);db.contentType=Hj(Q.ContentType);sa.ContentId=db;return sa}}Object(c.a)(Wj,"WordAccessibilityViolation",null,[]);class Ff{constructor(){this.Violations=this.Rules=null}static lQm(Q){const sa=new Yc;try{var db={};if(Q.Rules){for(let Gb=0;Gb<Q.Rules.length;++Gb){const Xb=
Se.mQm(Q.Rules[Gb]);db[Xb.RuleId]=Xb}sa.AccessibilityRules=db}if(Q.Violations){const Gb=Array(Q.Violations.length);for(db=0;db<Q.Violations.length;++db)Gb[db]=Wj.kQm(Q.Violations[db]);sa.Results=Gb}sa.IsPartialResult=!1;sa.IsSuccess=!0}catch(Gb){pa.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Gb.message),sa.IsSuccess=!1}return sa}}Object(c.a)(Ff,"WordAccessibilityCheckResult",null,[]);class Ui extends Pc{constructor(Q,
sa,db){super(Q);this.Vgc=sa;this.RTa=db}Wpm(){const Q=Object.assign(new Sd.a,{fk:lf.construct(this.fileId,this.RTa),status:1,Bv:"AccessibilityCheck"});this.Vgc(12,!1,Object(n.a)(this,this.onSuccess,"onSuccess"),Object(n.a)(this,this.onFailure,"onFailure"),Q,null,Q)}Jtk(Q){Q=la.b(Q);return Ff.lQm(Q)}}Object(c.a)(Ui,"WordAccessibilityCheckService",Pc,[]);class Ll extends Lm{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}Mb(Q){super.Mb(Q);Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",
()=>new km(M.AFrameworkApplication.pa,Mn.a.instance,pc.FocusManager.instance(),tg.a.instance,Q.Rd("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Mf.KeyInputManager.instance,hj.a.instance,M.AFrameworkApplication.K.Oa("AccessibilityCheckerHelpUrl"))).fa();Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Ui(()=>M.AFrameworkApplication.rootQuerySignature,xm.a.gK,Di.PageReader.instance.Ygd(If.App.na.Aa.Nb))).fa();Q.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",
()=>new ic(If.App.na.Aa,Q.resolve("Box4.Graph.IGraphIteratorFactory"),ll.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),M.AFrameworkApplication.pa,bg.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).fa();Q.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Qh(M.AFrameworkApplication.pa,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),
Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),If.App.Yh.Bj,Xl.App.cyb)).fa()}init(){Xl.App.RHc&&this.container.resolve("Box4.IFeatureHelper").Rk.continueWith(()=>{Lm.prototype.init.call(this)})}}Object(c.a)(Ll,"WordAccCheckerPackageManager",Lm,[]);class nm{constructor(Q,sa){this.djh=!1;this.Se=Q;this.GS=sa}Gva(Q){Q.zy.Xqh(Object(n.a)(this,this.fSm,"triggerWebToWebActiveCoauthSurveysEventHandler"))}fSm(){this.eSm()}eSm(){!this.djh&&this.Se&&(this.Se.sba?this.GS?
this.GS.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):pa.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.djh=!0)}}Object(c.a)(nm,"CoauthSurveyManager",null,[1060]);class po{constructor(){this.Cr=this.Z=null}get name(){return"WordEditor.CoauthSurveys"}init(){If.App.na&&(this.Cr=If.App.na.Aa)&&(this.Cr.Hma?this.Fia():this.Cr.Q$(()=>{this.Fia()}))}Fia(){var Q=this.Cr.Nb;Q&&(Q=Q.contentReplicator)&&this.Z.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").Gva(Q)}dispose(){}Mb(Q){this.Z=
Q;Q.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new nm(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Da("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").fa()}static main(){M.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&fa.a.instance.kc(new po)}}Object(c.a)(po,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var eq;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=
1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(eq||(eq={}));Object(c.b)("ComponentLoggingScenario",eq);var Yl=b(1073);class zq{flush(Q,sa){const db=this.DSk(Q);db.LoggingScenario=eq[sa];Gh.a(db).length?pa.ULS.sendTraceTag(594571986,3013,15,"{0}",db):pa.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",Yl.a[Q.vAa])}DSk(Q){const sa={};if(!Q)return sa;const db=new mi.a;for(db.enqueue(Q);!db.isEmpty;){Q=
db.dequeue();const Gb=Yl.a[Q.vAa];try{sa[Gb]=Q.cM()}catch(Xb){pa.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Gb.toString(),{["Kind"]:"Exception",["Stack"]:Xb.stack,["Message"]:Xb.message,["FileName"]:Xb.fileName,["LineNumber"]:Xb.lineNumber})}if((Q=Q.moc)&&Q.length)for(let Xb of Q)!Xb||Yl.a[Xb.vAa]in sa||db.enqueue(Xb)}return sa}}Object(c.a)(zq,"ComponentStateLogManager",null,[1059]);class Nq{flush(){}}Object(c.a)(Nq,"NoOpComponentStateLogManager",
null,[1059]);class qo{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve("Common.IComponentStateLogManager")}dispose(){}Mb(Q){this.Z=Q;M.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new zq).as("Common.IComponentStateLogManager").fa():Q.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Nq).as("Common.IComponentStateLogManager").fa()}static main(){fa.a.instance.kc(new qo)}}
Object(c.a)(qo,"WordEditorComponentStateLoggingPackage",null,[1,2]);var ik=b(254),fq=b(442),ro=b(527),Ij=b(528);class Ri{constructor(Q,sa=null,db=-1,Gb=null){this.Iea=Q;this.cmh=Gb||(()=>sa);this.pNd=db}Ki(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf=null,eg=!1,Xh=null,Nj=null){const dh=new XMLHttpRequest;let dl="";Xc="";2===sa?(dl="POST",db&&(Xc=db)):dl="GET";sa={};this.Iea&&(Q=ik.a.Nef(sa,Q,ik.a.UFe,M.AFrameworkApplication.MId,this.Iea));dh.open(dl,Q,!0);this.H5j(sa,Q);if(Gb)for(let vn in Gb)dh.setRequestHeader(vn,
Ta.a.QQ(Gb[vn]));for(let vn in sa)dh.setRequestHeader(vn,sa[vn]);Q=Xh||this.pNd;0<Q&&(dh.timeout=Q);Q=[];Array.add(Q,ik.a.rfa);Gb=new Sys.Net.WebRequest;const un=new ro.a(1,2,Gb,Q,Xb,zd,ve,yf,eg,cf,Nj);dh.onreadystatechange=()=>{this.iXl(dh,un)};try{dh.send(Xc)}catch(vn){pa.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}Xsc(){return 1}iXl(Q,sa){if(this.Uak(Q,sa)&&4===Q.readyState)if(Q.getResponseHeader(ik.a.LPh)&&M.AFrameworkApplication.lcd)M.AFrameworkApplication.lcd();
else{var db=Q.getResponseHeader(ik.a.Qzh);ik.a.WLg(db);this.vZm(Q,sa);Q.status===yd.a.Yw?(sa.status=2,sa.Vu(new Ij.a(sa))):(sa.status=Q.status&&Q.status!==yd.a.R9b?Q.status===yd.a.E3?5:3:7,sa.rI(new fq.a(sa)))}}H5j(Q,sa){Q["X-xhr"]=1;M.AFrameworkApplication.Veb&&(Q[ik.a.Cri]=1);M.AFrameworkApplication.buildVersion&&(Q[ik.a.mdg]=Ta.a.QQ(M.AFrameworkApplication.buildVersion));let db=null;this.cmh&&(db=this.cmh());db&&(Q[ik.a.BPg]=db);M.AFrameworkApplication.canary&&(Q[ik.a.Enc]=Ta.a.QQ(M.AFrameworkApplication.canary),
M.AFrameworkApplication.Tqd&&pa.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",Q[ik.a.Enc]));M.AFrameworkApplication.accessToken&&(ik.a.iTb(sa,M.AFrameworkApplication.oW)||(Q[ik.a.Idf]=Ta.a.QQ(M.AFrameworkApplication.accessToken)),ik.a.iTb(sa,M.AFrameworkApplication.Gra)||(Q[ik.a.Jdf]=M.AFrameworkApplication.jJa.toString()));M.AFrameworkApplication.userType&&(Q[ik.a.idj]=Ta.a.QQ(M.AFrameworkApplication.userType))}vZm(Q,sa){sa.mf=Q.status?Q.status:yd.a.R9b;try{sa.wd=Q.responseText;if(void 0!==
sa.I0a&&null!==sa.I0a){sa.Dk={};for(let db=0;db<sa.I0a.length;++db){const Gb=sa.I0a[db];sa.Dk[Gb]=Q.getResponseHeader(Gb)}}sa.CAe&&(sa.dca=Q.responseText&&Q.responseText.length?Q.responseXML:null)}catch(db){pa.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",sa.id,sa.request.get_url(),4===Q.readyState)}}Uak(Q,sa){return Q?sa?!0:(pa.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(pa.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(Q,sa,db){return new Ri(Q,null,db,sa)}}Object(c.a)(Ri,"SimpleClientRequestSender",null,[978]);class ml{constructor(Q,sa,db){this.Re=Q;this.aih=sa;this.geh=db}Ki(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf=null,eg=!1,Xh=null,Nj=null,dh=null,dl=null,un=!1){return this.geh?this.aih.Ki(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Nj,dh):this.Re.Ki(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh,Nj,dh,dl,
un)}Xsc(Q){return this.geh?this.aih.Xsc():this.Re.Xsc(Q)}}Object(c.a)(ml,"ClientRequestAdapter",null,[1037]);var Ki=b(155),ui=b(235),cn=b(231),Zl=b(1054),Lf=b(89),pn=b(659),ii=b(521),$d=b(114),Mj=b(589),$e=b(423),aj;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(aj||(aj={}));Object(c.b)("MostRecentRevisionIdOrigin",
aj);class ij extends Sys.EventArgs{constructor(Q,sa,db){super();this.fOa=Q;this.q_l=sa;this.httpStatusCode=db}}Object(c.a)(ij,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class so{constructor(){this.t7a=0}get isEmpty(){return!this.t7a}U0d(Q){this.t7a|=Q}eli(Q){return!!(this.t7a&Q)}clear(){this.t7a=0}}Object(c.a)(so,"RetryAttempt",null,[]);class Ml extends uf.a{constructor(){super();this.CellId=this.FileId=null}pi(){return 37}static construct(Q){const sa=new Ml;sa.FileId=Q.wg().Ik;sa.CellId=
$d.a(Q.Kb.id);return sa}}Object(c.a)(Ml,"LastSavedRevisionRequest",uf.a,[]);var Dn;(function(Q){Q[Q.noResultYet=-1]="noResultYet";Q[Q.upToDate=0]="upToDate";Q[Q.sessionLost=1]="sessionLost";Q[Q.userSignedOut=2]="userSignedOut";Q[Q.previousRequestPending=3]="previousRequestPending";Q[Q.requestFailed=4]="requestFailed";Q[Q.shuttingDown=5]="shuttingDown";Q[Q.nullResponseData=6]="nullResponseData";Q[Q.invalidResponseData=7]="invalidResponseData";Q[Q.failedRevisionLookup=8]="failedRevisionLookup";Q[Q.savedWithinThreshold=
9]="savedWithinThreshold";Q[Q.notSavedWarning=10]="notSavedWarning";Q[Q.kickoutThreshold=11]="kickoutThreshold";Q[Q.unknownRevision=12]="unknownRevision";Q[Q.contentNotYetLoaded=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.kickoutThreshold_Offline=17]="kickoutThreshold_Offline";Q[Q.dssSessionDeleted=18]="dssSessionDeleted";Q[Q.dssSessionExpired=19]="dssSessionExpired";Q[Q.waitingForSessionTokenRefresh=20]="waitingForSessionTokenRefresh";
Q[Q.dssSessionNotFound=21]="dssSessionNotFound";Q[Q.networkOffline=22]="networkOffline"})(Dn||(Dn={}));Object(c.b)("SaveMonitorResult",Dn);class rg{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh,Nj,dh,dl,un,vn,Fa,Ua,Ga,ua,Sa,rb,Ib,Vb,jc=null){this.uWc=0;this.NTc=!1;this.CWd=null;this.yUc=this.NP=-1;this.H4e=null;this.wVd=0;this.xVd=!1;this.aNb=null;this.gXc=0;this.N7e=this.fkh=null;this.av=this.z7g=this.OPe=0;this.DZe=null;this.XKj=Q;this.eRe=sa;this.NGa=Q;this.jmh=db;this.yJj=Gb;this.LYe=Xb;this.MGj=
Xc;this.GIj=zd;this.bjc=ve;this.VYg=yf;this.mMe=cf;this.dt=eg;this.oS=Xh;this.RJb=Nj;this.Fzj=dh;this.Ynb=dl;this.TXe=un;this.kS=vn;this.Xx=Fa;this.DHj=Ua;this.Pyj=Vb;this.Gfc=new so;this.S6e=new $e.a;this.wSe=rb;this.ZA=new Zl.a(-1);this.Gi=jc;if(this.CWe=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsGlobalNetworkStateEnabledForDocxSaveMonitor",!1):!1)this.TCj=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TimeoutIntervalForOfflineKickout",
Number.MAX_SAFE_INTEGER):Number.MAX_SAFE_INTEGER;this.ZA.a4c(Object(n.a)(this,this.Iom,"resultStateChanged"));this.AWd=Ga;this.hob=Fa();this.o3g=ua;this.Qmj=Sa;this.LHb=Ib;this.gkh=this.jmh;this.B0e=jb.a.nil;this.la=new m.a}get n9d(){return this.OPe}get qAb(){return this.B0e}get ofb(){return!this.MXa()||this.qAb.equals(this.MXa().id)}get Oke(){return 10===this.ZA.currentState?!0:!1}get Ztl(){return this.Xx().getTime()-this.hob.getTime()>this.LYe}get ooc(){return this.av}get vAa(){return 3}get moc(){let Q=
null;If.App.na&&If.App.na.Aa&&If.App.na.Aa.Nb&&(Q=If.App.na.Aa.Nb.contentReplicator);return[Q,Xl.App.XB]}start(){this.OPe=this.VYg.Esb(Object(n.a)(this,this.SGk,"fireRequestIfNecessary"),this.NGa)}uHc(Q){if(!this.n9d||this.NGa===Q)return!1;const sa=this.NGa;this.NGa=Q;this.stop("changing save monitor interval from "+sa+"ms to "+Q+"ms");this.start();return!0}h1a(Q,sa){if(sa>=this.uWc&&Q&&!jb.a.nil.equals(Q)){var db=!this.B0e.equals(Q);this.uWc=sa;this.B0e=Q;const Gb=this.Xx();this.N7e=Gb;const Xb=
this.ofb;db&&(sa={["Id"]:Q.toString(),["IsUpToDate"]:Xb,["Origin"]:aj[sa]},this.DZe&&(sa.LastUpToDateTime=this.DZe.toISOString()),(db=this.pJf())&&db.store&&(Q=db.store.getRevision(Q))&&(sa.LastSavedCreationTime=Q.creationTime.toISOString()),pa.ULS.sendTraceTag(557320151,rg.Uo,50,"Updating Last Saved Revision: {0}",sa));Xb&&(this.DZe=Gb)}else sa<this.uWc?pa.ULS.sendTraceTag(572051800,rg.Uo,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.uWc,sa):pa.ULS.sendTraceTag(572051801,
rg.Uo,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',sa)}stop(Q){this.Oe(Q)}Oe(Q){this.n9d&&(pa.ULS.sendTraceTag(5830084,rg.Uo,50,"Stopping DocxSaveMonitor because {0}!",Q),this.VYg.Oe(this.n9d),this.OPe=0)}SGk(){var Q=this.hob;this.hob=this.Xx();if(this.kS())this.ZA.event(5),this.stop("session has shut down");else{this.NGa===rg.qRi&&this.uHc(this.eRe);var sa=this.RJb();if(sa)if(this.Ogi())this.ZA.event(22),this.uHc(rg.J6i),this.Xx().getTime()-this.hob.getTime()>this.TCj&&this.Qle(17,Lf.a.NNh,"while offline");
else if(this.TXe()&&M.AFrameworkApplication.Uf("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.ofb)this.ZA.event(0);else if(this.Ynb())this.ZA.event(1),this.stop("session is lost"),M.AFrameworkApplication.Qn("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.Pyj&&!this.Ytl()&&(pa.ULS.sendTraceTag(554726995,rg.Uo,10,"DocxSaveMonitor: Session lost but not kicked out"),this.Ps(Lf.a.tbd));else if(this.TXe())20!==this.ZA.currentState?(this.ZA.event(20),
this.fkh=this.Xx(),pa.ULS.sendTraceTag(593510691,rg.Uo,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.gkh)):this.Xx().getTime()-this.fkh.getTime()>this.gkh&&(this.ZA.event(14),this.stop("Waited too long for session token to be refreshed"),this.Ps(Lf.a.sbd));else if(this.Fzj())if(this.hob=Q,this.NTc)this.ZA.event(3),this.Xx().getTime()-this.CWd.getTime()>this.LYe&&(Q=this.mMe.Xsc(this.NP),pa.ULS.sendTraceTag(19161610,205,50,
"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.NP,Ph.a[Q]),this.AWd&&this.AWd.log(),this.stop("stuck on previousRequestPending"),this.Ps());else if(Q=ii.b(Ml.construct(sa)),this.NTc=!0,this.CWd=this.DHj(),this.NP=this.mMe.Ki(rg.serviceUrl,2,Q,{"Content-Type":"application/json; charset=utf-8"},!1,0,Object(n.a)(this,this.Xak,"checkSaveRequestSucceeded"),Object(n.a)(this,this.Wak,"checkSaveRequestFailed"),null,void 0,void 0,this.MGj,this.GIj,void 0,void 0,!0),0>=this.NP)this.NTc=
!1,pa.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.NP.toString());else{Q=this.mMe.Xsc(this.NP);sa=100;if(Q&&1!==Q||this.o3g)sa=50;pa.ULS.sendTraceTag(19161612,rg.Uo,sa,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.NP,["Status"]:Ph.a[Q]});this.AWd&&this.AWd.start(this.NP)}else this.ZA.event(2);else this.ZA.event(13)}}Ogi(){return this.Gi&&this.CWe&&(1===this.Gi.networkState||3===this.Gi.networkState)?!0:!1}tcl(){if(0>=this.bjc)return!1;
var Q=this.f0k();if(!Q)return this.H4e=null,this.wVd=0,this.xVd=!1;this.aNb=Q.Vtb;this.aNb===this.H4e?this.wVd++:(this.H4e=this.aNb,this.wVd=1,this.xVd=!1);if(this.wVd<rg.gMl)return!1;this.gXc=+this.Xx()-+this.aNb;if(this.gXc<=this.bjc)return!1;if(!this.xVd)return this.xVd=!0,this.kKi(),!1;if(this.LHb)this.LHb.execute(sa=>{sa.flush(this,0)});else{Q="";try{this.wSe&&(Q=this.wSe())}catch(sa){Q=la.c({["Kind"]:"Exception",["Stack"]:sa.stack,["Message"]:sa.message,["FileName"]:sa.fileName,["LineNumber"]:sa.lineNumber}),
pa.ULS.sendTraceTag(50426817,rg.Uo,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}pa.ULS.sendTraceTag(50426818,rg.Uo,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.aNb.toISOString(),this.gXc,this.bjc,Q)}this.bjc=-1;this.stop("Exceeded oldest allowed local revision");this.Ps(Lf.a.Nxk);return!0}f0k(){let Q=null,sa=this.MXa();for(;sa&&!sa.tX;)Q=sa,sa=sa.Ag;return Q}Cxl(){return this.Ynb()?
(this.ZA.event(1),this.stop("session is lost"),!0):this.TXe()?(this.ZA.event(14),pa.ULS.sendTraceTag(20029718,rg.Uo,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.Ps(Lf.a.sbd),!0):!1}pJf(){const Q=this.RJb();return Q?Q.Kb:null}MXa(){const Q=this.pJf();return Q?Q.Hg:null}Jzh(Q){return this.Qmj.eli(Q)&&!this.Gfc.eli(Q)}Wak(Q){this.av=this.ooc+1;let sa=this.NTc=!1,db=!1;(Q=Q.data)?(13===Q.status&&pa.ULS.sendTraceTag(22552772,rg.Uo,15,"Request expired in CRM queue {0}",{["Id"]:Q.id,
["ConsecutiveErrors"]:this.ooc}),db=7===Q.status||13===Q.status,this.Jzh(2)&&db?(this.Gfc.U0d(2),sa=!0,this.yUc=Q.mf,this.ZA.event(16)):this.Jzh(1)&&5===Q.status?(this.Gfc.U0d(1),sa=!0,this.yUc=Q.mf,this.ZA.event(15)):(this.ZA.event(4),pa.ULS.sendTraceTag(22552773,rg.Uo,15,"Request failed {0}",{["Status"]:Q.status,["HttpStatus"]:Q.mf,["Correlation"]:Q.Dk?Q.Dk[ik.a.rfa]:"",["Id"]:Q.id,["ConsecutiveErrors"]:this.ooc}),this.yUc=Q.mf)):(this.ZA.event(4),pa.ULS.sendTraceTag(23425240,rg.Uo,15,"RequestFailed and event data is null"));
if(this.CWe&&this.Ogi&&this.Gi.Hj)this.Gfc.clear(),pa.ULS.sendTraceTag(546096136,rg.Uo,50,"Client is offline and EV is deployed. Clearing the failed attempts.");else{if(!sa&&(this.Gfc.clear(),db?this.Qle(17,Lf.a.NNh,"while offline"):this.Qle(11,Lf.a.Vzf,"while online")))return;this.uHc(sa?this.LNk(db):this.eRe)}}LNk(Q){return Q?rg.J6i:rg.qRi}Qle(Q,sa,db){return this.Ztl?(this.ZA.event(Q,{}),this.stop("request failed after kickout interval "+db),this.LHb&&this.LHb.execute(Gb=>{Gb.flush(this,2)}),this.Ps(sa),
!0):!1}Xak(Q){this.av=this.ooc+1;this.NTc=!1;var sa={};this.Gfc.clear();if(Q=Q.data){var db=Q.Dk?Q.Dk[ik.a.rfa]:"";sa.HttpStatus=Q.mf;sa.Correlation=db;sa.Id=Q.id;pa.ULS.sendTraceTag(23425242,rg.Uo,this.o3g?50:100,"Request succeeded at the HTTP level {0}",sa);this.yUc=Q.mf}else pa.ULS.sendTraceTag(23425241,rg.Uo,15,"Request succeeded with null response data");if(this.kS()||!this.n9d)this.ZA.event(5),this.stop("session has shut down");else if(!this.Cxl())if(Q&&Q.wd)if(Q=this.ata(Q.wd))if(this.oS.sEa(Q),
Q.StatusCode)this.uBl(Q,sa)||this.ZA.event(8,sa);else{this.av=0;this.hob=this.Xx();this.S6e.clear();sa={["LastSavedRevisionId"]:Q.LastSavedRevisionId};Q=$d.b(Q.LastSavedRevisionId);this.h1a(Q,3);var Gb=this.pJf().store.getRevision(Q);if(Gb){Q=null;db=this.MXa();Gb=(Gb=Gb.Eta(db))?Gb.id:jb.a.nil;let Xb=db;for(;Xb&&!Xb.id.equals(Gb);)Q=Xb,Xb=Xb.Ag;this.mdl(Q,sa,db)||this.ZA.event(9)}else this.tcl()||this.ZA.event(12,sa);this.uHc(this.XKj)&&pa.ULS.sendTraceTag(22552774,rg.Uo,50,"Received response from server -- going back to normal interval")}else this.ZA.event(7),
this.f4f("invalid response",sa);else this.ZA.event(6),this.f4f("null response",sa)}uBl(Q,sa){const db=Q.StatusCode;return 88===db||89===db||236===db?(sa.KickoutDiagnostics=this.wSe(),88===db?(sa.Result="deleted DSS session",this.ZA.event(18,sa),this.stop("deleted DSS session"),this.Ps(Lf.a.localCobaltDeletedSessionFault)):89===db?(sa.Result="expired DSS session",this.ZA.event(19,sa),this.stop("expired DSS session"),this.Ps(Lf.a.localCobaltExpiredSessionFault)):(M.AFrameworkApplication.Uf("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),
M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=$d.b(Q.LastSavedRevisionId),this.h1a(Q,4)),sa.Result="DSS session not found",this.ZA.event(21,sa),this.stop("DSS session not found"),this.Ps(Lf.a.localCobaltSessionNotFound)),!0):104===db?(this.stop("this operation is disabled on the server"),!0):this.f4f("unrecognized OperationResult: "+db,sa)}f4f(Q,sa){if(!this.S6e.contains(Q))this.S6e.add(Q);else if(this.Qle(11,
Lf.a.Vzf,Q))return sa.ConsecutiveErrors=this.ooc,sa.Reason=Q,pa.ULS.sendTraceTag(41997899,rg.Uo,15,"DocxSaveMonitor kickout. {0}",sa),!0;this.uHc(this.eRe);return!1}mdl(Q,sa,db){let Gb=!1;if(Q){const Xb=this.Xx().getTime()-Q.creationTime.getTime();Xb>=this.jmh&&(Gb=!0,rg.Mui(sa,this.m4k(Q,Xb,db)),Xb>=this.LYe&&10===this.ZA.currentState?(this.ZA.event(11,sa),this.stop("didn't save in time"),this.Ps()):(this.ZA.event(10,sa),this.kKi(),this.qGf()))}return Gb}Bqh(Q){this.la.addHandler(rg.hHi,Q)}agf(Q){this.la.addHandler(rg.wGf,
Q)}wwe(Q){this.la.removeHandler(rg.wGf,Q)}kKi(){this.la.raiseEvent(rg.hHi)}cVj(Q){this.la.addHandler(rg.CCi,Q)}ata(Q){let sa;return({group:sa}=Mj.a.Koa(Q,sa)).returnValue?sa.Responses[0]:null}m4k(Q,sa,db){const Gb={};Gb.FirstUnsavedRevisionId=Q.id.toString();Gb.FirstUnsavedRevisionLengthToRoot=Q.xt;Gb.UnsavedTimeInMs=sa;Gb.CurrentRevisionId=db.id.toString();Gb.CurrentRevisionLengthToRoot=db.xt;return Gb}qGf(){xm.a.ibe(8,null,null,null)}Ps(Q=Lf.a.Vzf){this.yJj?(this.stop(rg.vBl),Q===Lf.a.sbd?this.dt.value.Ps(Q,
Object.assign(new pn.a,{xN:4,gQ:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,B6:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.dt.value.Ps(Q,new pn.a)):pa.ULS.sendTraceTag(19247383,rg.Uo,50,"Kickout disabled")}Iom(Q,sa){Q={};Q.DocxSaveMonitorState=Dn[sa.newState];Q.PreviousState=Dn[sa.c8b];Q.PreviousStateHits=sa.Kwd;Q.PreviousStateTransitionTime=sa.Lwd.toISOString();Q.LastHttpStatus=this.yUc;Q.LastSuccessTime=this.hob.toISOString();this.CWd&&(Q.LastRequestStartTime=
this.CWd.toISOString());Q.LastSavedRevisionID=this.qAb.toString();Q.LastSavedRevisionIdOrigin=this.uWc;Q.LastSavedRevisionIdSetTime=this.N7e?this.N7e.toISOString():null;var db=sa.E3i;db&&rg.Mui(Q,db);22===sa.c8b&&(this.hob=this.Xx());db=sa.newState;switch(db){case 13:pa.ULS.sendTraceTag(5830086,rg.Uo,50,"{0}",Q);break;case 1:pa.ULS.sendTraceTag(5884125,rg.Uo,50,"{0}",Q);break;case 0:pa.ULS.sendTraceTag(5830087,rg.Uo,50,"{0}",Q);break;case 2:pa.ULS.sendTraceTag(5830088,rg.Uo,50,"{0}",Q);break;case 3:pa.ULS.sendTraceTag(5830089,
rg.Uo,50,"{0}",Q);break;case 4:pa.ULS.sendTraceTag(5884126,rg.Uo,50,"{0}",Q);break;case 5:pa.ULS.sendTraceTag(5884127,rg.Uo,50,"{0}",Q);break;case 6:pa.ULS.shipAssertTag(5830090,rg.Uo,!1,"{0}",Q);break;case 7:pa.ULS.shipAssertTag(5830091,rg.Uo,!1,"{0}",Q);break;case 8:pa.ULS.sendTraceTag(5830092,rg.Uo,15,"{0}",Q);break;case 10:pa.ULS.sendTraceTag(5830094,rg.Uo,15,"{0}",Q);break;case 9:pa.ULS.sendTraceTag(5884128,rg.Uo,50,"{0}",Q);break;case 11:pa.ULS.sendTraceTag(5830096,rg.Uo,15,"{0}",Q);break;case 17:pa.ULS.sendTraceTag(37835678,
rg.Uo,15,"{0}",Q);break;case 12:pa.ULS.sendTraceTag(5830095,rg.Uo,15,"{0}",Q);break;case 18:pa.ULS.sendTraceTag(38122832,rg.Uo,15,"{0}",Q);break;case 19:pa.ULS.sendTraceTag(38122833,rg.Uo,15,"{0}",Q);break;case 21:pa.ULS.sendTraceTag(0,rg.Uo,15,"{0}",Q);break;case 14:pa.ULS.sendTraceTag(6575508,rg.Uo,15,"{0}",Q);break;case 15:pa.ULS.sendTraceTag(36739287,rg.Uo,50,"{0}",Q);break;case 16:pa.ULS.sendTraceTag(36767649,rg.Uo,15,"{0}",Q);break;case 20:pa.ULS.sendTraceTag(593510690,rg.Uo,15,"{0}",Q);break;
case 22:pa.ULS.sendTraceTag(0,rg.Uo,15,"{0}",Q);break;default:pa.ULS.shipAssertTag(5884129,rg.Uo,!1,"Bad state:{0} logInfo:{1}",db,Q)}10===sa.newState&&10!==sa.c8b&&this.la.raiseEvent(rg.CCi)}cM(){const Q={};this.aNb&&(Q.ORT=this.aNb.toISOString());0<this.gXc&&(Q.AA=this.gXc);0<this.bjc&&(Q.MAA=this.bjc);const sa={};M.AFrameworkApplication.k3&&(sa.S=1);If.App.lostSession&&(sa.LS=1);If.App.Lb&&If.App.Lb.Zo.rj&&(sa.KO=1);Q.AMD=sa;return Q}RVk(){const Q={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};M.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=Ta.a.QQ(M.AFrameworkApplication.buildVersion));M.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Ta.a.QQ(M.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=M.AFrameworkApplication.jJa.toString());M.AFrameworkApplication.canary&&(Q["X-Key"]=Ta.a.QQ(M.AFrameworkApplication.canary));M.AFrameworkApplication.userType&&(Q["X-UserType"]=Ta.a.QQ(M.AFrameworkApplication.userType));const sa=M.AFrameworkApplication.je.C4;
sa&&(Q["X-WacCluster"]=Ta.a.QQ(sa));M.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=Ta.a.QQ(M.AFrameworkApplication.userSessionId));return Q}jbe(){var Q=If.App.Lb.Zo.networkState;if(1===Q||3===Q)pa.ULS.sendTraceTag(558158790,rg.Uo,15,"Not sending request because we dont have network.");else{Q=this.RJb();var sa=new Sys.Net.WebRequest;sa.set_httpVerb("POST");sa.set_url(rg.serviceUrl);var db={};db.body=ii.b(Ml.construct(Q));db.headers=this.RVk();db.method=sa.get_httpVerb();try{"function"===
typeof window.fetch?window.fetch(sa.getResolvedUrl(),db).then(Gb=>{pa.ULS.sendTraceTag(561551382,rg.Uo,50,"Request succeeded at the HTTP level {0}",Gb.statusText);this.z7g=Gb.status;return Gb.json()},Gb=>{pa.ULS.sendTraceTag(561551383,rg.Uo,15,"Request failed at the HTTP level {0}",Gb);return null}).then(Gb=>{Gb=JSON.stringify(Gb);this.Qak(Gb,this.z7g);return Gb},()=>{pa.ULS.sendTraceTag(561551385,rg.Uo,15,"Request succeeded with null response data");return""}):pa.ULS.sendTraceTag(561002076,rg.Uo,
15,"Browser does not support Fetch.")}catch(Gb){pa.ULS.sendTraceTag(561551386,rg.Uo,15,String.format("Exception when attempting to get last revision save id : {0}",Gb))}}}Qak(Q,sa){let db=jb.a.nil,Gb=!1;sa===yd.a.Yw&&((Q=this.ata(Q))?(db=$d.b(Q.LastSavedRevisionId),Q.StatusCode||(Gb=!0)):pa.ULS.sendTraceTag(561002077,rg.Uo,50,"Response is null when attempting to get last revision save id"));this.la.raiseEvent(rg.wGf,new ij(db,Gb,sa))}static Mui(Q,sa){for(let db in sa)Q[db]=sa[db]}Ytl(){return uj.SessionStatusManager.instance.rj}}
rg.qRi=0;rg.serviceUrl=If.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";rg.vBl="kickout";rg.hHi="PS";rg.wGf="FLSR";rg.CCi="SMWS";rg.Uo=343;rg.gMl=5;rg.J6i=5E4;Object(c.a)(rg,"DocxSaveMonitor",null,[1066,160]);class Oq{constructor(Q,sa){this.NUa=Q;this.mwj=sa}pb(Q){Q.ma(vb.a.jte,qh.a.view,Object(n.a)(this,this.jte,"pendingAutosavesCheck"));Q.ma(vb.a.GHd,qh.a.view,Object(n.a)(this,this.GHd,"updateDocxSaveMonitorInterval"));Q.qc(vb.a.GHd,101)}jte(){const Q=this.mwj();return 32!==
Q?Q:!this.NUa||this.NUa.ofb?32:2<=this.NUa.ooc?8:4}GHd(Q,sa,db,Gb,Xb){this.NUa&&this.NUa.uHc(parseInt(Xb.toString()));return 32}}Object(c.a)(Oq,"DocxSaveMonitorActor",null,[]);class Tf{Esb(Q,sa){return window.setInterval(Q,sa)}Oe(Q){window.clearInterval(Q)}}Tf.instance=new Tf;Object(c.a)(Tf,"DocxSaveMonitorTaskManager",null,[1065]);class Np{constructor(Q){this.NP=0;this.zza=Q}start(Q){this.zza&&(this.NP=Q,this.zza.reset())}log(){if(this.zza){var Q={};Q.RequstId=this.NP;Q.InvokeCount=this.zza.zie;
Q.InvokeFailedCount=this.zza.Aie;Q.NoOpenConnectionCount=this.zza.fpe;Q.SynchronousNotificationCount=this.zza.OCe;Q.ResponseNotAvailable=this.zza.sAd;pa.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(c.a)(Np,"RequestLifeCycleTelemetryManager",null,[1058]);class Nk{constructor(){this.Z=this.NUa=null}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(If.App.Aq||If.App.Uk)this.NUa=this.Z.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor"),(new Oq(this.NUa,
()=>cn.WoncaApp.rq.Dge())).pb(M.AFrameworkApplication.pa)}Aok(){var Q=M.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var sa=Q.$("DocxSaveMonitorKickoutEnabled");const db=Q.vb("DocxSaveMonitorIntervalMs",6E4),Gb=Q.vb("DocxSaveMonitorFailureIntervalMs",5E3),Xb=Q.vb("DocxSaveMonitorWarningTimeMs",12E4),Xc=Q.vb("DocxSaveMonitorKickoutTimeMs",3E5),zd=Q.vb("DocxSaveMonitorQueueTimeoutMs",6E4),ve=Q.vb("DocxSaveMonitorSentTimeoutMs",12E4),yf=Q.vb("DocxSaveMonitorOldestAllowedLocalRevisionMs",
3E5);var cf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const eg=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Xh=M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Nj=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||Xh;Xh=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);const dh=M.AFrameworkApplication.je;var dl=Nj?
new Ri(M.AFrameworkApplication.userSessionId,dh.C4,dh.Irk):null;dl=new ml(dh,dl,Nj);cf=cf&&dh&&!Nj?new Np(dh.cRa):null;Nj=new so;Nj.U0d(1);Nj.U0d(2);Xh=Xh?this.Z.Da("Common.IComponentStateLogManager"):null;sa=new rg(db,Gb,Xb,sa,Xc,zd,ve,yf,Tf.instance,dl,za.a.instance.Rd("Box4.IKickoutExecutor"),ui.a.instance,Object(n.a)(this,this.rfe,"getTargetNode"),()=>!M.AFrameworkApplication.Wsd||pk.a.instance.avc,()=>If.App.lostSession,Object(n.a)(Ki.a.instance,Ki.a.instance.C6,"checkAndTriggerSessionHasExpired"),
()=>M.AFrameworkApplication.gi,()=>new Date,()=>new Date,cf,eg,Nj,Object(n.a)(this,this.kMk,"getAdditionalDiagnosticLog"),Xh,Q,za.a.instance.sa("Common.ISessionStatus")||uj.SessionStatusManager.instance);sa.start();pa.ULS.sendTraceTag(5884131,rg.Uo,50,"SaveMonitor initialized");return sa}rfe(){const Q=If.App.na.Aa.hc;return Q?Q.Oc:null}kMk(){const Q={};M.AFrameworkApplication.Sb&&(Q.TM=M.AFrameworkApplication.Sb.cM());cn.WoncaApp.rq&&(Q.RS=cn.WoncaApp.rq.cM());Xl.App.XB&&(Q.CRS=Xl.App.XB.cM());If.App.na&&
If.App.na.Aa&&If.App.na.Aa.Nb&&If.App.na.Aa.Nb.contentReplicator&&(Q.GSR=If.App.na.Aa.Nb.contentReplicator.cM());M.AFrameworkApplication.k3&&(Q.S=1);If.App.lostSession&&(Q.LS=1);If.App.Lb&&If.App.Lb.Zo.rj&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}dispose(){this.NUa&&this.NUa.stop("WordEditorDocxSaveMonitorPackage is being disposed")}Mb(Q){this.Z=Q;(If.App.Aq||If.App.Uk)&&Q.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",Object(n.a)(this,this.Aok,"createSaveMonitor")).as("Wonca.IDocxSaveMonitor").fa()}static main(){fa.a.instance.kc(new Nk)}}
Object(c.a)(Nk,"WordEditorDocxSaveMonitorPackage",null,[1,2]);class Lg{get Hhf(){return"Word"}get xzh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return 0}get currentVersion(){return 1}get Qql(){return Lg.isEnabled()&&M.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Nwc(){return Lg.isEnabled()&&M.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get lmi(){return M.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get UHk(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get rvi(){return 24}get VRi(){return 4E3}get URi(){return""}static isEnabled(){const Q=
M.AFrameworkApplication.sessionStartInfoSettings?M.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(c.a)(Lg,"FirstRunExperienceLauncherSettings",null,[1233]);class Oc{constructor(Q){this.h0g=Q}xGm(Q){this.h0g&&this.h0g.yGm(Q)}}Object(c.a)(Oc,"FirstRunExperienceManager",null,[1100]);class fo{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}Mb(Q){this.Z=Q;this.Z.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new Oc(this.Z.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).fa()}init(){const Q=this.Z.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.xGm(new Lg)}dispose(){}}Object(c.a)(fo,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class go{constructor(Q,sa,db){this.ea=Q;this.FTa=sa;this.jYe=db}dispose(){this.FTa&&this.FTa.dispose()}pb(){this.ea.ma(vb.a.gGd,qh.a.view,Object(n.a)(this,this.gGd,"toggleFormatPicturePane"));this.ea.Ia(vb.a.rca,
qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane"),4);this.ea.ma(vb.a.Lkd,qh.a.view,Object(n.a)(this,this.Lkd,"hideFormatPicturePane"));this.ea.Ia(vb.a.DEc,qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane"),4);this.ea.ma(vb.a.EEc,qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane"));this.ea.ma(vb.a.FEc,qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane"));this.jYe&&(this.ea.Ia(vb.a.ung,qh.a.view,Object(n.a)(this,this.eJi,"queryFormatPicturePane"),96),this.ea.ma(vb.a.cBe,
qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane")),this.ea.Ia(vb.a.vng,qh.a.view,Object(n.a)(this,this.eJi,"queryFormatPicturePane"),96),this.ea.ma(vb.a.dBe,qh.a.view,Object(n.a)(this,this.rca,"showFormatPicturePane")))}eJi(Q,sa,db,Gb,Xb){if(1===db)return 32;switch(Q){case vb.a.ung:Xb[Gj.a.On]=1===this.FTa.Ksb;break;case vb.a.vng:Xb[Gj.a.On]=2===this.FTa.Ksb}return 32}rca(Q,sa,db,Gb,Xb){if(1===db)return 32;if(2===db){sa=this.FTa.tg.isVisible;this.FTa.Ny(!0,1===Xb);db=0;switch(Q){case vb.a.cBe:Xb=
1;break;case vb.a.dBe:Xb=2;break;case vb.a.DEc:Xb=2;db=1;break;case vb.a.EEc:Xb=1;db=2;break;case vb.a.FEc:Xb=1;db=3;break;case vb.a.gGd:Xb=this.FTa.Ksb;this.jYe&&!Xb&&(Xb=1);break;default:db=Xb=0}sa&&Q===vb.a.rca||this.FTa.ixm(Xb,db);return 32}return 8}Lkd(Q,sa,db,Gb,Xb){this.toggleButton(Xb,!1);return this.Qdk(db)}Qdk(Q){if(1===Q)return 32;this.FTa.Ny(!1);return 32}gGd(Q,sa,db,Gb,Xb){return this.FTa.tg.isVisible?this.Lkd(Q,sa,db,Gb,Xb):this.rca(Q,sa,db,Gb,Xb)}toggleButton(Q,sa){Q&&(Q[Gj.a.On]=sa)}}
Object(c.a)(go,"FormatPictureActor",null,[12]);class em{constructor(Q,sa){this.wPb=!1;this.tg=Q;this.jYe=sa}get Ksb(){return this.tg.xqk}ixm(Q,sa){switch(Q){case 0:case 1:this.tg.tHm(sa);break;case 2:this.tg.CHm(sa)}}Ny(Q,sa=!1){this.wPb||this.jWf();Q?this.tg.WU(sa):this.tg.LBa()}dispose(){this.tg.dispose()}jWf(){this.wPb||(this.tg.initialize(),this.wPb=!0)}}Object(c.a)(em,"FormatPictureManager",null,[1323,12]);var Nn=b(350),Li=b(109),ps=b(550);class Fk{}Fk.YO=ps.a.wrc;Fk.Izc=1;Fk.uBb=WordEditorIntl.WordEditorStrings.L_FormatPicture;
Fk.HAa="FormatPictureTaskPaneData";Object(c.a)(Fk,"FormatPicturePaneConstants",null,[]);class Aq{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(c.a)(Aq,"FormatPictureTaskPaneProps",null,[]);class zp{constructor(Q,
sa,db,Gb){this.X7e=0;this.YOc=this.yra=null;this.ZWd=this.SWd=this.ESd=this.sLd=this.PZd=0;this.Qv=this.f4a=!1;this.WNe=0;this.HJ=Q;this.pAj=sa;this.JZe=db;this.Yd=Gb}initialize(){this.f2();this.Lwa()}get isVisible(){return this.Qv}WU(Q){this.$Dd(Q)}LBa(){this.tia();this.kgl()}tHm(Q){this.sYi(Q,1)}CHm(Q){this.sYi(Q,2)}sYi(Q,sa){this.WNe=sa;this.X7e=Q}get xqk(){return this.WNe}dispose(){}f2(){this.HJ.GWa();this.X7e=this.WNe=0}get jh(){return this.pAj.value}get Mc(){return this.JZe.value}lfb(){return!!this.jh.Ef&&
this.jh.Ef.name===Fk.YO}tYl(){this.vWi()}vWi(){this.jh.uf(Fk.YO)}Lwa(){const Q=this.jh.gd(Fk.YO);Q.parent=Hh.AFrame.zo;Q.l6(Object(n.a)(this,this.tYl,"onSetFocus"))}tia(){this.lfb()&&this.jh.uf(this.jh.IW)}$Dd(Q){Ci.UISurfaces.eu().then(sa=>{sa.showTaskPane(Fk.YO,this.wC(Q));this.isVisible&&Q&&this.jh.uf(Fk.YO);return null})}Xu(){Ci.UISurfaces.eu().then(Q=>{Q.updateTaskPane(Fk.YO,this.wC(!1));return null})}kgl(){Ci.UISurfaces.eu().then(Q=>{Q.hideTaskPane(Fk.YO,2);return null})}wC(){const Q=new Aq;
this.fCm(Q);return Object.assign(new Zc.a,{title:Fk.uBb,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:sa=>{this.Qv=!0;If.App.na.z9a(Object(n.a)(this,this.ul,"pollForStateAndUpdate"));If.App.na.updateCommandUI();this.vWi();this.Yd.p9a(Fk.YO,sa)},onClose:()=>{this.tia();this.Qv=!1;If.App.na.jCc(Object(n.a)(this,this.ul,"pollForStateAndUpdate"));If.App.na.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}fCm(Q){const sa=Rf.getRenderAppChromeSettings().numberFormatInfo;
Q.section=this.X7e;Q.numberFormatInfo="object"===typeof sa?sa:null;Q.title=this.yra;Q.description=this.YOc;Q.topCrop=this.PZd;Q.bottomCrop=this.sLd;Q.leftCrop=this.ESd;Q.rightCrop=this.SWd;Q.rotationAngle=this.ZWd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.f4a}onTitleChange(){return Q=>{if(Q!==this.yra){this.yra=Q;var sa=new Nn.DictionaryPropertySet;
sa.setValue(Li.a.vYa,Q);this.Mc.zb(kg.a.NDc,2,sa);this.Xu()}}}onDescriptionChange(){return Q=>{if(Q!==this.YOc){var sa=new Nn.DictionaryPropertySet;sa.setValue(Li.a.a3,Q);this.YOc=Q;this.Mc.zb(kg.a.xDb,2,sa);this.Xu()}}}onCropSpinButtonChange(){return(Q,sa)=>{const db=new Nn.DictionaryPropertySet;switch(sa){case 0:this.PZd=Q;db.setValue(Li.a.$wb,Q);this.Mc.zb(vb.a.cuc,2,db);break;case 1:this.sLd=Q;db.setValue(Li.a.Xwb,Q);this.Mc.zb(vb.a.$tc,2,db);break;case 2:this.ESd=Q;db.setValue(Li.a.Ywb,Q);this.Mc.zb(vb.a.auc,
2,db);break;case 3:this.SWd=Q,db.setValue(Li.a.Zwb,Q),this.Mc.zb(vb.a.buc,2,db)}this.Xu()}}onRotationSpinButtonChange(){return Q=>{this.ZWd=Q;const sa=new Nn.DictionaryPropertySet;sa.setValue(Li.a.jld,0);sa.setValue(Li.a.eU,Q);this.Mc.zb(kg.a.imageRotate,2,sa);this.Xu()}}ul(){let Q=!1;Q=this.i$l()||Q;Q=this.GPa()||Q;Q=this.FPa()||Q;Q=this.LAc()||Q;(Q=this.f$l()||Q)&&this.Xu()}i$l(){const Q=2===this.Mc.zb(kg.a.NDc,1,null),sa=Q!==this.f4a;this.f4a=Q;return sa}GPa(){var Q=new Nn.DictionaryPropertySet;
this.Mc.zb(kg.a.GPa,2,Q);Q=Q.ha(Li.a.vYa,"");const sa=Q!==this.yra;this.yra=Q;return sa}FPa(){var Q=new Nn.DictionaryPropertySet;this.Mc.zb(kg.a.FPa,2,Q);Q=Q.ha(Li.a.a3,"");const sa=Q!==this.YOc;this.YOc=Q;return sa}LAc(){var Q=new Nn.DictionaryPropertySet;this.Mc.zb(vb.a.MAc,2,Q);const sa=Q.ha(Li.a.$wb,0),db=Q.ha(Li.a.Xwb,0),Gb=Q.ha(Li.a.Ywb,0);Q=Q.ha(Li.a.Zwb,0);const Xb=sa!==this.PZd||db!==this.sLd||Gb!==this.ESd||Q!==this.SWd;this.PZd=sa;this.sLd=db;this.ESd=Gb;this.SWd=Q;return Xb}f$l(){var Q=
new Nn.DictionaryPropertySet;this.Mc.zb(kg.a.Jhb,2,Q);Q=Q.ha(Li.a.eU,0);const sa=Q!==this.ZWd;this.ZWd=Q;return sa}}Object(c.a)(zp,"ReactFormatPicturePane",null,[1056,12]);class jp{constructor(){this.bPd=this.Z=null}get name(){return"WordEditor.FormatPicture"}Mb(Q){this.Z=Q;this.Z.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new em(this.Z.resolve("WordEditor.FormatPicture.IFormatPicturePane"),Xl.App.dQg)).fa();this.Z.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new zp(hj.a.instance,
new ub.a(()=>pc.FocusManager.instance()),new ub.a(()=>M.AFrameworkApplication.pa),Mn.a.instance)).fa();this.Z.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new go(M.AFrameworkApplication.pa,this.Z.resolve("WordEditor.FormatPicture.IFormatPictureManager"),Xl.App.dQg)).fa()}init(){if(Xl.App.TFb||Xl.App.THc)this.bPd=this.Z.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.bPd.pb(),If.App.na.updateCommandUI()}dispose(){this.bPd&&this.bPd.dispose()}static main(){fa.a.instance.kc(new jp)}}
Object(c.a)(jp,"WordEditorFormatPicturePackage",null,[1,2]);class Ap{constructor(){this.$gc=this.TZc=null;this.zWd=0}get name(){return"WordEditor.FrameTiming"}Mb(){this.$gc=new EventTiming.FrameTimingMeter;this.zWd=M.AFrameworkApplication.K.vb("FrameTimingMeterReportingIntervalInSeconds",60);0>=this.zWd&&(this.zWd=60);this.TZc=Q=>{(Q=Q.rawEvent)&&pa.ULS.sendTraceTag(24962208,306,50,la.c(Q.detail))};S.a.addHandler(window.self,B.a.KPi,this.TZc)}init(){this.$gc&&this.$gc.start(this.zWd)}dispose(){this.$gc&&
(this.$gc.stop(),this.$gc=null);this.TZc&&(S.a.removeHandler(window.self,B.a.KPi,this.TZc),this.TZc=null)}static main(){fa.a.instance.kc(new Ap)}}Object(c.a)(Ap,"FrameTimingPackageManager",null,[1,2]);var dn=b(1093),tj=b(492);class On extends uf.a{constructor(){super();this.Prompt=0;this.FileId=null}pi(){return 100}static construct(Q,sa){const db=new On;db.FileId=Q;db.Prompt=sa;return db}}Object(c.a)(On,"GraphMergeConsentChangedRequest",uf.a,[]);class Ih{constructor(Q,sa,db,Gb,Xb,Xc=null,zd=null){this.Fi=
!1;this.yP=null;this.Lgh=this.vYe=!1;this.xP=Q;this.X_d=db;this.dFa=Gb;this.DSa=Xb;this.X_d&&this.X_d.FUj(Object(n.a)(this,this.X9h,"handleOnGraphMergeComplete"));this.oS=Xc||ui.a.instance;if(!zd){const ve=new tj.a;zd=yf=>ve.N2(0,yf)}this.ooj=zd}get fAl(){return this.vYe}get cum(){return this.Lgh}trf(){if(this.dFa.Cge)this.vYe=!0;else if(this.vYe=!1,!this.cum){this.Lgh=!0;var Q=this.DSa.aia;pa.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===Q);if(100===Q||400===Q)Q=On.construct(this.xP(),
Q),this.Cv(Q)}}X9h(Q,sa){sa&&sa.mag&&sa.mag.muf&&!this.dFa.omi&&(this.dFa.U$i(),this.dFa.Cge=!0,this.Cv(sa.mag.muf))}Cv(Q){const sa=new Sd.a;sa.fk=Q;sa.status=1;sa.Bv="GraphMerge";const db=this.ooj(()=>{this.W9b(sa,33===Q.pi())});db.cA(sa);db.oI()}W9b(Q,sa){this.Fi||(sa&&(this.dFa.Cge=!1),2===Q.statusCode&&!Z.a.Qua(Q.og)&&1===Q.og.length&&Q.og[0]?(Q=Q.og[0],Q.StatusCode?this.dFa.jAg():sa&&this.DSa.dQi(Object(n.a)(this,this.trf,"consentChoiceMade")),this.oS.sEa(Q),this.fAl&&this.trf()):this.dFa.jAg())}Gva(Q){this.yP=
Q;this.yP.y9a(Object(n.a)(this,this.U9h,"handleOnAfterReplication"));this.yP.$za(Object(n.a)(this,this.V9h,"handleOnAfterResponseReceived"))}U9h(Q,sa){sa&&sa.F2a&&this.dFa.U$i()}V9h(Q,sa){sa&&(sa.ShowMergePrompt&&this.DSa.dQi(Object(n.a)(this,this.trf,"consentChoiceMade")),M.AFrameworkApplication.vg&&(M.AFrameworkApplication.vg.SessionMergeInfo|=sa.PartMergeInfo))}dispose(){this.Fi||(this.X_d&&this.X_d.ukm(Object(n.a)(this,this.X9h,"handleOnGraphMergeComplete")),this.yP&&(this.yP.dib(Object(n.a)(this,
this.U9h,"handleOnAfterReplication")),this.yP.B0a(Object(n.a)(this,this.V9h,"handleOnAfterResponseReceived"))),this.Fi=!0)}}Object(c.a)(Ih,"GraphMergeBackupManager",null,[1235,12]);class Zh{constructor(Q,sa=null,db=null,Gb=null){this.rKe=0;this.oXe=!1;this.S6g=new Date(0);this.Cge=!1;this.DSa=Q;this.Xx=sa||(()=>new Date);db||(db=M.AFrameworkApplication.K?M.AFrameworkApplication.K.vb("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.TBj=db;Gb||(Gb=M.AFrameworkApplication.K?M.AFrameworkApplication.K.vb("WordEditorGraphMergeMaxBackups",
1):1);this.W8g=Gb}get azl(){return+this.Xx()-+this.S6g<this.TBj}get omi(){return 500===this.DSa.aia?!1:100===this.DSa.aia?!0:this.oXe||this.Cge||this.azl}U$i(){this.S6g=this.Xx();this.rKe++;this.rKe>=this.W8g&&this.jAg()}jAg(){this.oXe||(this.oXe=!0,pa.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.rKe,this.W8g))}}Object(c.a)(Zh,"GraphMergeBackupThrottler",null,[1234]);class kp{constructor(Q,sa,db=null){this.N1g=!1;
this.gD=Q;this.jJb=sa;null==db&&(db=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.$4e=db?500:300}get aia(){return this.$4e}dQi(Q){if(!this.N1g&&300===this.aia){var sa=this.jJb.value;sa&&sa.isFeatureEnabled(83)&&(this.N1g=!0,this.gD.execute(db=>{db.JGm(()=>{this.Ogk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.aia&&(pa.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.$4e=100,Q());
this.zNi()}Ogk(Q){300===this.aia&&(pa.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.$4e=400,Q());this.zNi()}zNi(){this.gD.execute(Q=>{Q.egl()})}}Object(c.a)(kp,"GraphMergeCollectionConsentManager",null,[1099]);class jk extends Sys.EventArgs{constructor(Q){super();this.mag=Q}}Object(c.a)(jk,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Eo=b(602),to=b(824),ho=b(526),ug=b(664),Xj=b(1584),Qf=b(1437),Rg=b(184),Op=b(126);class Nl{constructor(Q,sa,db,Gb,
Xb,Xc){this.Pmg=this.ig=null;this.Xod=this.JPg=!1;this.jl=null;this.LDd=Q.runtime.LDd;this.fo=Q;this.Xc=sa;this.Lf=db;this.Zm=Gb;this.Egk=Xb;this.graphNodeComplexMerge=Xc}}Object(c.a)(Nl,"GraphNodeComplexMergeState",null,[]);var ue=b(1192),sl=b(1177);class qn{constructor(Q,sa=null){this.qg=Q;this.Lic=sa||this.ohd()}get iAb(){return this.Lic}get Xc(){return this.qg}ohd(){return[Object(n.a)(this,this.yIm,"simpleMerge"),Object(n.a)(this,this.cgk,"complexMerge")]}jCm(Q,sa,db,Gb,Xb,Xc){Q=new Nl(Q,db,new ub.a(()=>
new ue.a(Gb?Gb.Oi:null,Xb)),new ub.a(()=>new ue.a(Gb?Gb.Oi:null,Xc)),new ub.a(()=>new ue.a(Xc,Xb)),sa.bIh(Xb));Q.ig=Gb.Alc;Q.Pmg=new Rg.a;return Q}merge(Q,sa,db,Gb,Xb,Xc){sa=this.jCm(Q,sa,db,Gb,Xb,Xc);db=!0;for(Gb=0;Gb<this.iAb.length&&db;Gb++)(db=(0,this.iAb[Gb])(sa))||Q.logger.Ume("GraphNodeMerge.GetMergeFunctions()",Gb);if(Q=sa.Xod&&sa.jl?new sl.a(sa.jl,!1):null)switch(Q.dBm(sa.ig),(Q?Q.Oi:Xb).Ab){case 1074135145:sa.fo.runtime.N8b.KFh.W(Q.Oi.id,Q.Oi);break;case 1074135153:sa.fo.runtime.N8b.Dwh.W(Q.Oi.id,
Q.Oi);break;case 1074135127:sa.fo.runtime.N8b.WDh.W(Q.Oi.id,Q.Oi)}return{returnValue:sa.Xod,jl:Q}}yIm(Q){if(Q.fo.runtime.Qa&&Q.fo.runtime.Qa.rvb(1000005)&&0<Q.ig.count)return!0;var sa=Q.graphNodeComplexMerge.gxd;return Q.Zm.value.Rmd(sa)&&Q.Egk.value.Rmd(sa)?Q.Lf.value.Rmd(sa)?!0:(sa=Q.Zm.value.Ie,Q.Xod=!0,Q.jl=sa.gF(),!1):(Q.Xod=!0,!1)}cgk(Q){const sa=Q.Zm.value.Ie;Q.LDd&&Op.a.instance.ya(4018183,1,3,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",sa.id,sa.Ab);const db=Q.graphNodeComplexMerge.MKg(Q);
Q.Xod=db;Op.a.instance.ya(4018184,1,db?4:3,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",db?"Succeeded":"Failed",sa.id,sa.Ab,!!Q.jl);return db}}Object(c.a)(qn,"GraphNodeMerge",null,[1315]);class vg extends uf.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=
0}pi(){return 33}static construct(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg){const Xh=new vg;Xh.FileId=Q;Xh.BaseRevisions=sa;Xh.TheirRevisions=db;Xh.YourRevisions=Gb;Xh.IgnoreConflictsInLastServerRevision=Xb;Xh.MergeHint=Xc;Xh.ObjectSpaceId=zd?$d.a(zd):null;Xh.RequestId=ve?$d.a(ve):null;Xh.Source=yf;Xh.Reason=cf;Xh.Prompt=eg;return Xh}}Object(c.a)(vg,"CreateGraphMergeReplayRequest",uf.a,[]);var Fl=b(698),Pn=b(18),io=b(1586),Ol=b(1551);class Mi{constructor(Q,sa=null,db=null){this.px=Q;this.fD=Q.pj;this.zob=
Q.s6i;this.CMb=Q.ihj;this.XAj=Q.Qqi;this.qg=sa||new to.a;this.lFj=db||Object(n.a)(this,this.ixk,"doParagraphMergeForModifiedObject")}itb(Q){const sa=new Rg.a;for(let db=0;db<Q.length;db++){const Gb=this.dxk(Q.J(db));sa.add(Gb)}return sa}htb(Q,sa,db){const Gb=Q.Xh===Q.gj&&Q.startCp===Q.endCp;sa&&({fQa:Q.Xh,pwa:Q.startCp}=this.LRa(Q.Xh,Q.startCp,Q.Xh,Q.startCp),Gb&&(Q.gj=Q.Xh,Q.endCp=Q.startCp));db&&!Gb&&({fQa:Q.gj,pwa:Q.endCp}=this.LRa(Q.gj,Q.endCp,Q.gj,Q.endCp));return Q}dxk(Q){if(Q.Xh===Q.gj){var sa=
new Rg.a;sa.add(Q.startCp);sa.add(Q.endCp);({fQa:db,Z9b:Gb}=this.DNg(Q.Xh,sa,db,Gb));return new Fl.a(db,Gb.J(0),db,Gb.J(1))}var db=new Rg.a;var Gb=new Rg.a;let Xb,Xc,zd;db.add(Q.startCp);({fQa:sa,Z9b:Xc}=this.DNg(Q.Xh,db,sa,Xc));Gb.add(Q.endCp);({fQa:Xb,Z9b:zd}=this.DNg(Q.gj,Gb,Xb,zd));return new Fl.a(sa,Xc.J(0),Xb,zd.J(0))}DNg(Q,sa,db,Gb){db=Q;Gb=sa;if(!this.fD.J(Q))return pa.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",
Q),{fQa:db,Z9b:Gb};if(this.zob.get(Q))({fQa:db,Z9b:Gb}=this.lFj(Q,sa,db,Gb));else if(this.px.Ihe&&!this.px.Ihe.J(this.px.Ihe.length-1).ew(Q)){Gb=new Rg.a;for(let Xb=0;Xb<sa.length;Xb++){let Xc;({fQa:db,pwa:Xc}=this.LRa(Q,sa.J(Xb),db,Xc));Gb.add(Xc)}}return{fQa:db,Z9b:Gb}}K1h(Q){let sa="";Q.forEach(db=>{sa+=db.aFb();sa+=" ";return!0});return sa}U1h(Q){const sa=za.a.instance.sa("Box4.IFeatureHelper"),db=new io.a;db.input.source=this.px.gge;db.input.s3=this.px.s3;db.input.kdd=()=>sa;db.runtime.pj=this.fD;
db.runtime.sKa=this.px.pEh;1===Q?(db.runtime.Lw=this.CMb,db.runtime.Hp=this.zob,db.runtime.$$d=this.px.n4f,db.runtime.REe=this.px.r4f):2===Q&&(db.runtime.Lw=this.zob,db.runtime.Hp=this.CMb,db.runtime.$$d=this.px.r4f,db.runtime.REe=this.px.n4f);db.runtime.Qa=sa;return db}ixk(Q,sa,db,Gb){db=Q;Gb=sa;var Xb=this.zob.get(Q);if(!Xb)return{fQa:db,Z9b:Gb};Gb=new Rg.a;Gb.add(Xb);var Xc=this.CMb.get(Q)||this.fD.J(Q);Xb=new Rg.a;Xb.add(Xc);Xc=new Rg.a;Xc.add(this.fD.J(Q));pa.ULS.sendTraceTag(17409890,318,50,
"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.px.gge,this.px.s3,this.K1h(Xb),this.K1h(Gb));var zd=this.U1h(this.px.s3);Xb=new Ol.a(zd,Xc,1===zd.input.s3?Xb:Gb,1===zd.input.s3?Gb:Xb,this.U1h(1),Xb,Gb);Gb=new Rg.a;for(Xc=0;Xc<sa.length;Xc++){this.px.NF("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const ve=({rib:db,pwa:zd}=Xb.CHd(Q,sa.J(Xc))).returnValue;Gb.add(zd);ve?pa.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",
Q,sa.J(Xc),db,zd):pa.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Q)}return{fQa:db,Z9b:Gb}}s1k(Q,sa){let db=0;for(let Gb=0;Gb<Q.length;Gb++)if(sa.equals(Q.J(Gb)))return db=Gb,{returnValue:!0,OMa:db};return{returnValue:!1,OMa:db}}LRa(Q,sa){const db=this.XAj&&!!this.CMb.J(Q)&&!this.fD.J(Q);let Gb=Q,Xb=sa,Xc=!1,zd=!1;(db?this.CMb:this.zob).forEach((ve,yf)=>{this.px.NF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.Y0f(yf.Ab)&&this.fD.J(ve)){yf=null;if(db){yf=this.Ohd(eg=>this.CMb.J(eg)||this.fD.J(eg),ve);var cf=this.mke(yf,Q)}else cf=this.Ohd(eg=>this.fD.J(eg),ve),cf=this.mke(cf,Q);if(cf&&(zd=!0,yf||(yf=this.Ohd(eg=>this.CMb.J(eg)||this.fD.J(eg),ve)),ve=this.Ohd(eg=>this.zob.J(eg)||this.fD.J(eg),ve),cf=0,({OMa:cf}=this.s1k(yf,Q)).returnValue)){for(let eg=cf+1;eg<yf.length;eg++)if(this.mke(ve,yf.J(eg)))return Xb=0,Gb=yf.J(eg),Xc=!0,!1;for(--cf;0<=cf;cf--)if(this.mke(ve,yf.J(cf)))return Xb=Number.MAX_VALUE,
Gb=yf.J(cf),Xc=!0,!1}}return!0});if(!Xc&&(pa.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,sa,db,zd),5===this.px.gge)){pa.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Gb);let ve;({CTh:ve}=this.GUk(ve)).returnValue?(Gb=ve,
Xb=0,pa.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Gb)):pa.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Gb)}return{fQa:Gb,pwa:Xb}}GUk(Q){Q=jb.a.nil;let sa=new Rg.a;this.zob.forEach((db,Gb)=>{this.px.NF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.Y0f(Gb.Ab)?(sa=this.Ohd(Xb=>this.zob.J(Xb)||this.fD.J(Xb),db),!1):!0});return 0<sa.length?(Q=sa.J(0),{returnValue:!0,CTh:Q}):{returnValue:!1,CTh:Q}}Y0f(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}Ohd(Q,sa){var db=Q(sa);sa=new Rg.a;if(!this.Y0f(db.Ab))return sa;db=this.qg.getPropertyObjectIds(db,Pn.a.ff);for(let Gb=0;Gb<db.length;Gb++){const Xb=new Rg.a;this.JNf(Q,db.J(Gb),Xb);sa.aw(sa.length,Xb)}return sa}JNf(Q,sa,db){var Gb=Q(sa);if(Gb)if(393230===Gb.Ab)db.add(sa);else if(393229===
Gb.Ab)sa=this.qg.getPropertyObjectIds(Gb,Pn.a.pfa).Ye(0),this.JNf(Q,sa,db);else if(393250===Gb.Ab||393251===Gb.Ab||393252===Gb.Ab)for(sa=this.qg.getPropertyObjectIds(Gb,Pn.a.ff),Gb=0;Gb<sa.length;Gb++)this.JNf(Q,sa.J(Gb),db)}mke(Q,sa){for(let db=0;db<Q.length;db++)if(sa.equals(Q.J(db)))return!0;return!1}}Object(c.a)(Mi,"GraphMergeSelectionRecordUpdater",null,[]);class ne extends Xj.a{constructor(Q=null,sa=null,db=null,Gb=null,Xb=null,Xc=null,zd=null,ve=null,yf=-1,cf=null,eg=null,Xh=null){super();
this.xP=Q||(()=>M.AFrameworkApplication.rootQuerySignature);sa||(sa=Nj=>new Eo.a(Nj));this.wfh=sa;this.qg=db||new to.a;this.uVg=zd||new Qf.ChildNodeListMerge(this.Xc);this.L7a=ve;this.ARi||(this.L7a=(Nj,dh,dl)=>new ho.a(Nj,dh,dl));this.Lic=Gb||this.ohd();this.snb=Xb||new vh.a;this.w1g=Xc||new qn(this.Xc);this.b9g=void 0===yf||null===yf||-1===yf?Xl.App.wGe:yf;this.dFa=cf;this.DSa=eg;this.fge=this.buk(Xh);this.C_g=()=>za.a.instance.sa("Box4.IFeatureHelper")}buk(Q){Q||(Q=M.AFrameworkApplication.K?M.AFrameworkApplication.K.vb("WordEditorGraphMergeBackupCasesBrowser",
0):0);return Q}OLa(){return(new Date).getTime()}U3i(Q,...sa){return String.format.apply(null,[Q].concat(sa))}IPm(Q){throw Ef.a.invalidOperation(Q);}Xce(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}N5l(Q){if(this.dFa&&this.dFa.omi||!this.TMm(Q))return null;this.gGl(Q);let sa;({I1j:Gb,sPm:Xb,N3m:sa}=this.Iok(Q,Object(n.a)(this,this.$Ih,"createSerializedRevisionFrom")));const db=Xj.a.sVk(Q);var Gb=vg.construct(this.xP(),Gb.iY(),Xb.iY(),sa.iY(),Q.input.Ytc,Q.input.s3,
Q.input.Kg,Q.input.O3b,Q.input.source,db,this.DSa.aia);var Xb=Q.output.LK;3===db&&0<Xb.length&&(Gb.MergedRevision=this.$Ih(Q.output.LK.last()));return Gb}$Ih(Q){const sa=Q.wG,db=If.App.na.Aa.Nb;return new ug.a(Q,sa,db.wc,db.fileId,db.Tna,db.contextId,sa?sa.id:jb.a.nil,this.ARi,!1,!0)}itb(Q,sa){return(new Mi(Q)).itb(sa)}htb(Q,sa,db,Gb){return(new Mi(Q)).htb(sa,db,Gb)}}Object(c.a)(ne,"GraphMerger",Xj.a,[]);class fm extends ne{constructor(Q,sa=null,db=null){super(Q,void 0,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,sa,db);this.la=new m.a}get aia(){return this.DSa?this.DSa.aia:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}FUj(Q){this.la.addHandler(fm.wRf,Q)}ukm(Q){this.la.removeHandler(fm.wRf,Q)}vEc(){return!1}a_a(Q,sa,db,Gb,Xb,Xc,zd){(Q=super.a_a(Q,sa,db,Gb,Xb,Xc,zd))&&this.la.raiseEvent(fm.wRf,new jk(Q));return Q}}fm.wRf="GMC";Object(c.a)(fm,"WordEditorGraphMerger",ne,[1092,1093,1094]);class gq{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}Mb(Q){this.Z=
Q;this.Z.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new kp(this.Z.Da("WordEditor.IBusinessBarController"),new ub.a(()=>Q.sa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").fa();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Zh(this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").fa();this.Z.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new fm(()=>M.AFrameworkApplication.rootQuerySignature,
this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").fa();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Ih(()=>M.AFrameworkApplication.rootQuerySignature,M.AFrameworkApplication.pa,this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.Z.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.Z.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").fa()}init(){If.App.Wu||
(If.App.Wu=dn.a.t2());const Q=this.Z.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");If.App.Wu.ewh(Q);this.Z.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.Z.sa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(c.a)(gq,"GraphMergePackage",null,[1,2]);var Zo=b(102);class Vi{constructor(Q){this.Yic=0;this.tg=Q}mKh(Q){this.Yic=Math.max(0,--this.Yic);this.aPi(Q);0<this.Yic&&window.setTimeout(()=>{this.mKh(Q)},1E3)}aPi(Q){Q.style.backgroundColor="rgba(255,0,0,"+Math.min(1,
this.Yic/20)+")"}dPi(Q){this.tg&&this.tg.I1l&&(this.Yic++,this.aPi(Q),this.tg.fyi=Uh.a.Gbe(Q,!1),1===this.Yic&&window.setTimeout(()=>{this.mKh(Q)},1E3))}}Object(c.a)(Vi,"ParagraphRenderVisualizationManager",null,[1096]);class nl{constructor(Q,sa,db,Gb,Xb){this.BZc=this.MMd=this.c2c=this.tg=null;this.GNe=new V.a;this.EZc=null;this.W$g=0;this.ea=Q;this.HJ=sa;this.Yd=db;this.Nza=Gb;this.UWg=Xb}get I1l(){return this.BZc?this.BZc.checked:!1}get fyi(){return this.W$g}set fyi(Q){this.EZc&&(this.EZc.innerText=
String.format("Total number of child elements in last rendered paragraph: {0}",Q));this.W$g=Q}pb(){this.ea.ma(vb.a.htf,qh.a.application,Object(n.a)(this,this.showTaskPane,"showTaskPane"))}dispose(){null!==this.tg&&(this.HJ.gtb(nl.Py,this.tg),this.tg=null);this.Nza.execute(Q=>{this.jRh(Q,sa=>{sa.Ikm(Object(n.a)(this,this.qDi,"onTypingSpeedMeterWindowAvailable"))})});this.UWg.execute(Q=>{this.iRh(Q,sa=>{sa.jsg(Object(n.a)(this,this.H6b,"onCpuMeterFrameAvailable"))})})}qDi(Q,sa){this.c2c&&(this.c2c.innerText=
sa.pOl+" CPM")}H6b(Q,sa){this.MMd&&(this.MMd.innerText=sa.ctd.CP+"%",this.GNe.add(sa.ctd.CP))}z7d(){const Q=new Rd.CuiHelper(Zo.a.mrb,Box4Intl.Box4Strings);this.tg=this.HJ.A7d(nl.Py,0,nl.width,"InteractivePerfTaskPaneData",Q);this.Rjk();this.Ojk();this.Qjk()}showTaskPane(){if(!If.App.na.TEb)return 16;this.tg||this.z7d();this.HJ.showTaskPane(this.tg);this.tg.element.style.overflow="scroll";return 32}bLf(Q){Q=document.getElementById(Q);return Uh.a.Bta(Uh.a.Bta(Q,"cui-groupContainer"),"cui-groupBody")}iRh(Q,
sa){const db=Q.wq.task;db.continueWith(()=>{sa(db.result)})}jRh(Q,sa){const db=Q.wq.task;db.continueWith(()=>{sa(db.result)})}Rjk(){const Q=this.bLf("TypingSpeedMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const sa=document.createElement("div");sa.innerText="Typing Speed";this.c2c=document.createElement("div");this.c2c.innerText="0 CPM";this.Nza.execute(db=>{this.jRh(db,Gb=>{Gb.oVj(Object(n.a)(this,this.qDi,"onTypingSpeedMeterWindowAvailable"))})});Q.appendChild(sa);Q.appendChild(this.c2c)}Ojk(){const Q=
this.bLf("CpuMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const sa=document.createElement("div");sa.innerText="CPU Meter";this.MMd=document.createElement("div");this.UWg.execute(Xb=>{this.iRh(Xb,Xc=>{Xc.i1d(Object(n.a)(this,this.H6b,"onCpuMeterFrameAvailable"))})});const db=document.createElement("div"),Gb=document.createElement("button");Gb.innerText="View Cpu Percent";this.Yd.Ma(B.a.click,Gb,Object(n.a)(this,this.pwk,"displayCpuPercentLogs"));db.appendChild(Gb);Q.appendChild(sa);Q.appendChild(this.MMd);
Q.appendChild(db)}Qjk(){const Q=this.bLf("RenderGroup"),sa=document.createElement("label");sa.innerText="Enable render visualizations";this.BZc=document.createElement("input");this.BZc.setAttribute("type","checkbox");Q.appendChild(this.BZc);Q.appendChild(sa);this.EZc=document.createElement("div");this.EZc.style.margin="10px";Q.appendChild(this.EZc);za.a.instance.ia("Box4.IParagraphRenderVisualizationManager",()=>new Vi(this))}pwk(){const Q=oa.a.En("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;
Q.writeln("<HEAD>");Q.writeln('<STYLE type="text/css">');Q.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");Q.writeln("</STYLE>");Q.writeln("</HEAD>");Q.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const sa=document.createElement("div");var db=document.createElement("div");db.innerText=String.format("{0}, {1}","Frame","CpuPercent");sa.appendChild(db);for(db=0;db<this.GNe.count;db++){const Gb=this.m4j(db,this.GNe.J(db));Gb&&sa.appendChild(Gb)}Q.writeln(sa.innerHTML);Q.writeln("</BODY>");
Q.close();return!0}m4j(Q,sa){Q=Q.toString();sa=sa.toString();const db=document.createElement("div");db.innerText=String.format("{0}, {1}",Q,sa);return db}}nl.Py="InteractivePerfTaskPane";nl.width=400;Object(c.a)(nl,"InteractivePerfTaskPane",null,[]);class jo{constructor(){this.tg=null}get name(){return"WordEditor.InteractivePerfTaskPane"}Mb(Q){Q.ia("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",()=>new nl(M.AFrameworkApplication.pa,hj.a.instance,M.AFrameworkApplication.oa.EA,Q.Da("Common.ITypingSpeedMeterProvider"),
Q.Da("Common.ICpuMeterProvider"))).fa()}init(){if(this.tg=za.a.instance.sa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.tg.pb(),"1"===Qc.a.XT(document.URL,"wdShowIPerfTaskPane")&&M.AFrameworkApplication.pa.processAction(vb.a.htf,2)}dispose(){this.tg&&(this.tg.dispose(),this.tg=null)}static main(){fa.a.instance.kc(new jo)}}Object(c.a)(jo,"InteractivePerfTaskPanePackageManager",null,[1,2]);var lp=b(266);class hq{constructor(Q){this.DMe="FontPicker";this.PWe=null;this.Jlb=Q;this.xOd=
this.Jlb.uDa(lp.a.S2b,Object(n.a)(this,this.Cbb,"featureStateChangeCallback"));this.Jlb.isFeatureEnabled(lp.a.S2b,!1).then(sa=>{this.PWe=sa})}get isLicensed(){return this.PWe}Cbb(Q){this.PWe=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.DMe,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.Jlb.dCc(lp.a.S2b,this.xOd)}}Object(c.a)(hq,"ModernFontPickerFeatureHelper",null,[1048,12]);var Ok=b(434),om=b(557),en=b(1372);class uo{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=
null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(c.a)(uo,"FontInfoTaskPaneProps",null,[]);class Pp{constructor(Q,sa,db,Gb=null){this.ubf=this.vP=this.xOd=null;this._state=this.mic=0;this.JZe=Q;this.Jlb=sa;this.moj=db;this.kb=Gb}get Mc(){return this.JZe.value}initialize(){this.Mc.ma(mb.a.Stg,Lc.a.frame,Object(n.a)(this,this.Stg,"requestFontInfo"));this.xOd=this.Jlb.uDa(lp.a.S2b,Object(n.a)(this,this.Cbb,"featureStateChangeCallback"));this.Lwa()}WU(Q=!1){const sa=
Ci.UISurfaces.eu(),db=this.Jlb.isFeatureEnabled(lp.a.S2b,!1),Gb=[];Gb.push(sa);Gb.push(db);Promise.all(Gb).then(Xb=>{Xb[0].showTaskPane(en.a.nXb,this.wC(Xb[1]));Q&&this.UR()})}XYm(Q){Ci.UISurfaces.eu().then(sa=>{sa.updateTaskPane(en.a.nXb,this.wC(Q));return null})}Cbb(Q){this.XYm(Q.isEnabled)}Stg(Q,sa,db,Gb,Xb){this.vP=Xb.CommandValueId;this.ubf=Xb.Trigger;this.mic=Xb.InputMethod;this.WU(2===this._state&&1===this.mic);return 32}wC(Q){const sa=new uo;sa.onUpsellButtonClicked=Object(n.a)(this,this.onUpsellButtonClicked,
"onUpsellButtonClicked");sa.fontName=this.vP;sa.isLicensed=Q;sa.trigger=this.ubf;sa.helpArticleUrl=this.Wgk();sa.paneId=en.a.nXb;Q=this.yjl();Q.contentProps=sa;return Q}yjl(){return Object.assign(new Zc.a,{title:en.a.uBb,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(n.a)(this,this.onOpen,"onOpen"),onClose:Object(n.a)(this,this.onClose,"onClose"),onShow:Object(n.a)(this,this.onShow,"onShow"),onHide:Object(n.a)(this,this.onHide,
"onHide")})}Lwa(){if(this.kb){var Q=this.kb.gd(en.a.nXb);Q.parent=Hh.AFrame.zo;Q.iR=!0}}onOpen(){this._state=2;this.UR()}onShow(Q){this._state&&(this._state=2,1===Q&&(this.mic=Q),this.UR())}onClose(){this.mic=this._state=0;this.blur()}onHide(){this._state=1;this.mic=0}UR(){this.kb&&1===this.mic&&this.kb.uf(en.a.nXb)}blur(){this.kb&&this.kb.Ef&&this.kb.Ef.name===en.a.nXb&&this.kb.uf(this.kb.IW)}onUpsellButtonClicked(){this.Jlb.launchUpsellExperience(en.a.experienceId)}dispose(){this.Jlb.dCc(lp.a.S2b,
this.xOd)}Wgk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.moj,this.aWk(),"WDWAENDUSER",M.AFrameworkApplication.lcid)}aWk(){switch(this.ubf){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Pp.S3j(this.vP)}static S3j(Q){let sa="hlpFontInfo";for(let db=0;db<Q.length;++db){const Gb=Ta.a.charAt(Q,
db);if(255<Q.charCodeAt(db)||Ta.a.Sfi(Gb))sa+=Gb}return sa}}Object(c.a)(Pp,"FontInfoPane",null,[1047,12]);class qs extends Pp{constructor(Q,sa,db,Gb,Xb){super(Q,sa,Gb.Oa("FontInfoHelpBaseUrl"),Xb);this.HJ=db}WU(Q){this.f2();super.WU(Q)}Cbb(Q){super.Cbb(Q);If.App.na.updateCommandUI()}f2(){this.HJ.GWa()}}Object(c.a)(qs,"WordEditorFontInfoPane",Pp,[]);class Pq{constructor(){this.Sgc=this.pTd=this.dRc=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}Mb(Q){this.Z=Q;Q.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new hq(this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).fa();Q.ia("Common.ModernFontPicker.IFontInfoPane",()=>new qs(new ub.a(()=>M.AFrameworkApplication.pa),this.Z.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),hj.a.instance,M.AFrameworkApplication.K,pc.FocusManager.instance())).fa()}init(){this.pTd=this.Z.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.dRc=this.Z.resolve("Common.ModernFontPicker.IFontInfoPane");
this.dRc.initialize();M.AFrameworkApplication.K.$("IsAnonymousUser")||((this.Sgc=this.Z.sa(om.a))?this.Sgc.initialize():pa.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));If.App.na.updateCommandUI()}dispose(){this.dRc&&(this.dRc.dispose(),this.dRc=null);this.pTd&&(this.pTd.dispose(),this.pTd=null);this.Sgc&&(this.Sgc.PBh(),this.Sgc=null)}static main(){Object(Ok.a)()&&fa.a.instance.kc(new Pq)}}Object(c.a)(Pq,"ModernFontPickerPackage",null,[1,2]);var vk=b(122),kk=
b(6),Pk=b(36),tl=b(846);class Yj{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh=null){this.Ty=db;this.BUd=Gb;this.Tb=Q;this.Ub=sa;this.Zd=Xb;this.tSa=Xc;this.b1=zd;this.cVg=ve;this.bVg=yf;this.Jp=cf;this.zc=eg;this.NMd=Xh||Yj.Ax}get Tf(){return this.Jp?this.Jp.Tf:!1}dei(Q){return this.wua(Q,0)}Oll(Q){return this.wua(Q,1)}wua(Q,sa){let db=null;if(this.Tf&&this.b1&&(this.bVg.instance&&this.bVg.instance.wRa(Q),sa?1===sa&&(db=this.b1.M1h(Q.node)):db=this.b1.nJf(Q.node,Q.cpBegin,Q.gb),db&&!db.ha(fb.a.qeb,
!1)))return pa.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Gb=kk.GraphIterator.rz(this.Tb.hj());Gb.set(Q.node);Gb.Na(10);const Xb=this.Ub.tc(15);Xb.sr(Gb);sa?Pk.OutlineElementNavigator.Hc(Gb):(this.splitParagraph(Gb,Q),this.Ty.Scc(Q.node,fg.a.tq));Q=uk.ParagraphReader.Pm(Gb.currentNode);this.Mml(Gb);this.Tf&&db&&this.cVg&&(sa=new V.a,sa.add(Gb.currentNode),this.cVg.Inh(sa,db.id));this.Oxm(Q);Xb.dispose();return 32}Oxm(Q){Q=Hg.SelectionFactory.ae(Q,
0);Km.a.instance.setSelection(Q)}Mml(Q){this.Zd.IB(Q,!0,!0,null,!1,!1);Q=Pk.OutlineElementNavigator.Gd(Q);this.Pll(Q)}splitParagraph(Q,sa){const db=Pk.OutlineElementNavigator.Hc(Q);if(sa.cpBegin||this.Tf&&(!this.Tf||-1!==sa.gb)){wj.a.instance.J(50)&&If.App.Lb.Sk&&sa.cpBegin!==uk.ParagraphReader.textLength(sa.node)&&If.App.Lb.Am.zD(sa.node);this.Zd.IB(Q,!1,!0,null,!1,!0);var Gb=kk.GraphIterator.rz(this.Tb.hj());Gb.set(db);this.Zd.Eia(Gb,Q,sa,!0,!0,!0)}}Pll(Q){Q=this.NMd(Q);this.tSa.SWf(Q)}static get characterPropertiesEditor(){return Yj.Wb||
(Yj.Wb=za.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static kF(){return new Yj(new Vm.a,new ip.a,za.a.instance.resolve("Box4.IAutoCorrectScheduler"),tl.a.instance,za.a.instance.resolve("Box4.IOutlineElementEditor"),za.a.instance.resolve("Box4.IBlobEditor"),za.a.instance.sa("Box4.IContentControlReader"),za.a.instance.sa("Box4.IContentControlEditor"),za.a.instance.Da("Box4.IContentControlConverter"),za.a.instance.sa("Box4.ContentControlConfigSettings"),za.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return Yj.ra||
(Yj.ra=Yj.kF())}static Ax(Q){return lm.a.Ax(Q)}}Yj.Wb=null;Yj.ra=null;Object(c.a)(Yj,"PageBreakInserter",null,[1133]);class wk{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){this.ea=Q;this.zVe=sa;this.Ub=db;this.nl=Gb;this.QXe=Xb;this.yl=Xc;this.Oyj=zd;this.ib=ve}pb(){this.ea.ma(vb.a.wua,qh.a.view,Object(n.a)(this,this.Pml,"insertPageBreakViewHandler"));this.ea.ma(vb.a.wua,qh.a.xc,Object(n.a)(this,this.Oml,"insertPageBreakIpHandler"));this.ea.ma(vb.a.wua,qh.a.table,Object(n.a)(this,this.Nml,"insertPageBreakBeforeTableHandler"));
this.ea.qc(vb.a.wua,4)}LU(){const Q=pc.FocusManager.instance().gd(vk.AppFrame.MD);Hh.AFrame.Mi(Q,Mf.KeyInputManager.Db(fg.a.tq,Mf.KeyInputManager.Vh),vb.a.wua)}Pml(Q,sa,db,Gb){var Xb=sa.view,Xc=Xb.Xa.Lg;if(!Xc)return 2;if(!this.cof(sa))return 8;if(1===db)return 32;let zd=!0;db=8;const ve=this.QXe(Xc);Xc=this.Ub.tc(15);Xc.Va(Xb.Oc);Xc.Bm=Q;ve||(db=this.ea.Qe(sa,kg.a.Zsa,2,!0,Gb,null),Q=32===db,pa.ULS.shipAssertTag(4208012,314,Q),zd=Q);zd&&(Xb=Xb.Xa.Lg,Q=this.QXe(Xb),pa.ULS.shipAssertTag(4208013,314,
Q,"{0}",{["ContextId"]:sa.contextId}),db=8,Q&&(db=this.zVe.dei(Xb),pa.ULS.shipAssertTag(4208014,314,32===db)));Xc.dispose();32===db&&this.ib.hq(10);return db}Ptl(Q){return this.wv(Q.iterator)}zwl(Q){Q=Q.J(0);const sa=xe.SelectionEditor.mk(Q,!0,!1);if(this.wv(sa.xa.iterator))return!0;Q=xe.SelectionEditor.mk(Q,!1,!1);return this.wv(Q.xa.iterator)}wv(Q){return Q.Na(14)}Oml(Q,sa,db){if(!sa||sa.contextId!==qh.a.xc)return 8;if(1===db)return sa.contextId===qh.a.xc?32:8;if(2===db){if(!this.cof(sa))return 8;
Q=this.zVe.dei(sa);32===Q&&this.ib.hq(10);return Q}return 32}Nml(Q,sa,db){if(!sa||sa.contextId!==qh.a.table)return 8;if(1===db)return 32;if(2===db){if(!this.cof(sa))return 8;Q=this.zVe.Oll(sa);32===Q&&this.ib.hq(10);return Q}return 32}cof(Q){let sa=null;if(Q.contextId===qh.a.view){sa=Q.view;if(!sa.features.cFd)return!1;Q=sa.Xa.Lg;if(!Q)return!1}else{var db=kk.GraphIterator.wa(Q.node);if(db.Na(36)||db.Na(38)||db.Na(40)||db.Na(14))return!1}return Q.contextId===qh.a.table?wj.a.instance.J(14)&&this.yl.Atl(Q.node):
wj.a.instance.J(14)&&!this.yl.ytl(Q)||this.nl&&this.nl.instance&&this.nl.instance.ZQ(Q)?!1:((db=this.QXe(Q))?this.Ptl(Q):this.zwl(sa.Xa.Fa))||db&&this.Oyj(Q,!0)?!1:!0}static kF(){return new wk(M.AFrameworkApplication.pa,Yj.instance,new ip.a,za.a.instance.Da("Box4.IExternalSelectionManager"),xe.SelectionEditor.He,$b.a.instance,oe.HyperlinkReader.M7,za.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return wk.ra||(wk.ra=wk.kF())}}wk.ra=null;Object(c.a)(wk,
"PageBreakActor",null,[1090]);class Bq{constructor(){this.d3e=this.Z=null}get name(){return"WordEditor.PageBreak"}Mb(Q){this.Z=Q}init(){this.Z.resolve("Box4.IFeatureHelper").Rk.continueWith(()=>{this.Wk()})}Wk(){this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(142)&&(this.d3e=wk.instance,this.d3e.pb(),this.d3e.LU(),If.App.na.updateCommandUI())}dispose(){}}Object(c.a)(Bq,"PackageManager",null,[1,2]);var Xg=b(1095),ko=b(73),lh=b(1097),$o=b(226),Po=b(142),ym=b(230),zr=b(258),zg=b(477);class Cq{constructor(Q,
sa,db,Gb,Xb,Xc,zd,ve){this.BNb=null;this.la=new m.a;this.$Ne=1;this.pSd=-1;this.O6a=null;this.ea=Q;this.Ea=sa;this.Za=db;this.HNd=Gb;this.VA=Xb;this.Mt=Xc;this.bI=zd;this.$Qd=ve;this.enable()}get GUb(){return this.$Ne}UYi(Q){this.$Ne!==Q&&(this.$Ne=Q,this.la.raiseEvent("X"),this.e1f&&this.iNg())}get e1f(){const Q=za.a.instance.sa("WordEditor.Pagination.IPageEndMarkers");return Q?Q.e1f:!0}get sg(){return this.VA.value}get Oj(){return Xi.a.instance}PTj(Q){this.la.addHandler("X",Q)}iNg(){this.Oj.Cd(()=>
{this.bI.uM(this.$Qd?zg.a.ovd:zg.a.pvd)},"CPC:UPN")}enable(){this.Ea.pC(Object(n.a)(this,this.Kva,"onProcessSetSelectionFinished"));this.pmf()}Kva(){this.pmf()}pmf(){if(!this.O6a||1>=this.O6a.count)this.UYi(1);else{var Q=this.Ea.Fa.Pa;if(Q){var sa=Q.gf?Q.mc:Q.xa;!sa||0>sa.cpBegin||(Q=sa.node)&&uk.ParagraphReader.Hb(Q)&&this.ntl(Q)&&(this.BNb&&(this.Za.Oe(this.BNb),this.BNb=null),this.BNb=new Nb.a(2,1,400,db=>{this.findCurrentPageFromIp(db,sa)},62),this.Za.Cb(this.BNb))}}}ntl(Q){Q=kk.GraphIterator.wa(Q);
return Q.Na(35)||Q.Na(37)||Q.Na(39)?!1:!0}Jbj(Q){this.O6a=Q;this.Gaj()}Gaj(){if(-1!==this.pSd){var Q=this.sFk(this.pSd);-1!==Q&&this.UYi(Q)}}findCurrentPageFromIp(Q,sa){this.BNb===Q&&(this.BNb=null,this.pSd=this.NLk(sa),-1!==this.pSd&&this.Gaj())}sFk(Q){if(!this.O6a)return-1;for(let sa=0;sa<this.O6a.count;sa++){const db=this.O6a.J(sa);if(Q>db.Omh&&Q<db.Omh+db.height)return db.pageNumber}return-1}NLk(Q){var sa=this.C1k(Q);if(!sa||!sa.htmlElement)return-1;const db=sa.getBounds();Q=this.qRk(Q,sa);if(!Q)return-1;
sa=oa.a.Zcb(this.HNd.gPa,sa.htmlElement).y;return Q.y+Math.floor(Q.height/2)-db.y+sa}C1k(Q){return Q.node.zd(this.sg.eb)}qRk(Q,sa){Q=this.Mt?this.Mt.AAa(Q,!0):Q.cpBegin;return zr.a.rl(sa,Q)}disable(){this.Ea.yDa(Object(n.a)(this,this.Kva,"onProcessSetSelectionFinished"))}}Object(c.a)(Cq,"CurrentPageCalculator",null,[1248,1243]);class Qo{constructor(Q,sa){Qo.IY=Q;this.fWe=sa}get mpc(){return Qo.IY}get gje(){return this.fWe}get GUb(){return this.mpc.GUb}Kzk(){this.fWe=!0;this.mpc.enable()}pvk(){this.fWe=
!1;this.mpc.disable()}}Qo.IY=null;Object(c.a)(Qo,"CurrentPageManager",null,[1247]);var zm=b(97);class rn extends Sys.EventArgs{constructor(Q,sa){super();this.Swi=sa}}Object(c.a)(rn,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Am extends Sys.EventArgs{constructor(Q,sa,db){super();this.delta=Q;this.Swi=db}}Object(c.a)(Am,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class Ud{constructor(Q,sa){this.Gdh=this.DVd=-1;this.DUd=null;this.la=new m.a;this.W0e=!1;this.VA=Q;this.HV=sa;this.H6a=
new V.a;this.sg.aqh(Object(n.a)(this,this.g1l,"pageViewOnAfterValidate"));this.RTf()}get sg(){return this.VA.value}get gPa(){this.DUd||(this.DUd=this.sg.Oc.zd(this.sg.eb).gPa,pa.ULS.shipAssertTag(34136386,336,!!this.DUd));return this.DUd}QUj(Q){this.la.addHandler("OnPageContentSizeChangeKey",Q)}g1l(Q,sa){this.W0e=this.qak();sa.Ova||this.HV.value.measure(Object(n.a)(this,this.mak,"checkForDocumentSizeChanges"))}mak(){const Q=this.gPa.clientHeight;this.lak(Q);this.sak(Q)}lak(Q){Q!==this.Gdh&&(this.la.raiseEvent("OnDocumentBottomChangeKey",
new rn(Q,this.W0e)),this.Gdh=Q)}sak(Q){Q!==this.DVd&&(-1!==this.DVd&&this.la.raiseEvent("OnPageContentSizeChangeKey",new Am(Q-this.DVd,Q,this.W0e)),this.DVd=this.gPa.clientHeight)}qak(){let Q=!1;for(let sa=this.H6a.count-1;0<=sa;sa--)this.H6a.J(sa).hasChildNodes()&&(this.H6a.removeAt(sa),Q=!0);return Q}RTf(){If.App.Yh.Bj.Nd(23).ro(Object(n.a)(this,this.Zhg,"outlineGroupOnPropertyChanged"))}Zhg(Q,sa){sa.property===zm.a.PD&&(Q=sa.node)&&Q.ha(zm.a.PD,!1)&&(Q=Q.zd(this.sg.eb))&&(Q=Q.htmlElement)&&this.H6a.add(Q)}}
Object(c.a)(Ud,"DocumentSizeManager",null,[]);var Bm=b(68),Bp=b(255);class En{constructor(Q){this.VA=Q}get sg(){const Q=this.VA.value;pa.ULS.shipAssertTag(37820298,336,Q.vj,"OutlineManager.PageView is not a PageView.");return Q}Ize(Q,sa){const db=Bm.a.eh(En.Cj.XD(Q),1);sa+=db;Q.zd(this.sg.eb).htmlElement.firstChild.style.minHeight=sa+"px"}w_h(){const Q=kk.GraphIterator.wa(this.sg.Oc);Q.Fo();Q.Vd();pa.ULS.shipAssertTag(37820299,336,10===Q.Fj.type);return Q.Fj}r1h(){const Q=kk.GraphIterator.wa(this.sg.Oc);
Q.Fo();Q.YT();pa.ULS.shipAssertTag(37820300,336,10===Q.Fj.type);return Q.Fj}c3k(Q){const sa=kk.GraphIterator.wa(this.sg.Oc);sa.Fo();sa.Vd();let db=sa.Fj,Gb=null;for(;Q!==db&&sa.El();)Gb=db,db=sa.Fj;pa.ULS.shipAssertTag(37820301,336,10===sa.Fj.type);return Gb}static get Cj(){return Bp.a.instance}}Object(c.a)(En,"OutlineManager",null,[1246]);class ap{constructor(Q){this.kHa=0;this.M4=null;this.Za=Q}Xre(){this.M4||(this.M4=this.O9c())}n5d(){this.M4&&0<ap.$ed(this.M4).length&&this.Za.Cb(this.M4);this.M4=
null}O9c(){return Object.assign(new Nb.a(3,1,250,Object(n.a)(this,this.wDg,"showAdornmentTextBatched"),166),{customData:[]})}Rzg(Q){this.kHa=Q}ODd(Q){if(Q){Q.style.width=this.kHa+"px";if(this.M4)var sa=this.M4;else sa=this.O9c(),this.Za.Cb(sa);ap.$ed(sa).push(Q)}}Kkd(Q){Q&&(Q.style.width="0px",this.ETf(Q))}pHd(Q,sa){sa?this.ODd(Q):this.Kkd(Q)}wDg(Q){for(let sa of Q.customData)this.showAdornmentText(sa)}showAdornmentText(Q){Q.style.width===this.kHa+"px"&&(this.sfd(Q).style.visibility="visible")}ETf(Q){Q&&
(this.sfd(Q).style.visibility="hidden")}sfd(Q){Q=Q.childNodes;pa.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static $ed(Q){return Q.customData}}Object(c.a)(ap,"PageAdornmentAnimationManager",null,[1245]);class Ar{constructor(Q){this.em=Q;this.Zda=new Kb.a;this.$da=new Kb.a}uKa(Q){Q=kk.GraphIterator.wa(Q);if(Q.Fo()&&Q.rs()){Q.Vd();do 10===Q.Ud&&this.skg(Q.currentNode),Q.$n();while(8!==Q.Ud)}}Mac(Q){const sa=Q.pageNumber;var db=
this.wZb(Q.Fcc);if(!this.Zda.La(db))return pa.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+db),!1;Q=this.Zda.J(db);pa.ULS.shipAssertTag(24958353,336,this.$da.La(db),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");db=this.$da.J(db);return this.vTf(Q,sa,db)}Lac(Q){const sa=Q.pageNumber;var db=this.wZb(Q.Fcc);if(!this.Zda.La(db))return pa.ULS.sendTraceTag(24958354,
336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+db),!1;Q=this.Zda.J(db);pa.ULS.shipAssertTag(24958355,336,this.$da.La(db),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");db=this.$da.J(db);return this.YFf(Q,sa,db)}UPf(Q){if(!Q)return pa.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var sa=Q.n3d;if(!sa)return pa.ULS.sendTraceTag(24979137,
336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.pageNumber)),0;sa=this.em.ssc(sa);if(!sa)return pa.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;sa=this.em.aua(sa);const db=1===Q.pageNumber;Q=!(Q.pageNumber%2);return 1===sa?1:2===sa?db?2:1:3===sa?Q?3:4:db?2:Q?3:4}skg(Q){if(10===Q.type){var sa=new Kb.a,db=this.em.ssc(Q);pa.ULS.shipAssertTag(24958356,336,!!db,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var Gb=this.em.aua(db);Q=this.wZb(Q);this.BNg(Q,Gb);this.ANg(Q,sa);db=kk.GraphIterator.wa(db);if(db.rs()){db.Vd();do Q=db.currentNode,Gb=this.Dgd(Q),Q=this.em.rai(Q),sa.add(Gb,Q),db.$n();while(36===db.Ud)}}}BNg(Q,sa){this.$da.La(Q)?this.$da.W(Q,sa):this.$da.add(Q,sa)}ANg(Q,sa){this.Zda.La(Q)?this.Zda.W(Q,sa):this.Zda.add(Q,sa)}Dgd(Q){pa.ULS.shipAssertTag(24958357,336,36===Q.type,"Expected node of type HeaderFooter but received node of type "+Q.type);return Q.ha(fb.a.Hwb,0)}wZb(Q){pa.ULS.shipAssertTag(24958358,
336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ha(fb.a.jca,0)}vTf(Q,sa,db){const Gb=1===sa;sa=!(sa%2);switch(db){case 2:if(Gb){if(Q.La(2))return Q.J(2)}else if(Q.La(0))return Q.J(0);break;case 3:if(sa){if(Q.La(1))return Q.J(1)}else if(Q.La(0))return Q.J(0);break;case 4:if(Gb){if(Q.La(2))return Q.J(2)}else if(sa){if(Q.La(1))return Q.J(1)}else if(Q.La(0))return Q.J(0);break;case 1:if(Q.La(0))return Q.J(0)}return!1}YFf(Q,sa,db){const Gb=1===sa;sa=!(sa%2);
switch(db){case 2:if(Gb){if(Q.La(5))return Q.J(5)}else if(Q.La(3))return Q.J(3);break;case 3:if(sa){if(Q.La(4))return Q.J(4)}else if(Q.La(3))return Q.J(3);break;case 4:if(Gb){if(Q.La(5))return Q.J(5)}else if(sa){if(Q.La(4))return Q.J(4)}else if(Q.La(3))return Q.J(3);break;case 1:if(Q.La(3))return Q.J(3)}return!1}}Object(c.a)(Ar,"PageAdornmentContentManager",null,[1244]);class hr{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf){this.VOg(Q,sa,db,Xc,zd,ve,yf);this._pageNumber=Q;this.yk=sa;this.Yr=db;this.uMj=
Gb;this.Koj=Xb;this.fsb=Xc;this.Jtc=zd;this.qrc=ve;this.UEi=yf}get pageNumber(){return this._pageNumber}get top(){return this.yk}get height(){return this.Yr}get Fcc(){return this.uMj}get n3d(){return this.Koj}TCd(Q){this.yk!==Q&&(this.fsb.style.top=Q+"px",this.yk=Q)}nzg(Q){this.height!==Q&&(this.fsb.style.height=Q+"px",this.Yr=Q)}VOg(Q,sa,db,Gb,Xb,Xc,zd){pa.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);pa.ULS.shipAssertTag(37244962,
336,0<=sa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",sa);pa.ULS.shipAssertTag(37244963,336,0<=db,"PageAdornmentContainer: height parameter value {0} is unexpected value.",db,sa);pa.ULS.shipAssertTag(37244992,336,!!Gb,"PageAdornmentContainer: containerDomElement parameter is null.");pa.ULS.shipAssertTag(37244993,336,!!Xb,"PageAdornmentContainer: headerLabelDomElement parameter is null.");pa.ULS.shipAssertTag(37244994,336,!!Xc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
pa.ULS.shipAssertTag(37244995,336,!!zd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(c.a)(hr,"PageAdornmentContainer",null,[1291]);class Uk{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh){this.i2g="headerFooterTab";this.oZd=null;this.TIa=this.PTe=0;this.dZe=null;this.Cdb=!1;this.VA=Q;this.Yd=sa;this.nL=db;this.lpa=Gb;this.ea=Xb;this.Ji=Xc;this.Qv=zd;this.rY=ve;this.BFa=yf;this.CTa=cf;this.Za=eg;this.qa=Xh;this.P5e=[];this.K4=new Map;this.CTa.j1d(Object(n.a)(this,
this.w_b,"headerFooterDismissedEvent"));this.zu=!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.h3;if(this.bRd=(this.IVe=!!this.qa&&this.qa.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.qa&&this.qa.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===If.App.na.lk.getLayoutBreakpoint()&&(this.Qv=!1),If.App.na.lk.registerLayoutBreakpointChanged(this.i2g,Nj=>{switch(Nj){case "Small":this.Nai();break;default:this.q1i()}})}get sg(){return this.VA.value}q1i(){try{this.nHm()}catch(Q){pa.ULS.shipAssertTag(37244997,
336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Nai(){try{this.ggl()}catch(Q){pa.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}qjm(){for(const Q of this.K4.keys())this.Zve(Q)}uKa(){try{this.ngk()}catch(Q){pa.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}cBm(Q){this.TIa=Q}Jbj(Q){try{this.QYm(Q)}catch(sa){pa.ULS.shipAssertTag(37245E3,
336,!1,"Exception was caught in UpdatePageElements. Message: {0}",sa.message)}}dispose(){try{this.WUm(),this.tVm(),this.CTa&&this.CTa.yOi(Object(n.a)(this,this.w_b,"headerFooterDismissedEvent"))}catch(Q){pa.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}Q6b(Q){this.VQl(Q.Jw);return!0}VQl(Q){const sa=this.nnd(Q),db=this.zYh(Q);db?(Q=this.BFa.UPf(db),this.ea.zb(sa?vb.a.dJd:vb.a.NHc,2,Q),this.Cdb=!0):(pa.ULS.sendTraceTag(37245002,
336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ea.processAction(vb.a.zuc,2))}KI(){return!0}w_b(){this.Rsf()&&(this.Cdb=!1,this.bWm(),this.dZe=new Date)}T6b(Q){this.Cdb||this.rY.ODd(Q.Jw);return!0}S6b(Q){this.Cdb||(Q=Q.Jw,this.cDg(Q)||this.rY.Kkd(Q));return!0}WUm(){this.K4.forEach(Q=>{this.YEe(Q)})}tVm(){this.zu&&(this.bRd&&(If.App.na.lk.unregisterLayoutBreakpointChanged(this.i2g),this.bRd=!1),this.zu=!1)}YEe(Q){if(Q){var sa=Q.Jtc;Q=Q.qrc;Uh.a.XNa(sa)&&Uh.a.XNa(Q)?
(this.Ji.Gb(B.a.pM,sa,Object(n.a)(this,this.T6b,"onMouseHoverOver")),this.Ji.Gb(B.a.pM,Q,Object(n.a)(this,this.T6b,"onMouseHoverOver")),this.Ji.Gb(B.a.ZG,sa,Object(n.a)(this,this.S6b,"onMouseHoverLeave")),this.Ji.Gb(B.a.ZG,Q,Object(n.a)(this,this.S6b,"onMouseHoverLeave")),this.Yd.Gb(B.a.click,sa,Object(n.a)(this,this.Q6b,"onHeaderFooterClickEvent")),this.Yd.Gb(B.a.click,Q,Object(n.a)(this,this.Q6b,"onHeaderFooterClickEvent")),this.nL.Gb(sa,Uk.E6b),this.nL.Gb(Q,Uk.E6b),this.lpa.Gb(B.a.Dz,sa,Object(n.a)(this,
this.KI,"onMouseDown")),this.lpa.Gb(B.a.Dz,Q,Object(n.a)(this,this.KI,"onMouseDown"))):pa.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}S$l(Q){Array.enqueue(this.P5e,Q);this.oZd||(this.oZd=new Nb.a(2,1,50,Object(n.a)(this,this.yfm,"registerEventHandlersTask")),this.Za.Cb(this.oZd))}yfm(){let Q=Array.dequeue(this.P5e);for(;Q;)this.Qna(Q),Q=Array.dequeue(this.P5e);this.oZd=null}Qna(Q){if(Q){var sa=Q.Jtc;Q=Q.qrc;Uh.a.XNa(sa)&&Uh.a.XNa(Q)?
(this.Ji.Ma(B.a.pM,sa,Object(n.a)(this,this.T6b,"onMouseHoverOver")),this.Ji.Ma(B.a.pM,Q,Object(n.a)(this,this.T6b,"onMouseHoverOver")),this.Ji.Ma(B.a.ZG,sa,Object(n.a)(this,this.S6b,"onMouseHoverLeave")),this.Ji.Ma(B.a.ZG,Q,Object(n.a)(this,this.S6b,"onMouseHoverLeave")),this.Yd.Ma(B.a.click,sa,Object(n.a)(this,this.Q6b,"onHeaderFooterClickEvent")),this.Yd.Ma(B.a.click,Q,Object(n.a)(this,this.Q6b,"onHeaderFooterClickEvent")),this.nL.Ma(sa,Uk.E6b),this.nL.Ma(Q,Uk.E6b),this.lpa.Ma(B.a.Dz,sa,Object(n.a)(this,
this.KI,"onMouseDown")),this.lpa.Ma(B.a.Dz,Q,Object(n.a)(this,this.KI,"onMouseDown"))):pa.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}nHm(){if(!this.Qv){for(let Q of this.K4.values())Q.fsb.style.display="block";this.Qv=!0}}ggl(){this.Qv&&(this.K4.forEach(Q=>{Q.fsb.style.display="none"}),this.Qv=!1)}ngk(){this.BFa.uKa(this.sg.Oc)}QYm(Q){this.rY.Xre();var sa=0;const db=new V.a;this.uKa();const Gb=this.QXk();for(var Xb of Q)Q=Xb.pageNumber,
this.M0l(Xb)||this.Zve(Xb.pageNumber),this.K4.has(Q)?this.TWm(Xb):this.Skk(Xb),sa=Q,db.add(Q);for(Xb=1;Xb<=sa;Xb++)db.contains(Xb)||this.Zve(Xb);for(sa+=1;sa<=Gb;sa++)this.Zve(sa);this.rY.n5d()}M0l(Q){return this.K4.has(Q.pageNumber)?this.K4.get(Q.pageNumber).Fcc.id===Q.Fcc.id:!1}QXk(){let Q=0;this.K4.forEach((sa,db)=>{db>Q&&(Q=db)});return Q}Skk(Q){const sa=Q.Fcc.zd(this.sg.eb);if(sa){var db=Q.pageNumber;Q=this.Dtf(db,Q.top,Q.height,sa.eta,Q.Fcc,Q.n3d);this.S$l(Q);this.TLg(Q);this.TNg(Q);this.bRd&&
!this.Qv&&(Q.fsb.style.display="none");this.K4.set(db,Q)}}Dtf(Q,sa,db,Gb,Xb,Xc){const zd=Dl.b("div","","PageAdornmentContainer");zd.style.top=sa+"px";zd.style.height=db+"px";Gb.appendChild(zd);this.rmf(zd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Gb=this.Vuf(Q);zd.appendChild(Gb);const ve=this.puf(Q);zd.appendChild(ve);const yf=this.fuf(Q);zd.appendChild(yf);M.AFrameworkApplication.isRtl&&(Sys.UI.DomElement.addCssClass(zd,"Rtl"),Sys.UI.DomElement.addCssClass(ve,
"Rtl"),Sys.UI.DomElement.addCssClass(yf,"Rtl"));return new hr(Q,sa,db,Xb,Xc,zd,ve,yf,Gb)}puf(Q){Q=Dl.b("div","h"+Q,"PageAdornmentHeaderLabel");const sa=Dl.b("span","","");sa.innerText=WordEditorIntl.WordEditorStrings.l_Header;sa.style.whiteSpace="nowrap";Q.appendChild(sa);return Q}fuf(Q){Q=Dl.b("div","f"+Q,"PageAdornmentFooterLabel");const sa=Dl.b("span","","");sa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;sa.style.whiteSpace="nowrap";Q.appendChild(sa);return Q}Vuf(Q){const sa=Dl.b("div",
"","PageAdornmentNumberLabel");sa.innerText=Q.toString();return sa}rmf(Q,sa,db){if(!this.PTe){const Gb=Dl.b("p","","");Gb.innerText=sa;Gb.style.whiteSpace="nowrap";Gb.style.visibility="hidden";Q.appendChild(Gb);sa=Dl.b("p","","");sa.innerText=db;sa.style.whiteSpace="nowrap";sa.style.visibility="hidden";Q.appendChild(sa);this.PTe=Q.clientWidth;this.rY.Rzg(this.PTe);Q.removeChild(Gb);Q.removeChild(sa)}}Zve(Q){if(this.K4.has(Q)){var sa=this.K4.get(Q);this.YEe(sa);Uh.a.qr(sa.fsb);this.K4.delete(Q)}}TWm(Q){if(this.K4.has(Q.pageNumber)){var sa=
this.K4.get(Q.pageNumber);sa.TCd(Q.top);sa.nzg(Q.height);this.TLg(sa);this.TNg(sa)}else pa.ULS.sendTraceTag(37245005,324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}bWm(){this.rY.Xre();this.uKa();this.K4.forEach(Q=>{this.TLg(Q);this.TNg(Q)});this.rY.n5d()}TLg(Q){const sa=Q.Jtc,db=Q.qrc,Gb=this.BFa.Mac(Q),Xb=this.BFa.Lac(Q);this.B_m(Q,Gb,Xb);this.rY.pHd(sa,Gb);this.rY.pHd(db,Xb)}B_m(Q,sa=!0,db=!0){const Gb=Q.Jtc;Q=Q.qrc;3!==M.AFrameworkApplication.pa.mode?
(Gb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Gb.title=sa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=db?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}cDg(Q){const sa=this.zYh(Q);return sa?this.nnd(Q)?this.BFa.Mac(sa):this.BFa.Lac(sa):(pa.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}zYh(Q){Q=Q.id;Q=
Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.K4.has(Q)?this.K4.get(Q):(pa.ULS.sendTraceTag(37245007,336,10,"Adornment container map does not contain the page number "+Q),null)}nnd(Q){return Q.id.length?"h"===Q.id.substring(0,1):(pa.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}TNg(Q){const sa=Q.height;sa<Uk.mMl?(Sys.UI.DomElement.addCssClass(Q.Jtc,Uk.Lwb),Sys.UI.DomElement.addCssClass(Q.qrc,Uk.Lwb)):(Sys.UI.DomElement.removeCssClass(Q.Jtc,Uk.Lwb),Sys.UI.DomElement.removeCssClass(Q.qrc,
Uk.Lwb));sa<Uk.nMl?(Sys.UI.DomElement.addCssClass(Q.UEi,Uk.Lwb),Sys.UI.DomElement.addCssClass(Q.fsb,Uk.Lwb)):(Sys.UI.DomElement.removeCssClass(Q.UEi,Uk.Lwb),Sys.UI.DomElement.removeCssClass(Q.fsb,Uk.Lwb))}Rsf(){return!this.dZe||C.a.lTf(this.dZe,500)}static E6b(){return!0}}Uk.Lwb="Hidden";Uk.mMl=120;Uk.nMl=50;Object(c.a)(Uk,"PageAdornmentManager",null,[1242,12,1243]);class Fo{constructor(Q,sa){this.e3e=new V.a;this.e3e.add(Q);this.e3e.add(sa)}get HEi(){return this.e3e}}Object(c.a)(Fo,"PageElementManagerList",
null,[]);var vo=b(53);class cl{constructor(Q){this.ql=Q;this.ojc=[]}VMi(){for(let Q=0,sa=this.ojc.length;Q<sa;Q++)Uh.a.qr(this.ojc[Q]);Array.clear(this.ojc)}MZh(Q,sa,db,Gb,Xb,Xc){let zd=Math.min(Gb.x-Xc.x,Xb.x-Xc.x);Gb=Math.min(Xc.x+Xc.width-(Gb.x+Gb.width),Xc.x+Xc.width-(Xb.x+Xb.width));sa+=Xb.y-Xc.y;({Dna:sa,leftMargin:zd,rightMargin:Gb}=this.HWj(sa,zd,Gb));Q=this.V0k(Q,zd,Gb,zd,Gb,db);Q.style.top=sa+"px";Q.style.zIndex="0";this.ojc.push(Q);vo.c(Q,!0);return Q}jee(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):
null}V0k(Q,sa,db,Gb,Xb,Xc){return Q?cl.I7k(sa,db,Gb,Xb,Xc):cl.g1k(Gb,Xb,Xc)}HWj(Q,sa,db){sa/=this.ql.instance.Eh;db/=this.ql.instance.Eh;Q/=this.ql.instance.Eh;return{Dna:Q,leftMargin:sa,rightMargin:db}}Ssl(Q){return this.Gmi(Q)&&this.IEi(Q)?(Q=this.fZb(Q))&&Q.offsetParent?!1:!0:!1}Rsl(Q){return!this.Gmi(Q)||this.IEi(Q)?!1:!0}vU(){}fZb(Q){if(!Q.Vig)return null;let sa=null;Q.Qxb&&!Q.Yga?(Q=this.jee(Q.Vig))&&(sa=Q):sa=Q.Vig;return sa}Gmi(Q){return Q.Qxb&&!Q.Yga&&Q.paragraphNode?!0:!1}IEi(Q){Q=Q.paragraphNode;
return!!Q&&!!Q.anchor}jzh(Q,sa){Q=oa.a.hcb(Q);sa=oa.a.hcb(sa);return(Q-sa)/this.ql.instance.Eh}Bmf(Q,sa){Q=oa.a.hcb(Q);sa=oa.a.hcb(sa);return(Q-sa)/this.ql.instance.Eh}yne(){this.Lbj(!1)}xne(){this.Lbj(!0)}Lbj(Q){for(let sa=0,db=this.ojc.length;sa<db;sa++){const Gb=this.ojc[sa];"PageEndMarker.Para"===Gb.id?cl.Obj(Gb,Q):"PageEndMarker.Table"===Gb.id&&cl.ucj(Gb,Q)}}static g1k(Q,sa,db){cl.Olc||(cl.Olc=Dl.b("div","PageEndMarker.Para","PageEndMarker"),cl.Olc.appendChild(Dl.b("div","","Current FullWidth")),
cl.Olc.appendChild(Dl.b("div","","Stale LeftWing")),cl.Olc.appendChild(Dl.b("div","","Stale RightWing")));const Gb=cl.Olc.cloneNode(!0);Gb.childNodes[1].style.width=Q-10+"px";Gb.childNodes[2].style.width=sa-10+"px";cl.Obj(Gb,db);return Gb}static I7k(Q,sa,db,Gb,Xb){cl.bQb||(cl.bQb=Dl.b("div","PageEndMarker.Table","PageEndMarker"),cl.bQb.appendChild(Dl.b("div","","Current LeftWing")),cl.bQb.appendChild(Dl.b("div","","Current RightWing")),cl.bQb.appendChild(Dl.b("div","","Stale LeftWing")),cl.bQb.appendChild(Dl.b("div",
"","Stale RightWing")));const Xc=cl.bQb.cloneNode(!0);Xc.childNodes[0].style.width=Q+"px";Xc.childNodes[1].style.width=sa+"px";Xc.childNodes[2].style.width=db-10+"px";Xc.childNodes[3].style.width=Gb-10+"px";cl.ucj(Xc,Xb);return Xc}static Obj(Q,sa){sa?cl.yIl(Q):cl.zIl(Q)}static zIl(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="block"}static yIl(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display=
"none"}static ucj(Q,sa){sa?cl.CIl(Q):cl.DIl(Q)}static DIl(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static CIl(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}cl.Olc=null;cl.bQb=null;Object(c.a)(cl,"PageEndDOMHelper",null,[]);class Vk{constructor(Q,sa){this.JNb=this.Ldh=null;this.ql=
Q;this.Sd=sa}sGg(Q,sa){try{this.$Lm(Q,sa)}catch(db){pa.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",db.message)}}Pfk(Q,sa,db,Gb,Xb,Xc,zd){this.Sd.Cd(()=>{try{this.Qfk(Q,sa,db,Gb,Xb,Xc,zd)}catch(ve){pa.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",ve.message)}},"PEMPC:CP")}$Lm(Q,sa){this.Ldh=Q;this.JNb=sa}Qfk(Q,sa,db,Gb,Xb,Xc,zd){var ve=this.Ldh;if(ve&&
Q){var yf=ve.count,cf=Q.count;if(yf&&cf){var eg=this.MFk(ve,Q);if(eg.count){var Xh=this.ql.Eh,Nj=this.noc(eg)/Xh,dh=this.NEh(eg)/Xh;Q=this.Dae(ve,Q);if(Q.count){ve=this.noc(Q)/Xh;Xh=this.NEh(Q)/Xh;var dl=!0;for(var un=0;un<eg.count;un++)if(eg.J(un)){dl=!1;break}var vn=un=0;this.JNb&&sa&&(un=this.D7j(this.JNb,sa),vn=sa.count-this.JNb.count);pa.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:db,["HardPageBreakExists"]:Xb,["EstimatedPageCount"]:yf,["CalculatedPageCount"]:cf,["InOrderAverageDelta"]:Nj,
["InOrderStandardDeviation"]:dh,["ShortestAverageDelta"]:ve,["ShortestStandardDeviation"]:Xh,["PositionsShouldBeUpdated"]:Gb,["DocumentHeightChanged"]:Xc,["DeltasAllZero"]:dl,["HeaderFooterOpenSinceLastResponse"]:zd,["DeltaInViewport"]:un,["ChangeInViewportMarkerCount"]:vn});Xc||zd||dl||(pa.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),sa=eg.toArray().toString(),db=Q.toArray().toString(),pa.ULS.sendTraceTag(35726603,
336,50,"{0} {1}",sa,db))}}}}else pa.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}D7j(Q,sa){const db=new V.a;for(let Gb of Q)db.add(Gb.top);if(!db.count)return-1;Q=new V.a;for(let Gb of sa)Q.add(Gb.top);if(!Q.count)return-1;sa=this.Dae(db,Q);return this.noc(sa)/this.ql.Eh}noc(Q){if(!Q.count)return 0;let sa=0;for(let db=0;db<Q.count;db++)sa+=Q.J(db);return sa/Q.count}NEh(Q){if(!Q.count)return 0;const sa=
this.noc(Q);let db=0;for(let Gb=0;Gb<Q.count;Gb++){const Xb=Q.J(Gb)-sa;db+=Xb*Xb}return Math.sqrt(db/Q.count)}MFk(Q,sa){const db=new V.a;if(!Q.count||!sa.count)return db;Q.Sc((Xb,Xc)=>Xb-Xc);sa.Sc((Xb,Xc)=>Xb-Xc);const Gb=Math.min(Q.count,sa.count);for(let Xb=0;Xb<Gb;Xb++){const Xc=Math.abs(Q.J(Xb)-sa.J(Xb));db.add(Xc)}return db}Dae(Q,sa){const db=new V.a;if(!Q.count||!sa.count)return db;var Gb=Q.count<=sa.count;const Xb=Gb?Q:sa;Q=Gb?sa:Q;for(sa=0;sa<Xb.count;sa++){Gb=Xb.J(sa);let zd=Math.abs(Gb-
Q.J(0)),ve=0;for(let yf=1;yf<Q.count;yf++){var Xc=Q.J(yf);Xc=Math.abs(Gb-Xc);Xc<zd&&(zd=Xc,ve=yf)}db.add(zd);Q.removeAt(ve)}return db}}Object(c.a)(Vk,"PageEndMarkerPositionComparer",null,[1240]);var Wi=b(326),iq=b(597);class lk{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf){this.yk=Q;this._pageNumber=sa;this.Gyj=db;this.ozj=Gb;this.mFj=Xb;this.RXc=Xc;this.jjc=zd;this.Sbh=ve;this.ic=yf;this.SEj=cf}get top(){return this.yk}get pageNumber(){return this._pageNumber}get Qxb(){return this.Gyj}get Yga(){return this.ozj}get Vig(){return this.mFj}get outlineNode(){return this.RXc}get outlineGroupNode(){return this.jjc}get n0l(){return this.Sbh}get paragraphNode(){return this.ic}get JX(){return this.SEj}TCd(Q){this.yk=
Q}Jze(Q){this._pageNumber=Q}wXi(Q){this.Sbh=Q}}Object(c.a)(lk,"PageEndMarker",null,[]);class ck{constructor(){this.xe=null;this.dxi=0}}Object(c.a)(ck,"PageEndMarkerToRestore",null,[]);class jq{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.VA=Q;this.ql=sa;this.uUa=db;this.ay=Gb;this.h3e=Xb;this.B1=Xc;this.Nh=zd;this.az=new V.a;this.pjc=new V.a;this.YPb=new Kb.a;this.L_d=new iq.a(new Wi.a);this.H6a=new V.a;this.sjc=!!Xb;this.RTf()}get sg(){const Q=this.VA.value;pa.ULS.shipAssertTag(37052750,336,Q.vj,"PageEndMarkerPositionUpdater.PageView is not a PageView.");
return Q}WHd(Q){try{this.AYm(Q)}catch(sa){this.ay.vU(sa.message+" "+sa.stack),pa.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",sa.message)}}gSj(Q){try{this.hSj(Q)}catch(sa){this.ay.vU(sa.message+" "+sa.stack),pa.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",sa.message)}}h8j(Q){try{return this.i8j(Q)}catch(sa){this.ay.vU(sa.message+" "+sa.stack),pa.ULS.sendTraceTag(37052752,
336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",sa.message)}return!1}Eom(){try{this.Fom()}catch(Q){this.ay.vU(Q.message+" "+Q.stack),pa.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}kid(){try{return this.U3k()}catch(Q){return this.ay.vU(Q.message+" "+Q.stack),pa.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",
Q.message),null}}zNg(){try{this.MZm()}catch(Q){this.ay.vU(Q.message+" "+Q.stack),pa.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",Q.message)}}Gof(){try{return this.tbk()}catch(Q){return this.ay.vU(Q.message+" "+Q.stack),pa.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}Eml(Q){try{this.Fml(Q)}catch(sa){this.ay.vU(sa.message+
" "+sa.stack),pa.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",sa.message)}}AYm(Q){if(Q){this.Ick();for(let sa=0;sa<Q.length;sa++){const db=sa+1,Gb=this.fhk(Q[sa],db);this.az.add(Gb);this.YPb.add(db,Gb)}}}Fml(Q){let sa=!1;for(let db of Q)if(db)if(0<db.pageCount)for(let Gb of db.bXf)sa=this.P0d(Gb,db.outlineGroupNode)||sa;else if(0>db.pageCount){sa=!0;for(let Gb of db.B8d)this.dtk(Gb.pageNumber)}sa&&this.etg()}hSj(Q){const sa=
this.BYh(Q.paragraphNode);this.P0d(Q,sa)&&this.etg()}dtk(Q){const sa=Q-1;0>sa||this.az.count<=sa||(this.az.removeAt(sa),this.YPb.La(Q)&&this.YPb.remove(Q))}U3k(){const Q=new V.a;for(let sa of this.az)this.hwc(sa)&&Q.add(sa);return Q}P0d(Q,sa){if(!Q)return pa.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;sa=this.bhk(Q,sa);Q=Q.Ppl?-1:Q.pageNumber;let db=!1,Gb;this.YPb.La(Q)?(Gb=this.YPb.J(Q).pageNumber,sa.Jze(Gb),this.az.W(Gb-
1,sa),this.YPb.remove(Q)):(Gb=sa.pageNumber,this.az.insert(Gb-1,sa),db=!0);return db}fhk(Q,sa){return new lk(0,sa,Q.HardBreak,!1,null,null,null,0,null,null)}bhk(Q,sa){const db=Q.sBb,Gb=Q.pageNumber,Xb=Q.JX,Xc=!!Xb&&Xb.HardBreak,zd=Q.Yga,ve=Q.paragraphNode,yf=this.T2h(sa),cf=Q.outlineNode;var eg=this.sNf(cf);if(!eg)return pa.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Xh=null;Xc&&(Xh=this.ay.jee(Q.sBb));Q=this.ay.jzh(Xh||db,
yf);eg=this.ay.Bmf(Xh||db,eg);return new lk(eg,Gb,Xc,zd,db,cf,sa,Q,ve,Xb)}i8j(Q){this.pjc=new V.a;this.sjc&&this.h3e.reset();this.Gim();this.kJm();this.IWj();this.Z7j(Q);return 0<this.pjc.count}Gim(){for(let Q=0;Q<this.az.count;Q++){const sa=this.az.J(Q);this.ay.Ssl(sa)?this.pHl(sa):(this.ay.Rsl(sa)||this.hwc(sa)&&!this.sNf(sa.outlineNode))&&this.VNi(sa)}}IWj(){let Q=0,sa=null;var db=0;let Gb=0;for(let Xb=0;Xb<this.az.count;Xb++){const Xc=this.az.J(Xb);this.hwc(Xc)&&(Xc.Qxb&&(Gb+=this.gzh(Xc,db,Gb)),
sa&&sa.id===Xc.outlineNode.id||(sa=Xc.outlineNode,Gb=Q=0),Xc.Qxb&&!Xc.Yga&&(Q=this.X7j(Xc)),db=Xc.top+Q+Gb,Xc.TCd(db))}this.gzh(null,db,Gb);this.Bim()}gzh(Q,sa,db){let Gb=null;this.sjc&&(Gb=this.h3e.$7j(Q,sa,db));return Gb?Gb.delta:0}Fom(){if(this.pjc){for(let Q=0;Q<this.pjc.count;Q++){const sa=this.pjc.J(Q);Uh.a.swm(sa.xe,sa.dxi)}this.sjc&&this.h3e.Bom()}}MZm(){if(!this.sjc){var Q=this.uUa.r1h();if(this.az.count){var sa=this.uUa.w_h();for(let Xb=0;Xb<this.az.count;Xb++){var db=this.az.J(Xb);if(this.hwc(db)&&
db.Yga){db=this.uUa.c3k(db.outlineNode);var Gb=0<Xb?this.az.J(Xb-1).outlineNode:sa;Gb=Xb&&db.id===Gb.id?this.az.J(Xb-1).top:0;this.uUa.Ize(db,Gb)}}sa=this.az.J(this.az.count-1);sa.Yga?this.uUa.Ize(Q,0):this.uUa.Ize(Q,sa.top)}else this.uUa.Ize(Q,0)}}kJm(){this.az.Sc((Q,sa)=>Q.pageNumber-sa.pageNumber)}etg(){for(let Q=0;Q<this.az.count;Q++)this.az.J(Q).Jze(Q+1)}X7j(Q){return Q?this.izh(Q)-Q.top:(pa.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}f8j(Q){if(!Q)return 0;
const sa=this.T2h(Q.outlineGroupNode);return sa?this.ay.jzh(this.ay.fZb(Q),sa):0}izh(Q){if(!Q)return 0;const sa=this.ay.fZb(Q);Q=this.sNf(Q.outlineNode);return Q?this.ay.Bmf(sa,Q):(pa.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}Bim(){let Q=0,sa=!1,db=null,Gb=!1;for(let Xb=this.az.count-1;0<=Xb;Xb--){const Xc=this.az.J(Xb);this.hwc(Xc)&&(db&&db.id===Xc.outlineNode.id||(sa=!db,db=Xc.outlineNode,Q=
this.H0k(db)),Xc.Qxb?(sa=!1,Q=Xc.top):this.sjc&&sa||!(Xc.top>Q)||(this.VNi(Xc),Uh.a.qr(this.ay.fZb(Xc)),Gb=!0))}Gb&&this.etg()}VNi(Q){this.az.contains(Q)&&(this.sjc&&this.B1.sjm(Q),this.az.remove(Q))}hwc(Q){return Q?(Q=this.ay.fZb(Q))&&Q.offsetParent?!0:!1:(pa.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}tbk(){let Q=!1;for(let sa=this.H6a.count-1;0<=sa;sa--)this.H6a.J(sa).hasChildNodes()&&(this.H6a.removeAt(sa),Q=!0);return Q}pHl(Q){(Q=this.BYh(Q.paragraphNode))&&
(this.L_d.contains(Q.id)||this.L_d.add(Q.id))}RTf(){this.Nh&&this.Nh.Nd(23).ro(Object(n.a)(this,this.Zhg,"outlineGroupOnPropertyChanged"))}Zhg(Q,sa){sa.property===zm.a.PD&&(Q=sa.node)&&Q.ha(zm.a.PD,!1)&&this.L_d.contains(Q.id)&&(sa=Q.zd(this.sg.eb))&&(sa=sa.htmlElement)&&(this.L_d.remove(Q.id),this.H6a.add(sa))}Z7j(Q){for(let sa=this.az.count-1;0<=sa;sa--){const db=this.az.J(sa);this.hwc(db)&&this.Y7j(db,Q)}}Y7j(Q,sa){const db=this.izh(Q),Gb=this.f8j(Q);Q.Qxb?(Q.TCd(db),Q.wXi(Gb)):(sa=sa?db-Q.top:
Gb-Q.n0l,Q.TCd(db-sa),Q.wXi(Gb-sa),1<Math.abs(sa)&&this.Izm(this.ay.fZb(Q),sa))}sNf(Q){if(!Q)return null;Q=Q.zd(this.sg.eb);return Q?Q.htmlElement:(pa.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}T2h(Q){return Q?(Q=Q.zd(this.sg.eb))?Q.htmlElement:null:null}BYh(Q){Q=kk.GraphIterator.wa(Q);return Q.Na(23)?Q.Cc(23):null}G0k(Q){if(!Q)return null;Q=Q.zd(this.sg.eb);return Q?oa.a.getElementBounds(Q.htmlElement):(pa.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),
null)}H0k(Q){return(Q=this.G0k(Q))?Q.height/this.ql.Eh:0}Izm(Q,sa){sa=(Uh.a.tTk(Q)-sa)*this.ql.Eh;this.pjc.add(Object.assign(new ck,{xe:Q,dxi:sa}))}Ick(){this.az=new V.a;this.YPb=new Kb.a}}Object(c.a)(jq,"PageEndMarkerPositionUpdater",null,[1241]);var ul=b(381),Nm=b(40);b(32);var Qk=b(760),xk=b(330),Rk=b(26);class vl{constructor(Q,sa,db,Gb,Xb,Xc,zd=!1,ve=!1,yf=!1,cf=!1,eg=!1){this.VOg(sa,db,Gb,Xb,Xc,yf,eg);this.position=Q;this.pageNumber=sa;this.paragraphNode=db;this.JX=Gb;this.sBb=Xb;this.outlineNode=
Xc;this.Teb=zd;this.rmi=ve;this.Ppl=yf;this.Yga=cf;this.o1f=eg}Jze(Q){this.pageNumber=Q}VOg(Q,sa,db,Gb,Xb,Xc,zd){zd||(pa.ULS.shipAssertTag(38326881,336,!!Xb,"PageEndDetails: outlineNode parameter value is null."),pa.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),pa.ULS.shipAssertTag(24126529,336,!!sa||Xc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),pa.ULS.shipAssertTag(24126530,336,!!db||Xc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
pa.ULS.shipAssertTag(24126531,336,!!Gb||Xc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static vmk(Q,sa){return vl.vtf(0,Q,null,sa,!0,!1)}static wmk(Q){return vl.vtf(0,0,null,Q,!1,!0)}static vtf(Q,sa,db,Gb,Xb,Xc){return new vl(Q,sa,null,null,db,Gb,Xb,Xc,!0)}static Toc(Q,sa){return new vl(0,Q,null,sa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(c.a)(vl,"PageEndDetails",null,[]);class ol{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh,Nj,dh,dl,un,vn,
Fa,Ua,Ga,ua,Sa){this.bza=!0;this.DNe=0;this.HUd=this.QTe=this.RTe=this.HPe=this.f3e=this.CTe=!1;this.rWd=this.aOb=null;this.kXe=!0;this.VA=Q;this.ui=sa;this.u$=db;this.KP=Gb;this.ach=Xb;this.M6a=Xc;ol.ay=ve;this.k1g=yf;this.lG=cf;this.Za=eg;this.xvj=Xh;this.Jc=dh;this.B1=un;this.j3e=vn;this.wjc=Fa;this.IY=Ua;this.Uic=new ul.a;this.qjc=new V.a;this.aza=new V.a;this.I6a=new ul.a;this.xV=Nj;this.Pya=Sa;this.Gse=this.Gse.bind(this);this.Ise=this.Ise.bind(this);this.Pve=this.Pve.bind(this);this.E8=this.E8.bind(this);
this.xV.X3c(Object(n.a)(this,this.r_a,"onContentDirtied"));this.g3e=!Ga;this.bch=ua;dl&&(dl.Dqh(Object(n.a)(this,this.Weg,"onHeaderFooterShow")),dl.j1d(Object(n.a)(this,this.Veg,"onHeaderFooterDismiss")));zd&&zd.QUj(Object(n.a)(this,this.xWl,"onPageContentSizeChange"));this.Pya.c4c(this.E8)}get e1f(){return this.kXe}get pageEnds(){return this.aza}get sg(){return this.VA.value}get Ij(){return this.ui.value}r_a(){this.yne()}Veg(){this.RTe=!1}Weg(){this.QTe=this.RTe=!0}WHd(Q,sa){const db=this.Jc.le("Task",
"UpdateMarkers");this.YLm();this.bza=sa;ol.ay.VMi();this.Uic=new ul.a;this.qjc.clear();this.aza.clear();this.I6a=new ul.a;this.kXe=this.CTe=!1;this.KP&&this.KP.WHd(Q);this.iBk();this.DNe=Q.length;this.B1&&this.B1.reset(Q);this.u$&&(this.u$.cBm(this.yNf()),this.u$.uKa());for(let Gb of Q)this.aza.add(Gb),this.Tsg(Gb);sa&&this.KP&&this.j3e&&this.j3e.isEnabled&&(Q=this.KP.kid(),this.j3e.j$a(Q));this.Ofk();this.HPe=this.f3e=!1;this.QTe=this.RTe;cn.WoncaApp.instance.Idb&&ol.MUf&&this.KP.zNg();this.M6a.PYm(this.KP.kid(),
this.aza.count);this.kXe=!0;this.IY&&this.IY.iNg();db.stop();pa.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:db.Wf,["RenderedLineCount"]:this.DNe,["AvgDurationPerPageInMs"]:db.Wf/this.yNf()})}c3h(){const Q=this.KP.kid();if(!Q)return null;const sa=Uh.a.bua(),db=new V.a;for(let Gb of Q)this.uvl(Gb,sa)&&db.add(Gb);return db}uvl(Q,sa){if(!Q)return!1;Q=ol.ay.fZb(Q);if(!Q)return!1;Q=oa.a.hcb(Q);return 0<=Q&&Q<=sa}dWh(){const Q=new V.a;if(!this.I6a)return pa.ULS.sendTraceTag(35005382,
336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),Q;const sa=this.I6a.keys;for(let Xb=0;Xb<sa.length;Xb++){var db=sa.J(Xb);if(db=this.I6a.J(db))for(let Xc=0;Xc<db.count;Xc++){var Gb=db.J(Xc);Gb.JX.HardBreak||Sys.UI.DomElement.containsCssClass(Gb.sBb,"Hidden")||(Gb=oa.a.hcb(Gb.sBb),Q.add(Gb))}}return Q}YLm(){const Q=this.dWh(),sa=this.c3h();this.ach.sGg(Q,sa);this.wjc&&this.wjc.isEnabled&&this.wjc.sGg(sa)}Ofk(){if(!(25<this.yNf())){var Q=this.dWh(),
sa=this.c3h();this.ach.Pfk(Q,sa,this.bch,this.f3e,this.CTe,this.HPe,this.QTe);this.wjc&&this.wjc.isEnabled&&this.wjc.j$a(sa)}}E8(){this.u$.qjm();this.KLh()}KLh(){this.HUd&&(this.sg.kkm(this.Gse),this.sg.Kkm(this.Ise),this.sg.vkm(this.Pve),this.HUd=!1)}iBk(){this.HUd||(this.sg.aqh(this.Gse),this.sg.qVj(this.Ise),this.sg.vqh(this.Pve),this.HUd=!0)}Tsg(Q){if(this.g3e)return!0;Q=this.klm(Q);if(!Q)return!1;this.B1&&this.B1.ddl(Q);this.KP&&(this.KP.gSj(Q),this.M6a.Hbj(this.KP.kid()),cn.WoncaApp.instance.Idb&&
ol.MUf&&this.KP.zNg());return!0}klm(Q){let sa=this.uBa(Q.ParaId);if(!sa)return null;if(!sa.anchor||!sa.Wg)return this.yph(Q,sa),null;let db,Gb;if(Q.HardBreak){var Xb=uk.ParagraphReader.Ah(sa,!0,!0,!0);this.x1l(Xb)&&(sa=Xb);if(!({Dna:Xb,outlineGroupNode:db,rBb:Gb}=this.TSm(Q,sa)).returnValue)return null;this.CTe=!0}else if(!({Bse:Xb,outlineGroupNode:db,rBb:Gb}=this.llm(Q,sa,Xb,db,Gb)).returnValue)return null;return this.P0d(sa,Q,Xb,db,Gb)}x1l(Q){return Q?(Q=Q.zd(this.sg.eb))?!!ol.ay.jee(Q.htmlElement):
!1:!1}llm(Q,sa,db,Gb,Xb){var Xc=Q.PageEndType;let zd;db=0;Xb=Gb=null;if(!Xc){if(!({Dna:Q,Mig:zd}=this.d3h(Q,sa)).returnValue)return{returnValue:!1,Bse:db,outlineGroupNode:Gb,rBb:Xb}}else if(!({Dna:Q,bDe:zd}=this.W0k(Q,sa)).returnValue)return{returnValue:!1,Bse:db,outlineGroupNode:Gb,rBb:Xb};var ve=kk.GraphIterator.wa(sa);ve.lc();Gb=ve.Cc(23);sa=Gb.zd(this.sg.eb).getBounds();ve=ve.L0a().zd(this.sg.eb);if(!ve)return pa.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",
this.sg.eb),{returnValue:!1,Bse:db,outlineGroupNode:Gb,rBb:Xb};Xb=ve.getBounds();db=Q-sa.y;Xc=ol.ay.MZh(Xc,db,this.bza,zd,sa,Xb);ve.eta.appendChild(Xc);return{returnValue:!0,Bse:db,outlineGroupNode:Gb,rBb:Xc}}TSm(Q,sa){let db=null;const Gb=sa.zd(this.sg.eb);var Xb=0;let Xc=null;if(this.Dle(Q,Gb,sa))return{returnValue:!1,Dna:Xb,outlineGroupNode:db,rBb:Xc};db=ol.Bwi(sa);const zd=db.zd(this.sg.eb);if(!zd)return pa.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.sg.eb),
{returnValue:!1,Dna:Xb,outlineGroupNode:db,rBb:Xc};Xb=zd.getBounds();Xb=zr.a.rl(Gb,Q.CP).y-Xb.y;Xc=this.IVk(sa);return{returnValue:!0,Dna:Xb,outlineGroupNode:db,rBb:Xc}}IVk(Q){return Q.zd(this.sg.eb).htmlElement}uBa(Q){const sa=this.lG.hMa(Q);if(sa!==jb.a.nil){const db=this.Ij.Ua(sa);if(db)return db}pa.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,sa);return null}d3h(Q,sa){const db=Q.CP;let Gb=0,Xb=null;const Xc=sa.zd(this.sg.eb);if(this.Dle(Q,
Xc,sa))return{returnValue:!1,Dna:Gb,Mig:Xb};Xb=Xc.getBounds();Gb=db?this.k1g(Object(ha.a)(7,Xc),db):Xb.y-this.xvj(Xc);return{returnValue:!0,Dna:Gb,Mig:Xb}}W0k(Q,sa){let db=null,Gb=0;var Xb=Q.PageEndType;let Xc=kk.GraphIterator.wa(sa);Xc.lc();if(!Nm.TableReader.wv(Xc))return pa.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({Dna:Gb,Mig:db}=this.d3h(Q,sa)).returnValue,Dna:Gb,bDe:db};if(1===Xb){Rk.returnToContainingRow(Xc);
Xb=Xc.currentNode.zd(this.sg.eb);if(this.Dle(Q,Xb,sa))return{returnValue:!1,Dna:Gb,bDe:db};Gb=Xb.getBounds().y}else{Xb=sa.zd(this.sg.eb);if(this.Dle(Q,Xb,sa))return{returnValue:!1,Dna:Gb,bDe:db};Gb=this.k1g(Object(ha.a)(7,Xb),Q.CP)}--Gb;sa=null;do Q=sa,sa=Xc.Cc(14);while(sa);Xc=kk.GraphIterator.wa(Q);Xc.lc();Rk.moveToFirstRow(Xc);db=Xc.currentNode.zd(this.sg.eb).getBounds();return{returnValue:!0,Dna:Gb,bDe:db}}Dle(Q,sa,db){if(!sa||sa.wha(16))return this.yph(Q,db),!0;sa=sa.getBounds();return sa.width||
sa.height?!1:(this.Voh(Q),!0)}Voh(Q){this.qjc.contains(Q)||this.qjc.add(Q)}yph(Q,sa){sa=sa.id;let db;({value:db}=this.Uic.tb(sa)).returnValue||(db=new V.a,this.Uic.W(sa,db));db.add(Q)}Gse(){const Q=new V.a;for(let sa=this.qjc.count-1;0<=sa;sa--){const db=this.qjc.J(sa);this.Tsg(db)||Q.add(db)}this.qjc=Q;this.Gof()}Gof(){this.KP&&this.KP.Gof()&&this.Kbj(!1)}xWl(Q,sa){1>=Math.abs(sa.delta)||(this.HPe=!0,this.Kbj(!sa.Swi))}Kbj(Q){this.KP&&(this.KP.h8j(Q)&&(this.f3e=!0),this.bch&&this.KP.Eom(),this.M6a.Hbj(this.KP.kid()),
cn.WoncaApp.instance.Idb&&ol.MUf&&this.KP.zNg())}Ise(Q,sa){try{const db=sa.id;if(this.Uic.La(db)){const Gb=this.Uic.J(db);for(Q=0;Q<Gb.count;Q++)this.Voh(Gb.J(Q));this.Uic.remove(db)}}catch(db){}}yne(){this.bza&&(this.bza=!1,ol.ay.yne())}xne(){this.bza||(this.bza=!0,ol.ay.xne())}oHm(){this.g3e=!1;this.aza&&this.WHd(this.aza.toArray(),this.bza);this.u$&&this.u$.q1i()}hgl(){this.g3e=!0;ol.ay.VMi();this.u$&&this.u$.Nai();this.B1&&this.B1.igl()}P0d(Q,sa,db,Gb,Xb){const Xc=this.aza.indexOf(sa)+1;if(0>
Xc)return null;const zd=ym.WordSectionNavigator.instance.FI(Q),ve=this.Yga(sa,Q);Q=new vl(db,Xc,Q,sa,Xb,zd,!Q||!sa||!Xb,!1,!1,ve);this.I6a.La(Gb.id)||this.I6a.W(Gb.id,new V.a);this.I6a.J(Gb.id).add(Q);return Q}Yga(Q,sa){if(!Q||!Q.HardBreak)return!1;Q=kk.GraphIterator.wa(sa);Q.Na(7);if(Q.MG())return!1;Q.Cc(23);return Q.MG()?!1:!0}ypg(Q){this.bza&&(Q.anchor&&Q.Wg?!(Q=ol.Bwi(Q))||this.aOb&&this.aOb.customData&&this.aOb.customData.id===Q.id||(this.aOb=Object.assign(new Nb.a(3,1,500,Object(n.a)(this,this.rem,
"redrawPageEndsForOutlineGroup")),{customData:Q}),this.Za.Cb(this.aOb)):pa.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}rem(Q){Q===this.aOb&&(this.aOb=null);if(this.bza){var sa=Q.customData;if(Q=this.I6a.get(sa.id))for(this.I6a.W(sa.id,new V.a),pa.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Q.count,sa.id),this.u$&&this.u$.uKa(),sa=0;sa<Q.count;sa++){const db=Q.J(sa),
Gb=db.JX;Gb.HardBreak||(Uh.a.qr(db.sBb),this.Tsg(Gb))}}}Pve(){this.bza&&!this.rWd&&this.aza&&0<this.aza.count&&(this.rWd=new Nb.a(3,1,500,Object(n.a)(this,this.qem,"redrawAllPageEndsInDocument")),this.Za.Cb(this.rWd))}qem(){this.rWd=null;this.bza&&this.aza&&0<this.aza.count&&(pa.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.WHd(this.aza.toArray(),this.bza))}dispose(){this.sg&&this.KLh();this.Pya.ysg(this.E8);this.xV.vwe(Object(n.a)(this,this.r_a,"onContentDirtied"))}static get Gxa(){return M.AFrameworkApplication.K.$("WordEditorCommentImprovementIsEnabled")}static get MUf(){null==
ol.SUe&&(ol.SUe=M.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return ol.SUe}static GVk(Q){let sa=0;try{const db=Q.htmlElement,Gb=Uh.a.DO(db.firstChild.style.marginTop);Q=0;const Xb=ol.kOf(db.parentNode);if(Xb){const Xc=Xb.firstChild;Xc&&Sys.UI.DomElement.containsCssClass(Xc,"ParaWrappingDiv")&&(Q=Uh.a.DO(Xc.firstChild.style.marginBottom))}sa=Math.max(Gb,Q)/2}catch(db){}return sa}static kOf(Q){let sa=Q.previousSibling;if(!sa){var db=Q.parentNode;if(Uh.a.m0f(db))if(wj.a.instance.J(45)||
ol.Gxa){if(db=db.parentNode)sa=db.previousSibling}else sa=db.previousSibling}if(!sa&&(Q=Q.parentNode,Sys.UI.DomElement.containsCssClass(Q,Qk.a.Yhg)||pa.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){sa=Q.lastChild;do{if(Sys.UI.DomElement.containsCssClass(sa,"OutlineElement")||Uh.a.m0f(sa)&&Sys.UI.DomElement.containsCssClass(sa,xk.a.jOa))break;sa=sa.previousSibling}while(sa)}if(sa){if(Sys.UI.DomElement.containsCssClass(sa,
xk.a.jOa))return sa.lastChild.lastChild;if(Uh.a.m0f(sa))return sa.lastChild}return sa}static Bwi(Q){Q=kk.GraphIterator.wa(Q);return Q.Na(23)?Q.Cc(23):null}yNf(){return this.DNe+1}}ol.ay=null;ol.SUe=null;Object(c.a)(ol,"PageEndMarkers",null,[1238,1239,12]);var mp=b(121);class Wk{constructor(Q,sa,db){this.l0l=".Outline";this.VA=Q;this.ql=sa;this.ay=db}get sg(){const Q=this.VA.value;pa.ULS.shipAssertTag(38416594,336,Q.vj,"Invalid PageView.");return Q}Yrc(Q){return(Q=Q.outlineNode)?this.S2h(Q):(pa.ULS.shipAssertTag(38336522,
336,!0,"Error getting last Outline DOM."),null)}S2h(Q){let sa,db;return(sa=Q.zd(this.sg.eb))&&(db=sa.htmlElement)?db.querySelector(this.l0l):(pa.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}AYh(Q){Q=Pk.OutlineElementNavigator.Om(Q.paragraphNode);let sa;return Q&&(sa=Q.zd(this.sg.eb))?sa.htmlElement:(pa.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}Zyh(Q,sa){const db=this.O$k(Q);return this.d8j(Q,sa)-db}HZh(Q){return this.W2h(Q.outlineNode,
Q.pageNumber)}W2h(Q,sa){if(!Q)return-1;var db=Q.ha(fb.a.uR,-1);db=Bm.a.eh(db,1);var Gb=Q.ha(fb.a.marginTop,-1);Gb=Bm.a.eh(Gb,1);Q=Q.ha(fb.a.marginBottom,-1);Q=Bm.a.eh(Q,1);return 1===sa?db-Q:db-(Gb+Q)}btk(Q){Q&&Uh.a.qr(Q.sBb)}dOf(Q){if(Q.rmi||Q.Yga)return 0;if(Q.Teb)return Q=this.Yrc(Q),oa.a.getElementBounds(Q).height/this.ql.Eh;const sa=this.Yrc(Q);return this.ay.Bmf(this.b3h(Q),sa)}Ekk(Q,sa,db){db=db.zd(this.sg.eb).getBounds();Q=Q.zd(this.sg.eb);const Gb=Q.getBounds();db.y=Gb.y;sa=this.ay.MZh(0,
sa*this.ql.Eh,!1,db,db,Gb);Q.eta.appendChild(sa);return sa}Cei(Q,sa){if(Q&&!Q.o1f)if(Q.Teb)this.Yrc(Q).style.paddingBottom=sa+"px";else if(Q.JX&&Q.JX.HardBreak)if(Q.Yga){if(Q=this.g4h(Q))Q.style.paddingBottom=sa+"px"}else{if(Q=this.AYh(Q))Q.style.paddingTop=sa+"px"}else pa.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}qrh(Q,sa){sa=this.Yrc(sa);Q=this.Yrc(Q);return oa.a.hcb(sa)-oa.a.hcb(Q)}h4h(Q){Q=kk.GraphIterator.wa(Q.outlineNode);Q.Na(7);
return Q.MG()}kki(Q){if(!Q||Q.o1f)return!1;if(Q.Teb||Q.rmi)return!0;Q=this.b3h(Q);return!!Q&&Uh.a.PAa(Q)}vU(Q){this.ay.vU(Q)}g4h(Q){return(Q=this.h4h(Q))?(Q=Q.Cl(this.sg.eb).htmlElement,Q?Q:(pa.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}b3h(Q){return Q.JX&&Q.JX.HardBreak&&!Q.Yga?this.ay.jee(Q.sBb):Q.sBb}O$k(Q){if(Q.Teb){Q=this.Yrc(Q);if(!Q)return pa.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=mp.a.lA(Q);return Uh.a.cma(Q.paddingBottom)}if(Q.JX&&Q.JX.HardBreak){if(Q.Yga)return(Q=
this.g4h(Q))?Uh.a.cma(Q.style.paddingBottom):-1;Q=this.AYh(Q);return Q?Uh.a.cma(Q.style.paddingTop):(pa.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}d8j(Q,sa){return this.dOf(Q)-sa}}Object(c.a)(Wk,"PageFullHeightDOMHelper",null,[]);class Cm{constructor(){this.delta=this.Aej=this.pageCount=0;this.Cna=null;this.iXa=this.GHi=0;this.outlineGroupNode=null;this.Fsa=0;this.bXf=new V.a;this.B8d=new V.a;this.nOl=new V.a}}Object(c.a)(Cm,"PageFullHeightInfo",null,
[]);class Qn{constructor(Q,sa){this.EHa=Q;this.dy=sa}hzh(Q,sa){try{return this.a8j(Q,sa)}catch(db){return this.dy.vU(db.message+" "+db.stack),pa.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",db.message),null}}a8j(Q,sa){pa.ULS.shipAssertTag(38416596,336,Q.Teb||Q.JX.HardBreak);const db=this.dy.dOf(Q),Gb=this.dy.Zyh(Q,sa),Xb=this.EHa.Xyh(Q,Gb);Q=Object.assign(new Cm,{Fsa:Gb,iXa:Xb,Cna:Q});this.hYm(Q);Q.Aej=Q.iXa-Q.Fsa;Q.delta=sa+Xb+Q.delta-db;return Q}hYm(Q){Q.Fsa>
Q.iXa?this.iYm(Q):0>Q.Fsa&&this.GMg(Q)}GMg(Q){let sa=Q.Cna.pageNumber;for(;0>Q.Fsa;)Q.pageCount--,Q.delta-=this.EHa.bgd(sa),Q.Fsa+=this.EHa.bgd(sa-1),sa--;Q.iXa=this.EHa.bgd(sa)}iYm(Q){const sa=this.dy.HZh(Q.Cna);Q.pageCount=Math.floor((Q.Fsa-Q.iXa)/sa)+1;Q.delta=Q.pageCount*sa;Q.Fsa-=Q.iXa+(Q.pageCount-1)*sa;Q.iXa=sa}}Object(c.a)(Qn,"PageFullHeightInfoCalculator",null,[]);class pm{constructor(Q,sa,db,Gb){this.TIa=0;this.qVa=null;this.EHa=Q;this.oNb=sa;this.mW=db;this.dy=Gb;this.Reh=new V.a}get x0(){return this.Reh}ddl(Q){try{this.hSf(Q)}catch(sa){this.dy.vU(sa.message+
" "+sa.stack),pa.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",sa.message)}}reset(Q){try{this.ynm(Q)}catch(sa){this.dy.vU(sa.message+" "+sa.stack),pa.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",sa.message)}}igl(){try{this.jgl()}catch(Q){this.dy.vU(Q.message+" "+Q.stack),pa.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}Gml(Q){try{this.Hml(Q)}catch(sa){this.dy.vU(sa.message+
" "+sa.stack),pa.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",sa.message)}}sjm(Q){try{this.tjm(Q)}catch(sa){this.dy.vU("Pagination: "+sa.message+" "+sa.stack),pa.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",sa.message)}}mkl(){var Q=this.mW.hde(),sa=this.mW.m1h();Q=vl.wmk(Q);sa=vl.vmk(this.TIa,sa);this.x0.W(0,Q);this.hSf(sa)}Anm(){var Q=ym.WordSectionNavigator.instance.m1h();
(Q=this.dy.S2h(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}cll(Q){this.Reh=new V.a;this.x0.add(null);for(let sa=0;sa<Q.length;sa++){const db=vl.Toc(sa+1,Q[sa]);this.x0.add(db)}this.x0.add(vl.Toc(Q.length+1,null))}Qkl(Q){this.EHa.Enm(Q)}Unm(){if(this.x0)for(let Q of this.x0)Q&&this.Dii(Q)&&this.dy.Cei(Q,0)}hSf(Q){const sa=this.X2k(Q);if(this.dy.kki(sa)){let db=this.dy.dOf(sa);Q.outlineNode!==sa.outlineNode&&(db+=this.dy.qrh(Q,sa));this.B7j(Q,db);this.Dii(Q)&&this.Usg(Q,db)}else this.qVa.add(Q),
20<this.qVa.count&&pa.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.qVa.count);this.x0.W(Q.pageNumber,Q);this.Ycl(Q)}jgl(){this.Unm()}ynm(Q){this.TIa=Q.length+1;this.qVa=new V.a;this.cll(Q);this.Qkl(this.TIa);this.mkl();this.Anm()}Hml(Q){this.EHa.SYm(Q);for(let sa of Q){if(!sa){pa.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<sa.pageCount){Q=sa.Cna.pageNumber;for(let db of sa.bXf)this.x0.insert(Q,db),Q++}else if(0>sa.pageCount)for(let db of sa.B8d)this.x0.remove(db),
this.qVa.contains(db)&&this.qVa.remove(db)}this.qPi()}tjm(Q){Q=Q.pageNumber;this.EHa.ujm(Q);this.x0.removeAt(Q);for(let sa of this.qVa)sa.pageNumber===Q&&this.qVa.remove(sa);this.qPi()}B7j(Q,sa){sa=this.dy.Zyh(Q,sa);this.EHa.Xyh(Q,sa)}Usg(Q,sa){Q.JX&&Q.JX.HardBreak||this.oNb.Usg(Q,sa)}Ycl(Q){Q=Q.pageNumber+1;for(let sa of this.qVa)if(sa&&sa.pageNumber===Q){this.hSf(sa);this.qVa.remove(sa);break}}qPi(){for(let Q=0;Q<this.x0.count;Q++){const sa=this.x0.J(Q);sa&&sa.Jze(Q)}}Dii(Q){Q=this.R0k(Q);return 2===
Q||1===Q}X2k(Q){return this.x0.J(Q.pageNumber-1)}R0k(Q){return Q.Teb?2:Q.JX&&Q.JX.HardBreak?1:0}}Object(c.a)(pm,"PageFullHeightManager",null,[1287]);class Wm{constructor(Q,sa,db,Gb){this.oNb=Q;this.EHa=sa;this.mW=db;this.dy=Gb}create(){return new pm(this.EHa,this.oNb,this.mW,this.dy)}}Object(c.a)(Wm,"PageFullHeightManagerFactory",null,[]);var ek=b(841),jj=b(519);class og{constructor(Q,sa,db,Gb,Xb){this.rjc=null;this.B1=Q;this.KP=sa;this.YXc=db;this.oNb=Gb;this.dy=Xb}reset(){this.rjc=new V.a}$7j(Q,
sa,db){try{return this.b8j(Q,sa,db)}catch(Gb){return pa.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Gb.message),null}}Bom(){try{this.Com()}catch(Q){pa.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}b8j(Q,sa,db){if(!this.B1.x0.count)return null;const Gb=this.U0k(Q,!Q);if(!Gb||Gb.o1f)return pa.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),
null;if(Gb.JX&&Gb.JX.HardBreak)return null;var Xb=this.B1.x0.J(Gb.pageNumber-1);return this.dy.kki(Xb)&&(sa-=db,Gb.outlineNode!==Xb.outlineNode&&(sa+=this.dy.qrh(Gb,Xb)),(Xb=this.YXc.hzh(Gb,sa))&&1<Math.abs(Xb.delta))?(Xb.GHi=sa,Xb.outlineGroupNode=this.F0k(Q,Gb),this.rjc.add(Xb),this.GMg(Xb),Xb):null}F0k(Q,sa){return sa&&sa.Teb?(Q=Object(ha.a)(jj.a,uk.ParagraphReader.dM(sa.outlineNode)),Q=kk.GraphIterator.wa(Q),Q.Fo(),Object(ha.a)(ek.a,Q.Cc(23))):Q&&Q.Qxb?Q.outlineGroupNode:null}Com(){this.rjc.Sc((Q,
sa)=>sa.Cna.pageNumber-Q.Cna.pageNumber);for(let Q of this.rjc)this.oNb.ePi(Q);this.WYm()}WYm(){this.KP.value.Eml(this.rjc);this.B1.Gml(this.rjc)}U0k(Q,sa){return sa?this.B1.x0.J(this.B1.x0.count-1):this.B1.x0.J(Q.pageNumber)}GMg(Q){let sa=Q.Cna.pageNumber;const db=-Q.pageCount;for(let Gb=0;Gb<db;Gb++)sa--,Q.B8d.add(this.B1.x0.J(sa))}}Object(c.a)(og,"PageFullHeightPositionUpdater",null,[1286]);class Wn{constructor(Q,sa,db,Gb,Xb){this.B1=Q;this.KP=sa;this.YXc=db;this.oNb=Gb;this.dy=Xb}create(){return new og(this.B1,
this.KP,this.YXc,this.oNb,this.dy)}}Object(c.a)(Wn,"PageFullHeightPositionUpdaterFactory",null,[]);class Pl{constructor(Q,sa){this.dy=Q;this.YXc=sa}Usg(Q,sa){try{this.olm(Q,sa)}catch(db){this.dy.vU(db.message+" "+db.stack),pa.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",db.message)}}ePi(Q){try{this.nlm(Q)}catch(sa){this.dy.vU(sa.message+" "+sa.stack),pa.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",sa.message)}}olm(Q,
sa){pa.ULS.shipAssertTag(38285913,336,Q.Teb||Q.JX.HardBreak);Q=this.YXc.hzh(Q,sa);this.ePi(Q)}nlm(Q){this.mlm(Q);this.elm(Q)}elm(Q){0<Q.pageCount?this.Qml(Q):0>Q.pageCount&&this.ctk(Q)}mlm(Q){this.dy.Cei(Q.Cna,Q.Aej)}Qml(Q){let sa=Q.GHi+Q.iXa;for(let Gb=0;Gb<Q.pageCount;Gb++){var db=Q.Cna.pageNumber+Gb;const Xb=Q.Cna.Yga?this.dy.h4h(Q.Cna):Q.Cna.outlineNode;db=this.Dkk(Xb,Q.outlineGroupNode,sa,db);Q.bXf.add(db);Q.nOl.add(sa);sa+=Q.iXa}}ctk(Q){for(let sa of Q.B8d)this.dy.btk(sa)}Dkk(Q,sa,db,Gb){sa=
this.dy.Ekk(Q,db,sa);return vl.vtf(db,Gb,sa,Q,!1,!1)}}Object(c.a)(Pl,"PageFullHeightRenderer",null,[]);class ca{constructor(Q){this.hZc=Q}get tog(){return this.hZc}}Object(c.a)(ca,"PageHeightDeltaResult",null,[1134]);class na{constructor(Q,sa,db){this.Rq=null;this.dy=Q;this.Sd=sa;db.execute(Gb=>{Gb.register(this)})}get zag(){return"PageHeightDelta"}get result(){return this.Rq}get vcg(){return 1}get Fwg(){return 500}get isEnabled(){return!0}Dcg(){this.Rq=null}j$a(Q){this.Sd.Cd(()=>{try{this.e6c(Q)}catch(sa){pa.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",sa.message)}},"PHDM:C")}e6c(Q){this.Rq=null;Q=this.f6c(Q);-1!==Q&&(this.Rq=new ca(Q))}f6c(Q){if(!Q.count)return-1;let sa=0,db=0;for(let Gb of Q)Q=this.c8j(Gb),-1!==Q&&(sa+=Q,db++);return db?sa/db:-1}c8j(Q){if(!Q.Lrl)return-1;const sa=this.dy.W2h(Q.n3d,Q.pageNumber);return-1===sa?-1:Math.abs(Q.height-sa)}}Object(c.a)(na,"PageHeightDeltaMetric",null,[1095]);class lb{constructor(Q){this.A4a=null;this.dy=Q}bgd(Q){return this.A4a.J(Q-
1)}Enm(Q){this.A4a=new V.a;for(let sa=0;sa<Q;sa++)this.A4a.add(-1)}Xyh(Q,sa){if(this.vvl(Q))return this.A4a.J(Q.pageNumber-1);sa=this.L7j(Q,sa);this.ZLm(Q,sa);return sa}SYm(Q){for(let sa of Q)this.RYm(sa)}ZLm(Q,sa){this.A4a.W(Q.pageNumber-1,sa)}ujm(Q){this.A4a.removeAt(Q-1)}RYm(Q){if(Q)if(0<Q.pageCount){var sa=Q.Cna.pageNumber;for(var db=0;db<Q.pageCount;db++)this.A4a.insert(sa,Q.iXa)}else if(0>Q.pageCount)for(sa=-Q.pageCount,Q=Q.Cna.pageNumber-sa,db=0;db<sa;db++)this.A4a.removeAt(Q)}vvl(Q){return-1!==
this.A4a.J(Q.pageNumber-1)}L7j(Q,sa){if(Q.Teb||Q.JX.HardBreak)Q=this.dy.HZh(Q),sa=sa<Q?Q:sa;return sa}}Object(c.a)(lb,"PageHeightStorage",null,[]);var Qb=b(212);class oc{constructor(Q){this.hZc=Q}get tog(){return this.hZc}}Object(c.a)(oc,"PageLevelDeltaResult",null,[1134]);class Jc{constructor(Q,sa,db,Gb){this.Rq=null;this.VA=Q;this.lC=sa;this.Sd=db;Gb.execute(Xb=>{Xb.register(this)})}get sg(){const Q=this.VA.value;pa.ULS.shipAssertTag(39081438,336,Q.vj,"PageLevelDeltaMetric.PageView is not a PageView.");
return Q}get zag(){return"PageLevelDelta"}get result(){return this.Rq}get vcg(){return 0}get Fwg(){return 60}get isEnabled(){return!0}Dcg(){this.Rq=null}j$a(Q){this.Sd.Cd(()=>{try{this.e6c(Q)}catch(sa){pa.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",sa.message)}},"PLDM:C")}e6c(Q){this.Rq=null;Q=this.f6c(Q);-1!==Q&&(this.Rq=new oc(Q))}f6c(Q){if(!Q.count)return-1;let sa=0,db=0;for(let Gb of Q)Q=this.e8j(Gb),-1!==Q&&(sa+=Q,db++);return db?sa/db:
-1}e8j(Q){if(Q.Qxb)return-1;var sa=Q.JX.CP;Q=Q.paragraphNode;pa.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.zd(this.sg.eb);pa.ULS.shipAssertTag(39081442,324,Object(Qb.a)(7,Q));let db;({fHh:sa,koi:Q,TRi:db}=this.T7j(Q,Uh.a.rv(Q.htmlElement).length,sa));return Q&&db?Math.min(sa.x-Q.x,db.x-sa.x):(pa.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}T7j(Q,sa,db){let Gb,Xb,Xc,zd=Xb=db,ve=Xc=Gb=null;if(db>sa)return pa.ULS.sendTraceTag(39081472,
336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{fHh:ve,ICl:zd,koi:Xc,upm:Xb,TRi:Gb};ve=this.lC.rl(Q,db);for(var yf=0,cf=db;yf<=cf;){let eg=Math.floor((yf+cf)/2),Xh=this.lC.rl(Q,eg);if(yf===cf){zd=eg;Xc=Xh;break}Xh.y+Xh.height<=ve.y?yf=eg+1:cf=eg}for(;db<=sa;){yf=Math.ceil((db+sa)/2);cf=this.lC.rl(Q,yf);if(db===sa){Xb=yf;Gb=cf;break}cf.y>=ve.y+ve.height?sa=yf-1:db=yf}return{fHh:ve,ICl:zd,koi:Xc,upm:Xb,TRi:Gb}}}Object(c.a)(Jc,"PageLevelDeltaMetric",null,[1095]);
class bd{constructor(Q,sa,db,Gb,Xb,Xc,zd){this.pageNumber=Q;this.top=sa;this.Omh=db;this.height=Gb;this.Fcc=Xb;this.n3d=Xc;this.Lrl=zd}}Object(c.a)(bd,"Page",null,[]);class pd{constructor(Q,sa,db,Gb,Xb){this.kjc=null;this.hjh=0;this.VA=Q;this.HNd=sa;this.$bh=db;this.uUa=Gb;this.cch=Xb;this.O6a=new V.a}get sg(){const Q=this.VA.value;pa.ULS.shipAssertTag(37007393,336,Q.vj,"PageManager.PageView is not a PageView.");return Q}get pages(){return this.O6a}Hbj(Q){Q=this.eLi(Q);this.Ibj(Q)}PYm(Q,sa){this.hjh=
sa;Q=this.eLi(Q);this.Ibj(Q);this.cch.isEnabled&&this.cch.j$a(Q)}eLi(Q){this.O6a=new V.a;this.kjc=new ul.a(0);const sa=new V.a;if(!Q)return this.pages;var db=0,Gb=null;for(let Xb=0;Xb<Q.count;Xb++){const Xc=Q.J(Xb);db=Xc.pageNumber;Gb=this.s7d(db,Gb,Xc);this.pages.add(Gb);!pd.U0e&&0>Gb.height&&sa.add(Gb);Gb=Xc}Q=this.s7d(db+1,Gb,null);this.pages.add(Q);!pd.U0e&&0>Q.height&&sa.add(Q);for(let Xb of sa)pd.U0e=!0,pa.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+
Xb.pageNumber);return this.pages}s7d(Q,sa,db){const Gb=sa?sa.outlineNode:this.uUa.w_h(),Xb=db?db.outlineNode:this.uUa.r1h();var Xc=this.X2h(Gb);const zd=this.X2h(Xb),ve=sa?this.fzh(sa):0;Xc=ve+Xc;const yf=db?this.fzh(db):this.HNd.gPa.clientHeight-zd;return new bd(Q,ve,Xc,Gb.id===Xb.id?yf-ve:yf+zd-Xc,Gb,Xb,(db?db.pageNumber:this.hjh+1)===(sa?sa.pageNumber:0)+1)}fzh(Q){return Q.Yga?0:Q.top}Ibj(Q){if(this.$bh.HEi)for(let sa of this.$bh.HEi)sa&&sa.Jbj(Q)}X2h(Q){this.kjc||(this.kjc=new ul.a(0));if(this.kjc.La(Q.id))return this.kjc.J(Q.id);
var sa=Q.zd(this.sg.eb);if(!sa)return pa.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;sa=oa.a.Zcb(this.HNd.gPa,sa.htmlElement).y;this.kjc.W(Q.id,sa);return sa}}pd.U0e=!1;Object(c.a)(pd,"PageManager",null,[1236]);var Vd=b(1030),Te=b(1036);class xf{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve){this.ea=Q;this.bI=sa;this.Y9=db;this.PZe=Gb;this.Lh=Xb;this.ech=Xc;this.Bu=zd;this.$Qd=ve}get Pva(){return this.PZe.value}pb(){this.ea.Ia(vb.a.wBc,qh.a.application,this.wBc.bind(this),
96);this.ea.Ia(vb.a.xBc,qh.a.application,this.xBc.bind(this),96);this.ea.Ia(vb.a.DGc,qh.a.application,this.DGc.bind(this),96);this.ea.Ia(vb.a.BGc,qh.a.application,this.BGc.bind(this),8)}DGc(){return 32}BGc(Q,sa,db,Gb){if(1===db)return 0===this.Bu.pv?32:8;this.Y9.gje?(this.Y9.pvk(),this.Pva&&this.Pva.hgl()):(this.Y9.Kzk(),this.Pva&&this.Pva.oHm());this.Lh.updateCommandUI();Gb.Er=this.Y9.gje?1:0;return 32}wBc(Q,sa,db,Gb,Xb){if(1===db)return 32;Q=this.ech.MZb();-1===Q?Q="":this.$Qd&&this.Y9.gje||1===
this.Bu.pv?(sa=this.ech.fZh(),sa>Q&&(Q=sa),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,sa,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);this.$Qd?(Xb[Vd.a.Visible]=!0,Xb[Vd.a.LabelText]=Q):(Xb[Te.a.Visible]=!0,Xb[Te.a.Value]=Q);return 32}xBc(Q,sa,db,Gb,Xb){if(1===db)return 32;Xb[Gj.a.On]=this.Y9.gje&&0===this.Bu.pv;return 32}static get Qa(){return xf.ua||(xf.ua=za.a.instance.resolve("Box4.IFeatureHelper"))}}
xf.ua=null;Object(c.a)(xf,"PaginationActor",null,[]);class gg{constructor(Q){this.hZc=Q}get tog(){return this.hZc}}Object(c.a)(gg,"PaginationDeltaResult",null,[1134]);class hh{constructor(Q,sa){this.JNb=this.BOd=null;this.Sd=Q;sa.execute(db=>{db.register(this)})}get zag(){return"PaginationDelta"}get result(){return this.BOd}get vcg(){return 1}get Fwg(){return 200}get isEnabled(){return!0}Dcg(){this.BOd=null}j$a(Q){this.Sd.Cd(()=>{try{this.e6c(Q)}catch(sa){pa.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",
sa.message)}},"PDM:C")}sGg(Q){this.JNb=Q}e6c(Q){this.BOd=null;Q=this.f6c(this.JNb,Q);-1!==Q&&(this.BOd=new gg(Q))}f6c(Q,sa){if(!(Q&&sa&&Q.count&&sa.count))return-1;const db=new V.a;for(let Gb of Q)db.add(Gb.top);Q=new V.a;for(let Gb of sa)Q.add(Gb.top);sa=this.Dae(db,Q);return this.noc(sa)}noc(Q){if(!Q.count)return 0;let sa=0;for(let db=0;db<Q.count;db++)sa+=Q.J(db);return sa/Q.count}Dae(Q,sa){const db=new V.a;if(!Q.count||!sa.count)return db;var Gb=Q.count<=sa.count;const Xb=Gb?Q:sa;Q=Gb?sa:Q;for(sa=
0;sa<Xb.count;sa++){Gb=Xb.J(sa);let zd=Math.abs(Gb-Q.J(0)),ve=0;for(let yf=1;yf<Q.count;yf++){var Xc=Q.J(yf);Xc=Math.abs(Gb-Xc);Xc<zd&&(zd=Xc,ve=yf)}db.add(zd);Q.removeAt(ve)}return db}}Object(c.a)(hh,"PaginationDeltaMetric",null,[1095]);var rh=b(355),Wg=b(1079),kj=b(1653);class bj extends rh.a{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve=null){super();this.yP=null;this.CNe=0;this.TIa=-1;this.VJb=!1;this.Pya=Q;this.E8=this.E8.bind(this);this.Pya.c4c(this.E8);this.ea=sa;this.PZe=db;this.IY=Gb;this.ZH=Xb;this.$Uc=
ve||ui.a.instance;this.tic=this.YTa=jb.a.nil;this.nAj=zd;Xc.CWR(()=>Xc.result.Zo.DVa(Object(n.a)(this,this.Kba,"onKickedOut")));this.Spc();this.re=new Wg.a(1E3);this.re.z2();this.ZH.register(this)}get BO(){return"Pagination"}get Pva(){return this.PZe.value}get i9d(){return this.nAj.value}get mpc(){return this.IY}get SBl(){return this.YTa}get wJg(){return this.TIa}KBm(Q){this.TIa!==Q&&(this.TIa=Q,this.IY.iNg())}E8(){this.YTa=this.tic=jb.a.nil;this.Spc()}Kba(){pa.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");
this.tMh()}Gva(Q){this.yP=Q;this.yP.y9a(Object(n.a)(this,this.Qeg,"onGraphSpaceReplication"));this.q9a(this.yP.node)}Qeg(){if(0==this.Pya.pv){var Q=this.yP.Vk;jb.a.Ln(Q,this.tic)||(this.tic=Q,this.uVl(this.YTa,this.tic))}}uVl(Q,sa){jb.a.Ln(Q,sa)?(this.Pva&&this.Pva.xne(),this.Spc()):(this.Pva&&this.Pva.yne(),this.kLm())}Szk(){this.enabled=2}Spc(){this.enabled=0}kLm(){this.CNe=0;this.Szk();this.dr(null,null,null)}PQ(){return If.App.lostSession||If.App.Lb.Zo.rj?!1:!!(this.enabled&2)&&this.re.Fx()}dr(){this.re.Daa();
this.ZH.ru()}forceOutbound(){}$D(){return 0===this.enabled?!1:this.Bb&&2===this.Bb.status?!0:this.PQ()}M3(){if(1===this._state)this.Bb.fk=kj.a.nfa(M.AFrameworkApplication.rootQuerySignature,this.YTa),this.Bb.Bv="Pagination",this.Bb.status=1,this._state=3;else if(3===this._state&&this.Bb&&2===this.Bb.status)if(M.AFrameworkApplication.gi)this._state=4;else if(this.re.Sy(),this.re.pA(),this._state=1,this.CNe++,2!==this.Bb.statusCode)this.Tpc();else if(1!==(this.Bb.og?this.Bb.og.length:0))this.Tpc();
else{var Q=this.Bb.og[0];this.$Uc.sEa(Q);104===Q.StatusCode?this.tMh():101===Q.StatusCode?this.Tpc():3===Q.StatusCode?this.Tpc():Q.StatusCode?this.Tpc():Q.PageEnds?(this.KBm(Q.PageEnds.length+1),this.YTa=$d.b(Q.LastKnownPaginationRevision),pa.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.TIa,this.YTa),this.Pva&&(this.Pva.WHd(Q.PageEnds,jb.a.Ln(this.YTa,this.tic)),this.i9d.pageEnds=
Q.PageEnds,this.mpc&&this.mpc.pmf()),pa.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.TIa,this.YTa),this.xvk()):this.Tpc()}}tMh(){this.yP&&this.yP.dib(Object(n.a)(this,this.Qeg,"onGraphSpaceReplication"));this.Spc()}Tpc(){60<this.CNe&&this.Spc()}xvk(){jb.a.Ln(this.YTa,this.tic)&&this.Spc()}dispose(){this.yP&&(this.yP.dib(Object(n.a)(this,this.Qeg,"onGraphSpaceReplication")),this.yP.node&&
this.lzd(this.yP.node),this.yP=null);this.Pya.ysg(this.E8)}q9a(Q){Q&&(Q.addListener(this),this.VJb=!0)}lzd(Q){this.VJb&&Q&&(Q.removeListener(this),this.VJb=!1)}Hva(Q){this.lzd(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.wc.Hg)&&this.RSl(this.YTa,Q.id)}onAfterFirstSaveContent(){}RSl(Q,sa){jb.a.Ln(Q,sa)&&this.Pva&&this.Pva.xne()}}Object(c.a)(bj,"PaginationReplicator",rh.a,[1089,12,110]);class fn{constructor(){this.u$=this.az=this.IY=this.Y9=this.Uv=this.ua=this.Z=null;this.Nya=!1}get name(){return"WordEditor.Pagination"}get k3m(){return this.ua.isFeatureEnabled(145)}get Yej(){return this.ua.isFeatureEnabled(143)}get g1b(){return this.ua.isFeatureEnabled(45)}get fQg(){return M.AFrameworkApplication.K.$("WordEditorPaginationIsDefaultOn")}get j3m(){return M.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}Mb(Q){this.Z=
Q;this.ua=this.Z.resolve("Box4.IFeatureHelper");this.Z.ia("WordEditor.Pagination.PageElementManagerList",()=>{const sa=this.g1b?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new Fo(this.Z.resolve("WordEditor.Pagination.PageAdornmentManager"),sa)}).fa();this.Z.ia("WordEditor.Pagination.OutlineManager",()=>new En(new ub.a(()=>If.App.na.Aa.hc))).as("WordEditor.Pagination.IOutlineManager").fa();this.Z.ia("WordEditor.Pagination.PageManager",()=>new pd(new ub.a(()=>If.App.na.Aa.hc),
this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageElementManagerList"),this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").fa();this.Z.ia("WordEditor.IPaginationReplicator",()=>{const sa=this.g1b?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new bj(this.Z.resolve("WordEditor.IMainViewModeManager"),M.AFrameworkApplication.pa,
new ub.a(()=>this.Yej?this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"):null),sa,Xl.App.XB,If.App.ema(),new ub.a(()=>this.Z.resolve("WordEditor.TableOfContents.IDocumentHeadings")))}).fa();this.Z.ia("WordEditor.ICurrentPageManager",()=>{const sa=this.g1b?this.Z.resolve("WordEditor.Pagination.CurrentPageCalculator"):null;return new Qo(sa,this.fQg)}).fa();this.Z.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Jc(new ub.a(()=>If.App.na.Aa.hc),this.Z.resolve("Box4.ITextMetricsAdapter"),
Xi.a.instance,this.Z.Da("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PageHeightDeltaMetric",()=>new na(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Xi.a.instance,this.Z.Da("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new hh(Xi.a.instance,this.Z.Da("WordEditor.FidelityMetrics.IFidelityMetricManager"))).fa();this.Z.ia("WordEditor.Pagination.PageHeightStorage",
()=>new lb(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new Wk(new ub.a(()=>If.App.na.Aa.hc),this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new Qn(this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightRenderer",
()=>new Pl(this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Wn(this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),this.Z.Rd("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();
this.Z.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).fa();this.Z.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new jq(new ub.a(()=>If.App.na.Aa.hc),this.Z.resolve("Common.IZoomManager"),this.Z.resolve("WordEditor.Pagination.OutlineManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.Z.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),
If.App.Yh.Bj)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").fa();this.Z.ia("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Wm(this.Z.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.Z.resolve("WordEditor.Pagination.PageHeightStorage"),ym.WordSectionNavigator.instance,this.Z.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).fa();this.Z.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.Z.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).fa();
this.Z.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Vk(this.Z.resolve("Common.IZoomManager"),Xi.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").fa();this.Z.ia("WordEditor.Pagination.PaginationActor",()=>new xf(M.AFrameworkApplication.pa,this.Z.resolve("WordEditor.IStatusBarUser"),this.Z.resolve("WordEditor.ICurrentPageManager"),new ub.a(()=>this.Yej?this.Z.resolve("WordEditor.Pagination.IPageEndMarkers"):null),M.AFrameworkApplication.oa,this.Z.resolve("WordEditor.IPageNumberFinder"),
this.Z.resolve("WordEditor.IMainViewModeManager"),this.g1b)).fa();this.Z.ia("WordEditor.Pagination.DocumentSizeManager",()=>new Ud(new ub.a(()=>If.App.na.Aa.hc),Xg.a.get_instance())).fa();this.Z.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new Cq(M.AFrameworkApplication.pa,Km.a.instance,ko.a.instance,this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),new ub.a(()=>If.App.na.Aa.hc),this.Z.sa("Box4.CharacterPointConverter"),this.Z.resolve("WordEditor.IStatusBarUser"),this.g1b)).as("Common.ICurrentPageCalculator").fa();
this.Z.ia("WordEditor.Pagination.PageEndMarkers",()=>this.az=new ol(new ub.a(()=>If.App.na.Aa.hc),new ub.a(()=>If.App.na.Aa.Nb.wc),this.Z.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.Z.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.Z.resolve("WordEditor.Pagination.IPageManager"),this.Z.resolve("WordEditor.Pagination.DocumentSizeManager"),this.Z.resolve("WordEditor.Pagination.PageEndDOMHelper"),
zr.a.Zub,this.Z.resolve("WordEditor.ParagraphWordIdMapping"),ko.a.instance,ol.GVk,this.Z.resolve("Box4.ContentEditableViewEventSource"),new lh.a,this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.Z.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.Z.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.g1b?this.Z.resolve("Common.ICurrentPageCalculator"):null,this.fQg,this.j3m,this.Z.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").fa();
this.Z.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new cl(this.Z.Da("Common.IZoomManager"))).fa();this.Z.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new ap(M.AFrameworkApplication.Sb)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").fa();this.Z.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new Ar(this.Z.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").fa();this.Z.ia("WordEditor.Pagination.PageAdornmentManager",
()=>this.u$=new Uk(new ub.a(()=>If.App.na.Aa.hc),Mn.a.instance,$o.a.instance,Pd.a.instance,M.AFrameworkApplication.pa,Po.a.instance,this.fQg,this.Z.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.Z.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.Z.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),ko.a.instance,M.AFrameworkApplication.K)).as("WordEditor.Pagination.IPageAdornmentManager").fa()}init(){this.ua.Rk.continueWith(()=>{this.Wk()})}Wk(){if(this.k3m){const Q=
If.App.na.Aa;Q.Hma?this.jsh():Q.Q$(Object(n.a)(this,this.gYj,"appIsInteractiveEventHandling"))}}gYj(){this.jsh()}jsh(){this.Nya||(this.Nya=!0,this.Y9=za.a.instance.resolve("WordEditor.ICurrentPageManager"),this.g1b&&(this.IY=za.a.instance.resolve("Common.ICurrentPageCalculator")),this.Uv=za.a.instance.resolve("WordEditor.IPaginationReplicator"),za.a.instance.resolve("WordEditor.Pagination.PaginationActor").pb())}dispose(){this.u$&&(this.u$.dispose(),this.u$=null);this.az&&(this.az.dispose(),this.az=
null);this.Uv&&(this.Uv.dispose(),this.Uv=null);this.IY&&(this.IY.disable(),this.IY=null);this.Y9&&(this.Y9=null)}}Object(c.a)(fn,"PackageManager",null,[1,2]);class wl{constructor(){this.Z=null}Mb(Q){this.Z=Q||za.a.instance}dispose(){}}Object(c.a)(wl,"TellMePackage",null,[1,2]);var qm=b(1129),Br=b(1133),Dq=b(293),Fn=b(1126),at=b(1038);class Go{constructor(Q=null,sa=null,db=null,Gb,Xb=null){this.nJe=null;this.DSg=!1;this.U_g=this.Bec=null;this.PJj=this.xhh=this.mTg=this.V_g=!1;this.EMd=null;this.Jnj=
null==sa?M.AFrameworkApplication.JRb:sa;this.Cxj=null==db?M.AFrameworkApplication.oO:db;this.pKj=null==Xb?M.AFrameworkApplication.z1a:Xb;this.vwj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.PLj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.IBm(!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.GLj=!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.qyb;this.HLj=
!Fn.a.Qu()&&!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.FLj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.$tj=!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.$Db;this.ILj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.wJj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.sEj=this.ADd||this.zDd;
this.qEj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.rEj=this.E0f;this.wzj=!!M.AFrameworkApplication.K&&this.rkb&&M.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.ovj=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Mvj=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.evj=M.AFrameworkApplication.K?parseFloat(M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.uzj=!!M.AFrameworkApplication.K&&(M.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.WKj=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.Qvj=M.AFrameworkApplication.K?M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.LJj=!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShowOpenSearchPaneStringInZeroTerm",!1);this.JLj=this.jmi&&(this.uhg||this.vhg||this.Wud||this.rkb&&Fn.a.lZa()&&!!M.AFrameworkApplication.K&&
(this.JDd||this.Vac||this.Xac||this.Yac||this.Zac||M.AFrameworkApplication.K.$("ShowAnswerSearchResults")||M.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||M.AFrameworkApplication.K.$("ShowEntitySearchResults")||M.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.Zjl(Q||{});this.T7e="2918242107";this.S7e="1454393937";this.xNb={};this.pqb=[];this.aik=[Fn.a.CEe]}get application(){return this.Bec}get JRb(){return this.Jnj}get Krm(){return this.T7e}get Jrm(){return this.S7e}get wEf(){return this.U_g}get XSh(){return this.V_g}get oO(){return this.Cxj}get z1a(){return this.pKj}get J9a(){return this.mTg}get Vfl(){return this.vwj}get TOm(){return this.PLj}get jmi(){return!0}get KOm(){return this.JLj}get PDm(){return this.xhh}IBm(Q){this.xhh=
Q}get rkb(){return this.GLj}get KFd(){return this.HLj}get IFd(){return this.FLj}get uEk(){return this.$tj}get IOm(){return this.ILj}get jEe(){return!1}get Wud(){return this.sEj}get uhg(){return this.qEj}get vhg(){return this.rEj}get mfb(){return!1}get mle(){return!1}get L2f(){return this.wzj}get JAe(){return this.PJj}get JDd(){return!1}get f0i(){return!1}get hoi(){return""}get E0f(){return!1}get eM(){return 2}get u4h(){return 4}get Fki(){return!1}get v4h(){return 5}get Oli(){return!1}get dPf(){return""}get bUk(){return this.ovj}get I5h(){return this.Mvj}get x5h(){return 1E3}get w5h(){return 1E-6}get zMm(){return this.WKj}get MGg(){return!1}get y4i(){return!1}get jli(){return!1}get A0f(){return!1}get zji(){return!1}get yji(){return!1}get nfb(){return!1}get kmi(){return!1}get rae(){return!1}get o1a(){return!1}get Vac(){return!1}get Xac(){return!1}get Yac(){return!1}get Zac(){return!1}get ADd(){return this.wJj}get zDd(){return!1}get uJf(){return null}get Cjb(){return!1}get Tke(){return!1}get z2h(){return 0}get JPk(){return this.evj}get f6h(){return this.Qvj}get Txl(){return this.uzj}get LEm(){return this.LJj}get UZk(){return-3.9}get nZa(){return!!M.AFrameworkApplication.oa&&
M.AFrameworkApplication.oa.mb.Bp}get Bp(){return!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.Bp}get Dul(){return!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.Bjb}get AOl(){return dm.getImageClass("OfficeAssistant_32x32x32")}dde(){return Promise.reject("GetFindMatchCount method is not overridden")}yle(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}dje(){return!1}nMi(){}Qbe(){return null}get Gwb(){return"NoOpHeaderUi"}get Xhk(){return this.EMd}get parameterData(){return this.xNb}get zTm(){return this.pqb}GBk(){if(this.nJe&&
!this.DSg&&(this.DSg=!0,this.wjb(this.nJe),this.Bp)){var Q=za.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new at.a(Q)).Hrc(this.nJe.AH);appChrome.api.dispatch(Q)}}get Uwg(){return""}wjb(){}quk(Q){const sa=[];for(let db=0;db<Q.length;++db)Q[db].sFm?sa.push(new Dq.a(Q[db].alternate,Fn.a.B9i+db.toString())):sa.push(new Dq.a(Q[db].standard,Fn.a.CEe+db.toString()));return sa}Zjl(Q){const sa={};for(let db in Q){const Gb=db,Xb=Q[db];for(let Xc in Xb){const zd=Xc,ve=Xb[Xc];(sa[zd]||
(sa[zd]={}))[Gb]=ve}}this.EMd=sa}get d6i(){return""}get c6i(){return""}get b6i(){return""}get n1i(){return!1}}Object(c.a)(Go,"TellMeApplicationData",null,[1327]);class Qq{constructor(Q,sa=null,db=!1){this.standard=Q;this.alternate=sa;this.sFm=db}}Object(c.a)(Qq,"TryQuerySet",null,[]);class Ro{get J0a(){return 18}N6(Q){return Cd.a(String.format("{0}|{1}|",3,Ta.a.we(Q.value)),mb.a.Zpd.toString(),Ro.FQl)}}Ro.FQl="Explore Office Store";Object(c.a)(Ro,"AppsForOfficeQueryMenuItemFactory",null,[1080]);var yi=
b(1114);class Dm{constructor(){this.icon=this.description=this.assetId=this.name=null;this.installed=!1;this.storeId=this.currentStoreType=this.assetStoreId=this.appVersion=null;this.targetType=0}}Object(c.a)(Dm,"OfficeAppItem",null,[]);class ni{constructor(){this.YKd=null}get F9a(){this.YKd||(this.YKd={},this.E9l());return this.YKd}n6j(Q){if(Q)for(let sa of Q)Q=sa[1],Q in this.F9a&&(Q=this.F9a[Q],Q.installed=!0,Q.name=sa[0],Q.description=sa[2],Q.targetType=sa[3],Q.appVersion=sa[4],Q.currentStoreType=
sa[6],Q.icon=sa[9],Q.storeId=sa[11],Q.assetStoreId=sa[12])}NBk(Q,sa,db,Gb,Xb){!yi.b(Q)&&Q in this.F9a&&(Q=this.F9a[Q],Q.installed=!0,Q.appVersion=sa,Q.storeId=db,Q.assetStoreId=Gb,Q.targetType=Xb)}V1(Q,sa,db,Gb){const Xb=new Dm;Xb.assetId=sa;Xb.name=Q;Xb.icon=db;Xb.description=Gb;Xb.installed=!1;this.YKd[sa]=Xb}E9l(){this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_Translator,"WA104124372",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_Translator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_Translator);
this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_TextMaster,"WA104079622",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_TextMaster,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_TextMaster);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ConsistencyChecker,"WA104041485",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ConsistencyChecker,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ConsistencyChecker);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_EFax,
"WA102919521",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_EFax,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_EFax);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ProWordCloud,"WA104038830",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ProWordCloud,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ProWordCloud);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_FontFinder,"WA104211266",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_FontFinder,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_FontFinder);
this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_PicHit,"WA104178141",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_PicHit,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_PicHit);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_IMGEffector,"WA104070070",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_IMGEffector,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_IMGEffector);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_LucidChart,"WA103633427",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_LucidChart,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_LucidChart);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_DocuSign,"WA104218065",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_DocuSign,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_DocuSign);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_GeoGebraTube,"WA104199813",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_GeoGebraTube,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_GeoGebraTube);
this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordCalc,"WA103699714",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordCalc,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordCalc);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_QR4Office,"WA104051163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_QR4Office,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_QR4Office);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_SymbolsCharacters,"WA104379279",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_SymbolsCharacters,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_SymbolsCharacters);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordToHTML,"WA104320163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordToHTML,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordToHTML);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_MapIt,"WA104374368",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_MapIt,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_MapIt);
this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_AbbreviationList,"WA104043061",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_AbbreviationList,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_AbbreviationList);this.V1(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_HandyCalculator,"WA104379673",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_HandyCalculator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_HandyCalculator)}static get instance(){return ni.ra}}ni.ra=
new ni;Object(c.a)(ni,"AppData",null,[]);const sn=(Q,sa,db,Gb=null)=>{const Xb=Ta.a.we(Q.name);var Xc="TellMe_OfficeAddin_Control";db.nke()?Xc="TellMe_OfficeAddin_SingleFlyoutLayout":db.Xji()&&(Xc="TellMe_OfficeAddin_StandaloneFlyoutLayout");db=Q.installed?String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}",Q.assetId,Q.appVersion,Q.storeId,Q.assetStoreId,Q.targetType,Ta.a.we(Q.name),Xc):String.format("{0}|{1}||{2}",2,Q.assetId,Xc);Xc=Ta.a.we(Q.description);return Cd.b(db,Q.installed?mb.a.bie.toString():mb.a.Zpd.toString(),
Xb,Q.icon,sa?"cui-img-16by16":"cui-img-32by32",null,Gb?Gb.sessionId+"|"+Gb.Ema+"|"+Q.name:"",Xb,sa?"Menu16":"Menu32",null,mb.a.X5i.toString(),Xc,null,null)},ih=(Q,sa,db,Gb,Xb)=>Cd.h(Q,null,null,null,!1,!0,null,null,"Image16by16",sa,db,Gb,null,Gb,null,!1,!1,!0,Xb);class Vh{constructor(Q){this.sc=Q}get J0a(){return 17}N6(Q,sa=null){if(this.sc.nke()){var db=[];Q=Q.value.split("|");for(let Gb of Q)if(!yi.b(Gb)){let Xb=sn(ni.instance.F9a[Gb],!1,this.sc,sa);db.push(Xb)}sa=CommonUIStrings.l_TellMeAppsForOfficeMenuSectionTitle;
db=Cd.e("TellMeDropdownControlsForApps_SingleFlyoutLayout",db);sa=Cd.j("TellMeDropdownMenuSectionForApps_SingleFlyoutLayout",db,"Menu32",sa);Q=String.format(CommonUIStrings.l_TellMeAppsForOfficeFlyoutAnchorTitle,Q.length-1);return ih("TellMeFlyoutAnchorForApps_SingleFlyoutLayout",M.AFrameworkApplication.Sp,dm.getImageClass("AppForOfficeLogo_16x16x32"),Q,[sa])}Q=ni.instance.F9a[Q.value];return this.sc.Xji()?(sa=[sn(Q,!1,this.sc,sa)],sa=Cd.e("TellMeControlsForApps_StandardFlyoutLayout",sa),sa=Cd.j("TellMeMenuSectionForApps_StandardFlyoutLayout",
sa,"Menu32"),db=String.format(CommonUIStrings.l_TellMeAppsForOfficeInsertAppHint,Ta.a.we(Q.name)),ih("TellMeFlyoutAnchorForApps_StandardFlyoutLayout"+Q.assetId,Q.icon,"cui-img-16by16",db,[sa])):sn(Q,!0,this.sc,sa)}}Object(c.a)(Vh,"AppsForOfficeRecommendationMenuItemFactory",null,[1080]);var np=b(1145);class $l{constructor(){this.SNc=0;this.ZSg=!1}mng(){this.ZSg||(this.RBc(),this.ZSg=!0);if(!this.SNc||4===this.SNc){const Q=new Nb.a(2,1,0,Object(n.a)(this,this.Qom,"retrieveData"));M.AFrameworkApplication.Sb.Cb(Q);
this.SNc=1}}RBc(){const Q={};Q.callback=Object(n.a)(this,this.wRl,"onAppForOfficeActivated");M.AFrameworkApplication.pa.zb(mb.a.RBc,2,Q)}Qom(){const Q={};Q.callback=Object(n.a)(this,this.dTl,"onDataReady");M.AFrameworkApplication.pa.zb(mb.a.mxd,2,Q)}wRl(Q,sa){ni.instance.NBk(sa[0],sa[1],sa[2],sa[3],sa[4])}dTl(Q){Q?(Q.errorCode||ni.instance.n6j(Q.value),this.SNc=Q.errorCode&&-1!==Q.errorCode?-2147208619===Q.errorCode?4:3:2):this.SNc=3}static get instance(){return $l.ra}}$l.ra=new $l;Object(c.a)($l,
"AppEntitlementQuery",null,[]);class ei{constructor(Q){this.Q1c=this.seh=null;this.sc=Q}initialize(){$l.instance.mng();this.sc.nke()&&(this.seh=[]);this.Q1c=null}xZm(Q,sa){Q in ni.instance.F9a&&(ni.instance.F9a[Q].installed?sa.dI(new np.a(Q,16)):(this.Q1c||(this.Q1c=Q),this.sc.nke()&&this.seh.push(Q)))}lTj(Q,sa){this.Q1c&&!yi.b(sa)&&(Q.dI(new np.a(this.Q1c,17)),Q.dI(new np.a(sa,18)))}}Object(c.a)(ei,"AppsForOfficeResultsProvider",null,[1295]);class Gn{constructor(){this.Q9g=this.R9g=null}get JMl(){return this.Q9g}N6(Q){this.R9g=
Q;return this.Juf(Q)}BPl(){this.Q9g=this.R9g}Dde(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.FF):Q.FF}PIf(Q){return Q.FF}}Object(c.a)(Gn,"ParameterizedCommand",null,[]);class oi extends Gn{constructor(Q){super();this.Tod=Q}get commandId(){return this.Tod?"DefinitionsParameterized":"DefinitionButton"}get Uig(){return"Definition"}Juf(Q){const sa=Ta.a.we(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.FF));return Cd.a(Fn.a.cwf(Q.value),
mb.a.Axf.toString(),sa,Fn.a.dXf,null,Ta.a.we(Fn.a.Yoc(Q.FF)),sa,null,null)}Dde(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.FF)}PIf(Q){return Fn.a.Yoc(Q.FF)}}Object(c.a)(oi,"DefinitionsParameterizedCommand",Gn,[]);class Ni extends Gn{constructor(Q){super();this.Tod=Q}get commandId(){return this.Tod?M.AFrameworkApplication.oa.mb.Zrl?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get Uig(){return"Find"}Juf(Q){const sa=Ta.a.we(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,
Q.FF));return Cd.a(Fn.a.cwf(Q.value),mb.a.findInDocument.toString(),sa,"Find_16x16x32",null,Ta.a.we(Q.FF),sa,null,null)}Dde(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.FF)}}Object(c.a)(Ni,"FindParameterizedCommand",Gn,[]);class Si{constructor(Q){this.sc=Q}get J0a(){return 16}N6(Q,sa=null){return sn(ni.instance.F9a[Q.value],!0,this.sc,sa)}}Object(c.a)(Si,"InstalledAppsForOfficeMenuItemFactory",null,[1080]);class pg extends Gn{constructor(Q){super();this.Tod=Q}get commandId(){return this.Tod?
"SynonymsParameterized":"SynonymButton"}get Uig(){return"Synonym"}Juf(Q){const sa=Ta.a.we(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,Q.FF));return Cd.a(Fn.a.cwf(Q.value),mb.a.Axf.toString(),sa,Fn.a.dXf,null,Ta.a.we(Fn.a.Yoc(Q.FF)),sa,null,null)}Dde(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.FF)}PIf(Q){return Fn.a.Yoc(Q.FF)}}Object(c.a)(pg,"SynonymsParameterizedCommand",Gn,[]);var ye=b(1658),Em=b(1582),Zj=b(1671),
Gl=b(1656),Rn=b(1238);class Cp extends ye.a{constructor(){super(...arguments);this.bW=null;this.t8a=Em.FindManager.createInstance(this,Zj.a.instance,Rn.a.instance,!0,!0)}static get instance(){return Cp.ra}brc(){this.bW(this.t8a.kj.Ioa);this.t8a.p$a(!0)}dde(Q){const sa=new Promise((db,Gb)=>{this.bW=db;setTimeout(()=>{Gb("Find manager execution timed out");this.t8a.p$a(!0)},500)});Q=Gl.a.createQuery(Q,0);this.t8a.find(Q);return sa}}Cp.ra=new Cp;Object(c.a)(Cp,"TellMeFindStatusSpy",ye.a,[]);class Ei extends Go{constructor(Q){super({});
this.RJe=null;this.Bec="Word";this.zvj=Q;M.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.V_g=!0,this.U_g=this.rae?"FindWithMatchesParameterized":"FindParameterized");this.mTg=M.AFrameworkApplication.K.$("SearchOfficeAddinIsEnabled")&&!M.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled");Q=new oi(this.nZa);const sa=new pg(this.nZa);this.parameterData[Q.commandId]=Q;this.parameterData[sa.commandId]=sa;M.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&
(Q=new Ni(this.nZa),this.parameterData[Q.commandId]=Q);M.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(Q=[new Qq(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Qq(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Qq(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Qq(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new Qq(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.pqb=this.quk(Q))}dde(Q){return Cp.instance.dde(Q)}get O0a(){return vk.AppFrame.P3}get Gwb(){return vk.AppFrame.kua}Qbe(){this.J9a&&
!this.RJe&&(this.RJe=new ei(this));return this.RJe}nMi(Q){this.J9a&&(Q.ia(new Si(this)),Q.ia(new Vh(this)),Q.ia(new Ro))}get Uwg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}wjb(Q){var sa=M.AFrameworkApplication.K;Q=Q.AH;Q.WordCountFlyout=!this.zvj();Q.SelectAllButton=!sa.$("TellMeSelectAllResultIsEnabled");const db=sa.$("TellMeDesktopUpSellIsEnabled");let Gb=M.AFrameworkApplication.Qyl;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",
!Gb));Gb=!1;Q.TextBoxUpSellButton=!db||Gb;Q.TableOfContentsUpSellButton=!db||Gb;Q.SmartArtUpSellButton=!db||Gb;Q.WordArtUpSellButton=!db||Gb;Q.MultiColumnLayoutUpSellButton=!db||Gb;Q.InsertEquationUpSellButton=!db||Gb;Q.TrackChangesUpSellButton=!db||Gb;Q.ShapesUpSellButton=!db||Gb;Q.LabelsUpSellButton=!db||Gb;Q.InsertCitationUpSellButton=!db||Gb;Q.TextBoxUpSellButtonEnterprise=!db||!Gb;Q.TableOfContentsUpSellButtonEnterprise=!db||!Gb;Q.SmartArtUpSellButtonEnterprise=!db||!Gb;Q.WordArtUpSellButtonEnterprise=
!db||!Gb;Q.MultiColumnLayoutUpSellButtonEnterprise=!db||!Gb;Q.InsertEquationUpSellButtonEnterprise=!db||!Gb;Q.TrackChangesUpSellButtonEnterprise=!db||!Gb;Q.ShapesUpSellButtonEnterprise=!db||!Gb;Q.LabelsUpSellButtonEnterprise=!db||!Gb;Q.InsertCitationUpSellButtonEnterprise=!db||!Gb;sa=!sa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!M.AFrameworkApplication.oO;Q.SynonymButton=sa;Q.DefinitionButton=sa}nke(){return M.AFrameworkApplication.K.vb("OfficeAddInSearchResultLayoutVariant",Ei.wyi)===
Ei.AQl}Xji(){return M.AFrameworkApplication.K.vb("OfficeAddInSearchResultLayoutVariant",Ei.wyi)===Ei.BQl}get d6i(){return M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get c6i(){return M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get MGg(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get b6i(){return M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName",
"")}get JDd(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get E0f(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get eM(){return M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get n1i(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get mle(){return M.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&
M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get jli(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRuleBasedSorting",!1)}get u4h(){return M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.QueryLengthThresholdForPrefixMatch",4)}get v4h(){return M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.QueryLengthThresholdForSubstringMatch",5)}get Fki(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePrefixMatch",
!1)}get Oli(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSubstringMatch",!1)}get f0i(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldShowLearningUIResults",!1)}get hoi(){return M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.LearningUIQuery","")}get A0f(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get x5h(){return M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",
1E3)}get w5h(){return 1E-6*M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get zji(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get yji(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get dPf(){return M.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName",
"")}get nfb(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNotesSuggestionIsEnabled",!1)}get kmi(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get z2h(){return M.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get jmi(){return M.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get jEe(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get mfb(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get JAe(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get y4i(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get Cjb(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.ShowFindInDocumentInZeroTerm",
!1)}get Tke(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get Vac(){return M.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get Xac(){return M.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get Yac(){return M.AFrameworkApplication.K.$("ShowEntitySearchResults")}get Zac(){return M.AFrameworkApplication.K.$("ShowWolframSearchResults")}get uJf(){return M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",
!1)?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Ei.wyi=1;Ei.BQl=2;Ei.AQl=3;Object(c.a)(Ei,"WordEditorTellMeApplicationData",Go,[]);var $h=b(1207),ir=b(82),wo=b(1150),Jh=b(1160),Sg=b(186);class Jg extends ye.a{constructor(Q){super();this.cOj=Q}brc(){this.cOj.update()}}Object(c.a)(Jg,"TellMeFindStatusManager",ye.a,[]);class Hn{constructor(Q){this.jqb=this.IUg=null;this.If=0;this.IQd="TellMeWAC.";const sa=Q.wEf;this.sc=Q;this.IOd=sa;this.zSd=Object.assign(new $h.a,{landingTab:"Indoc",data:null});
Q=new Jg(this);this.t8a=Em.FindManager.createInstance(Q,Zj.a.instance,Rn.a.instance,!0,!0)}Yaa(){return"WordFindInDocument"}Wta(){return this.sc.eM?1===this.sc.eM?1:3:0}Z7(Q,sa){this.Rzl(Q)?(this.jqb=Q,this.IUg=sa,Q=Gl.a.createQuery(Q.Bh,0),this.If=window.performance.now(),this.t8a.find(Q)):sa.resultsUpdated(new wo.a(Q))}update(){this.Qtm(Math.round(window.performance.now()-this.If));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.jqb.Bh);var sa=M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.o1a?
Fn.a.Dsb(this.jqb.Bh,15,this.zSd):Ta.a.we(this.jqb.Bh);const db=[];db.push(appChrome.actions.setControlLabel(this.IOd,Q));db.push(appChrome.actions.setCompoundButtonCommandValueId(this.IOd,sa));db.push(appChrome.actions.updateCompoundButtonDescription(this.IOd,this.nQf()));appChrome.api.dispatch(db);Q=new np.a(this.IOd,8,this.jqb.Bh,this.t8a.kj.Ioa.toString());sa=new Jh.a(2);sa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;sa.dI(Q);const Gb=new wo.a(this.jqb);Gb.cF(sa);window.requestAnimationFrame(()=>
{this.IUg.resultsUpdated(Gb)});this.t8a.p$a(!0);this.Rtm(Math.round(window.performance.now()-this.If))}nQf(){const Q=this.t8a.kj.Ioa.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}Rzl(Q){return!!Q&&!!Q.Bh&&""!==Q.Bh.trim()}Qtm(Q){const sa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.jqb.Bh.length};
this.sendActivityEvent(sa,Q)}Rtm(Q){const sa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.jqb.Bh.length};this.sendActivityEvent(sa,Q)}sendActivityEvent(Q,sa){Q=ir.a.tVb(Q);Xe.a.Z0a(Object.assign(new Sg.a,{name:"Latency",dataFields:Q,durationMs:sa}),this.IQd)}}Object(c.a)(Hn,"WordFindInDocumentWithMatchesProvider",null,[1249]);class Be{constructor(Q,sa){this.Mc=Q;this.Inl=sa}Ydb(Q,sa,db){return this.Inl.Ydb(0,
Q,sa,db)}insertHtmlText(Q){return Q?32===this.KWf(Q):!1}KWf(Q){return this.executeCommand(kg.a.NVa,Q)}executeCommand(Q,sa){const db=new Nn.DictionaryPropertySet;db.setValue(Li.a.GU,sa);db.setValue(Li.a.nQa,!1);sa=this.Mc.processAction(Q,1);32===sa&&(sa=this.Mc.zb(Q,2,db));return sa}}Object(c.a)(Be,"WordInsertContentHandler",null,[1088]);class Rq extends wl{constructor(){super()}get name(){return"WordEditor.TellMe"}init(){M.AFrameworkApplication.K.Qo(Object(n.a)(this,this.Kx,"onFullAppSettingsReady"))}Kx(){if(M.AFrameworkApplication.oDe){var Q=
If.App.na.mb.efe(mb.a.tellMe);Q.qje?this.OGi():Q.KJ(Object(n.a)(this,this.xrm,"scriptResource_LoadFinished"));var sa=new Ei(()=>!1);qm.TellMeActor.instance.initialize(sa,null,null,null,null,null,Object(n.a)(If.App.na,If.App.na.uGf,"forceUpdateRibbonControls"),M.AFrameworkApplication.K,this.Z.Da("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Z.Da("Common.IActionContextProvider"));qm.TellMeActor.instance.Pem(Q);qm.TellMeActor.instance.lgm(new Be(M.AFrameworkApplication.pa,this.Z.sa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
sa.XSh&&sa.rae&&qm.TellMeActor.instance.T1(new Hn(sa),Br.a.tellMe)}}OGi(){If.App.na.updateCommandUI()}xrm(){this.OGi()}}Object(c.a)(Rq,"WordEditorTellMePackage",wl,[]);class mk{constructor(){this.Z=null}get name(){return"WordEditor.TestFeature"}init(){this.Z.resolve("Box4.IFeatureHelper").Rk.continueWith(()=>{this.Wk()})}dispose(){}Wk(){if(this.Z.resolve("Box4.IFeatureHelper").isFeatureEnabled(225)){M.AFrameworkApplication.pa.Ia(vb.a.wordTestFeature,qh.a.view,Object(n.a)(this,this.SOm,"testFeature"),
96);var Q=pc.FocusManager.instance().gd(vk.AppFrame.MD);Hh.AFrame.Mi(Q,Mf.KeyInputManager.Db(fg.a.eGb,5|Mf.KeyInputManager.Vh),vb.a.wordTestFeature)}}SOm(Q,sa,db){2===db&&(Q=new Qe.StandardDialog,Q.Dc=0,Q.uoa(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}Mb(Q){this.Z=Q}static main(){fa.a.instance.kc(new mk)}}Object(c.a)(mk,"WordEditorTestFeaturePackage",null,[1,2]);var pi=b(98);class nj{constructor(Q,sa){this.oSi=Q;
this.Mc=sa;this.d9b()}d9b(){this.Mc.ma(vb.a.pDc,Lc.a.frame,Object(n.a)(this,this.pDc,"sendTrackChangeSettingUpdateNotification"));this.oSi.n6(Object(n.a)(this,this.C8,"onUpdateNotificationReceived"))}pDc(Q,sa,db,Gb,Xb){if(1===db)return 32;this.oSi.GR(9,Xb,!1);return 32}C8(Q,sa){if(9===sa.type){var db;(Q=sa.z9)?("string"===typeof Q?db=Q:"data"===Q.type&&(db=pi.a.y7d(Q.HHi,Q.newState,Q.fZi)),db&&nj.s9a(db)):pa.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}}dispose(){}static s9a(Q){Q=
If.App.na.notificationBar.DAa(Q,!1);Q.image=5;Q.oua="CoAuth_AuthorStatus_16x16x32";If.App.na.notificationBar.aA(Q)}}Object(c.a)(nj,"TrackChangeNotificationActor",null,[]);class Sq{constructor(){this.Ai=this.jbf=this.Z=null}get name(){return"WordEditor.TrackChangeNotificationActor"}Mb(Q){this.Z=Q}init(){this.Z.resolve("Box4.IFeatureHelper").Rk.continueWith(()=>{this.Wk()})}Wk(){If.App.rtc().continueWith(Object(n.a)(this,this.Mud,"onRtcProxyReady"))}Mud(){if(this.Ai=If.App.rtc().result)this.Z.ia("WordEditor.TrackChange.TrackChangeNotificationActor",
()=>new nj(this.Ai,M.AFrameworkApplication.pa)).fa(),this.jbf=this.Z.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}dispose(){this.jbf&&this.jbf.dispose()}}Object(c.a)(Sq,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Fm=b(64),yk=b(1647),kq=b(1648);class gn{}gn.LLg="UnsavedChanges";gn.Tqm="SavedChanges";gn.F$i="UnsavedChangesOpenPipe";gn.E$i="UnsavedChangesClosePipe";gn.CVm="UnsavedChanges";gn.MLg="UnsavedChangesIndicatorPositionRef";Object(c.a)(gn,"UnsavedChangesHighlightUtils",
null,[]);class Hs extends yk.a{constructor(Q){super();this.Jja=Q;this.Ada=[new kq.a(gn.LLg,gn.CVm)]}get MBa(){return!0}get Stc(){return 4}get E_b(){return this.Ada}ZOa(Q,sa){if(this.Jja){var db=this.Jja.Qag;if(db&&db.count&&db.contains(Q.id))for(Q=sa.eCb("span"),sa=0;sa<Q.length;sa++)db=Q[sa],sa||Uh.a.Kc(db,gn.F$i),sa===Q.length-1&&Uh.a.Kc(db,gn.E$i),Uh.a.Kc(db,gn.LLg)}}iZb(){}}Object(c.a)(Hs,"UnsavedChangesHighlightActor",yk.a,[]);var rm=b(829);class tn{constructor(Q){this.bOe=null;this.Jja=Q;this.LWe=
!1}get key(){return"UnsavedChangesHighlight"}get oy(){return"UnsavedChanges"}reset(Q){if(this.Jja){Q=Q.node;if(uk.ParagraphReader.Hb(Q)){const sa=this.Jja.Qag;if(sa&&sa.contains(Q.id)){this.LWe=!0;this.bOe=Q.id;return}}this.LWe=!1;this.bOe=jb.a.nil}}l2a(){let Q=null;return this.LWe?(Q=Object.assign(new rm.a,{kH:this.key,contentObject:this.bOe,description:null}),{returnValue:!0,oN:Q}):{returnValue:!1,oN:Q}}}Object(c.a)(tn,"UnsavedChangesHighlightCpContentDetailsProvider",null,[63,56]);var Is=b(1091);
class lq{constructor(Q,sa,db,Gb,Xb){this.O9g=null;this.uY=Q;this.Gi=sa;this.kC=db;this.Pv=Gb;this.rkh=Xb;this.Gi.DVa(this.Kba.bind(this))}get Qag(){return this.O9g}wgl(){if(this.uY){if(1===this.uY.eoc){if(this.uY.Wre()){this.O9g=this.uY.nAb;const Q=this.uY.lHc;this.uY.gTi.forEach(this.fvk.bind(this));Q.forEach(this.xgl.bind(this));0<Q.length&&this.xwk(this.kC);return 0}pa.ULS.sendTraceTag(561309320,306,50,"Unsaved Changes Highlighter: Either no unsaved change at all or changes outside canvas body");
return 3}return 5}return 1}Zai(Q,sa,db){if(sa)if(db){db=sa.querySelectorAll("span");for(let Gb=0;Gb<db.length;Gb++){const Xb=db[Gb];Gb||Uh.a.Kc(Xb,gn.F$i);Gb===db.length-1&&Uh.a.Kc(Xb,gn.E$i);Uh.a.Kc(Xb,gn.LLg)}Uh.a.Kc(sa,gn.MLg);Q&&this.Pv.gdc(Q)}else Uh.a.Kc(sa,gn.Tqm)}Rtc(Q,sa){const db=this.Q8k(Q);if(Q&&(Q=Q.zd(Xl.App.na.Aa.hc.eb)))if(Q.Vf&&Q.Vf.Pe&&0!==Q.Vf.Pe.count)for(let Gb of Q.Vf.Pe)this.Zai(db,Gb,sa);else this.Zai(db,Q.htmlElement,sa)}Q8k(Q){return this.rkh&&(Q=this.rkh.Efe(Q))&&Q&&(Q=
Q.zd(Xl.App.na.Aa.hc.eb))?Q:null}oWa(){const Q=this.uY.oWa(2);pa.ULS.sendTraceTag(570828103,306,Q?15:50,"Collect Unsaved Changes Result:{0}",Q);return Q}xgl(Q){this.Rtc(Q,!0);return!0}fvk(Q){this.Rtc(Q,!1);return!0}xwk(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingIsEnabled",0)})}Kba(Q,sa){sa===Sys.EventArgs.Empty?pa.ULS.sendTraceTag(572364513,306,15,"HighlightUnsavedChanges Not Run: Empty Event Args"):sa&&sa.errorCode?(Q=Is.a.xy,
Q.xy()&&(M.AFrameworkApplication.Qn("WordUch;WordUchcf"),M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",!1)&&(pa.ULS.sendTraceTag(572364515,306,50,'HighlightUnsavedChanges: {{"UnsavedClientChanges":"{0}", "UnsavedServerChanges":"{1}"}}',Q.kHc,Q.mHc),Q=this.wgl(),pa.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q)))):pa.ULS.sendTraceTag(572364514,306,15,"HighlightUnsavedChanges Not Run: No {0}",sa?"Error Code":
"Kickout Event Args")}dispose(){this.Gi.fib(this.Kba.bind(this))}}Object(c.a)(lq,"UnsavedChangesHighlighter",null,[12]);var Ka=b(549),Xa=b(303),tb=b(1090);class bc extends tb.a{constructor(Q){super();this.Jja=Q}Kac(Q){if(!this.Jja)return!1;const sa=this.Jja.Qag;return sa?sa.contains(Q.za.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}S7j(Q,sa){sa=Q.j0b?Q.j0b[sa]?Q.j0b[sa].style?Q.j0b[sa].style.marginLeft:null:null:null;var db=Q.leftMargin;Q=1440<=db?-(db/1440*96):Q.k$a(0,96,this.zoom);
db=0;sa&&(sa=sa.match(/^(\d+)px/))&&sa[1]&&(db=Number(sa[1]));return Q-db}m8j(Q,sa,db){return Sys.UI.DomElement.getBounds(Q).y-db.zYa[sa].y}P7j(Q){return Sys.UI.DomElement.getBounds(Q).height}EIh(Q,sa,db,Gb){let Xb;Xb=this.S7j(db,sa);sa=this.m8j(Q,sa,db);Q=this.P7j(Q);Gb=Ka.a.createElement(Gb,Xa.a.div);Gb.className="UnsavedChangesIndicator";Gb.style.left=Xb+"px";Gb.style.top=sa+"px";Gb.style.height=Q+"px";return Gb}hIh(Q,sa,db,Gb){const Xb=[];let Xc=Q.querySelectorAll("."+gn.MLg);if(0===Xc.length&&
Sys.UI.DomElement.containsCssClass(Q,gn.MLg))db=this.EIh(Q,sa,db,Gb),db.gsb=sa,Array.add(Xb,db);else for(Q=0;Q<Xc.length;Q++){let zd=this.EIh(Xc[Q],sa,db,Gb);zd.gsb=sa;Array.add(Xb,zd)}return Xb}kUb(Q){let sa=[];var db=Q.Pha;const Gb=db.rd.ownerDocument;if(db.Yi){let Xb=0;for(let Xc of db.Vf.Pe)(db=this.hIh(Xc,Xb,Q,Gb))&&(sa=sa.concat(db)),Xb+=1}else sa=this.hIh(db.htmlElement,0,Q,Gb);return sa}}Object(c.a)(bc,"UnsavedChangesIndicatorActor",tb.a,[]);class tc{constructor(){this.dG=this.hx=this.vTa=
this.Pv=this.uQd=this.Jja=null}get name(){return"WordEditor.UnsavedChangesHighlight"}Mb(){}init(){M.AFrameworkApplication.K.$("WordUnsavedChangesHighlightingPackageIsEnabled")&&(this.Pv=za.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,this.Jja=new lq(za.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),uj.SessionStatusManager.instance,Fi.a.Wp(za.a.instance.Da("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.Pv,za.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache")),
M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",!1)&&(this.vTa=za.a.instance.Da("Box4.Accessibility.IAccessibilityContextManager"),this.dG=za.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.uQd=new bc(this.Jja),this.Pv.u0a(this.uQd),this.vTa&&this.vTa.execute(Q=>{Q.$ba(new tn(this.Jja))}),this.hx=new Hs(this.Jja),this.dG.vCb(this.hx)))}dispose(){M.AFrameworkApplication.K.$("WordUnsavedChangesHighlightingPackageIsEnabled")&&
(M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UnsavedChangesHighlightIsEnabled",!1)&&(this.Pv&&this.uQd&&this.Pv.lHd(this.uQd),this.dG&&this.hx&&this.dG.$Ee(this.hx)),Fm.a.OB(this.Jja))}static main(){fa.a.instance.kc(new tc)}}Object(c.a)(tc,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,12]);var ed=b(130),jd=b(314);class Ed{constructor(Q,sa,db){const Gb=new wordVersionHistory.AppBootSettings;Gb.RenderServiceBase="";Gb.IsRtl=!1;Gb.Logger=new jd.a;Gb.forcePdfDevEnv=
db.Qu;Gb.UserSessionId=M.AFrameworkApplication.userSessionId;Gb.publicScriptPath=M.AFrameworkApplication.CM;Gb.userType=M.AFrameworkApplication.userType;Gb.shouldSendUserTypeHeader=Q.Qgj;this.pPg=new wordVersionHistory.AppVersionControllerImpl(Gb,sa)}onVersionSelected(Q,sa,db,Gb,Xb){void 0!==sa&&null!==sa?""===sa.DownloadUrl&&pa.ULS.sendTraceTag(593377155,3005,10,"baseVersionInfo is not null and baseVersionInfo.DownloadUrl is empty string, RevisionID: "+Q.RevisionID):db||pa.ULS.sendTraceTag(593377154,
3005,10,"baseVersionInfo is null or undefined selecting a non-first version, RevisionID: "+Q.RevisionID);this.pPg.onVersionSelected(Q,sa,Gb,Xb)}getRenderFailureEvent(){return this.pPg.getRenderFailureEvent()}getLoadFinishEvent(){return this.pPg.getLoadFinishEvent()}}Object(c.a)(Ed,"AppVersionControllerImplWrapper",null,[1294]);class Ge{create(Q,sa,db){return new Ed(Q,sa,db)}}Object(c.a)(Ge,"AppVersionControllerImplWrapperFactory",null,[1252]);class Ne{getVersionHistoryControllerInstance(Q){return versionHistory?
versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):null}}Object(c.a)(Ne,"VersionHistoryControllerFactory",null,[1251]);class Mg{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(sa){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(sa){}}}Object(c.a)(Mg,"VersionHistoryLogConnector",null,[]);var wg=b(79),nk=b(520),ak;(function(Q){Q[Q.None=0]="None";
Q[Q.v5m=1]="VHUnknown";Q[Q.X4m=100]="VHFailedToLoadVersionList";Q[Q.W4m=101]="VHFailedToGetDownloadToken";Q[Q.Y4m=102]="VHFailedToParseVersionList";Q[Q.$4m=103]="VHFetchFailed";Q[Q.y5m=104]="VHVersioningNotEnabled";Q[Q.c5m=105]="VHFileNotFound";Q[Q.x5m=106]="VHVersionTooOld";Q[Q.Z4m=107]="VHFetchException";Q[Q.t5m=108]="VHServiceUnavailable";Q[Q.O4m=109]="VHBadGateway";Q[Q.u5m=110]="VHUnauthorized";Q[Q.g5m=111]="VHInternalServerError";Q[Q.P4m=112]="VHEmptyVersionMetadatas";Q[Q.Q4m=113]="VHFailedHostDownload";
Q[Q.R4m=114]="VHFailedToAddDownloadToVersionStore";Q[Q.S4m=115]="VHFailedToCacheParts";Q[Q.V4m=116]="VHFailedToDownloadVersionMetadata";Q[Q.T4m=117]="VHFailedToDownloadParts";Q[Q.h5m=118]="VHInvalidDocID";Q[Q.i5m=119]="VHMissingDocID";Q[Q.j5m=120]="VHNullDocID";Q[Q.l5m=121]="VHNullHashedDocID";Q[Q.k5m=122]="VHNullGetDownloadAccessTokenRequest";Q[Q.U4m=123]="VHFailedToDownloadVersionFromHost";Q[Q.m5m=124]="VHNullResponseFromFetch";Q[Q.e5m=125]="VHGetTipVersionException";Q[Q.f5m=126]="VHGetVersionsException";
Q[Q.d5m=127]="VHGetDownloadTokenException";Q[Q.a5m=128]="VHFetchRetryException";Q[Q.p5m=129]="VHNullResponseFromRequestVersionHistory";Q[Q.o5m=130]="VHNullResponseFromRequestDownloadToken";Q[Q.A5m=131]="VHXhrJsonParseFailed";Q[Q.z5m=132]="VHXhrException";Q[Q.q5m=133]="VHNullResponseFromXhr";Q[Q.b5m=134]="VHFileGone";Q[Q.r5m=135]="VHNullRevisionIDs";Q[Q.s5m=136]="VHRequestDeleteVersionsException";Q[Q.n5m=137]="VHNullResponseFromRequestDeleteVersions";Q[Q.w5m=138]="VHVersionInfoFromTipVersionException"})(ak||
(ak={}));var Cf;(function(Q){Q[Q.w4m=0]="NotSet";Q[Q.PowerPoint=100]="PowerPoint";Q[Q.Word=110]="Word";Q[Q.Excel=120]="Excel"})(Cf||(Cf={}));var sm;(function(Q){Q[Q.None=0]="None";Q[Q.H4m=1]="Share";Q[Q.D4m=2]="Rename";Q[Q.Restore=3]="Restore"})(sm||(sm={}));var be=b(769);class pe{constructor(){this.revisionId=null;this.Kug=0}}Object(c.a)(pe,"ForceSaveData",null,[]);class af extends uf.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}pi(){return 106}static construct(Q,
sa,db){const Gb=new af;Gb.FileId=Q;Gb.VersionToken=sa;Gb.ExclusiveLockId=$d.a(db);return Gb}}Object(c.a)(af,"RestoreVersionRequest",uf.a,[]);class je{constructor(Q,sa,db,Gb,Xb,Xc,zd,ve,yf,cf,eg,Xh,Nj,dh){this.Mc=Q;this.jh=sa;this.G2=db;this.clickInputManager=Gb;this.rJk=Xb;this.dA=Xc;this.Tqi=zd;this.J2a=ve;this.FSb=yf;this.K1m=cf;this.K=eg;this.xYj=Xh;this.ikf=Nj;this.eSa=dh;this.LHc=this.Sdd=this.UDd=this.mBe=this.WDg=this.hLg=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=
null;this.cye=0;this.gGe=null;this.Wyi="";this.EJa=null;this.kPg=ak.None;this.wDk={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.pkb={};this.Dv={};this.ABe=!1;this.h3=!!M.AFrameworkApplication.oa&&M.AFrameworkApplication.oa.mb.h3;this.SRa=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryVetoes",!1)}Zgb(Q,sa=!0,db=null){wg.d(Q,sa,void 0,void 0,void 0,
void 0,db)}fdb(){return(new Date).getTime()}D4d(){null===this.Sdd&&(this.Sdd=this.fdb())}dsb(Q){const sa=new Nh.a;null===Q?pa.ULS.sendTraceTag(541693581,3005,15,"constructKpiAdditionalValuesWithDuration called with null startTime"):(sa.durationMs=this.fdb()-Q,sa.extendedProperties=new Map);return sa}kWf(){null===this.LHc&&(this.LHc=this.fdb());Na.Health.instance.recordKpiUsageForAlertableKpi("WordVersionHistorySelectVersion","vhwordonline",null)}cpg(){const Q=[],sa=Object.assign(new Nh.a,{extendedProperties:new Map});
if(null!=this.mBe&&null!=this.WDg){var db=this.mBe-this.WDg;Array.add(Q,Object.assign(new ob.a,{name:"showPaneDuration",string:db.toString()}));sa.extendedProperties.set("showPaneDuration",db.toString())}null!=this.Sdd&&null!=this.UDd&&(db=this.Sdd-this.UDd,Array.add(Q,Object.assign(new ob.a,{name:"firstActionDuration",string:db.toString()})),sa.extendedProperties.set("firstActionDuration",db.toString()));(db=this.kPg===ak.None)?Na.Health.instance.recordKpiSuccess("WordVersionHistory",sa):Na.Health.instance.recordKpiFailure("WordVersionHistory",
ak[this.kPg],!1,!1,sa);this.Zgb(vb.a.eDh,db,Q)}pb(){this.Mc.ma(mb.a.BBe,Lc.a.frame,Object(n.a)(this,this.iEg,"showVersionHistoryDialogAction"));this.Mc.ma(mb.a.fAd,Lc.a.frame,Object(n.a)(this,this.Jmm,"reportVersionHistorySaveACopySuccessAction"));this.Mc.ma(mb.a.Ywe,Lc.a.frame,Object(n.a)(this,this.Imm,"reportVersionHistorySaveACopyFailureAction"))}iEg(Q,sa,db){if(1===db)return uj.SessionStatusManager.instance.Hj?8:32;if(2===db){this.gGe=Td.a.create().toString();pa.ULS.sendTraceTag(592196993,3005,
50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.gGe);M.AFrameworkApplication.Uf("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");M.AFrameworkApplication.Qn("WoVer882;WoVer882cf");Object(be.a)();Na.Health.instance.recordKpiUsageForAlertableKpi("WordVersionHistory","vhwordonline",null);this.Zgb(vb.a.SDi,!0);this.pkb.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Dv.VersionHistoryLaunchSessionId=this.gGe;
this.perfTelemetryInfos=[];this.controller||(this.controller=this.K1m.getVersionHistoryControllerInstance({ulsLogger:new jd.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:M.AFrameworkApplication.zk,appSettings:{appName:Cf.Word,wdEnableDownloadTokens:this.J2a.Rgj,wdEnableSaveACopy:!0,wdEnableRestore:this.J2a.Ogj,userSessionId:M.AFrameworkApplication.userSessionId,wacCluster:this.K.Oa("WacCluster"),uiLocale:M.AFrameworkApplication.uiCulture?M.AFrameworkApplication.uiCulture:"en-us",
wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:M.AFrameworkApplication.K.Oa("VHSDisabledChangeGates"),wdEnableDownloadVersion:this.J2a.JJd,wdEnableSaveACopyOverFlowMenu:this.J2a.Pgj,isRtl:M.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:Ma.a.Qu,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return Na.Health.instance.recordKpiFailure("WordVersionHistory",
"scriptDependencyUnavailable",!1,!1,null),this.SRa&&this.eSa.QZa("scriptDependencyUnavailable",0),8;this.controller.setDisableSaveACopy(this.iDm()||this.gDm());this.jIm()}return 32}Jmm(Q,sa,db){if(1===db)return uj.SessionStatusManager.instance.$_?32:8;2===db&&(Q=this.dsb(this.cye),Na.Health.instance.recordKpiSuccess("WordVersionHistorySaveACopy",Q),this.cpg());return 32}Imm(Q,sa,db,Gb,Xb){var Xc,zd,ve;if(1===db)return uj.SessionStatusManager.instance.$_?32:8;2===db&&(Q="Unknown",sa="",Xb&&(Q=null!==
(Xc=Xb.FailureReason)&&void 0!==Xc?Xc:Q,Xb=null!==(zd=Xb.ExtraInfo)&&void 0!==zd?zd:"",sa=null!==(ve=this.wDk[Xb])&&void 0!==ve?ve:Xb),zd=this.dsb(this.cye),""!==sa&&zd.extendedProperties.set("ExtraInfo",sa),Na.Health.instance.recordKpiFailure("WordVersionHistorySaveACopy",Q,!1,!1,zd),this.SRa&&this.eSa.QZa(Q,3,sa),pa.ULS.sendTraceTag(592197004,3005,10,"Save failed with result: "+Q));return 32}jIm(){this.WDg=this.fdb();this.Sdd=this.UDd=this.mBe=null;if(document.getElementById("VersionHistoryOverlay"))this.hB();
else{this.Tfm();this.Ufm();this.Dfm();this.Ifm();this.Qfm();this.Hfm();this.J2a.Sgj&&this.Gfm();this.Pfm();this.Rfm();const Q=document.createElement("div");let sa=Q.id="VersionHistoryOverlay",db=null;this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryCtrlCTelemetry",!1)&&this.Kfm(Q);if(this.h3&&(db=M.AFrameworkApplication.oa.lk?M.AFrameworkApplication.oa.lk.getRegion(M.AFrameworkApplication.oa.lk.AR.J("Header")):null)){const Gb=document.getElementById("AppHeaderPanel");sa=Gb&&
"none"===Gb.style.display?String.format("{0} {1} {2}",sa,"RegionComposer","NoAppHeader"):String.format("{0} {1}",sa,"RegionComposer")}db||(db=document.getElementById("WACInnerFrame"));Q.className=sa;db.appendChild(Q);this.hLg=this.controller.createVersionHistoryDialog(Q);this.Lwa()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}iDm(){if(M.AFrameworkApplication.Lna)return pa.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),
!0;if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",!1))if(M.AFrameworkApplication.pZa){if(!this.K.$("SaveACopyBrsIsEnabled"))return pa.ULS.sendTraceTag(570770273,3005,50,"Version History is disabling Save a Copy because SaveACopyBrsIsEnabled is false."),!0}else{if(!this.K.$("SaveToAnotherFolderBrsIsEnabled"))return pa.ULS.sendTraceTag(570770274,3005,50,"Version History is disabling Save a Copy because SaveToAnotherFolderBrsIsEnabled is false."),
!0;if(!this.K.$("SupportsGetMoreInfoForPersonalStorage"))return pa.ULS.sendTraceTag(570770275,3005,50,"Version History is disabling Save a Copy because SupportsGetMoreInfoForPersonalStorage is false."),!0}else{const Q=32==this.Mc.processAction(mb.a.ZCc,1);let sa=32==this.Mc.processAction(mb.a.$Cc,1);if(!Q&&!sa)return pa.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0}return!1}gDm(){if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",
!1)){if(this.J2a.JJd&&M.AFrameworkApplication.z8i)return pa.ULS.sendTraceTag(570770304,3005,50,"Version History is disabling download version because it is trimmed."),!0}else if(this.J2a.JJd){if(M.AFrameworkApplication.Lna)return pa.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0;if(32!=this.Mc.processAction(mb.a.downloadACopy,1))return pa.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0}return!1}Ifm(){this.controller.getFullAppErrorEvent().addListener(Q=>{let sa=Q?ak[Q]:"";this.Dv[je.X6j]=sa;this.kPg=Q;this.SRa&&this.eSa.QZa(sa,0);pa.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",sa,this.gGe)})}Tfm(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.mBe=this.fdb();this.nnm(Q.containerDiv);Q.versions&&(this.Wyi=je.U4h(Q.versions[Q.versions.length-1]));this.hB();try{if(this.currentVersion&&""!==this.currentVersion.DownloadUrl&&
this.EJa){this.EQg();const sa=!this.ABe;this.kWf();this.EJa.onVersionSelected(this.currentVersion,this.baseVersion,this.Zji(this.currentVersion),this.pkb,sa);this.perfTelemetryInfos=[];this.pkb={}}}catch(sa){pa.ULS.sendTraceTag(592196996,3005,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",sa)}})}Ufm(){this.controller.getVersionSelectedEvent().addListener(Q=>{this.currentVersion=Q.currentVersion;this.baseVersion=Q.baseVersion;if(this.EJa)try{this.EQg();if(""!==(this.baseVersion?
this.baseVersion.DownloadUrl:"")||Q.noBaseToCompareTo)this.kWf(),this.EJa.onVersionSelected(Q.currentVersion,Q.baseVersion,Q.noBaseToCompareTo,this.pkb,!this.ABe);this.perfTelemetryInfos=[];this.pkb={}}catch(sa){pa.ULS.sendTraceTag(592196997,3005,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",sa)}})}Gfm(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>{try{pa.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),
this.Ccl(Q)}catch(sa){pa.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",sa)}})}Ccl(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.kWf(),this.EJa.onVersionSelected(this.currentVersion,this.baseVersion,!Q.versionSelected.noBaseToCompareTo,this.pkb,!this.ABe)):pa.ULS.sendTraceTag(591697922,3005,10,"VersionHistoryPaneActor: HandleGetDownloadTokenReadyEvent_Optimized: downloadTokenReadyObject.VersionSelected was null")}Dfm(){this.controller.getCloseSelectedEvent().addListener(()=>
{this.Vdk();this.vCl()})}Mkl(Q){const sa={};sa.FileDownloadUrl=Q;sa.SaveEntryPoint="VersionHistory";return sa}$4k(Q){let sa="Dialog Failure - ActionResponse "+Q.toString();2===Q?sa="DialogNotHandled":8===Q&&(sa="DialogFailed");return sa}Qfm(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.cye=this.fdb();Na.Health.instance.recordKpiUsage("WordVersionHistorySaveACopy",0,"vhwordonline",null);this.D4d();pa.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");
this.Vxi();var sa=this.Mkl(Q);Q=32==this.Mc.processAction(mb.a.ZCc,1);this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotUseVersionHistorySaveACopyImprovements",!1)&&(Q=this.J2a.afj);sa=this.Mc.zb(Q?mb.a.ZCc:mb.a.$Cc,2,sa);const db=this.dsb(this.cye),Gb=32===sa;if(!Gb){const Xb=this.$4k(sa);Na.Health.instance.recordKpiFailure("WordVersionHistorySaveACopy",Xb,!1,!1,db);this.SRa&&this.eSa.QZa(Xb,2);pa.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
sa.toString())}this.Zgb(vb.a.HCh,Gb)})}Hfm(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{if(this.J2a.JJd){var sa=this.fdb();Na.Health.instance.recordKpiUsage("WordVersionHistoryDownloadVersion",0,"vhwordonline",null);this.D4d();Q=new rk.QueryStringBuilder(Q);Q.ue("fn",M.AFrameworkApplication.fileName);Q=this.Mc.zb(mb.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});sa=this.dsb(sa);const db=32===Q;db?Na.Health.instance.recordKpiSuccess("WordVersionHistoryDownloadVersion",
sa):(this.SRa&&this.eSa.QZa("",4),Na.Health.instance.recordKpiFailure("WordVersionHistoryDownloadVersion",Q.toString(),!1,!1,sa),pa.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result : "+Q.toString()));this.Zgb(vb.a.GCh,db)}})}kme(){this.Vxi();this.cpg();this.dA&&this.dA.refreshDocument(null)}rdl(Q,sa){2===Q.statusCode&&Q.og&&0<Q.og.length&&Q.og[0]?(Q=Q.og[0],sa=this.dsb(sa),this.Tqi&&Q.ShouldAvoidLockRelease&&this.Tqi.sia(!1,"VersionHistory"),191===Q.StatusCode?(Na.Health.instance.recordKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",!0,!1,sa),this.SRa&&this.eSa.jFl(),this.Zgb(vb.a.Snc,!1),pa.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),je.wCl()):Q.StatusCode?(sa.extendedProperties.set("status",nk.a[Q.StatusCode]),Na.Health.instance.recordKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",!1,!1,sa),this.SRa&&this.eSa.QZa("ServerOperationFailed",5),this.Zgb(vb.a.Snc,!1),pa.ULS.sendTraceTag(592197007,
3005,10,"RestoreVersionRequest failed with "+nk.a[Q.StatusCode]),this.controller.setRestoreFailedAtServer(Object(n.a)(this,this.kme,"launchSurveyRefreshDocument"))):(Na.Health.instance.recordKpiSuccess("WordVersionHistoryRestore",sa),this.Zgb(vb.a.Snc,!0),pa.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.kme())):(Na.Health.instance.recordKpiFailure("WordVersionHistoryRestore","serverOperationFailed",!1,!1,null),this.SRa&&this.eSa.QZa("ServerOperationFailed",5),pa.ULS.sendTraceTag(592197009,
3005,10,"serverOperation failed with "+Ph.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(Object(n.a)(this,this.kme,"launchSurveyRefreshDocument")))}tJk(Q){pa.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var sa=Q.revisionId;const db=jb.a.create();sa=af.construct(M.AFrameworkApplication.rootQuerySignature,sa,db);const Gb=Object.assign(new Sd.a,{fk:sa,status:1,Bv:"RestoreVersion"});sa=this.ikf.N2(0,()=>{this.rdl(Gb,Q.Kug)});sa.cA(Gb);sa.oI()}forceSaveFailed(Q,sa){const db=
this.dsb(Q.Kug);db.extendedProperties.set("status",nk.a[sa]);Na.Health.instance.recordKpiFailure("WordVersionHistoryRestore","forceSaveFailed",!1,!1,db);this.SRa&&this.eSa.QZa("ForceSaveFailed",5);this.Zgb(vb.a.Snc,!1);pa.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+nk.a[sa]+"for version "+Q);this.controller.setRestoreFailedAtServer(Object(n.a)(this,this.kme,"launchSurveyRefreshDocument"))}Pfm(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{this.D4d();const sa=
this.fdb();Na.Health.instance.recordKpiUsage("WordVersionHistoryRestore",0,"vhwordonline",null);let db=null;Q&&(db=Q.split("-")[0]);db&&""!==db?(Q=Object.assign(new pe,{revisionId:db,Kug:sa}),pa.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",db),this.controller.setRestoreInProgress(),this.rJk(19,!1,Object(n.a)(this,this.tJk,"forceSaveSucceeded"),Object(n.a)(this,this.forceSaveFailed,"forceSaveFailed"),Q,null,null)):(Na.Health.instance.recordKpiFailure("WordVersionHistoryRestore",
"invalidRevisionId",!1,!1,null),this.SRa&&this.eSa.QZa("InvalidRevisionId",5),this.Zgb(vb.a.Snc,!1),pa.ULS.shipAssertTag(592197012,3005,!1))})}Vfm(){this.EJa.getRenderFailureEvent().addListener(Q=>{this.SRa&&this.eSa.QZa(Q,1);const sa=this.dsb(this.LHc);this.LHc=null;Na.Health.instance.recordKpiFailure("WordVersionHistorySelectVersion",Q,!1,!1,sa);try{this.Dv.ViewerErrorCode="ViewerErrorCode"in this.Dv?this.Dv.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),pa.ULS.sendTraceTag(592197014,
3005,10,"Versions viewer error code: {0}",Q)}catch(db){pa.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",db)}})}Lfm(){this.EJa.getLoadFinishEvent().addListener(()=>{null==this.UDd&&(this.UDd=this.fdb());const Q=this.dsb(this.LHc);this.LHc=null;Na.Health.instance.recordKpiSuccess("WordVersionHistorySelectVersion",Q);this.controller.setVersionLoadComplete()})}Rfm(){this.controller.getShowVersionChangesToggledEvent().addListener(Q=>{this.ABe=!Q;this.hB();try{this.currentVersion&&
""!==this.currentVersion.DownloadUrl&&this.EJa&&(this.EQg(),this.EJa.onVersionSelected(this.currentVersion,this.baseVersion,this.Zji(this.currentVersion),this.pkb,Q),this.perfTelemetryInfos=[],this.pkb={})}catch(sa){pa.ULS.sendTraceTag(592197016,3005,10,"VersionHistoryPaneActor: Exception in ShowVersionChangesToggledEvent callback: {0}",sa)}})}hB(){this.G2.Gu(vk.AppFrame.P3);this.G2.Gu(Hh.AFrame.uo);this.G2.Gu(vk.AppFrame.zoa);this.jh.wM("VersionHistoryViewer",!1);this.G2.hB("VersionHistoryViewer");
this.jh.wM("VersionHistoryHeader",!0);this.G2.hB("VersionHistoryHeader");this.jh.wM("VersionHistoryOverlay",!0);this.G2.hB("VersionHistoryOverlay")}Gu(){this.G2.hB(vk.AppFrame.P3);this.G2.hB(Hh.AFrame.uo);this.G2.hB(vk.AppFrame.zoa);this.G2.Gu("VersionHistoryOverlay");this.jh.wR("VersionHistoryOverlay");this.G2.Gu("VersionHistoryHeader");this.jh.wR("VersionHistoryHeader");this.G2.Gu("VersionHistoryViewer");this.jh.wR("VersionHistoryViewer")}Vdk(){this.cpg();document.getElementById("VersionHistoryOverlay").style.display=
"none";this.Dv.browser=Ma.a.QJ;Ma.a.I7&&(this.Dv.electronBrowserVersion=Ma.a.czk);this.Gu();pa.ULS.sendTraceTag(592197017,3005,50,la.c(this.Dv))}EQg(){for(let Q of this.perfTelemetryInfos){const sa=Q.TelemetryEventKey?Q.TelemetryEventKey:Q.telemetryEventKey?Q.telemetryEventKey:"",db=Q.TelemetryEventData?Q.TelemetryEventData:Q.telemetryEventData?Q.telemetryEventData:"";""!==sa&&""!==db&&(this.pkb[sa]=db)}}nnm(Q){try{this.EJa?Mg.setIsPageLoadForFirstTime(!1):(Mg.setIsPageLoadForFirstTime(!0),this.EJa=
this.xYj.create(this.J2a,Q,this.FSb),this.Vfm(),this.Lfm())}catch(sa){pa.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",sa)}}duf(Q){const sa=this.jh.gd(Q);sa.parent=Hh.AFrame.zo;this.G2.Lra(Q);sa.iR=!0;return sa}Lwa(){this.duf("VersionHistoryOverlay").S1((Q,sa)=>{try{"VersionHistoryOverlay"===sa.name&&this.hLg.then(db=>{db.enterFocusTrapZone();return null})}catch(db){pa.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",
db)}});this.clickInputManager.p9a("VersionHistoryOverlay",document.getElementById("VersionHistoryOverlay"));this.duf("VersionHistoryHeader").S1((Q,sa)=>{try{"VersionHistoryHeader"===sa.name&&this.hLg.then(db=>{db.enterHeaderFocusTrapZone();return null})}catch(db){pa.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",db)}});this.clickInputManager.p9a("VersionHistoryHeader",document.getElementById("vhHeader"));this.duf("VersionHistoryViewer").S1((Q,
sa)=>{try{"VersionHistoryViewer"===sa.name&&pc.FocusManager.UR(document.getElementById("vhViewer"))}catch(db){pa.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",db)}});this.clickInputManager.p9a("VersionHistoryViewer",document.getElementById("vhViewer"))}vCl(){const Q=za.a.instance.sa("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):
pa.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}Vxi(){const Q=za.a.instance.sa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):pa.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static U4h(Q){return Q.RevisionID?Q.RevisionID:Q.revisionID?Q.revisionID:""}static wCl(){const Q=za.a.instance.sa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):
pa.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}Kfm(Q){Q&&Q.addEventListener("keydown",sa=>{sa.ctrlKey&&"KeyC"===sa.code&&(this.D4d(),Na.Health.instance.recordKpiUsage("WordVersionHistoryCopyText",0,"vhwordonline",null));sa.ctrlKey&&"KeyF"===sa.code&&Na.Health.instance.recordKpiUsage("WordVersionHistorySearchText",0,"vhwordonline",null)})}Zji(Q){return je.U4h(Q)===this.Wyi}}je.X6j="ErrorCode";Object(c.a)(je,"VersionHistoryPaneActor",
null,[1250]);class Tg{constructor(){this.Qgj=this.Pgj=this.afj=this.JJd=this.Ogj=this.Sgj=this.Rgj=!1}}Object(c.a)(Tg,"WordVersionHistorySettings",null,[]);class hf{QZa(Q,sa,db){this.nsi(Q,!1,sa,db)}jFl(){this.nsi("MultipleClientsInCoauthSession",!0,5,void 0)}nsi(Q,sa,db,Gb){Na.Health.instance.recordQosError(this.w$k(Q,db,Gb),["VersionHistoryExperienceDegraded"],sa,!1,!0,!1,null)}w$k(Q,sa,db){if(0==sa)return"VersionHistoryLaunchFailed";if(1==sa)return Q.includes("Failed to fetch")?"SelectVersionFailedBecauseFetchFailed":
Q.includes("Unexpected server response (500) while retrieving PDF")?"SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?"SelectVersionFailedServerResponseBadGateway":Q.includes("Unexpected server response (415) while retrieving PDF")?"SelectVersionFailedServerResponseUnsupportedMediaType":Q.includes("Unexpected server response (408) while retrieving PDF")?"SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?
"SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?"SelectVersionFailedServerResponseRequestEntityTooLarge":"SelectVersionFailed";if(5==sa)return"RestoreVersionFailed"+Q;if(4==sa)return"DownloadVersionFailed"+Q;if(2==sa)return hf.lwg+Q;if(3==sa){if(db)return hf.lwg+db;Q=this.mWk(Q);return""!=Q?"SaveVersionFailedServerResponse"+Q:hf.lwg}}mWk(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";
case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}hf.lwg="SaveVersionFailed";Object(c.a)(hf,"WordVersionHistoryVetoHelper",null,[1086]);class xc{constructor(){this.K=this.container=null}get name(){return"WordEditor.VersionHistory"}init(){M.AFrameworkApplication.s3f()?(pa.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),ed.a.get_instance().Pk(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").dC;
(M.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(sa=>pa.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",sa)).then(()=>this.VZl()).catch(sa=>pa.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",sa))})):pa.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}VZl(){pa.ULS.sendTraceTag(541942913,
3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").pb();return null}dispose(){}Mb(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");if(this.K.$("AppSupportsVersionHistory")){var sa=this.container.resolve("Common.IBrowserUtils");Q=M.AFrameworkApplication.pZa;var db=!M.AFrameworkApplication.pZa&&this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryDownloadVersionIsEnabled",!1),Gb=new Tg;
Gb.Rgj=this.K.$("WordWdDownloadTokenIsEnabled");Gb.Sgj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");Gb.Ogj=this.K.$("WordVersionHistoryEnableRestore");Gb.JJd=Q||db;Gb.afj=Q;Gb.Pgj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");Gb.Qgj=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordVersionHistorySendUserTypeHeader",!1);this.container.ia("IVersionHistoryPaneActor",()=>new je(M.AFrameworkApplication.pa,pc.FocusManager.instance(),tg.a.instance,Mn.a.instance,xm.a.gK,If.App.na,
If.App.FA,Gb,sa,new Ne,M.AFrameworkApplication.K,new Ge,new tj.a,new hf)).fa()}}static main(){let Q=!1;M.AFrameworkApplication.K&&M.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&M.AFrameworkApplication.s3f()&&(Q=!0);fa.a.instance.kc(new xc,0,Q)}}Object(c.a)(xc,"WordVersionHistoryPackage",null,[1,2]);var Ah=b(124);class gm{constructor(Q,sa,db){this.ea=Q;this.ql=sa;this.qa=db}pb(){this.qa.$("ZoomPopupDialogIsEnabled")&&(this.ea.ma(mb.a.TEc,Lc.a.frame,Object(n.a)(this.ql,this.ql.TEc,
"showZoomDialog")),this.ea.Ia(mb.a.M$l,Lc.a.frame,Object(n.a)(this.ql,this.ql.dCi,"onQueryZoomText"),96),this.ea.ma(mb.a.kIc,Lc.a.frame,Object(n.a)(this.ql,this.ql.jhj,"zoomDialogTabFocusHandler")),this.ea.ma(mb.a.jIc,Lc.a.frame,Object(n.a)(this.ql,this.ql.jhj,"zoomDialogTabFocusHandler")));this.qa.$("ZoomSliderIsEnabled")&&(this.ea.Ia(mb.a.L$l,Lc.a.frame,Object(n.a)(this.ql,this.ql.eXl,"onQueryZoomPercentage"),96),this.ea.ma(mb.a.P3m,Lc.a.frame,Object(n.a)(this.ql,this.ql.f_l,"onZoomToPercentage")))}}
Object(c.a)(gm,"CommonZoomActor",null,[1050]);class yj extends gm{constructor(Q,sa,db){super(Q,sa,db);this.Aka=sa}pb(){super.pb();this.qa.$("ZoomPopupDialogIsEnabled")&&(this.ea.ma(vb.a.UQg,Lc.a.frame,Ah.ActionManager.Te),this.ea.ma(vb.a.mIc,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.O3m,"zoomTo100")));this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatusBarZoomToPageWidthIsEnabled",!1)&&this.ea.ma(vb.a.zoomToPageWidth,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.zoomToPageWidth,"zoomToPageWidth"));
this.ea.ma(mb.a.Mdb,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.Mdb,"increaseZoom"));this.ea.ma(mb.a.Fab,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.Fab,"decreaseZoom"));this.ea.ma(vb.a.sBd,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.ABm,"setZoomLevelFromRibbon"));this.ea.Ia(vb.a.Y_a,Lc.a.frame,Object(n.a)(this.Aka,this.Aka.dCi,"onQueryZoomText"),96);this.ea.Ia(vb.a.Qxd,qh.a.application,Object(n.a)(this.Aka,this.Aka.dXl,"onQueryZoomLevelLabelText"),96);this.ea.ma(kg.a.CJh,Lc.a.frame,Ah.ActionManager.Te);this.ea.ma(kg.a.BJh,
Lc.a.frame,Ah.ActionManager.Te);this.ea.ma(kg.a.FJh,Lc.a.frame,Ah.ActionManager.Te);this.ea.ma(kg.a.DJh,Lc.a.frame,Ah.ActionManager.Te);this.ea.ma(vb.a.Wia,Lc.a.frame,Ah.ActionManager.Te)}}Object(c.a)(yj,"WordEditorZoomActor",gm,[]);var op=b(256);class hn{constructor(Q,sa){this.zoom=Q;this.qXj=sa}}Object(c.a)(hn,"SetCustomZoomArgs",null,[]);var xl=b(912);class jn{constructor(Q,sa){this.qrk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.rrk=[jn.Byf,jn.K8d,
"200","150","100","75","50"];this.Usa=3;this.delta=.1;this.$4f=0;this.Jg=new m.a;this.Ld=this.t0e=null;this.K=Q;this.Mc=sa;this.aG=1}get Eh(){return this.aG}get N$c(){return Math.round(100*this.Eh)}get tOl(){return Math.floor(this.N$c/10)/10+this.delta}get sOl(){return Math.ceil(this.N$c/10)/10-this.delta}get ea(){return M.AFrameworkApplication.pa}get bMl(){this.t0e||(M.AFrameworkApplication.Qn("WoZoo372;WoZoo372cf"),M.AFrameworkApplication.K&&(this.t0e=M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ZoomDialogBoxInReactIsEnabled",
!1)));return this.t0e}YVj(Q){this.Jg.addHandler("ZoomChanged",Q)}Skm(Q){this.Jg.removeHandler("ZoomChanged",Q)}bca(Q){this.YVj(Q)}B9b(Q){this.Skm(Q)}xqg(){}Jrg(){}wqg(){}Irg(){}lIc(Q){this.khj(Q,this.Eh)}khj(Q,sa){null!==Q&&mp.a.Wzm(Q,sa)}kAe(Q,sa=!0){let db=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(db=new hn(Q,sa));this.iWi(db)}zBm(Q,sa=!1){this.Wia(Q,3|(sa?0:4))}d_l(Q,sa,db){if(1===Q)return 32;Q=db/100;Q<this.tsd?Q=this.tsd:Q>this.fsd&&(Q=this.fsd);this.Wia(Q);sa&&(sa.Er=Math.floor(100*
Q));return 32}dCi(Q,sa,db,Gb,Xb){if(1===db)return 32;Q=Ta.a.dBa(this.N$c,6,M.AFrameworkApplication.numberFormat);Xb.Value=Q;Xb.LabelText=Q;return 32}f_l(Q,sa,db,Gb,Xb){return 1===db?32:this.d_l(db,Gb,Xb.value)}eXl(Q,sa,db,Gb,Xb){Xb.MinValue=100*this.tsd;Xb.MaxValue=100*this.fsd;Xb.value=this.N$c;return 32}k8h(){return this.qrk}l8h(){return this.rrk}XRk(){let Q=Math.floor(100*this.Eh).toString();1===this.Usa?Q=jn.Byf:2===this.Usa&&(Q=jn.K8d);return Q}Mdb(Q,sa,db){if(1===db)return 32;this.Ard(this.Mc?
this.Mc.AW:0,"IncreaseZoom");this.Usa=0;this.Wia(this.tOl);return 32}Fab(Q,sa,db){if(1===db)return 32;this.Ard(this.Mc?this.Mc.AW:0,"DecreaseZoom");this.Usa=0;this.Wia(this.sOl);return 32}ABm(Q,sa,db,Gb,Xb){if(1===db)return 32;this.Ard(this.Mc?this.Mc.AW:0,"SetZoomLevelFromRibbon");Q=Xb.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Nb.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),ko.a.instance.Cb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.Usa=0;this.Wia(Q);
return 32}Ard(Q,sa){pa.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,sa,M.AFrameworkApplication.oa.mb.Bp)}TEc(Q,sa,db){if(1===db)return 32;pa.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.XRk();this.Ld=new xl.a(this.k8h(),this.l8h(),Object(n.a)(this,this.eel,"handleZoomDialogResult"),pc.FocusManager.instance(),this.bMl);this.Ld.TEc(CommonUIStrings.l_ZoomDialogTitle,
Q)}arl(Q){return Q.toLowerCase()===jn.Byf.toLowerCase()}brl(Q){return Q.toLowerCase()===jn.K8d.toLowerCase()}eel(Q){if(this.arl(Q)){this.Usa=1;var sa=32}else if(this.brl(Q))this.Usa=2,sa=this.zoomToPageWidth(0,null,2,null,null);else if(sa=Number.parseInvariant(Q)){this.Usa=0;let db=sa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(db=new hn(sa,!0));sa=this.iWi(db)}else sa=8;32===sa?pa.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):pa.ULS.sendTraceTag(7156360,
353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}mbm(){this.Jg.raiseEvent("ZoomChanged",null)}gKi(){}kog(){}jhj(Q){if(!this.Ld)return 2;var sa=this.Ld.jh.$j().Bi.vT;if(sa===this.Ld.vw&&Q===mb.a.kIc||sa===this.Ld.ZF&&Q===mb.a.jIc)this.Ld.O1||this.Ld.gUi(),this.Ld.jh.$j().Bi.tw(this.Ld.O1);else if(sa.id.startsWith(this.Ld.n0a)||sa.className.startsWith(this.Ld.Yue))sa=null,Q===mb.a.kIc?sa=this.Ld.ZF:Q===mb.a.jIc&&(sa=this.Ld.vw),this.Ld.jh.$j().Bi.tw(sa),Sys.UI.DomElement.removeCssClass(this.Ld.O1.parentNode,
this.Ld.FBc);else if(Q===mb.a.kIc)this.Ld.jh.$j().e_a();else if(Q===mb.a.jIc)this.Ld.jh.$j().d_a();else return 2;return 32}}jn.Byf="FullPage";jn.K8d="PageWidth";Object(c.a)(jn,"ZoomManager",null,[928]);var bt=b(318),Qp=b(935);class Om extends jn{constructor(Q,sa,db,Gb,Xb,Xc,zd){super(Q,sa);this.f3m=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.g3m=[jn.K8d,"200","150","125","100","75","50"];this.mcf=this.NQi=!1;this.JTg="AutoFitForAdaptiveLayout";this.zuj="FitPageWidthFailure";
this.hNj="UpdateZoomFailure";this.oOj="wwf";this.bI=this.Adf=null;this.mW=db;this.Ji=Gb;this.kb=Xb;this.Yd=Xc;this.vRc=zd;this.z6g=Q.$("KeepViewAfterZoomIsEnabled");this.pOj=Q.$("ZoomShortCutIsEnabled");this.nOj=Q.$("ZoomCtrlScrollIsEnabled");this.sNj=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.Wxj=(this.IVe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.rsj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.qOj=Q.$("ZoomSliderIsEnabled");this.Iz()}get appName(){return"WordEditor"}get fsd(){return 4}get tsd(){return.1}get qqk(){return wacBoot.CtrlWheelMetrics}vVj(Q){this.Jg.addHandler("PinchStart",
Q)}Mkm(Q){this.Jg.removeHandler("PinchStart",Q)}uVj(Q){this.Jg.addHandler("PinchEnd",Q)}Lkm(Q){this.Jg.removeHandler("PinchEnd",Q)}get Oz(){return this.bI||(this.bI=za.a.instance.sa("WordEditor.IStatusBarUser"))}Dcj(Q){return Q&4?!1:(Q={SelectZoomOption:"ComboBoxModel"},If.App.na&&If.App.na.QF(Q),this.N_m(),!0)}Wia(Q,sa=0){let db=!0;this.rsj||M.AFrameworkApplication.pa.processAction(vb.a.Wia,2);if(this.Eh===Q)return this.mcf||(this.mcf=this.Dcj(sa)),db;Q>this.fsd?Q=this.fsd:Q<this.tsd&&(Q=this.tsd);
1===Q||sa&1||M.AFrameworkApplication.pa.processAction(vb.a.UQg,2);try{let Gb=null;If.App.na&&Object(Qb.a)(Qp.PageView,If.App.na.Aa.hc)&&(Gb=If.App.na.Aa.hc);let Xb=-1,Xc=-1,zd=-1;const ve=!(sa&2);this.z6g&&ve&&(Xb=xe.SelectionEditor.v$k(Km.a.instance.Fa.Pa,Gb),Xc=Gb.yM.scrollLeft,zd=Gb.yM.scrollTop);const yf=this.Eh;this.aG=Q;this.mbm();this.mcf=this.Dcj(sa);ve&&this.JZm(Gb,Xb,Xc,zd,yf)}catch(Gb){db=!1,pa.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Gb)}return db}JZm(Q,sa,db,Gb,Xb){Q&&Q.isActive?
this.z6g?0<=sa&&100>=sa?Q.Xea.CDa(100-sa,!0,!0):Q.Xea.bBl(db,Gb,Xb,this.Eh):Q.Xea.CDa():pa.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}O3m(Q,sa,db){2===db&&(this.Ard(this.Mc?this.Mc.AW:0,"ZoomTo100"),this.Usa=0,this.Wia(1));return 32}iWi(Q){this.Usa=0;let sa,db=!0;if(this.sNj){if(!Object(Qb.a)(hn,Q))return pa.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;sa=Q.zoom/100;db=Q.qXj}else sa=Number.parseInvariant(String.format("{0}",
Q))/100;pa.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",sa);Q=0;db||(Q=2);this.Wia(sa,Q);return 32}zoomToPageWidth(Q,sa,db){if(1===db)return 32;pa.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");this.Usa=2;this.oBk();return this.mFf()}dXl(Q,sa,db,Gb,Xb){if(1===db)return 32;Q=Ta.a.dBa(this.N$c,6,M.AFrameworkApplication.numberFormat);Xb[op.a.labelText]=Q;return 32}k8h(){return this.f3m}l8h(){return this.g3m}oBk(){this.NQi||(If.App.na?(If.App.na.R$(Object(n.a)(this,
this.Fpg,"refitToPageWidth")),this.NQi=!0):pa.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}mFf(){var Q=If.App.na?If.App.na.Aa.hc:null;if(Q&&If.App.na.Gv){var sa=null;(Q=this.URk(Q))&&(sa=this.mW.FI(Q));sa||(sa=this.mW.hde());if(null!==sa)return sa=Bp.a.instance.du(sa),sa=Bm.a.eh(sa,0),Q=this.vRc(),sa+=Q&&Q.XBg()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,sa+=2*bt.a.CJd,this.Wia(If.App.na.Gv.offsetWidth/sa),32;pa.ULS.sendTraceTag(7185433,
353,10,"Zoom to page width: cannot find word section node.")}else pa.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}URk(Q){return Q&&Q.Xa&&Q.Xa.Fa.Pa&&Q.Xa.Fa.Pa.xa&&Q.Xa.Fa.Pa.xa.node?Q.Xa.Fa.Pa.xa.node:null}Fpg(){2===this.Usa&&this.mFf()}N_m(){this.Oz&&(this.qOj?(this.Oz.uM(zg.a.lhj),this.Oz.uM(zg.a.mhj)):this.Oz.uM(zg.a.nhj))}ILm(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var sa=Q.ctrlWheelOccurred;if("boolean"!==typeof sa)pa.ULS.sendTraceTag(594346948,
353,15,"ctrlWheelMetrics module not found");else{pa.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",sa);try{Q.stop()}catch(db){pa.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",db)}}}else pa.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Iz(){this.ILm(this.qqk);if(this.Ji){var Q=document.getElementById(vk.AppFrame.rbd);Q&&this.Ji.Ma(B.a.rAb,Q,Object(n.a)(this,this.pqk,"ctrlScrollZoomHandler"))}this.kb&&(Q=this.kb.gd(vk.AppFrame.MD),this.pOj&&(Q.bindAction(Mf.KeyInputManager.Db(fg.a.VFe,
Mf.KeyInputManager.Vh),mb.a.Mdb),Q.bindAction(Mf.KeyInputManager.Db(fg.a.OOg,Mf.KeyInputManager.Vh),mb.a.Mdb),Q.bindAction(Mf.KeyInputManager.Db(fg.a.WFe,Mf.KeyInputManager.Vh),mb.a.Fab),Q.bindAction(Mf.KeyInputManager.Db(fg.a.YFe,Mf.KeyInputManager.Vh),mb.a.Fab),Q.bindAction(Mf.KeyInputManager.Db(fg.a.jKd,Mf.KeyInputManager.Vh),vb.a.mIc)));this.Yd&&(this.Adf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Yd.Ma(B.a.click,this.Adf,Object(n.a)(this,this.e_l,"onZoomLabelClickEvent"));
this.Wxj&&(If.App.na.lk.registerLayoutBreakpointChanged("canvas",sa=>{this.Vjf(sa)}),If.App.na.lk.registerBoundingWindowRectsChanged("canvas",()=>{this.Vjf(If.App.na.lk.getLayoutBreakpoint())}))}Vjf(Q){let sa=!0,db="";if(3!==this.Usa)return sa;Na.Health.instance.recordKpiUsage(this.JTg,0,this.oOj,null);switch(Q){case "Small":8===this.mFf()&&(db=this.zuj,sa=!1);break;default:1===this.Eh||this.Wia(1)||(db=this.hNj,sa=!1)}sa||Na.Health.instance.recordKpiFailure(this.JTg,db,!0,!0,null);return sa}pqk(Q){if(Q.ctrlKey&&
(M.AFrameworkApplication.pa.processAction(kg.a.DJh,2),this.nOj)){Q=Q.G2m;if(!Q)return!1;this.Wia(this.Eh-Q);this.Ard(6,"CtrlScroll");return!0}return!1}e_l(){pa.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0}xqg(Q){this.vVj(Q)}Jrg(Q){this.Mkm(Q)}wqg(Q){this.uVj(Q)}Irg(Q){this.Lkm(Q)}gKi(){this.Jg.raiseEvent("PinchStart",null)}kog(){this.Jg.raiseEvent("PinchEnd",null)}}Object(c.a)(Om,"WordEditorZoomManager",jn,[1057,928]);class pp{constructor(){this.Z=
null}get name(){return"WordEditor.Zoom"}init(){if(M.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.Z.resolve("WordEditor.Zoom.WordEditorZoomActor"),sa=this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.pb();Sys.UI.DomElement.overrideGetBounds=!0;M.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&M.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&sa&&ed.a.get_instance().Pk(4,()=>{sa.Vjf(If.App.na.lk.getLayoutBreakpoint())||pa.ULS.sendTraceTag(578326819,
353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}Mb(Q){this.Z=Q;M.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.Z.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Om(M.AFrameworkApplication.K,M.AFrameworkApplication.pa,ym.WordSectionNavigator.instance,Po.a.instance,pc.FocusManager.instance(),Mn.a.instance,()=>Q.sa("Box4.IFloatingObjectUpdater"))).fa().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.Z.ia("WordEditor.Zoom.WordEditorZoomActor",
()=>new yj(M.AFrameworkApplication.pa,this.Z.resolve("WordEditor.Zoom.WordEditorZoomManager"),M.AFrameworkApplication.K)).fa())}static main(){fa.a.instance.kc(new pp)}}Object(c.a)(pp,"ZoomPackage",null,[1,2]);var ok=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},
children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},
children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",
Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},
{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},
{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",
Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",
attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",
Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",
Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},jr=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",
attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class Rp extends Kf.a{constructor(Q){super(!1,!1,!0);this.zKd=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.zKd.jUf}};this.Hh("",Object(n.a)(this,this.Hom,"resultHandler"),Q)}Hom(Q,sa){1===Q&&(this.zKd.jUf=sa.tooltipPersistenceEnabled)}}Object(c.a)(Rp,"AccessibilitySettingsDialog",
Kf.a,[]);class ct{constructor(Q,sa){this.ea=Q;this.zKd=sa}pb(){this.ea.ma(mb.a.GFm,Lc.a.frame,Object(n.a)(this,this.HFm,"showAccessibilitySettingsDialogHandler"))}HFm(){(new Rp(this.zKd)).start();return 32}}Object(c.a)(ct,"AccessibilitySettingsDialogActor",null,[1098]);const kr=Q=>{const sa=new t.a;M.AFrameworkApplication.je.Ki(qp(Q),1,null,null,!0,2,db=>{200===db.data.mf?sa.Ue("true"===db.data.wd.toLowerCase()):sa.Ue(!1)},()=>{sa.Ue(!1)},null,void 0,void 0,void 0,void 0,"7");return sa.task},qp=Q=>
String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",M.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,M.AFrameworkApplication.zk);class Eq{constructor(){this.ohc=null}get jUf(){return!!this.ohc}set jUf(Q){Q!==this.ohc&&(this.ohc=Q,Rf.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.fli()&&M.AFrameworkApplication.je.Ki(qp("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),null,!0,2,null,null,null,
void 0,void 0,void 0,void 0,"8"))}dEl(){const Q=new t.a;if(this.ohc)Q.Ue(this.ohc);else if(this.fli()){const sa=kr("getHoverableRibbonTooltipIsEnabled");sa.continueWith(()=>{this.ohc=sa.result;Rf.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(sa.result);Q.Ue(sa.result)},8)}else Q.Ue(!1)}fli(){const Q=M.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),sa=M.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!sa}}Object(c.a)(Eq,"AccessibilitySettingsInfo",
null,[1097]);class Wh{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}Mb(Q){this.Z=Q;Wh.Eje()&&(this.Z.register(ct,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").hd(()=>new ct(M.AFrameworkApplication.pa,this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).fa(),this.Z.register(Eq,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").hd(()=>
new Eq).fa())}init(){Wh.Eje()&&(this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").pb(),this.Z.resolve("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").dEl())}dispose(){}static main(){fa.a.instance.kc(new Wh)}static Eje(){Wh.wWe||(Wh.wWe=M.AFrameworkApplication.K?M.AFrameworkApplication.K.$("AccessibilitySettingsDialogIsEnabled")&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AccessibilitySettingsDialogIsEnabled",!1):
!1);return Wh.wWe}}Wh.wWe=null;Object(c.a)(Wh,"AccessibilitySettingsPackage",null,[1,2]);class xo{constructor(){this.events=[];this.Ptg=!1}static c4f(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!xo.fBl[Q.key]}static h5j(Q){return{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:xo.c4f(Q)?Q.key:" "===Q.key?"Space":"CharacterKey",["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static yki(Q){return window.performance&&
window.performance.now&&Q.timeStamp<performance.now()}static aRh(Q){return!!Q&&xo.yki(Q)&&xo.c4f(Q)}static bRh(Q){return!!Q&&xo.yki(Q)&&!xo.c4f(Q)}keyPressedEventHandlerStart(Q){xo.bRh(Q)&&this.A3i(Q)}keyPressedEventHandlerEnd(Q){xo.bRh(Q)&&this.R3i(Q)}keyDownEventHandlerStart(Q){xo.aRh(Q)&&this.A3i(Q)}keyDownEventHandlerEnd(Q){xo.aRh(Q)&&this.R3i(Q)}A3i(Q){this.events.push({["metadata"]:xo.h5j(Q),["timeStamp"]:Q.timeStamp,["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:performance.now()-Q.timeStamp,
["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0});this.ahm()}R3i(Q){if(0!==this.events.length)for(let sa=this.events.length-1;0<=sa;--sa){const db=this.events[sa];if(db.timeStamp===Q.timeStamp){db.timeToHandlerFinishMs=performance.now()-Q.timeStamp;db.eventDurationMs=db.timeToHandlerFinishMs-db.timeToHandlerStartMs;break}}}ahm(){if(!this.Ptg){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.Ptg=
!1;const sa=performance.now();this.events.forEach(Gb=>{Gb.timeToRequestAnimationFrameMs=sa-Gb.timeStamp});var db=document.createEvent("CustomEvent");db.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(db);this.events=[];db=document.createEvent("CustomEvent");db.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(db)});this.Ptg=!0}}}xo.fBl={R3m:!0,S3m:!0,T3m:!0,U3m:!0,V3m:!0,Delete:!0,End:!0,g4m:!0,j4m:!0,m4m:!0,y4m:!0,z4m:!0,Tab:!0};class Sp{constructor(){this.Zwe=
this.agb=this.$le=this.Pxc=null;this.Gwc=!1;this.ytg=null;this.Ded=[];this.aNg=()=>{Sp.wvl()&&null==this.agb?(this.$le=null,this.agb=requestAnimationFrame(this.pui)):null!=this.agb&&(cancelAnimationFrame(this.agb),this.agb=null)};this.pui=Q=>{if(null!=this.$le){const sa=Q-this.$le;if(null==this.Pxc||this.Pxc<sa)this.Pxc=sa;for(let db=0;db<Sp.cyd.length;++db)if(sa<Sp.cyd[db]){++this.Ded[db];break}}this.$le=Q;this.agb=requestAnimationFrame(this.pui)};this.PPi=()=>{if(null!=this.Pxc){var Q={};for(var sa=
0;sa<Sp.cyd.length;++sa)Q[Sp.cyd[sa]]=this.Ded[sa],this.Ded[sa]=0;sa=performance.now();Q={["intervalStart"]:this.ytg,["intervalEnd"]:sa,["maxFrameLengthMs"]:this.Pxc,["frameData"]:Q};var db=document.createEvent("CustomEvent");db.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(db);this.Pxc=null;this.ytg=sa}}}static Svl(){return!!window.performance&&!!window.performance.now}start(Q){!this.Gwc&&Sp.Svl()&&(this.OBm(),this.Zwe=setInterval(this.PPi,1E3*Q),this.ytg=performance.now(),this.aNg(),
document.addEventListener("visibilitychange",this.aNg),this.Gwc=!0)}stop(){this.Gwc&&(document.removeEventListener("visibilitychange",this.aNg),null!=this.Zwe&&(clearInterval(this.Zwe),this.Zwe=null),null!=this.agb&&(cancelAnimationFrame(this.agb),this.agb=null),this.PPi(),this.Gwc=!1)}get God(){return this.Gwc}OBm(){this.Ded=[];for(let Q=0;Q<Sp.cyd.length;++Q)this.Ded.push(0)}}Sp.wvl=()=>"visible"===document.visibilityState;Sp.cyd=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];
Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");
Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");fa.a.instance.kc(new xc);
Ze.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");f;Type.registerNamespace("CACPU");Ja.main();Type.registerNamespace("CAEventTimingMeter");L.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");xa.main();Type.registerNamespace("Common.App.GestureInput");cb.main();Type.registerNamespace("Common.App.GestureManager");nb.main();Type.registerNamespace("Common.ModernFontPicker");Type.registerNamespace("Common.App.OfflineLogger");
fa.a.instance.kc(new hc);Type.registerNamespace("Common.App.O365Shell");Jb.main();Type.registerNamespace("Common.App.SensitiveLogging");cd.main();Type.registerNamespace("Common.App.Rename");fa.a.instance.kc(new fj,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");fa.a.instance.kc(new ke);Type.registerNamespace("Common.App.SaveAsToHost");se.main();Type.registerNamespace("Common.App.SaveToCloudStorage");rj.main();Type.registerNamespace("Common.App.SaveACopy");td.main();Type.registerNamespace("Common.App.SaveToSharePoint");
Lj.main();Type.registerNamespace("Common.App.SharedFilePicker");jl.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Dj.main();Ji;Ap.main();fa.a.instance.kc(new fn);Nk.main();ok;jp.main();fa.a.instance.kc(new fo);Pq.main();gd.a.prototype.toString=id.a.prototype.toString;Kd.a.i9h=new vh.a;fa.a.instance.kc(new gq);pp.main();
fa.a.instance.kc(new Ll);fa.a.instance.kc(new Bq);fa.a.instance.kc(new Rq);mk.main();po.main();qo.main();tc.main();Type.registerNamespace("NLRT");fa.a.instance.kc(new Cn);Type.registerNamespace("Common.App.AccessibilitySettings");Wh.main();jr;jo.main();fa.a.instance.kc(new Sq);window.EventTiming={EventTimingMeter:xo,FrameTimingMeter:Sp}},912:function(D,P,b){D=b(0);var f=b(42),c=b(134),n=b(7),m=b(50),w=b(22),z=b(16),v=b(13);class t{static get RQg(){return t.SQg}}t.SQg="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";
Object(D.a)(t,"ZoomDialogHtml",null,[]);b.d(P,"a",function(){return A});class A extends c.a{constructor(B,S,C,H,J=!1){super(!1,!1,J);this.gJa=this.fJa=this.Z=this.M2a=null;this.MQg="ZoomDialogBoxGroup";this.k6=B;this.f9a=S;this.d3c=C;this.kb=H;this.Bf=this.ylf();this.Dc=1;this.xf="ZoomDialog"}get M8b(){return"ListRadioBox"}get n0a(){return"radiobox"}get Yue(){return"WACZoomDialogRadioRow"}get FBc(){return"WACZoomDialogRadioRow-highlight"}get jh(){return this.kb}get O1(){return this.M2a}TEc(B,S){if(this.aT)this.jEg(B,
S);else{const C={};for(let H=0;H<this.k6.length;H++)C[this.n0a+H]=this.f9a[H]===S?!0:!1;this.Hh(B,Object(f.a)(this,this.OQg,"zoomDialogHandler"),C);this.fwa();this.Lyd()}}jEg(B,S){var C=Array(this.k6.length);let H="";for(let J=0;J<this.k6.length;J++){const M=J.toString();C[J]={["key"]:M,["text"]:this.k6[J]};S===this.f9a[J]&&(H=M)}S={};S.dialogChoiceGroupProps={["id"]:this.MQg,["defaultSelectedKey"]:H,["options"]:C};C={["id"]:"OptionsDialog",["bodyControls"]:S};this.Hh(B,Object(f.a)(this,this.TQg,
"zoomDialogReactHandler"),C)}gUi(){this.M2a=document.getElementsByName(this.M8b)[0];this.Qbb(this.O1)}Wea(){this.Z||(this.Z=document.getElementById("WACDialogText"));this.Z&&(this.fJa||(this.fJa=Object(f.a)(this,this.NQg,"zoomDialogClickHandler"),this.Ho.Ma(n.a.click,this.Z,this.fJa)),this.gJa||(this.gJa=Object(f.a)(this,this.PQg,"zoomDialogKeyDownHandler"),this.qd.Ma(n.a.vh,this.Z,this.gJa)));super.Wea();this.Ac&&this.qd.Ma(n.a.wh,this.Ac,Object(f.a)(this,this.QN,"dialogDefaultEnterKeyHandler"))}fwa(){this.jh.$j().scope.sq(m.FocusManager.instance().jN);
this.jh.$j().scope.sq(m.FocusManager.instance().kN);this.jh.$j().scope.bindAction(m.FocusManager.instance().jN,v.a.kIc);this.jh.$j().scope.bindAction(m.FocusManager.instance().kN,v.a.jIc)}Lyd(){const B=document.getElementsByName(this.M8b);for(let S=0;S<B.length;S++){const C=B[S];w.a.addHandler(C,n.a.focus,Object(f.a)(this,this.EBc,"radioButtonFocusHandler"));C.checked&&(this.M2a=C)}}OQg(B,S){if(1===B)for(B=0;B<this.k6.length;B++)if(S[this.n0a+B]){this.d3c(this.f9a[B]);break}}EBc(B){this.Qbb(B.target)}NQg(B){B=
B.me;if(!B||!B.parentNode||"label"!==B.tagName.toLowerCase()&&!B.className.startsWith(this.Yue))return!1;B=this.Qgd(B);B=document.getElementById(this.n0a+B);this.Qbb(B);return!0}TQg(B,S){1===B&&(B=Number.parseInvariant(S.selectedOption.toString()),this.d3c(this.f9a[B]))}PQg(B){B=B.$a.keyCode;if(B!==Sys.UI.Key.down&&B!==Sys.UI.Key.right&&B!==Sys.UI.Key.up&&B!==Sys.UI.Key.left)return!1;let S=this.Qgd(this.O1);const C=this.k6.length-1;if(B===Sys.UI.Key.down||B===Sys.UI.Key.right)S=S<C?S+1:0;else if(B===
Sys.UI.Key.up||B===Sys.UI.Key.left)S=0<S?S-1:C;B=document.getElementById(this.n0a+S);this.Qbb(B);return!0}QN(B){return B.eventName===n.a.wh&&B.$a.keyCode===Sys.UI.Key.enter?(super.QN(B),!0):!1}Qbb(B){B&&(B.checked=!0,this.jh.Ef&&this.jh.Ef.name===this.tI||this.jh.uf(this.tI),this.jh.$j().Bi.tw(B),B.focus(),this.O1&&Sys.UI.DomElement.removeCssClass(this.O1.parentNode,this.FBc),Sys.UI.DomElement.addCssClass(B.parentNode,this.FBc),this.M2a=B)}Qgd(B){return Number.parseInvariant(z.a.substr(B.id,B.id.length-
1,1))}VO(){super.VO();const B=document.getElementById(this.$g("WACDialogPanel"));B.style.minWidth=String.format("{0}px",200);B.style.width=String.format("{0}px",200)}ylf(){let B="";for(let S=0;S<this.k6.length;S++)B+=c.a.ty(A.QQg,S.toString(),this.k6[S],this.M8b);return B}dispose(){this.Z&&(this.Ho&&this.fJa&&this.Ho.Gb(n.a.click,this.Z,this.fJa),this.qd&&this.gJa&&this.qd.Gb(n.a.vh,this.Z,this.gJa));this.Ho&&this.Ac&&this.qd.Gb(n.a.wh,this.Ac,Object(f.a)(this,this.QN,"dialogDefaultEnterKeyHandler"));
super.dispose()}}A.QQg=t.RQg;Object(D.a)(A,"ZoomDialog",c.a,[76])}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/d7544f9f92a4288740dc16921be5508a3fcb21f4/WordEditorDS.box4.dll2.js.map