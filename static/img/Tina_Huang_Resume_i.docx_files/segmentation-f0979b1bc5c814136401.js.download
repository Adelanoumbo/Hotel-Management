(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4780],{46576:function(e,t,n){"use strict";n.d(t,{mw:function(){return g},Vk:function(){return m}});var r=n(809),o=n.n(r),c=n(92447),i=n(27261),u=n(71439),a=n(46829),s=n(36623),f=n(61792),p=n(65455),l=n(62452),v=n(276),d=n(67294),h=n(12510);function O(){var e=(0,i.Z)(["\n  query GET_COUNTRY_CHANGE_ALLOWED {\n    user {\n      id\n      countryChangeAllowed\n    }\n  }\n"]);return O=function(){return e},e}var g="GET_COUNTRY_CHANGE_ALLOWED",b=(0,u.gql)(O());function y(e,t){return _.apply(this,arguments)}function _(){return(_=(0,c.Z)(o().mark((function e(t,n){var r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,e.prev=1,!n){e.next=7;break}return e.next=5,t.query({query:b,context:{headers:{Authorization:"Bearer ".concat(n)}},fetchPolicy:"no-cache"});case 5:c=e.sent,r=c.data.user.countryChangeAllowed;case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var m=function(){var e=(0,v.useDispatch)(),t=(0,l.KW)(),n=(0,h.useStore)().getState(),r=(0,f.PQ)(n),i=(0,p.mT)(n),u=(0,f.et)(n).countryCode,O=(0,f.hP)(n),g=(0,s.qr)(n),b=(0,a.useApolloClient)();(0,d.useEffect)((function(){function n(){return(n=(0,c.Z)(o().mark((function n(){var r,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!0,c=u&&u!==i,n.t0=!g,!n.t0){n.next=7;break}return n.next=6,y(b,O);case 6:n.t0=n.sent;case 7:r=n.t0,c&&!r&&t(u),e((0,f.oY)(r));case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}r&&function(){n.apply(this,arguments)}()}),[])}},47130:function(e,t,n){"use strict";n.d(t,{Z:function(){return v},G:function(){return d}});var r=n(64679),o=n.n(r),c=n(8777),i=n.n(c),u=n(87835),a=n(19291),s=n(49675),f=n(34155),p={keepAlive:!0,timeout:s.L.SOCKET_TIMEOUT};f.env.APP_ENV===u.T.LOCAL&&(p.rejectUnauthorized=!1);var l=(0,a.Lf)()?void 0:new(i().Agent)(p);function v(){return l}function d(){return new(o().Agent)(p)}},58886:function(e,t,n){"use strict";n.d(t,{C:function(){return s}});var r=n(809),o=n.n(r),c=n(92447),i=n(61792),u=n(75295),a=n(19291);function s(e,t){return f.apply(this,arguments)}function f(){return(f=(0,c.Z)(o().mark((function e(t,n){var r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,i.PQ)(t)){e.next=5;break}r=(0,i.hP)(t),e.next=9;break;case 5:if((0,a.Lf)()){e.next=9;break}return e.next=8,(0,u.Y)({},n);case 8:r=e.sent;case 9:return c=r?{headers:{authorization:"Bearer ".concat(r)}}:{},e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},39929:function(e,t,n){"use strict";n.r(t);var r=n(809),o=n.n(r),c=n(26265),i=n(92447),u=n(67294),a=n(37244),s=n.n(a),f=n(43125),p=n(65455),l=n(49644),v=n(58886),d=n(96029),h=n(61792),O=n(57332),g=n(46576),b=n(40102),y=n(5764),_=u.createElement;function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=function(){return(0,g.Vk)(),_(f.vI,null)};w.getInitialProps=function(){var e=(0,i.Z)(o().mark((function e(t){var n,r,i,u,a,g,b,_,m,w,T,P,k,I,j,x,C,S,A,D,N,Z,L;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b=t.apolloClient,_=t.features,m=t.res,w=t.store,T=w.getState(),P=(0,p.mT)(T),k=(0,p.n$)(T),I=(0,d.vl)(T)[s().app.PA_CODE.name],j=(0,d.vl)(T)[s().app.OFFER_TYPE.name],x=null===(n=(0,h.et)(T))||void 0===n?void 0:n.userId,C=(0,d.vl)(T)[s().app.CLIENT_ID.name],S=(0,d.vl)(T)[s().app.SVAR.name],e.next=11,(0,v.C)(T,t.logger);case 11:if(A=e.sent,null===m||void 0===m||!m.writableEnded){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,b.query({query:f.j_,variables:(0,f.WC)(P,I,k,j,x,C,S),context:E({},A)});case 16:if(D=e.sent,T=w.getState(),null!==(N=null===D||void 0===D||null===(r=D.data)||void 0===r||null===(i=r.segmentationOffers)||void 0===i||null===(u=i.result[0])||void 0===u?void 0:u.offers)&&void 0!==N&&N.length){e.next=21;break}throw(0,l.n)();case 21:return Z=null===(a=N[0])||void 0===a||null===(g=a.offer)||void 0===g?void 0:g.id,L=E(E({},(0,d.vl)(T)),{},(0,c.Z)({},s().app.ITEMS.name,[{id:Z}])),(0,y.OK)(t,O.Z.SEGMENTATION,{features:_,newQueryParams:L}),e.abrupt("return",{segmentationOfferId:Z});case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=(0,b.O)(f.vI.queryCollection,O.Z.SEGMENTATION)(w)},75295:function(e,t,n){"use strict";n.d(t,{Y:function(){return v}});var r=n(809),o=n.n(r),c=n(92447),i=n(69973);function u(){return{expiry:Number.MAX_SAFE_INTEGER,tokenPromise:null}}var a=u();function s(e,t){return i.Z.getImsServiceToken(e,t)}function f(){return!a.tokenPromise||Date.now()>a.expiry}function p(e){return Date.now()+1e3*e.expires_in/1.2}function l(){a=u()}function v(){return d.apply(this,arguments)}function d(){return(d=(0,c.Z)(o().mark((function e(){var t,n,r,c,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1?i[1]:void 0,e.prev=2,!f()){e.next=12;break}return a.expiry=Number.MAX_SAFE_INTEGER,a.tokenPromise=s(t,n),e.next=8,a.tokenPromise;case 8:r=e.sent,a.expiry=p(r),e.next=15;break;case 12:return e.next=14,a.tokenPromise;case 14:r=e.sent;case 15:c=r.access_token,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),l();case 21:return e.abrupt("return",c);case 22:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}},69973:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(809),o=n.n(r),c=n(92447),i=n(26265),u=n(49675),a=n(41681),s=n(97803),f=n(24817),p=n(34155);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){return(0,f.Z0)(e)?p.env.IMS_CLT_APP_SECRET:p.env.IMS_CLT_SECRET}function h(e){return v(v({},(0,a.ft)(e)),{},{secret:d(e)})}function O(){return{domain:(0,a.Fy)(),clientId:s.$.UNIFIED_CHECKOUT_SERVER,secret:p.env.IMS_SVR_SECRET,authCode:p.env.IMS_SVR_AUTH_CODE}}var g=n(47130),b=n(10975),y=n(80129);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,g.Z)();var w=function(){var e={request:function(e,t){return[e,m({agent:E,compress:!0},t)]},response:function(e){if(+(null===e||void 0===e?void 0:e.status)>=300)throw e;return e}},t=(0,u.Z)(e),n=function(){var e=(0,c.Z)(o().mark((function e(t,n){var c,i,u,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.length>2&&void 0!==a[2]?a[2]:{},i=a.length>3?a[3]:void 0,(u=m({},h(n))).authCode=t,e.abrupt("return",r(u,c,i));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r=function(){var e=(0,c.Z)(o().mark((function e(n){var r,c,i,u=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},c=u.length>2?u[2]:void 0,i={grant_type:"authorization_code",code:n.authCode,client_id:n.clientId,client_secret:n.secret},e.next=5,t.post("".concat(n.domain,"/ims/token/v2?").concat((0,y.stringify)(i)),{headers:m({},r),logger:c});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return m(m({},t),{},{getImsHealthCheck:function(e){var n=O();return t.get("".concat(n.domain,"/ims/healthcheck"),{headers:(0,i.Z)({},b.A.name.X_IMS_CLIENTID,n.clientId),timeout:u.L.IMS_HEALTH_CHECK_TIMEOUT,logger:e})},getImsProfileAndToken:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,c=h(n);return t.post("".concat(c.domain,"/ims/token/v3"),{body:(0,y.stringify)({grant_type:"aux_sid_exchange",client_id:c.clientId,client_secret:c.secret,aux_sid:e,scope:c.scopes,project_user_profile:!0}),headers:m({"Content-Type":"application/x-www-form-urlencoded"},r),timeout:u.L.SHORT_HTTP_TIMEOUT,logger:o})},getImsAccessToken:n,getImsProfileAndTokenFromImplicitJumpToken:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4?arguments[4]:void 0,i=h(r),a={client_id:i.clientId};return t.get("".concat(i.domain,"/ims/jump/implicit/").concat(e,"?").concat((0,y.stringify)(a)),{headers:m({Authorization:"Bearer ".concat(n)},o),timeout:u.L.SHORT_HTTP_TIMEOUT,logger:c},{includeHeaders:!0})},getImsServiceToken:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=O();return r(n,e,t)}})}()},17775:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/segmentation",function(){return n(39929)}])},64679:function(){},8777:function(){}},function(e){e.O(0,[9774,7949,532,5582,809,5184,3433,8880,8994,3022,1586,2101,8726,2172,2637,2449,9652,898,9174,5110,3728,5454,2482,2956,8371,3125],(function(){return t=17775,e(e.s=t);var t}));var t=e.O();_N_E=t}]);