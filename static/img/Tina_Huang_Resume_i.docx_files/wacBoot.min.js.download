var wacBoot=function(t){var n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(n){return t[n]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=10)}([function(t,n,e){"use strict";e.r(n);var i=window.__foldables_env_vars__,r=function(t,n,e,i,r){void 0===r&&(r=!1),this.left=t,this.right=t+e,this.top=n,this.bottom=n+i,this.x=t,this.y=n,this.width=e,this.height=i,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=r};function o(){!function(){if("function"==typeof window.CustomEvent)return;window.CustomEvent=function(t,n){var e=n||{bubbles:!1,cancelable:!1,detail:null},i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}}(),function(){if("function"==typeof window.DOMRect)return;window.DOMRect=function(t){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}}(),function(){if("object"==typeof window.onBoundingWindowRectsChange)return;window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",a)}(),function(){if("function"==typeof window.getWindowSegments)return;window.getWindowSegments=function(){var t=window.innerWidth,n=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&n>=1300&&964===t)return i&&i.update({spanning:"single-fold-horizontal"}),[new r(0,0,t,n/2),new r(0,n/2,t,n/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&n>=820&&1440===t)return i&&i.update({spanning:"single-fold-vertical"}),[new r(0,0,t/2,n),new r(t/2,0,t/2,n)];i&&i.update({spanning:"none"})}}catch(t){}return[new r(0,0,t,n)]}}()}function a(){window.dispatchEvent(window.onBoundingWindowRectsChange)}function s(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var n=Object(this),e=n.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<e;){var o=n[r];if(t.call(i,o,r,n))return o;r+=1}},configurable:!0,writable:!0})}function u(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,n){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i+=1){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},writable:!0,configurable:!0})}var c={},l={},d={},f={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}},h=[],v=void 0,p=-1,m="Undefined",b="Default",w=!1;function g(){var t;return null===(t=null===window||void 0===window?void 0:window.matchMedia)||void 0===t?void 0:t.call(window,"(prefers-reduced-motion: reduce)").matches}function S(){return"DP"===B()}function C(){return"DL"===B()}function R(t){return k(t,0)}function k(t,n){if(t&&h&&!(h.length<=0)){if(1===h.length)return y(h[0],n);var e;if("string"==typeof t){var i=document.querySelector(t);if(!i)return;e=i.getBoundingClientRect()}else if(void 0!==t.preventDefault){var o=t;e=new r(o.clientX,o.clientY,1,1)}else if(t.getBoundingClientRect)e=t.getBoundingClientRect();else if(t){var a=t;e=new r(a.x,a.y,1,1)}else{if(!t.current)return;e=t.current.getBoundingClientRect()}var s=P(e);return s&&y(s,n)}}function x(t,n){return k(t,8)}function y(t,n){return u(),t&&Object.assign({},t,{top:t.top+n,left:t.left+n,right:t.right-n,bottom:t.bottom-n,width:t.width-2*n,height:t.height-2*n})}function P(t){return I(t)?h[0]:(s(),h.find((function(n){return O(t,n)})))}function O(t,n){return t.left>=n.left&&t.top>=n.top&&t.right<=n.left+n.width&&t.bottom<=n.top+n.height}function A(t){return void 0!==t&&("DL"===B()||"DP"===B())&&I(t.getBoundingClientRect())}function I(t){return!(h.length<=1)&&(t.right>h[0].left+h[0].width?t.left<h[1].left:t.bottom>h[0].top+h[0].height&&t.top<h[1].top)}function W(t,n){if(h.length<=1)return-1;if(n){if(t.left<h[1].left)return t.right-h[0].right;if(t.top<h[1].top)return t.bottom-h[0].bottom}else{if(t.right>h[0].left+h[0].width)return h[1].left-t.left;if(t.bottom>h[0].top+h[0].height)return h[1].top-t.top}return-1}function E(t,n){c[t]=n}function L(t){void 0!==c[t]&&delete c[t]}function F(t,n){l[t]=n}function N(t){void 0!==l[t]&&delete l[t]}function D(t,n){d[t]=n}function T(t){void 0!==d[t]&&delete d[t]}function M(){window.getWindowSegments||o();var t=window.getWindowSegments(),n=!1;if(t.length!==h.length&&(n=!0),1===(h=t).length){var e=h[0];m=e.width>e.height?"Landscape":"Portrait"}else h.length<=1||h[0].top!==h[1].top?h.length<=1||h[0].left!==h[1].left||(n=n||"DP"===m,m="DL"):(n=n||"DL"===m,m="DP");var i=b;"Landscape"===m||"DL"===m?b=h[0].width<=960?"Small":"Large":"Portrait"!==m&&"DP"!==m||(b=h[0].width<=720?"Small":"Large"),function(){var t=h;for(var n in v&&t.push(v),l)l[n](t,m)}(),n&&function(t){for(var n in c)c[n](t,m)}("DL"===m||"DP"===m),i!==b&&function(){for(var t in d)d[t](b)}()}function B(){if("Undefined"===m){var t=window.getWindowSegments?window.getWindowSegments():void 0;return!t||t.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return m}function V(){return b}function j(){return v}function _(){return h}function H(){w||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",U)),o(),window.addEventListener("onBoundingWindowRectsChange",M),h&&0!==h.length||M(),w=!0)}function U(t){var n=t.boundingRect,e=n.width,i=n.height,r=n.left;0===e||0===i?(v=void 0,p=-1):((v=t.boundingRect).isOccluded=!0,p=r>0||"DL"===B()?1:0),M()}function q(){if(v)return h[p]}H(),e.d(n,"WindowSegment",(function(){return r})),e.d(n,"ensureWindowsAPIs",(function(){return o})),e.d(n,"arrayFindPolyfill",(function(){return s})),e.d(n,"objectAssignPolyfill",(function(){return u})),e.d(n,"LayoutBreakpointSizes",(function(){return f})),e.d(n,"isReducedAnimations",(function(){return g})),e.d(n,"isDPMode",(function(){return S})),e.d(n,"isDLMode",(function(){return C})),e.d(n,"getBoundingWindow",(function(){return R})),e.d(n,"getBoundingWindowWithPadding",(function(){return k})),e.d(n,"getBoundingWindowWithPaddingFabric",(function(){return x})),e.d(n,"getBoundingRect",(function(){return P})),e.d(n,"isRectWithin",(function(){return O})),e.d(n,"isElementSpanning",(function(){return A})),e.d(n,"isRectSpanning",(function(){return I})),e.d(n,"getRectSpanningOffset",(function(){return W})),e.d(n,"registerSpanningChanged",(function(){return E})),e.d(n,"unregisterSpanningChanged",(function(){return L})),e.d(n,"registerBoundingWindowRectsChanged",(function(){return F})),e.d(n,"unregisterBoundingWindowRectsChanged",(function(){return N})),e.d(n,"registerLayoutBreakpointChanged",(function(){return D})),e.d(n,"unregisterLayoutBreakpointChanged",(function(){return T})),e.d(n,"onWindowRectsChange",(function(){return M})),e.d(n,"getWindowMode",(function(){return B})),e.d(n,"getLayoutBreakpoint",(function(){return V})),e.d(n,"getKeyboardSegment",(function(){return j})),e.d(n,"getWindowRectsWithoutKeyboard",(function(){return _})),e.d(n,"initializeBaseWindowUtil",(function(){return H})),e.d(n,"getWindowRectForKeyboardSegment",(function(){return q}))},,,,,,function(t,n,e){"use strict";e.r(n);var i=function(){function t(t){this.regionComposerRootClassName="regionComposerRoot",this.regionElements={},this.positioningElements={Top:void 0,Left:void 0,Right:void 0,Bottom:void 0},this.positionCounts={Top:0,Left:0,Right:0,Bottom:0};var n=t.container,e=t.styleSheet;(this.containerElement=n,this.styleSheet=e,void 0===this.styleSheet.ownerRule&&0===this.styleSheet.cssRules.length&&this.styleSheet.parentStyleSheet&&!this.styleSheet.parentStyleSheet.parentStyleSheet&&1===this.styleSheet.parentStyleSheet.cssRules.length)?((this.styleSheet.parentStyleSheet||this.styleSheet).insertRule("."+this.regionComposerRootClassName+"{display: grid; position: absolute; width: 100%; height: 100%; z-index: 1;}",0),this.containerElement&&(this.dockPanel=document.createElement("div"),this.dockPanel.classList.add(this.regionComposerRootClassName),this.addPositioningElements(this.dockPanel),this.containerElement.appendChild(this.dockPanel))):this.containerElement&&(this.dockPanel=this.containerElement,this.getPositioningElements(this.dockPanel));this.styleSheet.insertRule("."+this.regionComposerRootClassName+"{}",0),this.regionComposerRootStyle=this.styleSheet.cssRules[0]}return t.prototype.dispose=function(){this.positionCounts={Top:0,Left:0,Right:0,Bottom:0},this.regionElements={},this.containerElement&&this.dockPanel&&this.containerElement.removeChild(this.dockPanel),this.dockPanel=void 0,this.containerElement=void 0},t.prototype.addRegion=function(t){if(this.dockPanel){var n,e=this.styleSheet.insertRule("."+t.id+"{display:block;}",this.styleSheet.cssRules.length),i=this.regionElements[t.id];this.containerElement&&((i=i||this.containerElement.querySelector("."+t.id))?n=i:(n=document.createElement("div")).classList.add(t.id));var r=this.getGridArea(t.position,!1);return this.updateTemplate(t.position),void 0!==this.lastChildIndex&&this.lastChildOriginalGridArea&&(this.styleSheet.cssRules[this.lastChildIndex].style.gridArea=this.lastChildOriginalGridArea),this.lastChildOriginalGridArea=r,r=this.getGridArea(t.position,!0),this.styleSheet.cssRules[e].style.gridArea=r,n&&!i&&(this.appendRegion(t.position,n),this.regionElements[t.id]=n),this.lastChildIndex=e,this.positionCounts[t.position]=this.positionCounts[t.position]+1,n}},t.prototype.updateTemplate=function(t){if(this.dockPanel)switch(t){case"Top":var n="repeat("+(this.positionCounts.Top+1)+", min-content) 1fr repeat("+Math.max(1,this.positionCounts.Bottom)+", min-content)";return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=n:this.styleSheet.insertRule("."+this.regionComposerRootClassName+"{grid-template-rows: "+n,this.styleSheet.cssRules.length));case"Left":n="repeat("+(this.positionCounts.Left+1)+", min-content) 1fr repeat("+Math.max(1,this.positionCounts.Right)+", min-content)";return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=n:this.styleSheet.insertRule("."+this.regionComposerRootClassName+"{grid-template-columns: "+n,this.styleSheet.cssRules.length));case"Right":n="repeat("+Math.max(1,this.positionCounts.Left)+", min-content) 1fr repeat("+(this.positionCounts.Right+1)+", min-content)";return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=n:this.styleSheet.insertRule("."+this.regionComposerRootClassName+"{grid-template-columns: "+n,this.styleSheet.cssRules.length));case"Bottom":n="repeat("+Math.max(1,this.positionCounts.Top)+", min-content) 1fr repeat("+(this.positionCounts.Bottom+1)+", min-content)";return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=n:this.styleSheet.insertRule("."+this.regionComposerRootClassName+"{grid-template-rows: "+n,this.styleSheet.cssRules.length))}},t.prototype.addPositioningElements=function(t){var n=this;Object.keys(this.positioningElements).forEach((function(e){var i=document.createElement("div");i.style.setProperty("display","none"),i.id=e,n.positioningElements[e]=i,t.appendChild(i)}))},t.prototype.getPositioningElements=function(t){var n=this;Object.keys(this.positioningElements).forEach((function(e){var i=t.querySelector("#"+e);i&&(n.positioningElements[e]=i)}))},t.prototype.appendRegion=function(t,n){var e=this.positioningElements[t];if(e){var i=e.parentNode;i&&!i.contains(n)&&(i.insertBefore(n,e.nextSibling),"Top"!==t&&"Left"!==t||(this.positioningElements[t]=n))}},t.prototype.getGridArea=function(t,n){if(!this.dockPanel)return"";switch(t){case"Top":return" "+(this.positionCounts.Top+1)+" / "+(this.positionCounts.Left+1)+" / "+(n?-1*(this.positionCounts.Bottom+1):this.positionCounts.Top+2)+" / "+-1*(this.positionCounts.Right+1);case"Left":return" "+(this.positionCounts.Top+1)+" / "+(this.positionCounts.Left+1)+" / "+-1*(this.positionCounts.Bottom+1)+" / "+(n?-1*(this.positionCounts.Right+1):this.positionCounts.Left+2);case"Right":return this.positionCounts.Top+1+" / "+-1*(this.positionCounts.Right+1)+" / "+-1*(this.positionCounts.Bottom+1)+" / "+(n?this.positionCounts.Left+1:-1*(this.positionCounts.Right+2));case"Bottom":return" "+-1*(this.positionCounts.Bottom+1)+" / "+(this.positionCounts.Left+1)+" / "+(n?this.positionCounts.Top+1:-1*(this.positionCounts.Bottom+2))+" / "+-1*(this.positionCounts.Right+1)}},Object.defineProperty(t.prototype,"dockPanelRootElement",{get:function(){return this.dockPanel},enumerable:!1,configurable:!0}),t}(),r=e(0),o=function(){function t(t){var n=this;this.layoutRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.accountForKeyboardRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.regionContainers={},this.unsupportedRules=[],this.setOffsetForActiveAccountForKeyboardRegions=function(t){var e=t?void 0:n.getWindowRectForKeyboardSegment(),i="Undefined"===n.windowMode?"Landscape":n.windowMode,r=n.getAffectedAccountForKeyboardRegions(e,i,n.layoutBreakpoint);if(r){var o=e?e.top+e.height:0;r.forEach((function(e){if(t)e.style.marginBottom="0px";else{var i=e.getBoundingClientRect(),r=Math.max(0,n.keyboardSegment.height-(o-i.bottom));e.style.marginBottom=r+"px"}}))}},this.boundingWindowRectsChanged=function(t,e){var i=t.find((function(t){return!!t.isOccluded})),r=n.windowMode!==e||n.keyboardSegment!==i;n.setOffsetForActiveAccountForKeyboardRegions(!0),n.windowMode=e,n.keyboardSegment=i,n.render(r)},this.layoutBreakpointChanged=function(t){n.layoutBreakpoint=t,n.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(n.keyboardSegment)return Object(r.getBoundingRect)(n.keyboardSegment)},this.props=t,this.windowMode=Object(r.getWindowMode)(),this.layoutBreakpoint=Object(r.getLayoutBreakpoint)(),this.keyboardSegment=Object(r.getKeyboardSegment)(),this.styleSheet=this.createStyleSheet(),this.createRegions(),Object(r.arrayFindPolyfill)(),Object(r.objectAssignPolyfill)(),Object(r.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(r.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render()}return t.prototype.render=function(t){var n=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){n.setOffsetForActiveAccountForKeyboardRegions(),f()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),f()))},t.prototype.dispose=function(){var t=this;Object.keys(this.layoutRegions).forEach((function(n){Object.keys(t.layoutRegions[n]).forEach((function(e){var i=t.layoutRegions[n][e];i&&i.dispose()}))})),Object.keys(this.regionContainers).forEach((function(n){var e=t.regionContainers[n];e&&document.removeChild(e),t.regionContainers[n]=void 0})),Object(r.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(r.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){return this.regionContainers[t]},t.prototype.createRegions=function(){var t=this,n=this.props.layoutCollection;Object.keys(n).forEach((function(e){var i=n[e];i&&t.createRegion(i,e)}));var e="";if(Object.keys(this.regionContainers).forEach((function(t){e=e+"."+t+", "})),e.length&&(e=e.substr(0,e.length-2),e+="{display: none; position: relative;}",this.styleSheet.insertRule(e,0)),this.styleElement){var i=this.styleSheet.cssRules;this.unsupportedRules=this.unsupportedRules.reverse();for(var r=0;r<i.length;r+=1){i[r].cssRules&&i[r].insertRule(e,0);var o=""+this.styleElement.innerHTML+i[r].cssText;if(o.indexOf("@media not all")>=0&&this.unsupportedRules.length>0){o=o.replace("@media not all",this.unsupportedRules.pop());o.replace(new RegExp("and (spanning: single-fold-.*)","g"),"{.multipleWindowRects"),"}"}this.styleElement.innerHTML=o,this.styleElement.innerHTML=""+this.styleElement.innerHTML}this.styleSheet=this.styleElement.sheet}},t.prototype.createRegionContainer=function(t){if(this.regionContainers[t.id])return this.regionContainers[t.id];var n=document.createElement("div");return n.setAttribute("style","width: "+("Header"===t.id?"100vw":"100%")+"; height: 100%; display: flex; flex: auto;"),this.regionContainers[t.id]=n,n},t.prototype.createRegion=function(t,n){var e=this;Object.keys(t).forEach((function(r){var o=t[r];e.addSelectorForLayoutDefinition(e.styleSheet,n,r);var a=e.rootDockPanel||(e.props.dockPanelProps?e.props.dockPanelProps.container:void 0),s=new i(Object.assign(e.props.dockPanelProps,{container:a,styleSheet:e.getLastChild(e.styleSheet)}));o.forEach((function(t){var i=e.createRegionContainer(t),o=s.addRegion(t);o&&i&&!o.contains(i)&&o.appendChild(i),t.accountForKeyboard&&o&&(e.accountForKeyboardRegions[n][r]||(e.accountForKeyboardRegions[n][r]=[]),e.accountForKeyboardRegions[n][r].push(o))})),!e.rootDockPanel&&s.dockPanelRootElement&&(e.rootDockPanel=s.dockPanelRootElement),e.layoutRegions[n][r]=s}))},t.prototype.getLastChild=function(t){for(var n=t.cssRules[t.cssRules.length-1];n.cssRules&&n.cssRules.length>0;)n=n.cssRules[n.cssRules.length-1];return n.cssRules?n:n.parentStyleSheet},t.prototype.getAffectedAccountForKeyboardRegions=function(t,n,e){if(void 0===n&&(n="Landscape"),void 0===e&&(e="Default"),this.accountForKeyboardRegions){var i=this.accountForKeyboardRegions[n][e]||this.accountForKeyboardRegions[n].Default||void 0;return t&&i?i.filter((function(n){return Object(r.isRectWithin)(n.getBoundingClientRect(),t)})):i}},t.prototype.createStyleSheet=function(){return this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this.styleElement.sheet},t.prototype.addSelectorForLayoutDefinition=function(t,n,e){var i,o,a="Small"===e?"max-width":"Large"===e?"min-width":void 0;if("Portrait"===n||"Landscape"===n)i="@media only screen and (orientation: "+n.toLowerCase()+") "+(a&&"Default"!==e?"and ("+a+": "+r.LayoutBreakpointSizes[e][n]+"px ){":"{")+"}";else{var s=void 0,u=void 0;"DP"===n?(s="landscape",u="single-fold-vertical"):(s="portrait",u="single-fold-horizontal"),o="@media only screen and (orientation: "+s+") and (spanning: "+u+")",this.unsupportedRules.push(o),i=o+" "+(a&&"Default"!==e?"and ("+a+": "+r.LayoutBreakpointSizes[e][n]+"px ){":"{")+"}"}t.insertRule(i,t.cssRules.length)},t}(),a=!1;function s(){return a}function u(t){var n;a=t&&!("undefined"!=typeof navigator&&(n=navigator.userAgent,/rv:11.0/i.test(n)||/Edge\//i.test(n)||/Safari/i.test(n)&&!/Chrome/i.test(n)&&!/Version\/[1-9][1-9]\.[0-9].*Safari/i.test(navigator.userAgent))),Object(r.initializeBaseWindowUtil)()}var c={};function l(t,n){c[t]=n}function d(t){void 0!==c[t]&&delete c[t]}function f(){for(var t in c)c[t]()}e.d(n,"RegionComposer",(function(){return o})),e.d(n,"shouldUseRegionComposer",(function(){return s})),e.d(n,"initializeWindowUtil",(function(){return u})),e.d(n,"registerAfterRegionsRendered",(function(){return l})),e.d(n,"unregisterAfterRegionsRendered",(function(){return d}))},,,,function(t,n,e){"use strict";e.r(n);var i=e(0),r=function(){function t(t){var n=this;this.accountForKeyboardRegionElements={Portrait:{Default:[],Small:[],Large:[]},Landscape:{Default:[],Small:[],Large:[]},DP:{Default:[],Small:[],Large:[]},DL:{Default:[],Small:[],Large:[]}},this.regionComposerRootId="regionComposerRoot",this.regionContainers={},this.setOffsetForActiveAccountForKeyboardRegions=function(t){var e=t?void 0:n.getWindowRectForKeyboardSegment(),i="Undefined"===n.windowMode?"Landscape":n.windowMode,r=n.getAffectedAccountForKeyboardRegions(e,i,n.layoutBreakpoint);if(r&&0!==r.length){var o=e?e.top+e.height:0;r.forEach((function(e){if(t)e.style.marginBottom="0px";else{var i=e.getBoundingClientRect(),r=Math.max(0,n.keyboardSegment.height-(o-i.bottom));e.style.marginBottom=r+"px"}}))}},this.boundingWindowRectsChanged=function(t,e){for(var i=void 0,r=t.length-1;r>=0;r-=1)if(t[r].isOccluded){i=t[r];break}var o=n.windowMode!==e||n.keyboardSegment!==i;n.setOffsetForActiveAccountForKeyboardRegions(!0),n.windowMode=e,n.keyboardSegment=i,n.render(o)},this.layoutBreakpointChanged=function(t){n.layoutBreakpoint=t,n.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(n.keyboardSegment)return Object(i.getBoundingRect)(n.keyboardSegment)},this.props=t,this.windowMode=Object(i.getWindowMode)(),this.layoutBreakpoint=Object(i.getLayoutBreakpoint)(),this.keyboardSegment=Object(i.getKeyboardSegment)(),this.regionComposerRoot=this.getRegionComposer(),this.regionComposerRoot&&(t.container&&t.container.appendChild(this.regionComposerRoot),this.registerAccountForKeyboardRegionElements(),Object(i.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(i.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render())}return t.prototype.render=function(t){var n=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){n.setOffsetForActiveAccountForKeyboardRegions(),a()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),a()))},t.prototype.dispose=function(){var t=this;Object.keys(this.regionContainers).forEach((function(n){var e=t.regionContainers[n];e&&document.removeChild(e),t.regionContainers[n]=void 0})),Object(i.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(i.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){if(this.regionComposerRoot)return this.regionContainers[t]||(this.regionContainers[t]=this.regionComposerRoot.querySelector("[id="+t+"Region]")),this.regionContainers[t]},t.prototype.getRegionComposer=function(){return document.getElementById(this.regionComposerRootId)},t.prototype.registerAccountForKeyboardRegionElements=function(){var t=this,n=this.props.layoutCollection;Object.keys(n).forEach((function(e){var i=n[e];i&&t.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(i,e)}))},t.prototype.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode=function(t,n){var e=this;Object.keys(t).forEach((function(i){var r;null===(r=t[i])||void 0===r||r.forEach((function(t){var r=e.getRegion(t.id);r&&e.accountForKeyboardRegionElements[n][i].push(r)}))}))},t.prototype.getAffectedAccountForKeyboardRegions=function(t,n,e){void 0===n&&(n="Landscape"),void 0===e&&(e="Default");var r=this.accountForKeyboardRegionElements[n][e]||this.accountForKeyboardRegionElements[n].Default||void 0;return t&&r&&0!==r.length?r.filter((function(n){return Object(i.isRectWithin)(n.getBoundingClientRect(),t)})):r},t}();var o={};function a(){for(var t in o)o[t]()}var s=void 0;function u(t){return s?s.getRegion(t):void 0}function c(){s&&(s.dispose(),s=void 0)}var l=function(){function t(){}return t.initialize=function(){t.ctrlWheelOccurred=!1,document.addEventListener("wheel",t.handleWheel)},t.stop=function(){document.removeEventListener("wheel",t.handleWheel)},t.handleWheel=function(n){n.ctrlKey&&(t.ctrlWheelOccurred=!0)},t}();l.initialize();var d,f={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},h={fastView:void 0,initialParaId:0,fastBootError:void 0},v=function(){function t(){}return t.getElement=function(t){if(this.DOMElements.hasOwnProperty(t))return this.DOMElements[t];var n=document.getElementById(t);return n?this.DOMElements[t]=n:null},t.removeElement=function(t){t&&this.DOMElements.hasOwnProperty(t.id)&&delete this.DOMElements[t.id],t&&t.parentNode&&t.parentNode.removeChild(t)},t.removeElementById=function(t){this.removeElement(this.getElement(t))},t.DOMElements={},t}(),p=function(){function t(){}return t.initialize=function(t,n,e,i,r,o,a,s,u,c,l,d,f,h){this.isViewMode=t,this.isEmbedMode=n,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=e,this.isOldRibbonCollapsedCookieOn="false"!==C.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==C.getCookie(r).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=o,this.isTwoPaneNavEnabled=a,this.isCssPositionRewriteEnabled=s,this.hideSkeletalHeader=u,this.hideSkeletalRibbon=c,this.hideSkeletalNavPane=l,this.embedViewer=d,this.isHostRenderingEnabled=f,this.postMessageOrigin=h},t}();!function(t){t[t.HideAnimationTime=256]="HideAnimationTime",t[t.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",t[t.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",t[t.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",t[t.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(d||(d={}));var m=0,b=!1,w=!1,g=function(){function t(){}return t.clearAriaLoadingAttributes=function(){var t=document.getElementById("applicationOuterContainer");t&&(t.removeAttribute("aria-busy"),t.removeAttribute("aria-hidden"))},t.getFastViewSkeletalClass=function(){return p.isCssPositionRewriteEnabled?this.u():this.h()},t.updateRibbonPanel=function(){p.isCssPositionRewriteEnabled&&p.isSimplifiedRibbonCookieOn?this.v():this.g()},t.updateWacDocumentPanel=function(){p.isCssPositionRewriteEnabled&&p.isSimplifiedRibbonCookieOn?this.S():this.C()},t.customizeSkeletalExperience=function(){m=document.body.clientWidth,p.isSimplifiedReactRibbonShown?v.removeElementById("SkeletalAdditionOldRibbon"):v.removeElementById("SkeletalNewRibbon"),p.isEmbedMode||p.embedViewer?(v.removeElementById("SkeletalHeader"),v.removeElementById("SkeletalNewHeader")):p.isNewHeaderShown?v.removeElementById("SkeletalHeader"):v.removeElementById("SkeletalNewHeader"),p.hideSkeletalRibbon&&v.removeElementById("SkeletalRibbon"),p.hideSkeletalNavPane&&v.removeElementById("SkeletalNavpane"),this.R()},t.bringFastViewToForegroundOfSkeletalCanvas=function(){var t=v.getElement("WACFastView");t&&(t.style.position="initial")},t.removeAllSubunitsFromSkeletalCanvas=function(){var t=v.getElement("SkeletalCanvas");if(t)for(var n=t.children.length-1;n>=0;n-=1){var e=t.children.item(n);e&&"WACFastView"!==e.id&&t.removeChild(e)}},t.fadeOutAndRemoveElement=function(t,n){var e=v.getElement(t);e&&(e.style.background="transparent",e.style.opacity="0",e.className+=" skeletalCover",window.setTimeout((function(){v.removeElement(e),n&&n()}),d.HideAnimationTime))},t.setMainContentEditable=function(){if(!b){b=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var t=document.getElementById("load_back");t&&(t.style.height="auto")}},t.u=function(){return t.h()},t.h=function(){var t="";return S()?t="SkeletalFastViewRtl":(t="SkeletalFastView",p.isTwoPaneNavEnabled&&!p.isEmbedMode?t="SkeletalFastView":p.isEmbedMode||m<=d.MinWidthToShowNavpane?t="SkeletalFastViewNoNavpane":m<=d.MinWidthToShowPageColumnPane&&(t="SkeletalFastViewPageColumnNavpane")),p.isViewModeAndRibbonPanelLarge&&(t+=" SkeletalFastViewViewMode"),p.isEmbedMode&&(t+=" SkeletalFastViewEmbedMode"),t},t.k=function(){p.isCssPositionRewriteEnabled?t.P():t.O()},t.P=function(){t.O()},t.O=function(){var t=v.getElement("SkeletalMainContent");t&&!p.isCssPositionRewriteEnabled&&(t.className+=p.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),v.removeElementById("SkeletalRibbonExtension")},t.v=function(){if(!w)if(p.isViewMode)w=!0;else{document.getElementById("WACRibbonPanel")&&(w=!0);var t=document.getElementsByClassName("WACReadingBarPanel").item(0);t&&(t.style.display="none")}},t.g=function(){if(!w){var t=document.getElementsByClassName("WACReadingBarPanel").item(0);if(p.isViewMode&&t)w=!0,p.isViewModeAndRibbonPanelLarge?t.className+=" RibbonPanelMaximizedViewMode":p.isViewModeAndRibbonPanelSmall&&(t.className+=" RibbonPanelMinimized");else{var n=document.getElementById("WACRibbonPanel");null!=n&&(w=!0,p.isSimplifiedReactRibbonShown?(n.className+=" RibbonPanelSLRMode",n.className+=" RibbonPanelNewSLRMode"):p.isOldRibbonExpandedAndShown&&!p.isInTouchMode?n.className+=" RibbonPanelMaximized":p.isOldRibbonExpandedAndShown&&p.isInTouchMode?n.className+=" RibbonPanelMaximizedTouchMode":p.isOldRibbonCollapsedAndShown&&(n.className+=" RibbonPanelMinimized")),t&&(t.style.display="none")}}},t.S=function(){var t=document.getElementById("WACDocumentPanelContent");null!=t&&(t.style.border="unset")},t.C=function(){var t=document.getElementById("WACDocumentPanel"),n=document.getElementById("WACDocumentPanelContent");null!=t&&(t.className+=" skeletalEnabled",p.isViewModeAndRibbonPanelLarge?t.style.top="40px":p.isViewModeAndRibbonPanelSmall?t.style.top="30px":p.isSimplifiedReactRibbonShown?t.style.top="77px":p.isOldRibbonCollapsedCookieOn||p.isInTouchMode||(t.style.top="124px"),S()?t.style.right="0px":p.isTwoPaneNavEnabled&&!p.isEmbedMode?m<d.MinWidthForTwoPaneNav?t.style.left=d.MinWidthToShowNavpane.toFixed()+"px":m<d.MinWidthToResizeTwoPaneNav?t.style.left=m.toFixed()+"px":t.style.left="426px":p.isEmbedMode||m<=d.MinWidthToShowNavpane?t.style.left="0px":m<=d.MinWidthToShowPageColumnPane?t.style.left="198px":p.isSnackbarNavPaneEnabled?t.style.left="426px":t.style.left="393px"),null!=n&&(n.style.border="unset")},t.R=function(){var n=v.getElement("SkeletalMainContent"),e=v.getElement("SkeletalExperience"),i=v.getElement("SkeletalRibbon");if(p.hideSkeletalHeader&&e&&(e.className+=" noHeader"),p.hideSkeletalRibbon&&e&&(e.className+=" noRibbon"),p.hideSkeletalNavPane&&e&&(e.className+=" noNavPane"),p.isViewMode?(e&&p.isCssPositionRewriteEnabled&&e.classList.remove("skeletalSLRGridRows"),i&&(i.innerHTML=""),p.isViewModeAndRibbonPanelSmall?(n&&!p.isCssPositionRewriteEnabled&&(n.style.top=p.isEmbedMode?"30px":"78px"),e&&p.isCssPositionRewriteEnabled&&(e.className+=" skeletalLegacyRibbonGridRows"),i&&!p.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):p.isViewModeAndRibbonPanelLarge?(i&&!p.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonExpandedViewMode"),p.isCssPositionRewriteEnabled&&e?e.className+=" skeletalReadingRibbonGridRows":!p.isCssPositionRewriteEnabled&&n&&(n.style.top=p.isEmbedMode?"40px":"88px")):e&&p.isCssPositionRewriteEnabled&&(e.className+=" skeletalReadingRibbonGridRows")):e&&!p.isSimplifiedReactRibbonShown&&p.isCssPositionRewriteEnabled&&(p.isOldRibbonExpandedAndShown&&!p.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedGridRows":p.isOldRibbonExpandedAndShown&&p.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":p.isOldRibbonCollapsedAndShown&&(e.className+=" skeletalLegacyRibbonGridRows")),p.isSimplifiedReactRibbonShown?i&&(i.className=p.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):i&&p.isCssPositionRewriteEnabled&&(i.className="skeletalPositionRewriteRibbon",p.isViewMode&&(i.className+=" viewMode")),p.isEmbedMode){i&&(p.isCssPositionRewriteEnabled||(i.style.top="0px"));var r=v.getElement("SkeletalAdditionOldRibbon");r&&!p.isCssPositionRewriteEnabled&&(r.style.top="0px")}if(S()&&t.A(),p.isOldRibbonCollapsedAndShown?t.k():p.isOldRibbonExpandedAndShown&&p.isEmbedMode&&n&&!p.isCssPositionRewriteEnabled&&(n.style.top="125px"),p.isTwoPaneNavEnabled&&!p.isEmbedMode){var o=v.getElement("SkeletalNavpane"),a=v.getElement("SkeletalNavpaneSectionColumn"),s=v.getElement("SkeletalNavpanePageColumn"),u=v.getElement("SkeletalCanvas"),c=v.getElement("SkeletalExperience");if(null!=o&&null!=a&&null!=s&&null!=u&&null!=c)if(m<=d.MinWidthForTwoPaneNav)p.isCssPositionRewriteEnabled?c.className+=" skeletalOreoTwopaneShrunkGridColumns":(o.style.width="300px",u.style.left="299px"),a.style.width="124px",s.style.width="124px";else if(m<=d.MinWidthToResizeTwoPaneNav){p.isCssPositionRewriteEnabled?c.style.gridTemplateColumns=m.toFixed()+"px 100%":(o.style.width=m.toFixed()+"px",u.style.left=m-1+"px");var l=.5*m-24;a.style.width=l.toFixed()+"px",s.style.width=l.toFixed()+"px"}}else if(p.isEmbedMode||m<=d.MinWidthToShowNavpane){v.removeElementById("SkeletalNavpane");u=v.getElement("SkeletalCanvas");var f=v.getElement("SkeletalExperience");p.isCssPositionRewriteEnabled&&f&&!p.hideSkeletalNavPane?p.isTwoPaneNavEnabled?f.className+=" skeletalNoTwopaneGridColumns":f.className+=" skeletalNoNavpaneGridColumns":!p.isCssPositionRewriteEnabled&&u&&(u.style.left="0px")}else if(m<=d.MinWidthToShowPageColumnPane){o=v.getElement("SkeletalNavpane");var h=v.getElement("SkeletalNotebookName"),b=(u=v.getElement("SkeletalCanvas"),v.getElement("SkeletalExperience"));v.removeElementById("SkeletalNavpaneSectionColumn"),v.removeElementById("skeletalNavpaneTab"),p.isCssPositionRewriteEnabled&&b?b.className+=" skeletalLegacyNavpanePageOnlyGridColumns":p.isCssPositionRewriteEnabled&&null!=o&&null!=u&&(o.style.width="201px",u.style.left="200px"),h&&(h.style.right="42px")}if(p.isSimplifiedReactRibbonShown&&null!=n)p.isCssPositionRewriteEnabled||(n.style.paddingTop=p.isEmbedMode?"74px":"126px",n.style.top="0px");else if(p.isOldRibbonCollapsedAndShown){var w=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),g=v.getElement("SkeletalRibbonBar");null!=n&&null!=g&&null!=w&&(v.removeElement(w),g.style.height="29px",g.style.borderBottom="1px solid #d2d2d2",p.isCssPositionRewriteEnabled||(n.style.top="0px"))}else if(p.isOldRibbonExpandedAndShown&&p.isInTouchMode){var C=v.getElement("SkeletalRibbonExtension");null==n||null==C||p.isCssPositionRewriteEnabled||(C.style.height="108px",n.style.top="187px")}},t.A=function(){var t=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var n in t){var e=v.getElement(t[n]);e&&(e.className+=" skeletalRTL")}var i=v.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},t}();function S(){var t=v.getElement("SkeletalExperience");return null!=t&&"rtl"===t.getAttribute("direction")}var C=function(){function t(){}return t.ensureCookieCompliance=function(t,n){if(t){var e=[];n&&(e=JSON.parse(n)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(e))}},t.getCookie=function(t){if(!t)return"";if(t.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var n=""+document.cookie,e=new RegExp("(?:^|; )"+t+"=([^;]*)"),i=n.match(e);return!i||i.length<2?"":i[1]},t.isDocumentEmpty=function(t){function n(t,n){return-1===(" "+t.className+" ").indexOf(" "+n+" ")}var e=t.querySelectorAll(".Paragraph");return!(!e||1!==e.length)&&(2===e[0].childElementCount&&!n(e[0].children[0],"TextRun")&&!n(e[0].children[1],"EOP")&&""===e[0].children[0].innerText)},t}();function R(){function t(){return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&n()&&!(navigator.userAgent.indexOf("iPhone")>=0)}function n(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||t()||n()}function k(t,n,e,i){var r;if(r=t.cssPositionRewriteIsEnabled&&!i?"WACFastViewPositionRewrite":"WACFastView",t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(r+=" Deeplink"),t.showRibbon||(r+=" HideRibbon"),t.showNavPane||(r+=" HideNavPane"),t.isOneNoteMobileViewerNavigationEnabled&&(r+=" ShowMobileViewerNavigation"),t.positionAbsolute){if(r+=" WACFastViewAbsolute",t.showRibbon?t.showRibbonHeader||(r+=" HeaderHidden"):r+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(r+=" SectionsHidden"):r+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)r+=" OneLineRibbon",r+=" OneLineRibbonWithTabHeaderRefresh";else{var o=n(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===o||t.ribbonExpandedByDefault&&"true"!==o)&&(r+=" RibbonPinned",e&&(r+=" Touch"))}t.skeletalBootUXIsEnabled&&(r+=" "+g.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(r+=" Snackbar"),t.twoPaneNavIsEnabled&&(r+=" TwoPaneNav")}return r}function x(){var t=document.getElementById("load_img");t&&(t.style.opacity="0",t.style.height="1px");var n=document.getElementById("load_back");n&&(n.style.opacity="0",n.style.height="1px")}function y(t,n){if(!(n.wordIsSkeletalDeepLinkOn&&n.isDeepLinkScenario||0===h.initialParaId)){var e=document.querySelector("p[paraid='"+h.initialParaId+"']");if(!e||!e.getBoundingClientRect)return;var i=e.getBoundingClientRect().bottom,r=t.getBoundingClientRect().bottom;t.firstElementChild&&(t.firstElementChild.scrollTop=i-r+70)}}function P(){var t=document.getElementById("application");t&&(t.style.top="0")}var O=function(){function t(){}return t.launchExperience=function(n){p.initialize("false"===n.IsEditMode,"true"===n.IsEmbedMode,"true"===n.SimplifiedReactRibbonUxIsEnabled,n.RibbonPreferenceCookieNameHint,n.IsSimplifiedRibbonOnCookieName,"true"===n.SnackbarNavPaneIsEnabled,"true"===n.OneNoteTwoPaneNavPaneIsEnabled,"true"===n.OneNoteCssPositionRewriteIsEnabled,"true"===n.HideHeaderEmbedded,"true"===n.HideRibbonEmbedded,"true"===n.ONHideNavEmbedded,"true"===n.MobileEmbedViewer,"true"===n.PageSSRHostRenderingIsEnabled,n.PostMessageOrigin),g.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){t.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)},t.showSkeletalUx=function(){var t=v.getElement("SkeletalExperience");t&&(t.style.opacity="1",t.className+=" skeletalShow")},t.setRibbonReady=function(){this.I||(this.W=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.L&&g.fadeOutAndRemoveElement("SkeletalRibbon",(function(){self.dispatchEvent(new CustomEvent("RibbonVisible"))})))},t.setPageReady=function(){this.I||(g.updateRibbonPanel(),g.updateWacDocumentPanel(),this.L=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},t.setNavpaneReady=function(){this.I||(g.updateRibbonPanel(),this.F=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.L&&g.fadeOutAndRemoveElement("SkeletalNavpane",(function(){g.setMainContentEditable()})))},t.sendPostMessageToHostWindowRendering=function(){var t=this;window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){if(!t.N){var n=window.parent,e={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==p.postMessageOrigin&&n.postMessage(JSON.stringify(e),p.postMessageOrigin),t.N=!0}}))}))},t.setFastViewReady=function(){this.I||(p.isHostRenderingEnabled?this.dismissSkeletalCanvas(this.sendPostMessageToHostWindowRendering.bind(this)):this.dismissSkeletalCanvas())},t.showFastViewOnSkeletalCanvas=function(){var t=this;if(g.bringFastViewToForegroundOfSkeletalCanvas(),g.removeAllSubunitsFromSkeletalCanvas(),p.isHostRenderingEnabled){var n=document.querySelector(".skeletalShow");n&&n.addEventListener("animationend",(function(){t.sendPostMessageToHostWindowRendering()})),window.setTimeout((function(){t.sendPostMessageToHostWindowRendering()}),this.POST_MESSAGE_FOR_HOST_RENDERING)}},t.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this.L&&this.F&&this.W)&&this.dismissSkeletalBootUx()},t.dismissSkeletalBootUx=function(n){if(void 0===n&&(n=!1),this.I)return!1;var e=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),r=document.getElementById("WACRibbonPanel");return e&&i&&r?(t.removeSkeletalExperience(),t.adjustElementsAfterSkeletalDismissal(e,i,r),this.I=!0,!0):(n&&t.removeSkeletalExperience(),!1)},t.removeSkeletalExperience=function(){var t=v.getElement("SkeletalExperience");t&&v.removeElement(t)},t.adjustWacRibbonAfterDismissSkeletal=function(t){p.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(t):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(t)},t.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(t){t.style.height="auto"},t.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(t){p.isSimplifiedReactRibbonShown?t.style.height="77px":t.style.height="auto"},t.adjustWacCanvasAfterDismissSkeletal=function(t){p.isCssPositionRewriteEnabled&&p.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(t)},t.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(t){t.className="SkeletalWacDocumentPanel skeletalEnabled "+t.className},t.dismissSkeletalCanvas=function(t){var n=this,e=document.getElementById("WACFastView");if(!this.I||e&&e.parentElement&&"SkeletalCanvas"===e.parentElement.id){this.L=!0;var i=document.getElementById("load_back");null!=i&&(this.preDismissSkeletalCanvas(i),g.fadeOutAndRemoveElement("SkeletalCanvas",(function(){t&&t(),n.F&&g.setMainContentEditable()})))}},t.preDismissSkeletalCanvas=function(t){p.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(t):this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissPositionRewriteSkeletalCanvas=function(t){this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissAbsoluteSkeletalCanvas=function(t){var n=document.getElementById("WACRibbonPlaceholder"),e=v.getElement("SkeletalRibbonExtension");if(null!=n&&null!=e&&(n.style.height="124px"),t.style.background="transparent",S()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!p.isEmbedMode){var r=document.getElementById("AppHeaderPanel");r&&(r.style.height="48px")}},t.adjustElementsAfterSkeletalDismissal=function(t,n,e){t&&(t.style.display="none",t.style.height="1px",t.style.opacity="0",t.setAttribute("aria-hidden","true"),g.clearAriaLoadingAttributes()),n&&this.adjustWacCanvasAfterDismissSkeletal(n),e&&this.adjustWacRibbonAfterDismissSkeletal(e)},t.W=!1,t.L=!1,t.F=!1,t.I=!1,t.N=!1,t.FORCE_DISMISS_AFTER=2e4,t.POST_MESSAGE_FOR_HOST_RENDERING=500,t}(),A=function(){function t(){}return t.getFloatingObjectsContainerWidth=function(){return 270},t.shouldShiftFastView=function(n,e,i){return t.shouldShiftBasedOnScreenSize(i)&&t.shouldShiftBasedOnNumSections(e)&&n},t.shouldShiftRealCanvas=function(n,e,i,r,o){if(!t.shouldShiftBasedOnScreenSize(n))return!1;var a=e(i);return!!t.shouldShiftBasedOnNumSections(a)&&r(o)},t.shouldShiftBasedOnScreenSize=function(t){return"Small"!==t},t.shouldShiftBasedOnNumSections=function(t){return 1===t},t}();function I(t,n){window._bB&&window._bB.sendBeacon(t,n)}var W=function(){return!!window&&!!window.performance&&!!window.performance.mark};function E(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function L(t){return E()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(t)}var F=function(t){if(W())try{window.performance.mark(t)}catch(t){}};function N(t,n,e){if(W()&&window.performance.measure)try{window.performance.measure(t,n,e)}catch(t){}}var D=function(t,n){this.eventName=t,this.timeStamp=(new Date).getTime()-n},T=function(){function t(t,n,e,i,r,o,a,s,u){var c=this;void 0===r&&(r="Default"),void 0===o&&(o=C.getCookie),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===u&&(u=0),this.getTopbarContainerFunc=t,this.getRibbonContainerFunc=n,this.getDocumentContainerFunc=e,this.appearance=i,this.entry=r,this.getCookieFunc=o,this.fastViewOnSkeletal=a,this.hasUnresolvedComments=s,this.numSections=u,this.D=R(),this.T=function(t){"Shift"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&c.M(t.type)},this.B=function(t){(13===t.keyCode||t.ctrlKey&&(66===t.keyCode||73===t.keyCode||85===t.keyCode))&&(t.preventDefault(),c.M(t.key))},this.V=function(t){if(void 0!==c.isEditable&&void 0!==c.htmlElement&&void 0!==c.j&&c.isEditable&&c.appearance.pasteLoadingUI&&!c.isPasteLoading&&c.htmlElement.parentElement){c.isPasteLoading=!0;var n=function(t){var n=document.createElement("div");n.id="WACLoadingPasteUI";var e=document.createElement("div");e.className="WACFastLoadingBoxUI";var i,r=document.createElement("img");return r.src=t,r.className="WACProgressIcon",e.appendChild(r),n.appendChild(e),n.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),n.setAttribute("aria-busy","true"),n.setAttribute("role","progressbar"),n}(c.appearance.loadingUIGif);c.htmlElement.parentElement.appendChild(n),c.pasteData=function(t){var n={};if(null!=t&&null!=t.types){var e=t.types[0];n.type=e,n.data=t.getData(e)}else{var i=window.clipboardData,r=i.getData("text");null!==r?(n.type="text/plain",n.data=r):i.files.length>0&&(n.type="image/png",n.data=i.files[0])}return n}(t.clipboardData),c.j.removeAttribute("contentEditable"),t.preventDefault()}else c._(t)},this._=function(t){c.M(t.type),t.preventDefault()},this.M=function(t){c.eventLogs&&c.openTime&&c.eventLogs.push(new D(t,c.openTime))},this.H=function(t){if(c.M(t.type),c.j&&t.target!==c.j){if(c.j.focus(),window.getSelection){var n=window.getSelection();n&&n.collapseToEnd()}t.preventDefault()}},this.U=function(t){var n=t.querySelector(".PageContentContainer");n&&(n.className+=" WACFastViewEditor",n.addEventListener("mousedown",(function(t){c.H(t)}))),c.j=t.querySelector(".NormalTextRun"),c.j&&(c.j.contentEditable="true",c.j.style.outline="0px",c.j.spellcheck=!1,c.j.setAttribute("aria-hidden","true"),c.j.focus(),c.j.addEventListener("paste",(function(t){c.V(t)})),c.j.addEventListener("keydown",(function(t){c.B(t)})))},this.q=function(t){I(t,"BootPhaseCompleted")},this.J=function(t){if(null!=t){var n=t.querySelector(".OutlineContainer"),e=t.querySelector(".PageContentContainer");if(null!=n&&null!=e){var i=document.createElement("div"),r=A.getFloatingObjectsContainerWidth()+"px";c.appearance.isRtl?i.style.paddingLeft=r:i.style.paddingRight=r,e.appendChild(i),i.appendChild(n)}}},this.G=function(){c.appearance.positionAbsolute&&c.appearance.showRibbon&&!c.X&&!c.appearance.skeletalBootUXIsEnabled&&(c.showRibbonPlaceholder(),c.X=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}return t.prototype.removeKeypressEventListener=function(){this.K&&document.removeEventListener("keydown",this.K)},t.prototype.showRibbonPlaceholder=function(){var t=this;function n(t,n){var e=document.createElement("div");return e.className="ribbonBar",e.setAttribute("unselectable","on"),e.appendChild(t),e.appendChild(n),e}if(!document.getElementById("ExternalHeaderFullTopBars")){var e=this.getTopbarContainerFunc(),i=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(e&&this.appearance.showRibbonHeader)if(i)this.topbarPlaceholderElement=i;else{var r=document.createElement("div");r.className="cui-topBar2",this.appearance.darkModeEnabled?r.className+=" SharedUXDarkModeFastViewHeader":this.appearance.modernUXEnabled&&(r.className+=" ModernUXFastViewHeader"),r.setAttribute("unselectable","on");var o=document.createElement("div");o.id="WACTopbarPlaceholder";var a=function(){var n=document.createElement("div");n.className="cui-topBar1",t.appearance.reactSharedHeaderIsEnabled?n.className+=" cui-topBar1-transitionalReactHeaderUI":n.className+=" cui-topBar1-transistionalHeaderUI",t.appearance.darkModeEnabled?n.className+=" SharedUXDarkModeFastViewHeader":t.appearance.modernUXEnabled&&(n.className+=" ModernUXFastViewHeader"),n.setAttribute("unselectable","on");var e="",i="";t.appearance.headerBackgroundColorOverride&&(e="background-color:"+t.appearance.headerBackgroundColorOverride+";"),t.appearance.headerTextColorOverride&&(i="color:"+t.appearance.headerTextColorOverride+";"),t.appearance.reactSharedHeaderIsEnabled&&(e||i)&&n.setAttribute("style",""+e+i);var r=document.createElement("span");r.className="cui-QATRowLeft BreadcrumbContainer";var o=document.createElement("span");o.className="AppAndBrandContainer",t.appearance.reactSharedHeaderIsEnabled&&e&&o.setAttribute("style",e);var a=document.createElement("div");a.className="WACFastBootLoader";var s=document.createElement("span");s.className="BreadcrumbItem";var u=t.appearance.reactSharedHeaderIsEnabled&&t.appearance.headerAppLauncherIsHidden;u?s.setAttribute("style","width:8px;height:48px;display:inline-block;"):s.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var c=document.createElement("span");return c.className="headBrand",t.appearance.reactSharedHeaderIsEnabled?c.setAttribute("style","line-height:48px;margin-left:2px;"):c.setAttribute("style","line-height:48px;"),c.appendChild(document.createTextNode(t.appearance.appBrandedName)),o.appendChild(s),o.appendChild(c),u||o.appendChild(a),r.appendChild(o),n.appendChild(r),t.appearance.appColorUpdateIsEnabled&&(n.className+=" cui-color-update",o.className+=" cui-color-update"),n}();o.appendChild(a),o.appendChild(r),e.appendChild(o),this.topbarPlaceholderElement=o}var s=this.getRibbonContainerFunc();if(s&&0===s.children.length){var u=document.createElement("div");if(u.id="WACRibbonPlaceholder",u.className=u.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(c=function(e,i){var r=document.createElement("div");r.className=e?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",r.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var o=document.createElement("div");return o.className=e?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",t.appearance.darkModeEnabled?(r.className+=" SharedUXDarkModeFastViewRibbon",o.className+=" SharedUXDarkModeFastViewRibbon"):t.appearance.modernUXEnabled&&(r.className+=" ModernUXFastViewRibbon",o.className+=" ModernUXFastViewRibbon"),i&&(o.style.height="90px"),n(r,o)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){t.M("ribbonClick")})),u.appendChild(c);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var c;(c=function(t,e){var i=document.createElement("div");i.className="ribbonUpper";var r=document.createElement("div");r.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var a=function(t,n){var e=n;if(t){e=n.replace("bgapp_word_topleft","bgapp_word_topleft_touch")}return e}(t,e);return o.style.backgroundImage="url('"+a+"')",t&&(r.className+=" ribbonTouch",o.className+=" ribbonTouch"),i.appendChild(o),n(i,r)}(this.D,this.appearance.ribbonImageBase)).addEventListener("click",(function(){t.M("ribbonClick")})),u.appendChild(c)}else u.style.height="30px";else u.className="cui-exth";s.appendChild(u),this.ribbonPlaceholderElement=u}}},t.prototype.open=function(t,n){var e=this;void 0===n&&(n=!1),this.appearance.showRibbonHeader||P(),this.G();var r=this.getDocumentContainerFunc();if(!r||!t)return!1;var o="canvasWrap"===r.id,a=document.createElement("div"),s=k(this.appearance,this.getCookieFunc,this.D,o);if(this.appearance.isRegionComposerShown&&(s+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(s+=" WACFastViewMLRVisible"),a.className=s,a.id="WACFastView",a.innerHTML=t,this.appearance.isOneNoteCanvasZoomEnabled&&this.appearance.currentZoomLevel&&1!==this.appearance.currentZoomLevel){var u=a.querySelector(".PageContentOrigin");null!==u&&(u.style.transform="scale("+this.appearance.currentZoomLevel+")")}if(this.htmlElement=a,this.appearance.editable&&(this.isEditable=C.isDocumentEmpty(a)),n)a.style.visibility="hidden";else{this.K=this.T,document.addEventListener("keydown",(function(t){e.K&&e.K(t)}));var c=function(t){e.M(t.type)};if(a.firstChild)if(a.firstChild.addEventListener("scroll",c),a.firstChild.addEventListener("click",c),a.firstChild.addEventListener("dblclick",c),a.firstChild.addEventListener("contextmenu",(function(t){e._(t)})),o)a.firstChild.classList.add("WACFastViewNavOreoGrid");A.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,i.getLayoutBreakpoint())?(this.M("Shifting Fast View"),this.J(a),this.hasShifted=!0):this.M("Not shifting Fast View"),this.M("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===i.getLayoutBreakpoint())),r.appendChild(a),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?O.showFastViewOnSkeletalCanvas():f.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?O.setFastViewReady():x()),y(a,this.appearance),this.q("RecordContentDisplayed"),this.isEditable&&(a.className+=" WACFastViewEditable",this.U(a),this.q("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),F("ViewableEnd"),N("Viewable","StartWacBoot","ViewableEnd"),!0},t.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},t.cssClass="WACFastView",t.cssPositionRewriteClass="WACFastViewPositionRewrite",t.cssClassAbsolute="WACFastViewAbsolute",t}();Object(i.objectAssignPolyfill)();var M=function(){function t(){}return t.initialize=function(n){t.Z=n,t.Y||(t.Y=!0,t.$=document.createElement("div"),t.$.setAttribute("unselectable","on"),Object.assign(t.$.style,{pointerEvents:"none",width:"100%",height:"100%",zIndex:"1000",position:"absolute",visibility:"hidden",transition:"opacity "+t.tt+"ms"}),t.$.id=t.nt,t.$.className=t.$.id)},t.launchExperience=function(n,e){var i="applicationOuterContainer";n&&(i=n),e&&(t.et=e),document.getElementById(i).appendChild(t.$),t.it(),window.setTimeout((function(){return t.dismissSkeletalBootUx()}),t.et)},t.setComponentReady=function(n){var e=t.rt(n);!t.I&&e&&(e.isReady=!0,t.ot()||t.fadeOutAndRemove(n))},t.dismissSkeletalBootUx=function(){if(t.I)return!1;for(var n in t.fadeOutAndRemove(t.nt),t.at)t.fadeOutAndRemove(n);return t.at={},t.I=!0,self.dispatchEvent(new CustomEvent("RibbonVisible")),!0},t.getSkeletalComponentColor=function(n,e){return n?"#323130":e?"#F5F5F5":t.st},t.getSkeletalBackgroundColor=function(n,e){return n?"#252423":e?"#FFFFFF":t.ut},t.addComponent=function(n){t.at[n.element.id]=n,n.element.style.transition="opacity "+t.tt+"ms",t.$.appendChild(n.element)},t.addComponentOutsideSkeletalContainer=function(n){t.at[n.element.id]=n,n.element.style.transition="opacity "+t.tt+"ms"},t.addShimmerToElement=function(t){if(!Object(i.isReducedAnimations)()){var n=document.getElementById(t);if(n){this.ct();var e=document.createElement("div");e.id=t+"_Shimmer",Object.assign(e.style,{height:"200px",top:"-200px",width:"100000%",left:"-99900%",backgroundColor:"linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",position:"absolute",transformOrigin:"left",zIndex:"1000",animation:"SkeletalShimmer 3s infinite linear"}),n.appendChild(e)}}},t.fadeOutAndRemove=function(n,e){var i=void 0,r=void 0;n===t.nt?i=t.$:(r=t.rt(n))&&(i=r.element),i&&(i.style.opacity="0",window.setTimeout((function(){t.lt(i),r&&t.dt(n),e&&e()}),t.tt))},t.isSkeletalDeepLink=function(){return t.Z},t.Y=!1,t.I=!1,t.et=3e4,t.nt="SkeletalContainer",t.tt=Object(i.isReducedAnimations)()?.001:200,t.at={},t.st="#EDEBE9",t.ut="#F3F2F1",t.Z=!1,t.ft=!1,t.it=function(){t.$&&(t.$.style.visibility="visible",t.$.style.opacity="1")},t.ht=function(){for(var n in t.at)if(!t.at[n].isReady)return!1;return!0},t.ot=function(){return!!t.ht()&&t.dismissSkeletalBootUx()},t.ct=function(){if(!t.ft){var n=document.createElement("style");n.type="text/css";n.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(n),t.ft=!0}},t.rt=function(n){return t.at[n]},t.dt=function(n){delete t.at[n]},t.lt=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},t}(),B=function(){function t(){}return t.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",t.handleVisibilityChange)},t.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},t.handleVisibilityChange=function(){var n={visibility:document.visibilityState,time:new Date};t.metrics.events.push(n)},t}();B.initialize();var V,j,_,H=function(t,n,e,i){this.documentViewport=t,this.timeStamp=n,this.schemaVersion=e,this.documentItemSize=i},U=function(){function t(){}return t.prototype.isSupported=function(){return!0},t.prototype.getDocumentCacheItem=function(t){return new H("",0,"",0)},t.prototype.saveDocumentCacheItem=function(t,n){return!0},t.prototype.removeDocumentCacheItem=function(t){},t.prototype.clearBrowserCache=function(){return 0},t.prototype.getItemsInCache=function(){return[]},t.prototype.getCacheKey=function(t){return"WordCachedDoc_"+t},t}(),q=function(){function t(){}return t.prototype.isSupported=function(){return!0},t.prototype.getDocumentCacheItem=function(t){var n=localStorage.getItem(t);return JSON.parse(n)},t.prototype.saveDocumentCacheItem=function(t,n){var e=new H("test",1633560587,"1.0",5),i=JSON.stringify(e);return localStorage.setItem(t,i),!0},t.prototype.removeDocumentCacheItem=function(t){localStorage.removeItem(t)},t.prototype.clearBrowserCache=function(){return 0},t.prototype.getItemsInCache=function(){return[]},t.prototype.getCacheKey=function(t){return"WordCachedDoc_"+t},t}();function z(t,n){return void 0===n&&(n=!1),(_?_(t):!!j&&!!j[t]&&"true"===j[t].toLowerCase())||function(t,n){return void 0===n&&(n=!1),V?V.getBooleanFeatureGate(t,n):n}(t,n)}function J(t,n){return j&&j[t]?j[t]:n}var G=function(){function t(n,i,r,o,a,s){var u,c;j=a,u=J("StaticContentUrl",""),c=u,z("AppChromeOverrideEnabled")&&(c=J("AppChromeBaseScriptUrlOverride","")),z("ExperimentalBundleIsEnabled")&&(c+="exp/"),e.p=e.p||c;var l=function(t){return"true"===a[t]};this.fastBootEnabled=l("FastBoot"),t.slice0Name=a.Slice0Name,this.appearance={positionAbsolute:!l("OneNoteCssPositionRewriteIsEnabled"),showRibbon:!l("HideRibbonEmbedded"),ribbonExpandedByDefault:n,ribbonPreferenceCookieName:a.RibbonPreferenceCookieNameHint,showRibbonImage:i,ribbonImageBase:a.RibbonImageBase,shouldStretchPageToBottom:r,appBrandedName:a.BrandedWebAppName,showRibbonHeader:!l("HideHeaderEmbedded"),showNavPane:o&&!l("ONHideNavEmbedded"),showNavSections:!l("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:l("PasteInBootLoadingUIIsEnabled"),loadingUIGif:a.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:!0,simplifiedReactRibbonAnimationIsEnabled:X(a),skeletalBootUXIsEnabled:l("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:l("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:l("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:l("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:l("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:l("OneNoteCssPositionRewriteIsEnabled"),wordIsSkeletalDeepLinkOn:l("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:l("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:t.isReactMultilineRibbonVisible(a),renderFastViewOnSkeletalUXIsEnabled:l("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!s,appColorUpdateIsEnabled:l("AppColorUpdateIsEnabled"),isRtl:l("Rtl"),showHeaderPlaceholder:l("ShowHeaderPlaceholder"),modernUXEnabled:l("Microsoft.Office.WordOnline.ModernUxExperimentOne")&&l("SharedUXThemingIsEnabled")&&K(a),darkModeEnabled:t.isDarkModePreferenceOn(a),isOneNoteCanvasZoomEnabled:!1,currentZoomLevel:1,isOneNoteMobileViewerNavigationEnabled:l("OneNoteMobileViewerNavigationIsEnabled")}}return t.prototype.launchFastView=function(t,n,e,i,r,o){if(void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=0),I("Launching FastView from entry point "+n,"BootLogs"),this.appearance.editable=e,this.fastBootEnabled&&!h.fastView&&!document.getElementById("PageContentContainer")){var a,s=document.getElementById("canvasWrap");if(null!=s&&this.appearance.cssPositionRewriteIsEnabled)a=s;else{var u=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";a=document.getElementById(u)}h.fastView=new T((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return a}),this.appearance,n,C.getCookie,i,r,o);try{return h.fastView.open(t)}catch(t){return h.fastBootError="FastView open failed: "+t.message+"\r\n"+t.stack,!1}}return!1},t.getSlice0=function(){if(null!=t.slice0Name&&t.slice0Name.length>0){var n=document.createElement("script");n.type="text/javascript",n.src=t.slice0Name,document.getElementsByTagName("head")[0].appendChild(n)}},t.isReactMultilineRibbonVisible=function(t){return"true"===t.ReactMultilineRibbonIsEnabled&&(function(t){return"true"===C.getCookie(t.ReactRibbonMLRPreferenceCookieName).toLowerCase()}(t)||"false"===C.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase())},t.isDarkModePreferenceOn=function(t){return"true"!==t.IsUnifiedHostMode&&"true"===t.SharedUXThemingIsEnabled&&"true"===t.SharedUXDarkModeIsEnabled&&"true"===C.getCookie("SharedUXDarkMode")},t}();function X(t){return"true"===t.OneLineRibbonAnimationIsEnabled}function K(t){var n=C.getCookie(t.ModernUxExperimentPreferenceCookieName).toLowerCase();return""===n?!("true"===t.ModernUxExperimentDefaultOffIsEnabled.toLowerCase()):"false"!==n}var Q=function(t,n,e,i){void 0===e&&(e=!1),void 0===i&&(i=1),this.pageHtml=t,this.editable=n,this.hasUnresolvedComments=e,this.numSections=i};function Z(t,n,e,i){var r;return{baseDocId:t.BaseDocId,fastBootEnabled:"true"===t.FastBoot,getCachedSSR:"true"===t.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(t.InitialParaId,16),isIndexedDBEnabled:"true"===t.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===t.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===t.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===t.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===t.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===t.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===t.OneNoteSyncHeartBeatIsEnabled,isOneNoteSyncHeartBeatNoShutdownEnabled:"true"===t.OneNoteSyncHeartBeatNoShutdownEnabled,isUserCreatingPersonalNotebookFirstTime:"true"===t.IsUserCreatingPersonalNotebookFirstTime,isRemoveSsrEnabled:"true"===t.IsRemoveSsrEnabled,IsBrowserSideCacheEnabled:"true"===t.IsBrowserSideCacheEnabled,isRemoveSsrEnabledForDarkMode:"true"===t.ExtraDarkModeWorkEnabled&&G.isDarkModePreferenceOn(t),isSessionStartInfoForServerSideVetoesEnabled:"true"===t.SessionStartInfoForServerSideVetoesIsEnabled,oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===t.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(t.OneNoteContentSyncVersion,10),optimizedForNewFile:e,pageTarget:t.PageTarget,pageTargetHtml:t.PageTargetHtml,requestOptions:Y(t,n,i),sessionStartJson:null!==(r=t.SessionStartInfoJson)&&void 0!==r?r:"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===t.SkipPageHtmlInGetCellsResponse,slice0Name:t.Slice0Name,syncHeartBeatSendInterval:parseInt(t.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(t.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(t.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:t.UserId}}function Y(t,n,e){return{accessToken:e?e.AccessToken:t.AccessToken,accessTokenTtl:e?e.AccessTokenTtl:"",applicationModeExtended:t.SessionStartInfoJson?JSON.parse(t.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:t.BuildVersion,canary:t.Canary,feMachineId:t.FEMachineId,logHostRequests:"true"===t.LogHostRequests?1:0,onenoteSyncEndpoint:t.ONOnlineSyncEndpoint,pageTarget:t.PageTarget,renderingMode:t.AddServerSideRenderingHeader,requestHeadMode:n,rootQuerySignature:t.RootQuerySignature,sessionOrigin:t.SessionOrigin?t.SessionOrigin:"UNKNOWN",url:t.WebServiceBase,userSessionId:t.SessionId,userType:t.UserType,wacCluster:t.WacCluster,wacUserAgent:t.WacUserAgent}}var $=function(){function t(t,n){var e=this;this.onGetCellsRequestCompleted=function(t){if(I("Get cells response received:"+t.status,"BootLogs"),!f.g_initialRequestCompleted){if(it(t.responseText,!1),!h.fastView&&!e.shouldDisableSSR()){var n=function(t){if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Cells)for(var n=t.Responses[0][1].Cells,e=0;e<n.length;e+=1){var i=n[e];if(i&&i.PageHtml)return new Q(i.PageHtml,!!i.IsPageHtmlEditable,!!i.HasUnresolvedComments,i.NumSections)}}(f.g_initialRequestResponseObject);n&&n.pageHtml&&e.vt&&e.vt.launchFastView(n.pageHtml,"WacBootGetCells",n.editable,!1,n.hasUnresolvedComments,n.numSections)}f.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){f.g_onInitialResponseReady&&f.g_onInitialResponseReady()},this.pt=function(t){var n=t.responseText;if(!h.fastView){var i=function(t){var n=rt(t);if(n&&n.Responses[0]&&n.Responses[0][1]&&n.Responses[0][1].Html)return n.Responses[0][1].Html;return}(n);i&&e.vt&&e.vt.launchFastView(i,"WacBootRenderPage")}},this.vt=t,this.bt=n}return t.prototype.shouldDisableSSR=function(){return this.bt.isRemoveSsrEnabled||this.bt.isRemoveSsrEnabledForDarkMode||this.bt.IsBrowserSideCacheEnabled},t.prototype.makeGetCellsRequest=function(t,n){I("Making GetCells Request","BootLogs"),h.initialParaId=this.bt.initParagraphId||0;var e=JSON.stringify(window.location.href),i=',"SearchQuery":null,"IsNewFile":'+(this.bt.isNewFile&&this.bt.optimizedForNewFile).toString()+',"InitialParaId":'+h.initialParaId+',"RequestUrl":'+e+',"SkipPageHtmlInResponse":'+this.bt.skipPageHtmlInGetCellsResponse.toString();this.bt.isSessionStartInfoForServerSideVetoesEnabled&&this.bt.sessionStartJson&&(i=i+',"SessionStartInfoJson":'+JSON.stringify(this.bt.sessionStartJson));var r=tt(1,i,this.bt.requestOptions,{IsRemoveSsrEnabled:this.shouldDisableSSR()});return nt(this.bt.requestOptions.url+"OneNote.ashx"+(n?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),r,this.bt,t,et)},t.prototype.makeRenderPageRequest=function(t){if(!this.bt.isNewFile||!this.bt.optimizedForNewFile){var n=tt(46,"",this.bt.requestOptions,t);nt(this.bt.requestOptions.url+"OneNote.ashx?IsRenderPage=1",n,this.bt,this.pt,(function(){}))}},t.prototype.makeStartSessionRequest=function(t,n){nt(this.bt.requestOptions.url+t,"",this.bt,n,(function(){}))},t.getCellsFromFrameRequest=function(t){f.g_initialRequestCompleted||(it(t,!0),f.g_fastViewOpenTime=new Date)},t}();function tt(t,n,e,i){var r=JSON.stringify(e.rootQuerySignature);r&&(r=r.substring(1,r.length-1));var o=JSON.stringify(e.pageTarget);o&&(o=o.substring(1,o.length-1));var a='{"Mode":'+e.requestHeadMode+',"srs":[[',s=',{"FileId":"'+r+'","PageTarget":"'+o+'","OperationId":1';for(var u in i)s+=',"'+u+'":'+i[u];return a+t+s+n+"}]]}"}function nt(t,n,e,i,r){var o=new XMLHttpRequest,a={};for(var s in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){},o=void 0)}}},o.open("Post",t,!0),function(t,n){var e=n.requestOptions;t["X-xhr"]="1",e.userSessionId&&(t["X-UserSessionId"]=e.userSessionId);e.buildVersion&&(t["X-OfficeVersion"]=e.buildVersion);t["Content-Type"]="application/json; charset=utf-8",e.canary&&(t["X-Key"]=e.canary);e.accessToken&&(t["X-AccessToken"]=e.accessToken);e.accessTokenTtl&&(t["X-AccessTokenTtl"]=e.accessTokenTtl);e.userType&&(t["X-UserType"]=e.userType);1===e.logHostRequests&&(t["X-LogHostRequests"]="1");e.wacCluster&&(t["X-WacCluster"]=e.wacCluster);e.wacUserAgent&&(t["X-WacUserAgent"]=e.wacUserAgent);e.renderingMode&&(t["X-ServerSideRendering"]=e.renderingMode);e.feMachineId&&(t["X-FEMachineId"]=e.feMachineId);n.sessionStartJson&&(t["X-SessionStartDimensions"]=function(t){if(!t||"UNKNOWN"===t)return t;var n={},e=JSON.parse(t);return n.Application=e.Application,n.ApplicationVersion=e.ApplicationVersion,n.Browser=e.Browser,n.BrowserMajorVersion=e.BrowserMajorVersion,n.BrowserVersion=e.BrowserVersion,n.Host=e.Host,n.IsSynthetic=e.IsSynthetic,n.Os=e.Os,n.Ring=e.Ring,n.RoutedVia=e.RoutedVia,n.SessionOrigin=e.SessionOrigin,n.UiHost=e.UiHost,n.UserSessionApplicationMode=e.UserSessionApplicationMode,n.WACDatacenter=e.WACDatacenter,JSON.stringify(n)}(n.sessionStartJson));t["X-Requested-With"]="XMLHttpRequest"}(a,e),a)o.setRequestHeader(s,a[s]);var u=n;return n||(u=""),r(),o.send(u),o}function et(){f.g_initialRequestInvokedTime=new Date,f.g_initialRequestMade=!0,F("InitialRequestStart")}function it(t,n){f.g_getCellsFromFrameRequest=n,f.g_initialRequestCompleted=!0,f.g_initialResponseTime=new Date,F("InitialRequestEnd"),F("InitialResponseProcessStart"),N("InitialRequest","InitialRequestStart","InitialRequestEnd");var e=rt(t);if(f.g_initialRequestResponseObject=e,e&&e.Responses&&e.Responses[0]&&e.Responses[0][1]){var i=e.Responses[0][1];f.g_acquireLockStartTime=i.AcquireLockStartTime,f.g_acquireLockEndTime=i.AcquireLockEndTime,f.g_acquireLockRequestStatus=i.AcquireLockRequestStatus,f.g_getDocumentStartTime=i.GetDocumentStartTime,f.g_getDocumentEndTime=i.GetDocumentEndTime,f.g_getDocumentRequestStatus=i.GetDocumentrequestStatus,f.g_getCellsStartTime=i.GetCellsStartTime,f.g_getCellsEndTime=i.GetCellsEndTime,f.g_getInitializeLocalCobaltStartTime=i.InitializeLocalCobaltStartTime,f.g_getInitializeLocalCobaltEndTime=i.InitializeLocalCobaltEndTime}f.g_initialResponseReadyTime=new Date,F("InitialResponseProcessEnd"),N("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")}function rt(t){try{return JSON.parse(t)}catch(t){h.fastBootError="JSON.parse failed: "+t.message+"\r\n"+t.stack}}function ot(){var t=window.performance;return t&&t.timeOrigin?t.timeOrigin:t&&t.timing&&t.timing.navigationStart?t.timing.navigationStart:0}function at(){var t=window.performance;return t&&t.now?t.now():(new Date).getDate()-ot()}function st(){var t=window.performance;return t&&t.now?ot()+t.now():(new Date).getDate()}function ut(t){return ot()+t}function ct(t,n){void 0===window.wacPerfObserver&&(window.wacPerfObserver={}),window.wacPerfObserver[t]=n}function lt(t){t.disconnect(),ct("timeOrigin",ot()),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window.wacPerfObserver))}function dt(){E()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((function(t){t.getEntries().forEach((function(t){"first-paint"===t.name?ct("firstPaint",t.startTime):"first-contentful-paint"===t.name&&ct("firstContentfulPaint",t.startTime)}))})).observe({type:"paint",buffered:!0}),E()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((function(t){var n=t.getEntries();ct("largestContentfulPaint",n[n.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(E()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("element"))var t=new PerformanceObserver((function(n){n.getEntries().forEach((function(t){ct("elementPaint_"+t.id,t.startTime)})),t.observe({type:"element",buffered:!0})}))}()}var ft=function(){return(ft=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};Object.create;function ht(t,n,e){if(e||2===arguments.length)for(var i,r=0,o=n.length;r<o;r++)!i&&r in n||(i||(i=Array.prototype.slice.call(n,0,r)),i[r]=n[r]);return t.concat(i||Array.prototype.slice.call(n))}Object.create;function vt(t){return"visually-ready"===t||"functionally-ready"===t||"visually-perceived"===t}function pt(t,n){var e;for(var i in t)if(!(null===(e=t[i].states[n])||void 0===e?void 0:e.final))return!1;return!0}function mt(t,n){return n&&t&&vt(n)&&t.states[n]}function bt(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];console.error.apply(console,ht(["[RumShepherd]"+t],n))}function wt(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];console.info.apply(console,ht(["[RumShepherd]"+t],n))}function gt(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];console.debug.apply(console,ht(["[RumShepherd]"+t],n))}var St=function(t,n){try{var e=new CustomEvent(t,{detail:n});self.dispatchEvent(e)}catch(t){bt("dispatchRumShepherdEvent failed with exception:",t)}},Ct=[];function Rt(t,n,e,i){var r,o="[rum:"+Number(at().toFixed())+"]"+n+" "+(e?JSON.stringify(e):"");Ct.push({level:t,message:o}),i&&(r={traces:ht([],Ct)},Ct=[],St("Wac-AppLoadTrace",r))}function kt(t){return t?ft({},t):{}}function xt(t){var n=[];for(var e in t){var i=t[e];n.push({id:i.id,rootElementId:i.rootElementId,subComponents:yt(i.subComponents)})}return n}function yt(t){var n=[];for(var e in t){var i=t[e];n.push({id:i.id,initTime:ut(i.initTime),optional:i.optional,unused:i.unused,states:Pt(i.states)})}return n}function Pt(t){var n={};for(var e in t){var i=t[e];(null==i?void 0:i.time)&&(n[e]=ut(i.time))}return n}function Ot(t,n){var e=t.subComponents;for(var i in e){var r=e[i];if(!(r.states[n]||r.unused))return!1}return!0}function At(t){var n=Number.POSITIVE_INFINITY;for(var e in t.subComponents){var i=t.subComponents[e];n=Math.min(n,i.initTime)}return n}function It(t,n){if(!t)return!1;var e=t.states[n];return t.optional||(null==e?void 0:e.time)&&e.promotedFromPreviousState}function Wt(t,n){return"visually-ready"===n&&mt(t,"visually-perceived")}function Et(t,n){return{start:t.start,time:null!=n?n:t.time,error:t.error,monitor:t.monitor,measures:kt(t.measures),data:kt(t.data)}}function Lt(t,n,e,i){"then"in t?t.then((function(t){i(t)})).catch((function(t){var r="Error in invokeMonitor ["+e+"}]";bt(r,t),i({start:n,time:n,monitor:"",error:r+": "+t})})):i(t)}var Ft=function(){function t(t){this.wt=null!=t?t:{}}return t.prototype.getBooleanSetting=function(t,n){var e=this.wt[t];if(!e)return n;switch(e.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return n}},t.prototype.getStringSetting=function(t,n){var e=this.wt[t];return e||n},t}();function Nt(t,n){var e={type:"RUM_TRACE",payloadJson:JSON.stringify(t)};!function(t,n,e){if(""!==n){var i=window.navigator;if(i&&i.sendBeacon)i.sendBeacon(n,t);else{var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",n,e),r.send(t))}}}(JSON.stringify(e),n,!0)}var Dt=function(){function t(t){var n=this;this.timeoutInMs=t,this.gt="",this.St=function(t){n.gt||(n.gt=t?"timeout":"cancelled",n.Ct&&n.Ct())},this.cancel=function(){n.St(!1)},t>0&&window.setTimeout((function(){return n.St(!0)}),t)}return Object.defineProperty(t.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reason",{get:function(){return this.gt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCancelled",{set:function(t){this.Ct=t},enumerable:!1,configurable:!0}),t}();function Tt(t){return new Dt(null!=t?t:0)}var Mt=e(12),Bt=function(){function t(t){var n=this;this.Rt={},this.kt={},this.xt=0,this.yt=t,function(t){var n="hidden"===document.visibilityState?0:1/0;t(n),document.addEventListener("visibilitychange",(function(e){n=Math.min(n,e.timeStamp),t(n)}),{once:!0})}((function(t){return n.xt=t}))}return Object.defineProperty(t.prototype,"tabHideTime",{get:function(){return this.xt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.Rt},enumerable:!1,configurable:!0}),t.prototype.startMonitors=function(t,n){var e=this;Rt(Mt.a.Verbose,"startMonitors",{appState:t});var i=function(t,i){if(Rt(Mt.a.Verbose,"onCompleteWithInputCheck",{metric:t}),i){if(!i.error){var r=e.Rt["first-input"]?e.Rt["first-input"].time:0,o=e.Rt["first-interaction"]?e.Rt["first-interaction"].time:0;r>0&&r<i.time&&(0===o||r<=o)&&(i.error="first-input"),o>0&&o<i.time&&(i.error="first-interaction")}n(t,i)}};"visually-ready"===t&&(this.monitorMetric("first-input",n),this.monitorMetric("first-interaction",n),this.monitorMetric("first-idle",i),this.monitorMetric("stable-interactivity",i,12e4))},t.prototype.cancelMonitors=function(t){var n=this;if("visually-ready"===t){Rt(Mt.a.Info,"cancelAppStateMonitors",t);var e=function(t){var e;null===(e=n.kt[t])||void 0===e||e.cancel(),n.kt[t]=void 0,n.Rt[t]=void 0};e("stable-interactivity"),e("first-idle")}},t.prototype.monitorMetric=function(t,n,e){if(Rt(Mt.a.Verbose,"monitorMetric",t),this.kt[t])Rt(Mt.a.Verbose,"monitorMetric:already-running",t);else{var i=Tt(e);this.kt[t]=i;var r=at();Lt((0,this.yt.monitors[t])(r,i),r,t,(function(e){Rt(Mt.a.Verbose,"monitorMetric:complete",t),n(t,e)}))}},t}();function Vt(t,n,e){t.states[n]={result:Et(e),monitoring:void 0,final:Ot(t,n)}}var jt=function(){function t(t){var n=this;this.Pt={},this.Ot={},this.At=function(t){if(n.Ot[t])return!1;var e=pt(n.Pt,t);return Rt(Mt.a.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:t,isFinal:e}),e},this.It=function(t){if("stable-interactivity"===t||"first-idle"===t){var e=n.Wt.metrics[t],i=pt(n.Pt,"visually-ready");return Rt(Mt.a.Verbose,"canMonitorMetricBeReported:si-error:",{metric:t,error:null==e?void 0:e.error,vrStateFinal:i}),!!e&&"cancelled"!==e.error&&i}return!0},this.Et=function(t){var e=n.Ot[t],i=n.It(t);!e&&i?n.Lt(t):Rt(Mt.a.Info,"reportMonitorMetricIfReady:not-ready",{metric:t,isReported:e,canMetricBeReported:i})},this.Ft=function(t){n.At(t)&&n.Lt(t)},this.Lt=function(t){try{var e=n.Wt.metrics[t],i={metric:t,timeOrigin:n.Nt,time:e.time,error:e.error||(n.Wt.tabHideTime<e.time?"tab-switch":void 0),monitor:e.monitor,measures:kt(e.measures),data:kt(e.data),auxMetrics:[],componentsData:xt(n.Pt)},r=i.measures;if(r.tabsSwitch=n.Wt.tabHideTime<e.time?n.Wt.tabHideTime:0,r.start=e.start,r.reportedTime=at(),"stable-interactivity"===t){var o=n.Wt.metrics["visually-ready"];r["visually-ready"]=o?o.time:0;var a=n.Wt.metrics["functionally-ready"];r["functionally-ready"]=a?a.time:0}if(vt(t)){for(var s in n.Pt){var u=n.Pt[s],c=u.states[t].result;r[s]=c.time,i.error=i.error||c.error;var l={metric:t+"-"+s,time:c.time,monitor:c.monitor,error:c.error,measures:kt(c.measures)};l.measures.start=c.start,l.measures.init=At(u),i.auxMetrics.push(l)}var d=n.Wt.metrics["stable-interactivity"];d&&d.error&&"cancelled"!==d.error&&!i.error&&(i.error="si-error")}n.yt.appLoadMetricReportCallback&&(n.Ot[t]=!0,Rt(Mt.a.Info,"reportMetric:reporting",t,!0),n.sendTraceViaRemoteTelemetry("Reporting app report with: "+JSON.stringify(i)),n.yt.appLoadMetricReportCallback(i))}catch(t){Rt(Mt.a.Error,"reportMetric:error",t),bt("_reportMetricIfReady:",t)}},this.Dt=function(){var t,e={time:st(),allMetricsReported:(t=n.Ot,!!(t["visually-ready"]&&t["functionally-ready"]&&t["stable-interactivity"]&&t["first-input"]&&t["first-interaction"]&&t["first-idle"])),metrics:n.Wt.metrics,components:xt(n.Pt),timeOrigin:ot()};n.sendTraceViaRemoteTelemetry("Reporting app load state with: "+JSON.stringify(e)),n.yt.appLoadStateLoggingCallback(e)},this.Tt=function(t,e,i,r,o){if(mt(e,o)){var a=e.states[o];e.states[i]={time:a.time,promotedFromPreviousState:!0}}else e.states[i]={time:r,promotedFromPreviousState:!1};if(Rt(Mt.a.Verbose,"processSubComponentState",{component:t.id,subComponent:e.id,state:i}),function(t,n){var e=t.subComponents;for(var i in e){var r=e[i].states[n];if(!((null==r?void 0:r.time)||e[i].optional||Wt(e[i],n)))return!1}return!0}(t,i)){var s=function(t,e){e&&(Rt(Mt.a.Info,"processSubComponentState:complete-monitor-metric",t),n.metrics[t]=Et(e),n.Et(t))},u=function(t,e){var i=function(t,n){var e,i,r=0;for(var o in t){var a=null===(i=null===(e=t[o].states[n])||void 0===e?void 0:e.result)||void 0===i?void 0:i.time;if(!a)return;r=Math.max(r,a)}return r}(n.Pt,t);Rt(Mt.a.Verbose,"processSubComponentState:appStateTime",{time:i,state:t}),i&&(!function(t,e,i){e&&(Rt(Mt.a.Info,"processSubComponentState:complete-appstate-metric",t),n.metrics[t]=Et(e,i),n.Ft(t))}(t,e,i),n.Wt.startMonitors(t,s))};if(n.Wt.cancelMonitors(i),mt(e,o)&&function(t,n){if(n&&t&&t.states[n]){var e=t.states[n];return(null==e?void 0:e.result)&&(null==e?void 0:e.final)}return!1}(t,o)&&function(t,n){if(!t||!n)return!1;var e=t.subComponents;for(var i in e)if(!It(e[i],n))return!1;return!0}(t,i)){var c=t.states[o];return Vt(t,i,c.result),void u(i,c.result)}var l=n.yt.monitors[i];Rt(Mt.a.Verbose,"processSubComponentState:start-monitor",{state:i}),function(t,n,e,i){var r=t.states[n];if(!(null==r?void 0:r.final)){(null==r?void 0:r.monitoring)&&(null==r||r.monitoring.cancel());var o=at(),a=Tt(5e3);t.states[n]={monitoring:a,final:Ot(t,n)},Lt(e(o,a,t),o,n,i)}}(t,i,l,(function(n){Rt(Mt.a.Verbose,"processSubComponentState:monitor-complete",{state:i}),Vt(t,i,n),u(i,n)}))}else Rt(Mt.a.Verbose,"processSubComponentState:component-not-ready",{component:t.id,state:i})},this.Mt=function(t,e){for(var i in Rt(Mt.a.Verbose,"processSubComponentUnused",{subComponent:e.id}),e.unused=!0,t.states){var r=i,o=t.states[r];!o.final&&Ot(t,r)&&(Rt(Mt.a.Verbose,"processSubComponentUnused:unused-final",{component:t.id,state:r}),gt("Unused set final:",t.id,r),o.final=!0,n.Ft(r))}n.Et("stable-interactivity"),n.Et("first-idle")},this.Bt=function(t,n,e,i){e?t.ignoredSubComponents[n]=!0:t.subComponents[n]||(t.subComponents[n]={id:n,initTime:at(),optional:i,unused:!1,states:{}})},Rt(Mt.a.Info,"initialize"),wt("RumShepherd:initialize"),this.Nt=Number(ot().toFixed()),this.yt=ft({},t),this.Wt=new Bt(this.yt),this.Vt=new Ft(this.yt.appSettings),this.sendTraceViaRemoteTelemetry("Initializing RumShepherd");for(var e=0,i=t.components;e<i.length;e++){var r=i[e];this.Pt[r.id]={id:r.id,rootElementId:r.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}window.setTimeout((function(){return n.Dt()}),12e4)}return t.prototype.sendTraceViaRemoteTelemetry=function(t){if(this.Vt.getBooleanSetting("RumShepherdRemoteTelemetryLoggingIsEnabled",!1)){var n=this.Vt.getStringSetting("RemoteTelemetryUrl","");Nt({time:st(),sessionId:this.Vt.getStringSetting("SessionId",""),message:t},n)}},t.prototype.addSubComponents=function(t){if(t&&t.component&&t.subComponents){var n=this.Pt[t.component];if(n){var e=n.ignoreNewSubComponents;if(function(t){for(var n in t.states)if(t.states[n].final)return!1;return!0}(n)||e){Rt(Mt.a.Verbose,"addSubComponents",{ignore:e,data:t}),gt("addSubComponents:",e,t);try{for(var i=Array.isArray(t.subComponents)?t.subComponents:[t.subComponents],r=0;r<i.length;r+=1)this.Bt(n,i[r],e,!1);if(t.optionalSubComponents)for(r=0;r<t.optionalSubComponents.length;r+=1)this.Bt(n,t.optionalSubComponents[r],e,!0)}catch(t){bt("addSubComponents",t)}}else bt("Component cannot be modified",t)}else bt("Invalid component",t)}else bt("Invalid data",t)},t.prototype.setSubComponentState=function(t){var n,e=at();if(t&&t.subComponent&&t.component&&t.state){var i=this.Pt[t.component];if(i){if(!i.ignoredSubComponents[t.subComponent]){i.ignoreNewSubComponents=i.ignoreNewSubComponents||!!t.ignoreNewSubComponents;var r=i.subComponents[t.subComponent];if(r)if(gt("setSubComponentState:",t),"unused"!==t.state){var o=t.state;if(vt(o))if(null===(n=i.states[o])||void 0===n?void 0:n.final)bt("Component state final. Can't set",t);else if(r.unused||r.states[o])bt("SubComponent unused or set",t);else{var a=t.promoteStateFrom;this.Vt.getBooleanSetting("RumShepherdStagePromotionIsEnabled",!1)&&a?this.Tt(i,r,o,e,a):this.Tt(i,r,o,e)}else bt("Unknown state reported",t)}else this.Mt(i,r);else bt("Unexpected sub-component",t)}}else bt("Invalid component",t)}else bt("Invalid data",t)},Object.defineProperty(t.prototype,"components",{get:function(){return this.Pt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.Wt.metrics},enumerable:!1,configurable:!0}),t}();function _t(t,n,e,i){if(L("element")){var r="testimg-"+e,o=function(t){var n=document.createElement("img");if(t){if(!("elementTiming"in n))return;n.elementTiming=t}return n.style.position="absolute",n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",n}(r);if(o){var a=null!=i?i:document.documentElement;return new Promise((function(e){var i=function(n,i){void 0===n&&(n=0),s&&s.disconnect(),e({start:t,time:n,monitor:"image-paint-api",error:i})},s=new PerformanceObserver((function(t){for(var n=0,e=t.getEntries();n<e.length;n++){var s=e[n];if(s.identifier===r){try{a.removeChild(o)}catch(t){bt("measureImagePaintTime",t)}return void i(s.renderTime)}}}));n.onCancelled=function(){return i(0,n.reason)},s.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}function Ht(t,n){return window.requestAnimationFrame?new Promise((function(e){var i,r=function(r){void 0===r&&(r=0),cancelAnimationFrame(i),e({start:t,time:r,monitor:"rAF",error:n.reason})};n.onCancelled=r,i=requestAnimationFrame((function(){r(at())}))})):Promise.resolve({start:t,time:0,monitor:"",error:"rAF Unsupported"})}function Ut(t,n){return new Promise((function(e){var i,r,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(i),clearTimeout(r),e({start:t,time:o,monitor:"rAF-setTimeout",error:n.reason})};n.onCancelled=function(){return o()},i=requestAnimationFrame((function(){r=window.setTimeout((function(){o(at())}),0)}))}))}function qt(t,n,e){void 0===e&&(e=1e3);var i=n||Tt(12e3);if(!L("longtask"))return function(t,n){var e=at();if(!window.requestAnimationFrame)return Promise.resolve({start:e,time:0,monitor:"",error:"rAF unsupported"});var i=at(),r=0,o=i,a=0,s=0,u=i;return new Promise((function(i){var c,l=function(n){void 0===n&&(n=0),cancelAnimationFrame(c);var o={start:e,time:n,monitor:"long-frames",error:t.reason,measures:{longTasksCount:r,longestTaskDuration:s,longTasksDuration:a}};i(o)};t.onCancelled=l;var d=function(t){var e=t-o,i=t-u;u=t,i>=50&&(e=0,a+=i,r+=1,o=t,s=Math.max(s,i)),e>=n?l(o):c=window.requestAnimationFrame(d)};c=window.requestAnimationFrame(d)}))}(i,e);var r=performance.now(),o=0,a=r,s=0,u=0;return new Promise((function(n){var r,c=function(){clearTimeout(r),l&&l.disconnect();var e=at()-t,c={start:t,time:a,monitor:"longtask-api",error:i.reason,measures:{longTasksDuration:s,longTasksCount:o,longestTaskDuration:u,monitoredTime:e}};n(c)};i.onCancelled=c;var l=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){o+=1,s+=t.duration;var n=t.startTime+t.duration;a=Math.max(n,a),u=Math.max(u,t.duration)}))}));l.observe({entryTypes:["longtask"]});var d=function(){var t=performance.now()-a;if(t>=e)c();else{var n=e-t;r=window.setTimeout(d,n)}};r=window.setTimeout(d,e)}))}function zt(t,n){return L("first-input")?new Promise((function(e){var i,r=function(n,r,o){i&&i.disconnect(),e({start:t,time:n,monitor:"first-input-api",error:o,measures:{fid:r}})};try{n.onCancelled=function(){return r(0,0,n.reason)};(i=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){return function(t){var n=t.processingStart,e=n-t.startTime;r(n,e)}(t)}))}))).observe({type:"first-input",buffered:!0})}catch(t){r(0,0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"FID unsupported"})}function Jt(t,n){var e=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],i={passive:!0,capture:!0},r=st();return new Promise((function(o){var a=function(e,i,r){u(removeEventListener);var a={start:t,time:e,monitor:"first-interaction",error:n.reason,data:{eventName:i},measures:{delay:r}};o(a)};n.onCancelled=function(){return a(0,"",0)};var s=function(t){if(t.cancelable){var n=st(),e=t.timeStamp>1e12,i=(e?st():performance.now())-t.timeStamp;(i<0||i>n-r)&&(i=0),a(e?t.timeStamp-ot():t.timeStamp,t.type,i)}},u=function(t){e.forEach((function(n){t(n,s,i)}))};u(addEventListener)}))}function Gt(t,n){return window.requestIdleCallback?new Promise((function(e){var i,r=function(n,r){window.cancelIdleCallback(i),e({start:t,time:n,monitor:"first-idle",error:r})};try{i=window.requestIdleCallback((function(t){return r(at(),t.didTimeout?"timeout":"")}),{timeout:n.timeout}),n.onCancelled=function(){return r(0,n.reason)}}catch(t){r(0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var Xt=0,Kt=function(t){wt("report "+t.metric+":"+t.time+"ms",t);var n=new CustomEvent("Wac-AppLoadMetricReport",{detail:t});self.dispatchEvent(n)},Qt=function(t){wt("reporting the application load state at epoch time: "+t.time+"; with the status of all metrics reported as "+t.allMetricsReported);var n=new CustomEvent("Wac-AppLoadStateReport",{detail:t});self.dispatchEvent(n)},Zt=function(t,n,e){if(e){var i="vr-"+e.id+"-"+Xt;Xt+=1;var r=document.documentElement;return function(t,n,e,i){var r=i?_t(t,n,e,i):void 0;return r||(r=Ht(t,n)),r}(t,n,i,null!=r?r:void 0)}return Ht(t,n)};function Yt(t,n){var e=new jt({appLoadMetricReportCallback:Kt,appLoadStateLoggingCallback:Qt,appSettings:n,monitors:{"visually-ready":Zt,"visually-perceived":Zt,"functionally-ready":Ut,"stable-interactivity":qt,"first-input":zt,"first-interaction":Jt,"first-idle":Gt},components:t});window.addEventListener("Wac-SubComponentsInit",(function(t){var n=t.detail;e.addSubComponents(n)})),window.addEventListener("Wac-SubComponentSetLoadState",(function(t){var n=t.detail;e.setSubComponentState(n)}))}var $t;function tn(t,n){if(n){"true"===t.WacPerfObserverEntriesIsEnabled&&(dt(),window.addEventListener("WacAppInteractive",(function(){!function(t,n){if(void 0===t&&(t=[5e3]),void 0===n&&(n=12e4),E()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("longtask")&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("first-input")&&0!==t.length){var e=performance.now(),i=0,r=e,o=0,a=void 0,s=void 0,u=0,c=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if("longtask"===t.entryType){i+=1,o+=t.duration;var n=t.startTime+t.duration;r=n>r?n:r}else"first-input"===t.entryType&&(a=t.processingStart,s=a-t.startTime)}))}));c.observe({entryTypes:["longtask","first-input"]});var l=function(){var d=performance.now(),f=d-r;if(s)ct("firstInputProcessingStart",a),ct("FID",s),lt(c);else{for(;u<t.length;u+=1){var h=t[u];if(!(f>=h-10))break;ct("TTSI_"+h,r),ct("longTaskCount_"+h,i),ct("totalLongTasksDuration_"+h,o)}var v=d-e;if(u<t.length&&v<n){var p=t[u]-f;setTimeout(l,p)}else lt(c)}};t.sort((function(t,n){return t-n})),setTimeout(l,t[0])}}([500,1e3,2e3,3e3,5e3])})));var i="true"===t.HideHeaderEmbedded;if("true"===t.RumShepherdIsEnabled){var r=[{id:"ribbon",rootElementId:"WACRibbonPanel"},{id:"canvas"}];i||r.push({id:"header",rootElementId:"AppHeaderPanel"}),Yt(r,function(t){return{RumShepherdRemoteTelemetryLoggingIsEnabled:t.RumShepherdRemoteTelemetryLoggingIsEnabled,RumShepherdStagePromotionIsEnabled:t.RumShepherdStagePromotionIsEnabled,RemoteTelemetryUrl:t.RemoteTelemetryUrl,SessionId:t.SessionId}}(t))}var o="true"===t.IsRegionComposerEnabled;if(o){var a=e(6);a.initializeWindowUtil(o),o=a.shouldUseRegionComposer()}C.ensureCookieCompliance("true"===t.MSCCEnabled,t.MSCCCookies);var s=Z(t,2,!0),u=new G("true"!==t.BootReadOnlyUx,!0,!0,!1,t,o),c=new $(u,s),l=c.makeGetCellsRequest((function(t){c.onGetCellsRequestCompleted(t),c.onInitialResponseReady()}),!0);s.getCachedSSR&&!c.shouldDisableSSR()&&c.makeRenderPageRequest({});var d="true"===t.WordSkeletalRibbonIsEnabled||"earlydismiss"===t.WordIsSkeletalRibbonOn||"latedismiss"===t.WordIsSkeletalRibbonOn,f="true"===t.WordIsSkeletalDeepLinkOn&&"true"===t.IsDeepLinkScenario;if((d||f)&&M.initialize(f),d&&!G.isReactMultilineRibbonVisible(t))if("false"!==C.getCookie("WordIsSimplifiedRibbonOn")){var h=G.isDarkModePreferenceOn(t),v=!1,p=C.getCookie(t.ModernUxExperimentPreferenceCookieName).toLowerCase();if(""===p)v=!("true"===t.ModernUxExperimentDefaultOffIsEnabled.toLowerCase());else v="false"!==p;var m="true"===t.SharedUXThemingIsEnabled&&"true"===t["Microsoft.Office.WordOnline.ModernUxExperimentOne"]&&v;M.addComponent(function(t,n,e){var i=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],r=document.createElement("div");r.id="SkeletalRibbon",r.className=r.id,r.style.marginTop=e?"0":"48px";var o=document.createElement("div");o.id="ribbonContent",o.className=o.id,o.style.backgroundColor=n,o.style.height="76px",o.style.transition="opacity 0.1s",o.style.borderBottom="none",o.style.width="100%",o.style.minWidth="640px",o.setAttribute("unselectable","on");var a=document.createElement("div");a.id="topbar",a.className="topbar",a.style.height="38px",a.style.width="100%",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between";var s=document.createElement("div");s.style.height="16px",s.style.display="flex",s.style.justifyContent="flex-start";for(var u=[],c=0;c<=14;c+=1)u[c]=document.createElement("div"),u[c].style.backgroundColor=t,u[c].style.borderRadius="2px",u[c].style.height="100%",u[c].style.marginLeft="8px",u[c].style.marginRight="8px",u[c].style.outline="transparent",u[c].style.border="1px solid transparent",u[c].style.width=i[c];var l=document.createElement("div");l.style.height="24px",l.style.display="flex";var d=[];for(c=0;c<4;c+=1)d[c]=document.createElement("div"),d[c].style.width="24px",d[c].style.borderRadius="50%",d[c].style.backgroundColor=t,d[c].style.marginLeft="4px",d[c].style.marginRight="4px",d[c].style.outline="transparent",d[c].style.border="1px solid transparent",l.appendChild(d[c]);l.appendChild(u[7]),l.appendChild(u[8]);var f=document.createElement("div");f.id="bottombar",f.className="bottombar",f.style.height="38px",f.style.width="100%",f.style.display="flex",f.style.alignItems="center";var h=document.createElement("div");for(h.style.height="22px",h.style.display="flex",h.style.width="100%",c=0;c<=6;c+=1)s.appendChild(u[c]);for(c=9;c<=14;c+=1)h.appendChild(u[c]);var v=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];for(p(),c=0;c<v.length;c+=1)v[c].addListener(p);function p(){v[0].matches?(u[7].style.width="32px",u[8].style.width="32px",u[6].style.display="none",u[5].style.display="none"):v[1].matches?(u[7].style.width="32px",u[8].style.width="32px",u[6].style.display="none"):v[2].matches&&(u[7].style.width="32px",u[8].style.width="32px")}var m=document.createElement("div");return m.id="highContrastCover",m.className=m.id,m.style.height="4px",m.style.backgroundColor="rgba(0, 0, 0, 0)",a.appendChild(s),a.appendChild(l),f.appendChild(h),o.appendChild(a),o.appendChild(f),r.appendChild(o),r.appendChild(m),{isReady:!1,element:r}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(M.getSkeletalComponentColor(h,m),M.getSkeletalBackgroundColor(h,m),i))}return(d||f)&&M.launchExperience(),l}}function nn(t){var n=document.getElementById("WACFastView"),e=n.querySelector(".WACViewPanel"),i=n.querySelector(".OutlineContainer"),r=n.querySelector(".Outline"),o=n.querySelector(".PageContentOrigin");i&&(i.style.minHeight="0",i.style.left="-140px"),e&&(e.style.overflow="hidden"),o&&(o.style.top="-1px",o.style.width="calc(100% - "+function(){var t=document.createElement("div");t.style.visibility="hidden",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t);var n=document.createElement("div");t.appendChild(n);var e=t.offsetWidth-n.offsetWidth;return t.parentNode.removeChild(t),e}()+"px)");var a=document.createElement("div");return a.id="SkeletalPage",a.className=a.id,a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.left="0",a.style.right="0",a.style.top="0",a.style.zIndex="1",a.style.backgroundColor="window",a.appendChild(function(t){var n=document.createElement("div");n.id="SkeletalCanvas",n.className=n.id,n.style.width="100%",n.style.height="100%",n.style.overflow="hidden",n.style.position="relative";var e=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",e&&(i.style.paddingLeft=e.style.paddingLeft,i.style.paddingRight=e.style.paddingRight,i.style.paddingTop=e.style.paddingTop);for(var r=[],o=0;o<2;o+=1)r[o]=document.createElement("div"),r[o].style.backgroundColor=t,r[o].style.height="18px",r[o].style.marginBottom="16px";r[0].style.width="150px",r[1].style.width="220px";var a=[];for(o=0;o<21;o+=1)a[o]=document.createElement("div"),a[o].style.backgroundColor=t,a[o].style.height="14px",a[o].style.marginBottom="6px";a[0].style.width="92%",a[1].style.width="100%",a[2].style.width="93%",a[3].style.width="80%",a[3].style.marginBottom="16px",a[4].style.width="92%",a[5].style.width="100%",a[6].style.width="55%",a[6].style.marginBottom="16px",a[7].style.width="95%",a[8].style.width="38%",a[8].style.marginBottom="26px",a[9].style.width="90%",a[10].style.width="100%",a[11].style.width="98%",a[12].style.width="100%",a[13].style.width="33%",a[13].style.marginBottom="16px",a[14].style.width="91%",a[15].style.width="90%",a[16].style.width="100%",a[17].style.width="85%",a[17].style.marginBottom="40px",a[18].style.width="92%",a[19].style.width="100%",a[20].style.width="93%",i.appendChild(r[0]);for(o=0;o<=17;o+=1)i.appendChild(a[o]);i.appendChild(r[1]);for(o=18;o<=19;o+=1)i.appendChild(a[o]);return n.appendChild(i),n}(t)),a.appendChild(function(t){var n=document.createElement("div");n.id="SkeletalFloaties",n.className=n.id,n.style.position="absolute",n.style.top="20px",n.style.right="-300px",n.style.width="270px";for(var e=[],i=0;i<3;i+=1){e[i]=document.createElement("div"),e[i].id="SkeletalFloatie",e[i].className=e[i].id,e[i].style.boxSizing="border-box",e[i].style.position="relative",e[i].style.width="100%",e[i].style.backgroundColor="window",e[i].style.padding="15px",e[i].style.paddingBottom="22px",e[i].style.marginBottom="14px";var r=document.createElement("div");r.id="SkeletalTitle",r.className=r.id,r.style.backgroundColor=t,r.style.width="42%",r.style.height="18px",r.style.borderRadius="2px",r.style.marginBottom="11px";for(var o=[],a=0;a<3;a+=1)o[a]=document.createElement("div"),o[a].id="SkeletalParagraph",o[a].className=o[a].id,o[a].style.marginTop="6px",o[a].style.backgroundColor=t,o[a].style.height="14px",o[a].style.borderRadius="2px",o[a].style.width="100%";o[0].style.width="100%",o[1].style.width="85%",o[2].style.width="70%",e[i].appendChild(r);for(var s=0;s<3;s+=1)e[i].appendChild(o[s]);n.appendChild(e[i])}return n}(t)),r&&(r.style.overflow="visible",r.appendChild(a)),{isReady:!1,element:a}}var en=function(){function t(t,n,e){this.success=t,this.errorCode=n,this.extraErrorInfo=e}return t.createSuccess=function(){return new t(!0)},t.createFailure=function(n,e){return new t(!1,n,e)},t}(),rn=function(){function t(t){this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=t,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}return t.getWindow=function(){return window},t.prototype.launchFastView=function(n,i,r,o){void 0===r&&(r=!1),void 0===o&&(o=1),t.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),h.fastView&&h.fastView.isOpen()&&this.log("FastView was already opened");var a="true"===this.instantAppSettings.IsRegionComposerEnabled;a&&(a=e(6).shouldUseRegionComposer());var s=new G(!0,!0,!0,!1,this.instantAppSettings,a).launchFastView(n,"WordEditorInstantApp",i,!1,r,o),u="true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario,c=G.isDarkModePreferenceOn(this.instantAppSettings),l=!1,d=C.getCookie(this.instantAppSettings.ModernUxExperimentPreferenceCookieName).toLowerCase();""===d?l=!("true"===this.instantAppSettings.ModernUxExperimentDefaultOffIsEnabled.toLowerCase()):l="false"!==d;var f="true"===this.instantAppSettings["Microsoft.Office.WordOnline.ModernUxExperimentOne"]&&l;if(u&&s)return M.addComponentOutsideSkeletalContainer(nn(M.getSkeletalComponentColor(c,f))),void M.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&s&&this.addSkeletalParagraph(c,f)},t.prototype.trackOfficeServerDiagnostics=function(t){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=t},t.prototype.sendAppFailedMessage=function(n){this.sendPostMessageToParentWindow(t.toJsApiAppFailed,{Error:{errorType:n}},"*")},t.prototype.signalReady=function(){var t=this;window.addEventListener("message",(function(n){t.receivePostMessage(n)}),!1),this.sendReadyMessage();var n=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);n||(n=1e4),window.setTimeout((function(){return t.timeoutWopiPendingSessionMessage()}),n)},t.prototype.startWacBoot=function(t){var n=t||this.instantAppSettings;this.getCellsConnection=tn(n,!0)},t.prototype.abortGetCellsConnection=function(){this.getCellsConnection&&this.getCellsConnection.abort()},t.prototype.getCellsFromFrameRequest=function(t){$.getCellsFromFrameRequest(t),this.abortGetCellsConnection()},t.prototype.addSkeletalParagraph=function(t,n){try{var e=document.getElementById("WACFastView"),i=e.querySelectorAll(".Paragraph").length;if(20!==i&&60!==i)return!1;var r=e.querySelector(".Outline");if(r){var o=function(t,n){var e=document.createElement("div");e.id="SkeletalParagraph",e.style.width="100%",e.style.overflow="hidden",e.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";var r=t.querySelectorAll(".OutlineElement");-1!==r[r.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");var o=t.querySelector(".OutlineContent");o&&(i.style.paddingLeft=o.style.paddingLeft,i.style.paddingRight=o.style.paddingRight);for(var a=["92%","100%","93%","80%"],s=0;s<a.length;s+=1){var u=document.createElement("div");u.style.backgroundColor=n,u.style.width=a[s],u.style.height="14px",u.style.marginBottom="6px",i.appendChild(u)}return e.appendChild(i),e}(e,M.getSkeletalComponentColor(t,n));r.appendChild(o),M.addShimmerToElement(o.id)}}catch(t){return this.log("failed to add skeletal paragraph: "+t.message+"\r\n"+t.stack),!1}return!0},t.prototype.sendPostMessageToParentWindow=function(t,n,e){var i={MessageId:t,SendTime:Date.now(),Values:n},r=this.postMessageOrigin;e&&(r=e),window.parent.postMessage(JSON.stringify(i),r),this.log("Sent "+t)},t.prototype.receivePostMessage=function(n){if(n.origin===this.postMessageOrigin){var e;try{e=JSON.parse(n.data)}catch(t){return}switch(e.MessageId){case t.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case t.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure("WopiPendingSession_Fail");break;case t.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;var i=e.Values.WopiDetails;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.makeStartSessionRequest(i),this.beginStartSessionTimeout(!0);break;case t.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!e.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);var r=e.Values.StartSessionResponse;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.processStartSessionResponse(!1,r.RequestStatus,r.ResponseText);break;case t.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}},t.prototype.beginStartSessionTimeout=function(t){var n=this,e=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);e||(e=1e4),t?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((function(){return n.timeoutWopiStartSessionFromWacFrameMessage()}),e)):window.setTimeout((function(){return n.timeoutWopiStartSessionFromJsApiMessage()}),e)},t.prototype.sendReadyMessage=function(){var n=this;this.sendPostMessageToParentWindow(t.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((function(){return n.timeoutWacInitializeReadyAckMessage()}),t.wacInitializeReadyAckTimeoutInMs)},t.prototype.timeoutWacInitializeReadyAckMessage=function(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<t.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log("WacInitializeReadyAckTimeout. [RetriesRemain:"+(t.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount)+"]")):this.log("WacInitializeReadyAckTimeout. No retries remain"))},t.prototype.timeoutWopiPendingSessionMessage=function(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure("WopiPendingSession_Timeout")},t.prototype.timeoutWopiStartSessionFromJsApiMessage=function(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.timeoutWopiStartSessionFromWacFrameMessage=function(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.makeStartSessionRequest=function(t){var n=this,e=Z(this.instantAppSettings,0,!0,t),i=new $(null,e),r="WOPIsrc="+encodeURIComponent(t.WopiSrc);window.location.search&&(r+="&"+window.location.search.substr(1)),"true"===this.instantAppSettings.FileGetUrlPresent&&(r+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),i.makeStartSessionRequest("WordEditorStartSession.ashx?"+r,(function(t){return n.processStartSessionResponse(!0,t.status,t.responseText)}))},t.prototype.getAppSettingsFromResponse=function(t){try{return{success:!0,appSettings:JSON.parse(t)}}catch(t){return{success:!1,errorInfo:t.message+"\r\n"+t.stack}}},t.prototype.processStartSessionResponse=function(n,e,i){var r=this,o=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200===e){var a,s=this.getAppSettingsFromResponse(i);if(s.success)(a=s.appSettings)&&a.UrlToRedirect&&window.top.location.replace(a.UrlToRedirect),this.instantBootPltDiagnostics.isStartSessionFromWac=n,n&&(this.instantBootPltDiagnostics.startSessionCompleteTime=o),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),$t=s.appSettings,t.instantAppSettingsToPreserve.forEach((function(t){$t&&t in r.instantAppSettings&&($t[t]=r.instantAppSettings[t])})),t.getWindow().g_appSettings=$t,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(en.createSuccess());else this.initializeAppOnFailure("StartSession_AppSettingsParseError",s.errorInfo)}else this.initializeAppOnFailure("StartSession_Fail","Status "+e)},t.prototype.initializeAppOnFailure=function(n,e){$t=this.instantAppSettings,t.getWindow().g_appSettings=$t,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(en.createFailure(n,e))},t.prototype.initializeApp=function(n){n.success&&$t?this.startWacBoot($t):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:n.errorCode,extraErrorInfo:n.extraErrorInfo}),$t&&n.errorCode&&($t.InstantBoot_FailureCode=n.errorCode),n.errorCode&&n.extraErrorInfo&&$t&&($t[n.errorCode]=n.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),t.getWindow().g_livebooksJsDownloaded&&(t.getWindow().Sys.Application.get_isInitialized()?t.getWindow().g_liveBooksAppConstructed||pageInit():(t.getWindow().Sys.Application.add_init(pageInit),t.getWindow().Sys.Application.initialize()))},t.prototype.log=function(t){this.logs.push({time:Date.now(),message:t})},t.prototype.sendBeacon=function(n,e){t.getWindow()._bB&&t.getWindow()._bB.sendBeacon(n,e)},t.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",t.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",t.fromJsApiPendingSessionFail="WopiPendingSession_Fail",t.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",t.fromJsApiStartSessionComplete="WopiStartSession_Complete",t.toJsApiInitReady="WacInitialize_Ready",t.toJsApiAppFailed="Wac_AppFailed",t.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",t.wacInitializeReadyMaxRetries=3,t.wacInitializeReadyAckTimeoutInMs=1e3,t.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName"],t}(),on=function(t){if(!s){s=new r({container:t,layoutCollection:{Landscape:{Default:[{id:"KeyboardRegion"}]},Portrait:{Default:[{id:"KeyboardRegion"}],Small:[{id:"KeyboardRegion"}]},DP:{Default:[{id:"FarPane"},{id:"KeyboardRegion"}]},DL:{Default:[{id:"KeyboardRegion"}]}}})}};e.d(n,"show",(function(){return on})),e.d(n,"dispose",(function(){return c})),e.d(n,"getRegion",(function(){return u})),e.d(n,"WindowUtil",(function(){return i})),e.d(n,"CtrlWheelMetrics",(function(){return l})),e.d(n,"FastViewLogEntry",(function(){return D})),e.d(n,"FastView",(function(){return T})),e.d(n,"FastViewUtils",(function(){return C})),e.d(n,"isTouchSupport",(function(){return R})),e.d(n,"cssClassAbsolute",(function(){return"WACFastViewAbsolute"})),e.d(n,"cssClass",(function(){return"WACFastView"})),e.d(n,"cssPositionRewriteClass",(function(){return"WACFastViewPositionRewrite"})),e.d(n,"getFastViewCssClasses",(function(){return k})),e.d(n,"removeSplashScreen",(function(){return x})),e.d(n,"setFastViewScrollTop",(function(){return y})),e.d(n,"makeStyleChangesToHideHeader",(function(){return P})),e.d(n,"sendWacBeacon",(function(){return I})),e.d(n,"ShiftUtils",(function(){return A})),e.d(n,"SkeletalBoot",(function(){return O})),e.d(n,"bootSettings",(function(){return f})),e.d(n,"FastViewSettings",(function(){return h})),e.d(n,"WacSkeletalBoot",(function(){return M})),e.d(n,"WindowVisibilityMetrics",(function(){return B})),e.d(n,"DocumentCacheItem",(function(){return H})),e.d(n,"LocalStorageDocumentCache",(function(){return U})),e.d(n,"LocalStorageDocumentCacheTest",(function(){return q})),e.d(n,"WordEditorInstantAppResult",(function(){return en})),e.d(n,"WordEditorInstantApp",(function(){return rn})),e.d(n,"startWacBoot",(function(){return tn}))},,function(t,n,e){"use strict";var i;e.d(n,"a",(function(){return i})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(i||(i={}))}]);
//# sourceMappingURL=wacBoot.min.js.map